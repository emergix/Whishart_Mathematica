(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 6.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[   1190948,      26839]
NotebookOptionsPosition[   1166577,      26086]
NotebookOutlinePosition[   1166977,      26103]
CellTagsIndexPosition[   1166934,      26100]
WindowFrame->Normal
ContainsDynamic->False*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"<<", " ", 
  "\"\<C:\\\\Documents and Settings\\\\ocroissant\\\\My Documents\\\\BiHeston\
\\\\BiHeston_CompiledFunctions.m\>\""}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.404645251981682*^9, 3.40464527556026*^9}, {
  3.4049789141052*^9, 3.4049789197042*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"CompiledFunction", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"k1", ",", "k2", ",", "K", ",", "\[Beta]", ",", "b"}], "}"}], 
    ",", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"b", " ", "K", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox["K", "\[Beta]"], ")"}], 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]]}], 
      RowBox[{
       RowBox[{"b", " ", "k1", " ", "k2"}], "+", 
       RowBox[{"\[ImaginaryI]", " ", 
        SuperscriptBox["k2", "2"], " ", "k1"}]}]]}], 
    ",", "\<\"-CompiledCode-\"\>"}], "]"}],
  False,
  Editable->False]], "Output",
 CellChangeTimes->{3.405009567792348*^9, 3.4050704200342665`*^9, 
  3.405070737308014*^9, 3.4050716822853293`*^9, 3.405072635153472*^9, 
  3.4050923369234495`*^9, 3.4056664218711033`*^9, 3.4057555239067707`*^9, 
  3.405783245461258*^9, 3.4058307556546865`*^9, 3.4058677981045566`*^9, 
  3.405934894884112*^9, 3.405937076394746*^9, 3.4064724738296733`*^9, 
  3.4064725827543364`*^9, 3.4064730769388623`*^9, 3.406562235952747*^9, 
  3.406616204198513*^9, 3.4068884233176517`*^9, 3.4069608933874817`*^9, 
  3.4074808396669874`*^9, 3.4075831748494005`*^9, 3.4076703991429996`*^9, 
  3.4078495171038*^9, 3.4081959454733872`*^9, 3.4082021041400003`*^9, 
  3.4082023687790003`*^9, 3.408382051760319*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Spreadoption Vanille ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[Alpha]", " ", 
       SuperscriptBox[
        SubscriptBox["S", "1"], "a"]}], "-", 
      RowBox[{"\[Beta]", " ", 
       SuperscriptBox[
        SubscriptBox["S", "2"], "b"]}], "-", "K"}], ")"}], "+"], 
   TraditionalForm]]]
}], "Subtitle",
 CellChangeTimes->{{3.4026388686724606`*^9, 3.4026388811727004`*^9}, {
  3.404630792762659*^9, 3.404630809558997*^9}, {3.4048121803219595`*^9, 
  3.4048121923849225`*^9}, {3.405938214182216*^9, 3.4059382196823215`*^9}}],

Cell["Handling", "Text",
 CellChangeTimes->{{3.4059584675710735`*^9, 3.405958469274232*^9}}],

Cell[CellGroupData[{

Cell["High Level interface", "Subsubtitle",
 CellChangeTimes->{{3.404642425693043*^9, 3.404642434083829*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SmileBiHestonVanilla", "[", 
   RowBox[{
   "S_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "a_", ",", "b_", ",", 
    "KList1_", ",", "\[Tau]_", ",", "\[CapitalSigma]_", ",", "M_", ",", 
    "\[CapitalSigma]inf_", ",", "\[Beta]_", ",", "\[Rho]_", ",", "\[Mu]_", 
    ",", "printflag_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "KList", ",", "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", 
      ",", "period1n", ",", "\[Epsilon]1", ",", "LegendreCoef2", ",", 
      "period2", ",", "period2n", ",", "\[Epsilon]2", ",", "imax", ",", 
      "\[Lambda]1", ",", "\[Lambda]2", ",", "Q", ",", "KListPositive", ",", 
      "KListNegative", ",", 
      RowBox[{"KPositivePrices", "=", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"KNegativePrices", "=", 
       RowBox[{"{", "}"}]}], ",", "prices", ",", "startmonitortime", ",", 
      "plafondexplosion", ",", "initialTailFlag", ",", "InitialTailPosition", 
      ",", "InitialTailPosition2", ",", "kmax", ",", "StartControl", ",", 
      "IncrementFactor"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "KList1", "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{"KList", "=", 
        RowBox[{"{", "KList1", "}"}]}], ",", 
       RowBox[{"KList", "=", "KList1"}]}], "]"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"Q", "=", 
      RowBox[{
       RowBox[{"CholeskyDecomposition", "[", 
        RowBox[{"-", 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"M", ".", "\[CapitalSigma]inf"}], "+", 
            RowBox[{"\[CapitalSigma]inf", ".", " ", 
             RowBox[{"Transpose", "[", "M", "]"}]}]}], "2"], ")"}]}], "]"}], 
       "/", "\[Beta]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", ",", 
          "period1n", ",", "\[Epsilon]1", ",", "startmonitortime", ",", 
          "plafondexplosion", ",", "initialTailFlag", ",", 
          "InitialTailPosition", ",", "InitialTailPosition2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "LegendreCoef2", ",", "period2", ",", "period2n", ",", "\[Epsilon]2",
           ",", "kmax", ",", "StartControl", ",", "IncrementFactor"}], "}"}], 
        ",", "imax", ",", "\[Lambda]1", ",", "\[Lambda]2"}], "}"}], "=", 
      RowBox[{"BiHestonVanillaOptimalParameters", "[", 
       RowBox[{
       "S", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", "b", ",", 
        RowBox[{"KList", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "\[Tau]", ",", 
        "\[CapitalSigma]", ",", "M", ",", "\[CapitalSigma]inf", ",", "Q", ",",
         "\[Rho]", ",", "\[Mu]", ",", "\"\<VanillaSpreadoption\>\"", ",", 
        "printflag"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"KListPositive", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"KList", ",", 
        RowBox[{
         RowBox[{"#", "\[GreaterEqual]", "0"}], "&"}]}], "]"}]}], ";", 
     RowBox[{"KListNegative", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"KList", ",", 
        RowBox[{
         RowBox[{"#", "<", "0"}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "KListPositive", "]"}], ">", "0"}], ",", 
       RowBox[{"KPositivePrices", "=", 
        RowBox[{"SmileBiHestonVanillaPositiveK", "[", 
         RowBox[{
         "S", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", "b", ",", 
          "KListPositive", ",", "\[Tau]", ",", "\[CapitalSigma]", ",", "M", 
          ",", "\[CapitalSigma]inf", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", 
          ",", "\[Beta]", ",", "\[Lambda]1", ",", "\[Lambda]2", ",", 
          RowBox[{"{", 
           RowBox[{
           "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", ",", 
            "period1n", ",", "\[Epsilon]1", ",", "imax", ",", 
            "startmonitortime", ",", "plafondexplosion", ",", 
            "initialTailFlag", ",", "InitialTailPosition", ",", 
            "InitialTailPosition2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "LegendreCoef2", ",", "period2", ",", "period2n", ",", 
            "\[Epsilon]2", ",", "kmax", ",", "StartControl", ",", 
            "IncrementFactor"}], "}"}], ",", "printflag"}], "]"}]}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"printflag", "\[Equal]", "1"}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", " ", ",", "1"}], "]"}], ")"}]}], ",", 
       RowBox[{"Print", "[", "\"\<Fin partie positive\>\"", "]"}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "KListNegative", "]"}], ">", "0"}], ",", 
       RowBox[{"KNegativePrices", "=", 
        RowBox[{"SmileBiHestonVanillaNegativeK", "[", 
         RowBox[{
         "S", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", "b", ",", 
          "KListNegative", ",", "\[Tau]", ",", "\[CapitalSigma]", ",", "M", 
          ",", "\[CapitalSigma]inf", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", 
          ",", "\[Beta]", ",", "\[Lambda]1", ",", "\[Lambda]2", ",", 
          RowBox[{"{", 
           RowBox[{
           "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", ",", 
            "period1n", ",", "\[Epsilon]1", ",", "imax", ",", 
            "startmonitortime", ",", "plafondexplosion", ",", 
            "initialTailFlag", ",", "InitialTailPosition", ",", 
            "InitialTailPosition2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "LegendreCoef2", ",", "period2", ",", "period2n", ",", 
            "\[Epsilon]2", ",", "kmax", ",", "StartControl", ",", 
            "IncrementFactor"}], "}"}], ",", "printflag"}], "]"}]}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"prices", "=", 
      RowBox[{"Join", "[", 
       RowBox[{"KNegativePrices", ",", "KPositivePrices"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Alpha]1", " ", 
           RowBox[{
            RowBox[{"S", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "^", "a"}]}], "-", 
          RowBox[{"\[Beta]1", " ", 
           RowBox[{
            RowBox[{"S", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "^", "b"}]}], "-", 
          RowBox[{"KList1", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ",", "0", ",", 
         RowBox[{"prices", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "KList1", "]"}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4042074577632284`*^9, 3.4042074770760994`*^9}, {
   3.4042075328115444`*^9, 3.4042077538626633`*^9}, {3.404207970241818*^9, 
   3.404207993351637*^9}, {3.4042080286491895`*^9, 3.404208043665103*^9}, {
   3.4042173037335176`*^9, 3.4042173873444977`*^9}, {3.4042175109093704`*^9, 
   3.404217554472707*^9}, {3.4042999349691343`*^9, 3.4042999555923347`*^9}, {
   3.404381253215744*^9, 3.404381270172944*^9}, {3.4044634862113743`*^9, 
   3.4044635745846777`*^9}, {3.404463622474383*^9, 3.4044637577842846`*^9}, {
   3.4044637895649247`*^9, 3.4044638511887417`*^9}, {3.404463881485035*^9, 
   3.404463962092862*^9}, {3.4044646348143206`*^9, 3.4044646352830615`*^9}, {
   3.4044659090554795`*^9, 3.4044659091648526`*^9}, {3.404466252111393*^9, 
   3.4044662673767247`*^9}, {3.4044662976417685`*^9, 
   3.4044662980323863`*^9}, {3.4044673732461166`*^9, 
   3.4044673808397207`*^9}, {3.4046519546877003`*^9, 
   3.4046519750474663`*^9}, {3.4046528875181103`*^9, 3.404652993051387*^9}, 
   3.404811180721076*^9, {3.404811251817556*^9, 3.404811256317729*^9}, 
   3.404826602406996*^9, {3.4048266367520647`*^9, 3.4048266473149705`*^9}, {
   3.404838584300705*^9, 3.404838585847639*^9}, 3.405092320454278*^9, {
   3.405664986154463*^9, 3.405665079594355*^9}, {3.405665127720587*^9, 
   3.405665280114807*^9}, 3.405665328600113*^9, {3.406309714793578*^9, 
   3.406309844411578*^9}, {3.406309920658578*^9, 3.406309939960578*^9}, {
   3.406471623651659*^9, 3.4064716512929916`*^9}, {3.4065572919668093`*^9, 
   3.4065573000451407`*^9}, {3.406612407397131*^9, 3.4066124373510227`*^9}, {
   3.406960300219844*^9, 3.4069603147826233`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SmileBiHestonVanilla3", "[", 
   RowBox[{
   "S_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "a_", ",", "b_", ",", 
    "KList1_", ",", "\[Tau]_", ",", "\[CapitalSigma]_", ",", "M_", ",", "Q_", 
    ",", "\[Beta]_", ",", "\[Rho]_", ",", "\[Mu]_", ",", "printflag_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "KList", ",", "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", 
      ",", "period1n", ",", "\[Epsilon]1", ",", "LegendreCoef2", ",", 
      "period2", ",", "period2n", ",", "\[Epsilon]2", ",", "imax", ",", 
      "\[Lambda]1", ",", "\[Lambda]2", ",", "KListPositive", ",", 
      "KListNegative", ",", 
      RowBox[{"KPositivePrices", "=", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"KNegativePrices", "=", 
       RowBox[{"{", "}"}]}], ",", "prices", ",", "startmonitortime", ",", 
      "plafondexplosion", ",", "initialTailFlag", ",", "InitialTailPosition", 
      ",", "InitialTailPosition2", ",", "kmax", ",", "StartControl", ",", 
      "IncrementFactor", ",", "\[CapitalSigma]inf"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[CapitalSigma]inf", "=", 
      RowBox[{"\[CapitalSigma]inf", "=", 
       RowBox[{"SolveSymetricEquation", "[", 
        RowBox[{"M", ",", 
         RowBox[{
          RowBox[{"-", "2"}], 
          SuperscriptBox["\[Beta]", "2"], " ", 
          RowBox[{
           RowBox[{"Transpose", "[", "Q", "]"}], ".", "Q"}]}]}], "]"}]}]}], 
     " ", ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "KList1", "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{"KList", "=", 
        RowBox[{"{", "KList1", "}"}]}], ",", 
       RowBox[{"KList", "=", "KList1"}]}], "]"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", ",", 
          "period1n", ",", "\[Epsilon]1", ",", "startmonitortime", ",", 
          "plafondexplosion", ",", "initialTailFlag", ",", 
          "InitialTailPosition", ",", "InitialTailPosition2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "LegendreCoef2", ",", "period2", ",", "period2n", ",", "\[Epsilon]2",
           ",", "kmax", ",", "StartControl", ",", "IncrementFactor"}], "}"}], 
        ",", "imax", ",", "\[Lambda]1", ",", "\[Lambda]2"}], "}"}], "=", 
      RowBox[{"BiHestonVanillaOptimalParameters", "[", 
       RowBox[{
       "S", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", "b", ",", 
        RowBox[{"KList", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "\[Tau]", ",", 
        "\[CapitalSigma]", ",", "M", ",", "\[CapitalSigma]inf", ",", "Q", ",",
         "\[Rho]", ",", "\[Mu]", ",", "\"\<VanillaSpreadoption\>\"", ",", 
        "printflag"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"KListPositive", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"KList", ",", 
        RowBox[{
         RowBox[{"#", "\[GreaterEqual]", "0"}], "&"}]}], "]"}]}], ";", 
     RowBox[{"KListNegative", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"KList", ",", 
        RowBox[{
         RowBox[{"#", "<", "0"}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "KListPositive", "]"}], ">", "0"}], ",", 
       RowBox[{"KPositivePrices", "=", 
        RowBox[{"SmileBiHestonVanillaPositiveK", "[", 
         RowBox[{
         "S", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", "b", ",", 
          "KListPositive", ",", "\[Tau]", ",", "\[CapitalSigma]", ",", "M", 
          ",", "\[CapitalSigma]inf", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", 
          ",", "\[Beta]", ",", "\[Lambda]1", ",", "\[Lambda]2", ",", 
          RowBox[{"{", 
           RowBox[{
           "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", ",", 
            "period1n", ",", "\[Epsilon]1", ",", "imax", ",", 
            "startmonitortime", ",", "plafondexplosion", ",", 
            "initialTailFlag", ",", "InitialTailPosition", ",", 
            "InitialTailPosition2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "LegendreCoef2", ",", "period2", ",", "period2n", ",", 
            "\[Epsilon]2", ",", "kmax", ",", "StartControl", ",", 
            "IncrementFactor"}], "}"}], ",", "printflag"}], "]"}]}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"printflag", "\[Equal]", "1"}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", " ", ",", "1"}], "]"}], ")"}]}], ",", 
       RowBox[{"Print", "[", "\"\<Fin partie positive\>\"", "]"}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "KListNegative", "]"}], ">", "0"}], ",", 
       RowBox[{"KNegativePrices", "=", 
        RowBox[{"SmileBiHestonVanillaNegativeK", "[", 
         RowBox[{
         "S", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", "b", ",", 
          "KListNegative", ",", "\[Tau]", ",", "\[CapitalSigma]", ",", "M", 
          ",", "\[CapitalSigma]inf", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", 
          ",", "\[Beta]", ",", "\[Lambda]1", ",", "\[Lambda]2", ",", 
          RowBox[{"{", 
           RowBox[{
           "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", ",", 
            "period1n", ",", "\[Epsilon]1", ",", "imax", ",", 
            "startmonitortime", ",", "plafondexplosion", ",", 
            "initialTailFlag", ",", "InitialTailPosition", ",", 
            "InitialTailPosition2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "LegendreCoef2", ",", "period2", ",", "period2n", ",", 
            "\[Epsilon]2", ",", "kmax", ",", "StartControl", ",", 
            "IncrementFactor"}], "}"}], ",", "printflag"}], "]"}]}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"prices", "=", 
      RowBox[{"Join", "[", 
       RowBox[{"KNegativePrices", ",", "KPositivePrices"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Alpha]1", " ", 
           RowBox[{
            RowBox[{"S", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "^", "a"}]}], "-", 
          RowBox[{"\[Beta]1", " ", 
           RowBox[{
            RowBox[{"S", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "^", "b"}]}], "-", 
          RowBox[{"KList1", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ",", "0", ",", 
         RowBox[{"prices", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "KList1", "]"}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4042074577632284`*^9, 3.4042074770760994`*^9}, {
   3.4042075328115444`*^9, 3.4042077538626633`*^9}, {3.404207970241818*^9, 
   3.404207993351637*^9}, {3.4042080286491895`*^9, 3.404208043665103*^9}, {
   3.4042173037335176`*^9, 3.4042173873444977`*^9}, {3.4042175109093704`*^9, 
   3.404217554472707*^9}, {3.4042999349691343`*^9, 3.4042999555923347`*^9}, {
   3.404381253215744*^9, 3.404381270172944*^9}, {3.4044634862113743`*^9, 
   3.4044635745846777`*^9}, {3.404463622474383*^9, 3.4044637577842846`*^9}, {
   3.4044637895649247`*^9, 3.4044638511887417`*^9}, {3.404463881485035*^9, 
   3.404463962092862*^9}, {3.4044646348143206`*^9, 3.4044646352830615`*^9}, {
   3.4044659090554795`*^9, 3.4044659091648526`*^9}, {3.404466252111393*^9, 
   3.4044662673767247`*^9}, {3.4044662976417685`*^9, 
   3.4044662980323863`*^9}, {3.4044673732461166`*^9, 
   3.4044673808397207`*^9}, {3.4046519546877003`*^9, 
   3.4046519750474663`*^9}, {3.4046528875181103`*^9, 3.404652993051387*^9}, 
   3.404811180721076*^9, {3.404811251817556*^9, 3.404811256317729*^9}, 
   3.404826602406996*^9, {3.4048266367520647`*^9, 3.4048266473149705`*^9}, {
   3.404838584300705*^9, 3.404838585847639*^9}, 3.405092320454278*^9, {
   3.405664986154463*^9, 3.405665079594355*^9}, {3.405665127720587*^9, 
   3.405665280114807*^9}, 3.405665328600113*^9, {3.406309714793578*^9, 
   3.406309844411578*^9}, {3.406309920658578*^9, 3.406309939960578*^9}, {
   3.406471623651659*^9, 3.4064716512929916`*^9}, {3.4065572919668093`*^9, 
   3.4065573000451407`*^9}, {3.406612407397131*^9, 3.4066124373510227`*^9}, {
   3.406960300219844*^9, 3.4069603147826233`*^9}, {3.4070484093800545`*^9, 
   3.407048424458469*^9}, {3.4070568540421886`*^9, 3.4070568786207857`*^9}, 
   3.407583314664401*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TestBiHestonVanilla", "[", 
   RowBox[{
   "S_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "a_", ",", "b_", ",", "K_",
     ",", "\[Tau]_", ",", "\[CapitalSigma]_", ",", "M_", ",", 
    "\[CapitalSigma]inf_", ",", "\[Beta]_", ",", "\[Rho]_", ",", "\[Mu]_", 
    ",", "\[Lambda]1_", ",", "\[Lambda]2_", ",", "\[Omega]1_", ",", 
    "scope_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"KList", ",", "Q", ",", "as", ",", "res", ",", "res2", ",", 
      RowBox[{"Y", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Log", "[", 
          RowBox[{"S", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
         RowBox[{"Log", "[", 
          RowBox[{"S", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Q", "=", 
      RowBox[{
       RowBox[{"CholeskyDecomposition", "[", 
        RowBox[{"-", 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"M", ".", "\[CapitalSigma]inf"}], "+", 
            RowBox[{"\[CapitalSigma]inf", ".", " ", 
             RowBox[{"Transpose", "[", "M", "]"}]}]}], "2"], ")"}]}], "]"}], 
       "/", "\[Beta]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"SmileSymetrizedBiHestonVanillaIntegrand", "[", 
         RowBox[{
         "Y", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", "b", ",", 
          RowBox[{"{", "K", "}"}], ",", "\[Tau]", ",", "\[CapitalSigma]", ",",
           "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", "\[Beta]", ",", 
          "\[Lambda]1", ",", "\[Lambda]2", ",", "\[Omega]1", ",", 
          "\[Omega]2"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Omega]2", ",", "0", " ", ",", 
         RowBox[{"2", "scope"}]}], "}"}], ",", 
       RowBox[{"PlotPoints", "\[Rule]", "50"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", 
        RowBox[{"\"\<Integrand spreadoption : K =\>\"", "<>", 
         RowBox[{"ToString", "[", "K", "]"}], "<>", "\"\< \[Omega]1=\>\"", "<>",
          
         RowBox[{"ToString", "[", "\[Omega]1", "]"}]}]}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4042074577632284`*^9, 3.4042074770760994`*^9}, {
   3.4042075328115444`*^9, 3.4042077538626633`*^9}, {3.404207970241818*^9, 
   3.404207993351637*^9}, {3.4042080286491895`*^9, 3.404208043665103*^9}, {
   3.4042173037335176`*^9, 3.4042173873444977`*^9}, {3.4042175109093704`*^9, 
   3.404217554472707*^9}, {3.4042999349691343`*^9, 3.4042999555923347`*^9}, {
   3.404381253215744*^9, 3.404381270172944*^9}, {3.4044634862113743`*^9, 
   3.4044635745846777`*^9}, {3.404463622474383*^9, 3.4044637577842846`*^9}, {
   3.4044637895649247`*^9, 3.4044638511887417`*^9}, {3.404463881485035*^9, 
   3.404463962092862*^9}, {3.4044646348143206`*^9, 3.4044646352830615`*^9}, {
   3.4044659090554795`*^9, 3.4044659091648526`*^9}, {3.404466252111393*^9, 
   3.4044662673767247`*^9}, {3.4044662976417685`*^9, 
   3.4044662980323863`*^9}, {3.4044673732461166`*^9, 
   3.4044673808397207`*^9}, {3.4046519546877003`*^9, 
   3.4046519750474663`*^9}, {3.4046528875181103`*^9, 3.404652993051387*^9}, 
   3.404811180721076*^9, {3.404811251817556*^9, 3.404811256317729*^9}, 
   3.404826602406996*^9, {3.4048266367520647`*^9, 3.4048266473149705`*^9}, {
   3.404838584300705*^9, 3.404838585847639*^9}, {3.404888355750947*^9, 
   3.4048883751261473`*^9}, {3.404888409087347*^9, 3.4048884100857472`*^9}, 
   3.404888482298147*^9, {3.404888523107747*^9, 3.404888593260947*^9}, {
   3.4048886239773474`*^9, 3.404888647377347*^9}, {3.4048888242189474`*^9, 
   3.4048888357941475`*^9}, {3.4048891031157475`*^9, 3.404889148121747*^9}, {
   3.404889229444547*^9, 3.404889260831747*^9}, {3.404889328176947*^9, 
   3.404889408579347*^9}, {3.4048896364485474`*^9, 3.4048896370257473`*^9}, {
   3.4048906491191473`*^9, 3.404890657433947*^9}, 3.4048906939379473`*^9, {
   3.4048908372083473`*^9, 3.404890839158347*^9}, {3.4048912343375473`*^9, 
   3.4048912741487474`*^9}, {3.40646429265149*^9, 3.40646432916805*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Test2BiHestonVanilla", "[", 
   RowBox[{
   "S_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "a_", ",", "b_", ",", "K_",
     ",", "\[Tau]_", ",", "\[CapitalSigma]_", ",", "M_", ",", 
    "\[CapitalSigma]inf_", ",", "\[Beta]_", ",", "\[Rho]_", ",", "\[Mu]_", 
    ",", "\[Lambda]1_", ",", "\[Lambda]2_", ",", 
    RowBox[{"{", 
     RowBox[{
     "LegendreCoef1_", ",", "LegendreCoef1n_", ",", "period1_", ",", 
      "period1n_", ",", "\[Epsilon]1_", ",", "imax_", ",", 
      "startmonitortime_", ",", "plafondexplosion_", ",", "initialTailFlag_", 
      ",", "InitialTailPosition_"}], "}"}], ",", "scope_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"period", ",", "Q", ",", "as", ",", "res", ",", "res2", ",", 
      RowBox[{"Y", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Log", "[", 
          RowBox[{"S", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
         RowBox[{"Log", "[", 
          RowBox[{"S", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}], ",", "tt", ",", 
      "Y0"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Q", "=", 
      RowBox[{
       RowBox[{"CholeskyDecomposition", "[", 
        RowBox[{"-", 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"M", ".", "\[CapitalSigma]inf"}], "+", 
            RowBox[{"\[CapitalSigma]inf", ".", " ", 
             RowBox[{"Transpose", "[", "M", "]"}]}]}], "2"], ")"}]}], "]"}], 
       "/", "\[Beta]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"period", "=", "scope"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Y0", "=", 
      RowBox[{
       RowBox[{"AdaptativeIntegrate", "[", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{"\[Omega]1", ",", 
           RowBox[{
            RowBox[{"SmileSymetrizedBiHestonVanillaIntegrandCC", "[", 
             RowBox[{
             "Y", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", "b", ",", 
              
              RowBox[{"{", "K", "}"}], ",", "\[Tau]", ",", "\[CapitalSigma]", 
              ",", "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", "\[Beta]",
               ",", "\[Lambda]1", ",", "\[Lambda]2", ",", "\[Omega]1", ",", 
              "0"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", "LegendreCoef1", 
         ",", "LegendreCoef1n", ",", "period1", ",", "period1n", ",", 
         "\[Epsilon]1", ",", "imax"}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tt", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Omega]2", ",", 
          RowBox[{
           RowBox[{"VectorAdaptativeIntegrateExplosionSafe", "[", 
            RowBox[{
             RowBox[{"Function", "[", 
              RowBox[{"\[Omega]1", ",", 
               RowBox[{
                RowBox[{"SmileSymetrizedBiHestonVanillaIntegrandCC", "[", 
                 RowBox[{
                 "Y", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", "b", 
                  ",", 
                  RowBox[{"{", "K", "}"}], ",", "\[Tau]", ",", 
                  "\[CapitalSigma]", ",", "M", ",", "Q", ",", "\[Rho]", ",", 
                  "\[Mu]", ",", "\[Beta]", ",", "\[Lambda]1", ",", 
                  "\[Lambda]2", ",", "\[Omega]1", ",", "\[Omega]2"}], "]"}], 
                "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", "LegendreCoef1",
              ",", "LegendreCoef1n", ",", "period1", ",", "period1n", ",", 
             "\[Epsilon]1", ",", "imax", ",", "1", ",", "startmonitortime", 
             ",", "plafondexplosion", ",", "initialTailFlag", ",", 
             "InitialTailPosition"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Omega]2", ",", "0", ",", "period", ",", 
          RowBox[{"period", "/", "100"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ListPlot", "[", 
      RowBox[{"tt", ",", 
       RowBox[{"Joined", "\[Rule]", "True"}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", "\"\<U1:2nd Inv. Fourier:\>\""}], ",", 
       
       RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}]}], "]"}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.4060287212753143`*^9, 3.4060288323243217`*^9}, {
   3.4060295386347575`*^9, 3.4060295388378863`*^9}, {3.406029734997903*^9, 
   3.4060297570139503`*^9}, {3.4060298386405177`*^9, 3.40602983982804*^9}, {
   3.4064662625300426`*^9, 3.406466302484191*^9}, 3.406469356562373*^9, 
   3.4064697568851213`*^9, {3.4064697940266967`*^9, 3.4064697991987047`*^9}, {
   3.4064699252956824`*^9, 3.4064699261238284`*^9}, {3.4065580863152685`*^9, 
   3.406558093127943*^9}, {3.4066124566483917`*^9, 3.406612458039052*^9}, {
   3.4066125093528657`*^9, 3.4066125365410614`*^9}, {3.4066128419863806`*^9, 
   3.406612843048908*^9}, {3.406612915378885*^9, 3.406612916441412*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SmileBiHestonVanilla2", "[", 
   RowBox[{
   "S_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "a_", ",", "b_", ",", 
    "KList1_", ",", "\[Tau]_", ",", "\[CapitalSigma]_", ",", "M_", ",", 
    "\[CapitalSigma]inf_", ",", "Q_", ",", "\[Rho]_", ",", "\[Mu]_", ",", 
    "printflag_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "KList", ",", "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", 
      ",", "period1n", ",", "\[Epsilon]1", ",", "LegendreCoef2", ",", 
      "period2", ",", "period2n", ",", "\[Epsilon]2", ",", "imax", ",", 
      "\[Lambda]1", ",", "\[Lambda]2", ",", "KListPositive", ",", 
      "KListNegative", ",", 
      RowBox[{"KPositivePrices", "=", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"KNegativePrices", "=", 
       RowBox[{"{", "}"}]}], ",", "\[Beta]m", ",", "prices", ",", 
      "startmonitortime", ",", "plafondexplosion", ",", "initialTailFlag", 
      ",", "InitialTailPosition", ",", "InitialTailPosition2", ",", "kmax", 
      ",", "StartControl", ",", "IncrementFactor"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "KList1", "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{"KList", "=", 
        RowBox[{"{", "KList1", "}"}]}], ",", 
       RowBox[{"KList", "=", "KList1"}]}], "]"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"\[Beta]m", "=", 
      RowBox[{"-", 
       RowBox[{
        RowBox[{"(", 
         FractionBox[
          RowBox[{
           RowBox[{"M", ".", "\[CapitalSigma]inf"}], "+", 
           RowBox[{"\[CapitalSigma]inf", ".", 
            RowBox[{"Transpose", "[", "M", "]"}]}]}], "2"], ")"}], ".", 
        RowBox[{"Inverse", "[", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Transpose", "[", "Q", "]"}], ".", "Q"}], ")"}], 
         "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", ",", 
          "period1n", ",", "\[Epsilon]1", ",", "startmonitortime", ",", 
          "plafondexplosion", ",", "initialTailFlag", ",", 
          "InitialTailPosition", ",", "InitialTailPosition2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "LegendreCoef2", ",", "period2", ",", "period2n", ",", "\[Epsilon]2",
           ",", "kmax", ",", "StartControl", ",", "IncrementFactor"}], "}"}], 
        ",", "imax", ",", "\[Lambda]1", ",", "\[Lambda]2"}], "}"}], "=", 
      RowBox[{"BiHestonVanillaOptimalParameters", "[", 
       RowBox[{
       "S", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", "b", ",", 
        RowBox[{"KList", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "\[Tau]", ",", 
        "\[CapitalSigma]", ",", "M", ",", "\[CapitalSigma]inf", ",", "Q", ",",
         "\[Rho]", ",", "\[Mu]", ",", "\"\<VanillaSpreadoption\>\"", ",", 
        "printflag"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"KListPositive", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"KList", ",", 
        RowBox[{
         RowBox[{"#", "\[GreaterEqual]", "0"}], "&"}]}], "]"}]}], ";", 
     RowBox[{"KListNegative", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"KList", ",", 
        RowBox[{
         RowBox[{"#", "<", "0"}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "KListPositive", "]"}], ">", "0"}], ",", 
       RowBox[{"KPositivePrices", "=", 
        RowBox[{"SmileBiHestonVanillaPositiveK2", "[", 
         RowBox[{
         "S", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", "b", ",", 
          "KListPositive", ",", "\[Tau]", ",", "\[CapitalSigma]", ",", "M", 
          ",", "\[CapitalSigma]inf", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", 
          ",", "\[Beta]m", ",", "\[Lambda]1", ",", "\[Lambda]2", ",", 
          RowBox[{"{", 
           RowBox[{
           "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", ",", 
            "period1n", ",", "\[Epsilon]1", ",", "imax", ",", 
            "startmonitortime", ",", "plafondexplosion", ",", 
            "initialTailFlag", ",", "InitialTailPosition", ",", 
            "InitialTailPosition2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "LegendreCoef2", ",", "period2", ",", "period2n", ",", 
            "\[Epsilon]2", ",", "kmax", ",", "StartControl", ",", 
            "IncrementFactor"}], "}"}], ",", "printflag"}], "]"}]}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"printflag", "\[Equal]", "1"}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", " ", ",", "1"}], "]"}], ")"}]}], ",", 
       RowBox[{"Print", "[", "\"\<Fin partie positive\>\"", "]"}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "KListNegative", "]"}], ">", "0"}], ",", 
       RowBox[{"KNegativePrices", "=", 
        RowBox[{"SmileBiHestonVanillaNegativeK2", "[", 
         RowBox[{
         "S", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", "b", ",", 
          "KListNegative", ",", "\[Tau]", ",", "\[CapitalSigma]", ",", "M", 
          ",", "\[CapitalSigma]inf", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", 
          ",", "\[Beta]m", ",", "\[Lambda]1", ",", "\[Lambda]2", ",", 
          RowBox[{"{", 
           RowBox[{
           "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", ",", 
            "period1n", ",", "\[Epsilon]1", ",", "imax", ",", 
            "startmonitortime", ",", "plafondexplosion", ",", 
            "initialTailFlag", ",", "InitialTailPosition", ",", 
            "InitialTailPosition2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "LegendreCoef2", ",", "period2", ",", "period2n", ",", 
            "\[Epsilon]2", ",", "kmax", ",", "StartControl", ",", 
            "IncrementFactor"}], "}"}], ",", "printflag"}], "]"}]}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"prices", "=", 
      RowBox[{"Join", "[", 
       RowBox[{"KNegativePrices", ",", "KPositivePrices"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Alpha]1", " ", 
           SuperscriptBox[
            RowBox[{"S", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "a"]}], "-", 
          RowBox[{"\[Beta]1", " ", 
           SuperscriptBox[
            RowBox[{"S", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "b"]}], "-", 
          RowBox[{"KList1", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ",", "0", ",", 
         RowBox[{"prices", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "KList1", "]"}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4042074577632284`*^9, 3.4042074770760994`*^9}, {
   3.4042075328115444`*^9, 3.4042077538626633`*^9}, {3.404207970241818*^9, 
   3.404207993351637*^9}, {3.4042080286491895`*^9, 3.404208043665103*^9}, {
   3.4042173037335176`*^9, 3.4042173873444977`*^9}, {3.4042175109093704`*^9, 
   3.404217554472707*^9}, {3.4042999349691343`*^9, 3.4042999555923347`*^9}, {
   3.404381253215744*^9, 3.404381270172944*^9}, {3.4044634862113743`*^9, 
   3.4044635745846777`*^9}, {3.404463622474383*^9, 3.4044637577842846`*^9}, {
   3.4044637895649247`*^9, 3.4044638511887417`*^9}, {3.404463881485035*^9, 
   3.404463962092862*^9}, {3.4044640040764313`*^9, 3.4044640086857176`*^9}, 
   3.404464521300875*^9, {3.4044646057055044`*^9, 3.4044646242676477`*^9}, {
   3.404466242564701*^9, 3.404466243330312*^9}, {3.404466359484331*^9, 
   3.404466395764885*^9}, 3.404651957359627*^9, {3.404651989141487*^9, 
   3.4046519954384828`*^9}, {3.404653007770419*^9, 3.404653025192629*^9}, {
   3.404662589800545*^9, 3.404662590237345*^9}, {3.404718208726282*^9, 
   3.4047182136173773`*^9}, 3.4048111841899595`*^9, {3.4048112616773095`*^9, 
   3.4048112656774635`*^9}, 3.4048265968755336`*^9, {3.4048266642843723`*^9, 
   3.404826666581335*^9}, {3.404838607801607*^9, 3.4048386098641863`*^9}, 
   3.4050923021413093`*^9, {3.4056653001464415`*^9, 3.405665322099988*^9}, {
   3.405866376811643*^9, 3.4058663923431916`*^9}, {3.4058665230332007`*^9, 
   3.405866563846484*^9}, {3.4058671956867404`*^9, 3.4058671962492514`*^9}, {
   3.406309997649578*^9, 3.406310000073578*^9}, {3.406471693559699*^9, 
   3.4064717204353867`*^9}, {3.4065573101547747`*^9, 
   3.4065573173268332`*^9}, {3.4066125598229074`*^9, 
   3.4066125863392115`*^9}, {3.4069602761568813`*^9, 3.4069602887039976`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TestBiHestonVanilla2", "[", 
   RowBox[{
   "S_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "a_", ",", "b_", ",", "K_",
     ",", "\[Tau]_", ",", "\[CapitalSigma]_", ",", "M_", ",", 
    "\[CapitalSigma]inf_", ",", "Q_", ",", "\[Rho]_", ",", "\[Mu]_", ",", 
    "\[Lambda]1_", ",", "\[Lambda]2_", ",", "\[Omega]1_", ",", "scope_"}], 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "KList", ",", "\[Beta]m", ",", "as", ",", "res", ",", "res2", ",", 
      RowBox[{"Y", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Log", "[", 
          RowBox[{"S", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
         RowBox[{"Log", "[", 
          RowBox[{"S", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Beta]m", "=", 
      RowBox[{"-", 
       RowBox[{
        RowBox[{"(", 
         FractionBox[
          RowBox[{
           RowBox[{"M", ".", "\[CapitalSigma]inf"}], "+", 
           RowBox[{"\[CapitalSigma]inf", ".", 
            RowBox[{"Transpose", "[", "M", "]"}]}]}], "2"], ")"}], ".", 
        RowBox[{"Inverse", "[", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Transpose", "[", "Q", "]"}], ".", "Q"}], ")"}], 
         "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"SmileSymetrizedBiHestonVanillaIntegrand2", "[", 
         RowBox[{
         "Y", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", "b", ",", 
          RowBox[{"{", "K", "}"}], ",", "\[Tau]", ",", "\[CapitalSigma]", ",",
           "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", "\[Beta]m", ",", 
          "\[Lambda]1", ",", "\[Lambda]2", ",", "\[Omega]1", ",", 
          "\[Omega]2"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Omega]2", ",", "0", " ", ",", 
         RowBox[{"2", "scope"}]}], "}"}], ",", 
       RowBox[{"PlotPoints", "\[Rule]", "50"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", 
        RowBox[{"\"\<Integrand spreadoption : K =\>\"", "<>", 
         RowBox[{"ToString", "[", "K", "]"}], "<>", "\"\< \[Omega]1=\>\"", "<>",
          
         RowBox[{"ToString", "[", "\[Omega]1", "]"}]}]}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4042074577632284`*^9, 3.4042074770760994`*^9}, {
   3.4042075328115444`*^9, 3.4042077538626633`*^9}, {3.404207970241818*^9, 
   3.404207993351637*^9}, {3.4042080286491895`*^9, 3.404208043665103*^9}, {
   3.4042173037335176`*^9, 3.4042173873444977`*^9}, {3.4042175109093704`*^9, 
   3.404217554472707*^9}, {3.4042999349691343`*^9, 3.4042999555923347`*^9}, {
   3.404381253215744*^9, 3.404381270172944*^9}, {3.4044634862113743`*^9, 
   3.4044635745846777`*^9}, {3.404463622474383*^9, 3.4044637577842846`*^9}, {
   3.4044637895649247`*^9, 3.4044638511887417`*^9}, {3.404463881485035*^9, 
   3.404463962092862*^9}, {3.4044646348143206`*^9, 3.4044646352830615`*^9}, {
   3.4044659090554795`*^9, 3.4044659091648526`*^9}, {3.404466252111393*^9, 
   3.4044662673767247`*^9}, {3.4044662976417685`*^9, 
   3.4044662980323863`*^9}, {3.4044673732461166`*^9, 
   3.4044673808397207`*^9}, {3.4046519546877003`*^9, 
   3.4046519750474663`*^9}, {3.4046528875181103`*^9, 3.404652993051387*^9}, 
   3.404811180721076*^9, {3.404811251817556*^9, 3.404811256317729*^9}, 
   3.404826602406996*^9, {3.4048266367520647`*^9, 3.4048266473149705`*^9}, {
   3.404838584300705*^9, 3.404838585847639*^9}, {3.404888355750947*^9, 
   3.4048883751261473`*^9}, {3.404888409087347*^9, 3.4048884100857472`*^9}, 
   3.404888482298147*^9, {3.404888523107747*^9, 3.404888593260947*^9}, {
   3.4048886239773474`*^9, 3.404888647377347*^9}, {3.4048888242189474`*^9, 
   3.4048888357941475`*^9}, {3.4048891031157475`*^9, 3.404889148121747*^9}, {
   3.404889229444547*^9, 3.404889260831747*^9}, {3.404889328176947*^9, 
   3.404889408579347*^9}, {3.4048896364485474`*^9, 3.4048896370257473`*^9}, {
   3.4048906491191473`*^9, 3.404890657433947*^9}, 3.4048906939379473`*^9, {
   3.4048908372083473`*^9, 3.404890839158347*^9}, {3.4048912343375473`*^9, 
   3.4048912741487474`*^9}, {3.4060278385083656`*^9, 
   3.4060278828217163`*^9}, {3.406028007011601*^9, 3.4060280212775*^9}, {
   3.406028103841585*^9, 3.4060281154668083`*^9}, {3.4064643492154384`*^9, 
   3.4064643625595303`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Test2BiHestonVanilla2", "[", 
   RowBox[{
   "S_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "a_", ",", "b_", ",", "K_",
     ",", "\[Tau]_", ",", "\[CapitalSigma]_", ",", "M_", ",", 
    "\[CapitalSigma]inf_", ",", "Q_", ",", "\[Rho]_", ",", "\[Mu]_", ",", 
    "\[Lambda]1_", ",", "\[Lambda]2_", ",", 
    RowBox[{"{", 
     RowBox[{
     "LegendreCoef1_", ",", "LegendreCoef1n_", ",", "period1_", ",", 
      "period1n_", ",", "\[Epsilon]1_", ",", "imax_", ",", 
      "startmonitortime_", ",", "plafondexplosion_", ",", "initialTailFlag_", 
      ",", "InitialTailPosition_"}], "}"}], ",", "scope_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "period", ",", "\[Beta]m", ",", "as", ",", "res", ",", "res2", ",", 
      RowBox[{"Y", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Log", "[", 
          RowBox[{"S", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
         RowBox[{"Log", "[", 
          RowBox[{"S", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}], ",", "tt", ",", 
      "Y0"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Beta]m", "=", 
      RowBox[{"-", 
       RowBox[{
        RowBox[{"(", 
         FractionBox[
          RowBox[{
           RowBox[{"M", ".", "\[CapitalSigma]inf"}], "+", 
           RowBox[{"\[CapitalSigma]inf", ".", 
            RowBox[{"Transpose", "[", "M", "]"}]}]}], "2"], ")"}], ".", 
        RowBox[{"Inverse", "[", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Transpose", "[", "Q", "]"}], ".", "Q"}], ")"}], 
         "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"period", "=", "scope"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Y0", "=", 
      RowBox[{
       RowBox[{"AdaptativeIntegrate", "[", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{"\[Omega]1", ",", 
           RowBox[{
            RowBox[{"SmileSymetrizedBiHestonVanillaIntegrand2CC", "[", 
             RowBox[{
             "Y", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", "b", ",", 
              
              RowBox[{"{", "K", "}"}], ",", "\[Tau]", ",", "\[CapitalSigma]", 
              ",", "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", 
              "\[Beta]m", ",", "\[Lambda]1", ",", "\[Lambda]2", ",", 
              "\[Omega]1", ",", "0"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", "LegendreCoef1", 
         ",", "LegendreCoef1n", ",", "period1", ",", "period1n", ",", 
         "\[Epsilon]1", ",", "imax"}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tt", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Omega]2", ",", 
          RowBox[{
           RowBox[{"VectorAdaptativeIntegrateExplosionSafe", "[", 
            RowBox[{
             RowBox[{"Function", "[", 
              RowBox[{"\[Omega]1", ",", 
               RowBox[{
                RowBox[{"SmileSymetrizedBiHestonVanillaIntegrand2CC", "[", 
                 RowBox[{
                 "Y", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", "b", 
                  ",", 
                  RowBox[{"{", "K", "}"}], ",", "\[Tau]", ",", 
                  "\[CapitalSigma]", ",", "M", ",", "Q", ",", "\[Rho]", ",", 
                  "\[Mu]", ",", "\[Beta]m", ",", "\[Lambda]1", ",", 
                  "\[Lambda]2", ",", "\[Omega]1", ",", "\[Omega]2"}], "]"}], 
                "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", "LegendreCoef1",
              ",", "LegendreCoef1n", ",", "period1", ",", "period1n", ",", 
             "\[Epsilon]1", ",", "imax", ",", "1", ",", "startmonitortime", 
             ",", "plafondexplosion", ",", "initialTailFlag", ",", 
             "InitialTailPosition"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Omega]2", ",", "0", ",", "period", ",", 
          RowBox[{"period", "/", "100"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ListPlot", "[", 
      RowBox[{"tt", ",", 
       RowBox[{"Joined", "\[Rule]", "True"}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", "\"\<U1:2nd Inv. Fourier:\>\""}], ",", 
       
       RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}]}], "]"}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.4060287212753143`*^9, 3.4060288323243217`*^9}, {
   3.4060295386347575`*^9, 3.4060295388378863`*^9}, {3.406029734997903*^9, 
   3.4060297570139503`*^9}, {3.4060298386405177`*^9, 3.40602983982804*^9}, 
   3.406469384125579*^9, {3.4064700671899395`*^9, 3.4064700861279244`*^9}, {
   3.406558139707261*^9, 3.4065581598952775`*^9}, {3.406612596933233*^9, 
   3.4066126257308445`*^9}, {3.4066128204858303`*^9, 3.406612820829589*^9}, {
   3.4066129009253893`*^9, 3.406612901753536*^9}, {3.406889536644402*^9, 
   3.4068895414257135`*^9}, {3.406889587426302*^9, 3.406889597020175*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Handling of (K > 0 or K < 0) and (\[Beta] or Q input)\
\>", "Subsubtitle",
 CellChangeTimes->{{3.404641877166887*^9, 3.4046419260584507`*^9}, {
  3.4046422780339584`*^9, 3.4046423090970545`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SmileBiHestonVanillaPositiveK", "[", 
   RowBox[{
   "S_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "a_", ",", "b_", ",", 
    "KList_", ",", "\[Tau]_", ",", "\[CapitalSigma]_", ",", "M_", ",", 
    "\[CapitalSigma]inf_", ",", "Q_", ",", "\[Rho]_", ",", "\[Mu]_", ",", 
    "\[Beta]_", ",", "\[Lambda]1_", ",", "\[Lambda]2_", ",", 
    RowBox[{"{", 
     RowBox[{
     "LegendreCoef1_", ",", "LegendreCoef1n_", ",", "period1_", ",", 
      "period1n_", ",", "\[Epsilon]1_", ",", "imax_", ",", 
      "startmonitortime_", ",", "plafondexplosion_", ",", "initialTailFlag_", 
      ",", "InitialTailPosition_", ",", "InitialTailPosition2_"}], "}"}], ",",
     
    RowBox[{"{", 
     RowBox[{
     "LegendreCoef2_", ",", "period2_", ",", "period2n_", ",", "\[Epsilon]2_",
       ",", "kmax_", ",", "StartControl_", ",", "IncrementFactor_"}], "}"}], 
    ",", "printflag_"}], "]"}], ":=", 
  RowBox[{"SmileBiHestonVanillaAux", "[", 
   RowBox[{
   "S", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", "b", ",", "KList", 
    ",", "\[Tau]", ",", "\[CapitalSigma]", ",", "M", ",", 
    "\[CapitalSigma]inf", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", 
    "\[Beta]", ",", "\[Lambda]1", ",", "\[Lambda]2", ",", 
    RowBox[{"{", 
     RowBox[{
     "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", ",", "period1n", 
      ",", "\[Epsilon]1", ",", "imax", ",", "startmonitortime", ",", 
      "plafondexplosion", ",", "initialTailFlag", ",", "InitialTailPosition", 
      ",", "InitialTailPosition2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "LegendreCoef2", ",", "period2", ",", "period2n", ",", "\[Epsilon]2", 
      ",", "kmax", ",", "StartControl", ",", "IncrementFactor"}], "}"}], ",", 
    "printflag"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.399897194377056*^9, 3.399897245940546*^9}, {
   3.3998976692611732`*^9, 3.3998976795269957`*^9}, {3.4002144512750473`*^9, 
   3.4002144569782815`*^9}, {3.400238263213356*^9, 3.400238300573448*^9}, {
   3.400408049201395*^9, 3.4004080510451803`*^9}, 3.400504474791651*^9, {
   3.4005667653701477`*^9, 3.400566798886416*^9}, {3.400819839626373*^9, 
   3.4008198425014277`*^9}, {3.4009134614843187`*^9, 
   3.4009134792034087`*^9}, {3.4009135487047434`*^9, 3.400913581252243*^9}, {
   3.4009136129872274`*^9, 3.4009136377220774`*^9}, {3.4009136698945704`*^9, 
   3.400913678910368*^9}, {3.400913713848539*^9, 3.400913720848673*^9}, {
   3.4009138946020093`*^9, 3.400913904914707*^9}, {3.40091789471006*^9, 
   3.400917899053893*^9}, {3.400921389214653*^9, 3.4009214402156324`*^9}, {
   3.400921492029127*^9, 3.4009215467489276`*^9}, {3.4009217594717617`*^9, 
   3.4009217705500994`*^9}, {3.401110611225083*^9, 3.4011106255847335`*^9}, {
   3.4011155613669987`*^9, 3.4011155856330895`*^9}, {3.401425790206461*^9, 
   3.401425813269404*^9}, {3.402046069834562*^9, 3.40204607210023*^9}, {
   3.4022357520580764`*^9, 3.4022357573706784`*^9}, {3.4022370965213895`*^9, 
   3.4022371025371304`*^9}, {3.402294637481146*^9, 3.4022946494188747`*^9}, {
   3.4022947595616145`*^9, 3.4022948086094313`*^9}, {3.4022949118926644`*^9, 
   3.4022949123770485`*^9}, 3.4022950944274187`*^9, {3.4023880298479567`*^9, 
   3.4023880317599564`*^9}, {3.403871467549989*^9, 3.4038715521922393`*^9}, {
   3.4038772034257407`*^9, 3.4038772338482*^9}, {3.4038778690791464`*^9, 
   3.4038778880951366`*^9}, {3.403877923330188*^9, 3.403877959690261*^9}, {
   3.403880525208268*^9, 3.403880528802087*^9}, {3.4039401668863335`*^9, 
   3.403940181277235*^9}, {3.403940658427021*^9, 3.403940660661439*^9}, 
   3.403940704459155*^9, {3.403947868049818*^9, 3.4039479096443667`*^9}, {
   3.404148916726935*^9, 3.404148924370935*^9}, {3.4041938566583424`*^9, 
   3.4041938600646577`*^9}, {3.4043010082023344`*^9, 3.404301032195134*^9}, {
   3.404301326445134*^9, 3.4043013377707343`*^9}, {3.4044640641065283`*^9, 
   3.404464086512348*^9}, {3.4044642317595596`*^9, 3.4044642428374715`*^9}, {
   3.404464285946019*^9, 3.4044643278983383`*^9}, {3.4044660317874985`*^9, 
   3.404466040881074*^9}, 3.4044661178795953`*^9, {3.404652033251709*^9, 
   3.4046520563146515`*^9}, 3.404811189237028*^9, 3.404811270615153*^9, 
   3.4048265897658854`*^9, 3.4048266716909065`*^9, 3.406469404844859*^9, 
   3.406470124910167*^9, 3.4065573404368*^9, {3.406558170583051*^9, 
   3.406558173301871*^9}, {3.4066126435750513`*^9, 3.4066126576691628`*^9}, 
   3.4069598513674755`*^9, {3.4069605121301622`*^9, 3.4069605220522275`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SmileBiHestonVanillaNegativeK", "[", 
   RowBox[{
   "S_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "a_", ",", "b_", ",", 
    "KList_", ",", "\[Tau]_", ",", "\[CapitalSigma]_", ",", "M_", ",", 
    "\[CapitalSigma]inf_", ",", "Q_", ",", "\[Rho]_", ",", "\[Mu]_", ",", 
    "\[Beta]_", ",", "\[Lambda]1_", ",", "\[Lambda]2_", ",", 
    RowBox[{"{", 
     RowBox[{
     "LegendreCoef1_", ",", "LegendreCoef1n_", ",", "period1_", ",", 
      "period1n_", ",", "\[Epsilon]1_", ",", "imax_", ",", 
      "startmonitortime_", ",", "plafondexplosion_", ",", "initialTailFlag_", 
      ",", "InitialTailPosition_", ",", "InitialTailPosition2_"}], "}"}], ",",
     
    RowBox[{"{", 
     RowBox[{
     "LegendreCoef2_", ",", "period2_", ",", "period2n_", ",", "\[Epsilon]2_",
       ",", "kmax_", ",", "StartControl_", ",", "IncrementFactor_"}], "}"}], 
    ",", "printflag_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"SmileBiHestonVanillaAux", "[", 
    RowBox[{
    "S", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", "b", ",", "KList", 
     ",", "\[Tau]", ",", "\[CapitalSigma]", ",", "M", ",", 
     "\[CapitalSigma]inf", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", 
     "\[Beta]", ",", "\[Lambda]1", ",", "\[Lambda]2", ",", 
     RowBox[{"{", 
      RowBox[{
      "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", ",", "period1n",
        ",", "\[Epsilon]1", ",", "imax", ",", "startmonitortime", ",", 
       "plafondexplosion", ",", "initialTailFlag", ",", "InitialTailPosition",
        ",", "InitialTailPosition2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "LegendreCoef2", ",", "period2", ",", "period2n", ",", "\[Epsilon]2", 
       ",", "kmax", ",", "StartControl", ",", "IncrementFactor"}], "}"}], ",",
      "printflag"}], "]"}], "+", 
   RowBox[{"S", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "-", 
   RowBox[{"S", "[", 
    RowBox[{"[", "2", "]"}], "]"}], "-", "KList"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.399897194377056*^9, 3.399897245940546*^9}, {
   3.3998976692611732`*^9, 3.3998976795269957`*^9}, {3.4002144512750473`*^9, 
   3.4002144569782815`*^9}, {3.400238263213356*^9, 3.400238300573448*^9}, {
   3.400408049201395*^9, 3.4004080510451803`*^9}, 3.400504474791651*^9, {
   3.4005667653701477`*^9, 3.400566798886416*^9}, {3.400819839626373*^9, 
   3.4008198425014277`*^9}, {3.4009134614843187`*^9, 
   3.4009134792034087`*^9}, {3.4009135487047434`*^9, 3.400913581252243*^9}, {
   3.4009136129872274`*^9, 3.4009136377220774`*^9}, {3.4009136698945704`*^9, 
   3.400913678910368*^9}, {3.400913713848539*^9, 3.400913720848673*^9}, {
   3.4009138946020093`*^9, 3.400913904914707*^9}, {3.40091789471006*^9, 
   3.400917899053893*^9}, {3.400921389214653*^9, 3.4009214402156324`*^9}, {
   3.400921492029127*^9, 3.4009215467489276`*^9}, {3.4009217594717617`*^9, 
   3.4009217705500994`*^9}, {3.401110611225083*^9, 3.4011106255847335`*^9}, {
   3.4011155613669987`*^9, 3.4011155856330895`*^9}, {3.401425790206461*^9, 
   3.401425813269404*^9}, {3.402046069834562*^9, 3.40204607210023*^9}, {
   3.4022357520580764`*^9, 3.4022357573706784`*^9}, {3.4022370965213895`*^9, 
   3.4022371025371304`*^9}, {3.402294637481146*^9, 3.4022946494188747`*^9}, {
   3.4022947595616145`*^9, 3.4022948086094313`*^9}, {3.402294889173478*^9, 
   3.402294916033369*^9}, 3.4022950990368824`*^9, {3.402301718929607*^9, 
   3.4023017207108912`*^9}, {3.4023166196688204`*^9, 3.402316620778217*^9}, {
   3.4023784653580155`*^9, 3.402378488030326*^9}, {3.402388034046956*^9, 
   3.4023880365689564`*^9}, {3.402388095676956*^9, 3.4023880963469563`*^9}, {
   3.4038714736126056`*^9, 3.4038714752220116`*^9}, {3.4038715635049562`*^9, 
   3.4038715747395473`*^9}, {3.4038772479109697`*^9, 3.40387725705177*^9}, {
   3.403877876657417*^9, 3.403877881095002*^9}, {3.403877937096077*^9, 
   3.4038779566120768`*^9}, {3.403880536192854*^9, 3.403880540802317*^9}, {
   3.403940184714801*^9, 3.403940192839957*^9}, {3.403940656239479*^9, 
   3.403940684099389*^9}, {3.403947936582384*^9, 3.4039479660829506`*^9}, {
   3.404148930517335*^9, 3.404148938223735*^9}, {3.404193865752267*^9, 
   3.4041938692054586`*^9}, {3.4042073013852262`*^9, 3.404207330682664*^9}, {
   3.4043000073687344`*^9, 3.4043000324223347`*^9}, {3.4044076957679477`*^9, 
   3.4044077049251475`*^9}, 3.404455930502843*^9, {3.4044640827467957`*^9, 
   3.404464111324372*^9}, 3.4044642071819067`*^9, 3.4044642538685102`*^9, 
   3.4044642954458365`*^9, {3.4044643395543647`*^9, 3.4044643561634207`*^9}, {
   3.404466044131011*^9, 3.4044660707867494`*^9}, 3.404469943181148*^9, {
   3.4046520351579957`*^9, 3.4046520543458643`*^9}, 3.4048111917058725`*^9, 
   3.404811272677732*^9, 3.4048265875783014`*^9, 3.404826673628481*^9, 
   3.4064694071105423`*^9, 3.406470128582136*^9, 3.406557345827563*^9, {
   3.406558179848913*^9, 3.4065581827708635`*^9}, {3.4066126617786427`*^9, 
   3.406612675013356*^9}, 3.4069598684771795`*^9, 3.40696053727127*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SmileBiHestonVanillaPositiveK2", "[", 
   RowBox[{
   "S_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "a_", ",", "b_", ",", 
    "KList_", ",", "\[Tau]_", ",", "\[CapitalSigma]_", ",", "M_", ",", 
    "\[CapitalSigma]inf_", ",", "Q_", ",", "\[Rho]_", ",", "\[Mu]_", ",", 
    "\[Beta]m_", ",", "\[Lambda]1_", ",", "\[Lambda]2_", ",", 
    RowBox[{"{", 
     RowBox[{
     "LegendreCoef1_", ",", "LegendreCoef1n_", ",", "period1_", ",", 
      "period1n_", ",", "\[Epsilon]1_", ",", "imax_", ",", 
      "startmonitortime_", ",", "plafondexplosion_", ",", "initialTailFlag_", 
      ",", "InitialTailPosition_", ",", "InitialTailPosition2_"}], "}"}], ",",
     
    RowBox[{"{", 
     RowBox[{
     "LegendreCoef2_", ",", "period2_", ",", "period2n_", ",", "\[Epsilon]2_",
       ",", "kmax_", ",", "StartControl_", ",", "IncrementFactor_"}], "}"}], 
    ",", "printflag_"}], "]"}], ":=", 
  RowBox[{"SmileBiHestonVanillaAux2", "[", 
   RowBox[{
   "S", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", "b", ",", "KList", 
    ",", "\[Tau]", ",", "\[CapitalSigma]", ",", "M", ",", 
    "\[CapitalSigma]inf", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", 
    "\[Beta]m", ",", "\[Lambda]1", ",", "\[Lambda]2", ",", 
    RowBox[{"{", 
     RowBox[{
     "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", ",", "period1n", 
      ",", "\[Epsilon]1", ",", "imax", ",", "startmonitortime", ",", 
      "plafondexplosion", ",", "initialTailFlag", ",", "InitialTailPosition", 
      ",", "InitialTailPosition2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "LegendreCoef2", ",", "period2", ",", "period2n", ",", "\[Epsilon]2", 
      ",", "kmax", ",", "StartControl", ",", "IncrementFactor"}], "}"}], ",", 
    "printflag"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.399897194377056*^9, 3.399897245940546*^9}, {
   3.3998976692611732`*^9, 3.3998976795269957`*^9}, {3.4002144512750473`*^9, 
   3.4002144569782815`*^9}, {3.400238263213356*^9, 3.400238300573448*^9}, {
   3.400408049201395*^9, 3.4004080510451803`*^9}, 3.400504474791651*^9, {
   3.4005667653701477`*^9, 3.400566798886416*^9}, {3.400819839626373*^9, 
   3.4008198425014277`*^9}, {3.4009134614843187`*^9, 
   3.4009134792034087`*^9}, {3.4009135487047434`*^9, 3.400913581252243*^9}, {
   3.4009136129872274`*^9, 3.4009136377220774`*^9}, {3.4009136698945704`*^9, 
   3.400913678910368*^9}, {3.400913713848539*^9, 3.400913720848673*^9}, {
   3.4009138946020093`*^9, 3.400913904914707*^9}, {3.40091789471006*^9, 
   3.400917899053893*^9}, {3.400921389214653*^9, 3.4009214402156324`*^9}, {
   3.400921492029127*^9, 3.4009215467489276`*^9}, {3.4009217594717617`*^9, 
   3.4009217705500994`*^9}, {3.401110611225083*^9, 3.4011106255847335`*^9}, {
   3.4011155613669987`*^9, 3.4011155856330895`*^9}, {3.401425790206461*^9, 
   3.401425813269404*^9}, {3.402046069834562*^9, 3.40204607210023*^9}, {
   3.4022357520580764`*^9, 3.4022357573706784`*^9}, {3.4022370965213895`*^9, 
   3.4022371025371304`*^9}, {3.402294637481146*^9, 3.4022946494188747`*^9}, {
   3.4022947595616145`*^9, 3.4022948086094313`*^9}, {3.4022949118926644`*^9, 
   3.4022949123770485`*^9}, 3.4022950944274187`*^9, {3.4023880298479567`*^9, 
   3.4023880317599564`*^9}, {3.403871467549989*^9, 3.4038715521922393`*^9}, {
   3.4038772034257407`*^9, 3.4038772338482*^9}, {3.4038778690791464`*^9, 
   3.4038778880951366`*^9}, {3.403877923330188*^9, 3.403877959690261*^9}, {
   3.403880525208268*^9, 3.403880528802087*^9}, {3.4039401668863335`*^9, 
   3.403940181277235*^9}, {3.403940658427021*^9, 3.403940660661439*^9}, 
   3.403940704459155*^9, {3.403947868049818*^9, 3.4039479096443667`*^9}, {
   3.404148916726935*^9, 3.404148924370935*^9}, {3.4041938566583424`*^9, 
   3.4041938600646577`*^9}, {3.4043010082023344`*^9, 3.404301032195134*^9}, {
   3.404301326445134*^9, 3.4043013377707343`*^9}, {3.4044640641065283`*^9, 
   3.404464086512348*^9}, 3.4044642025882444`*^9, 3.40446425699345*^9, 
   3.404464298664525*^9, {3.404464344023029*^9, 3.4044643586789975`*^9}, {
   3.404466080755308*^9, 3.4044660882239146`*^9}, {3.404469947399817*^9, 
   3.404469959712081*^9}, {3.4046520370799074`*^9, 3.4046520528927107`*^9}, 
   3.404811194205969*^9, 3.4048112748965673`*^9, 3.4048265860938697`*^9, 
   3.404826676784852*^9, 3.4064694095481043`*^9, 3.4064701315197115`*^9, 
   3.4065573488432655`*^9, {3.406558190786693*^9, 3.406558192927373*^9}, {
   3.406612681951034*^9, 3.4066126924825535`*^9}, 3.4069598720553727`*^9, 
   3.4069605428338766`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SmileBiHestonVanillaNegativeK2", "[", 
   RowBox[{
   "S_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "a_", ",", "b_", ",", 
    "KList_", ",", "\[Tau]_", ",", "\[CapitalSigma]_", ",", "M_", ",", 
    "\[CapitalSigma]inf_", ",", "Q_", ",", "\[Rho]_", ",", "\[Mu]_", ",", 
    "\[Beta]m_", ",", "\[Lambda]1_", ",", "\[Lambda]2_", ",", 
    RowBox[{"{", 
     RowBox[{
     "LegendreCoef1_", ",", "LegendreCoef1n_", ",", "period1_", ",", 
      "period1n_", ",", "\[Epsilon]1_", ",", "imax_", ",", 
      "startmonitortime_", ",", "plafondexplosion_", ",", "initialTailFlag_", 
      ",", "InitialTailPosition_", ",", "InitialTailPosition2_"}], "}"}], ",",
     
    RowBox[{"{", 
     RowBox[{
     "LegendreCoef2_", ",", "period2_", ",", "period2n_", ",", "\[Epsilon]2_",
       ",", "kmax_", ",", "StartControl_", ",", "IncrementFactor_"}], "}"}], 
    ",", "printflag_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"SmileBiHestonVanillaAux2", "[", 
    RowBox[{
    "S", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", "b", ",", "KList", 
     ",", "\[Tau]", ",", "\[CapitalSigma]", ",", "M", ",", 
     "\[CapitalSigma]inf", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", 
     "\[Beta]m", ",", "\[Lambda]1", ",", "\[Lambda]2", ",", 
     RowBox[{"{", 
      RowBox[{
      "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", ",", "period1n",
        ",", "\[Epsilon]1", ",", "imax", ",", "startmonitortime", ",", 
       "plafondexplosion", ",", "initialTailFlag", ",", "InitialTailPosition",
        ",", "InitialTailPosition2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "LegendreCoef2", ",", "period2", ",", "period2n", ",", "\[Epsilon]2", 
       ",", "kmax", ",", "StartControl", ",", "IncrementFactor"}], "}"}], ",",
      "printflag"}], "]"}], "+", 
   RowBox[{"S", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "-", 
   RowBox[{"S", "[", 
    RowBox[{"[", "2", "]"}], "]"}], "-", "KList"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.399897194377056*^9, 3.399897245940546*^9}, {
   3.3998976692611732`*^9, 3.3998976795269957`*^9}, {3.4002144512750473`*^9, 
   3.4002144569782815`*^9}, {3.400238263213356*^9, 3.400238300573448*^9}, {
   3.400408049201395*^9, 3.4004080510451803`*^9}, 3.400504474791651*^9, {
   3.4005667653701477`*^9, 3.400566798886416*^9}, {3.400819839626373*^9, 
   3.4008198425014277`*^9}, {3.4009134614843187`*^9, 
   3.4009134792034087`*^9}, {3.4009135487047434`*^9, 3.400913581252243*^9}, {
   3.4009136129872274`*^9, 3.4009136377220774`*^9}, {3.4009136698945704`*^9, 
   3.400913678910368*^9}, {3.400913713848539*^9, 3.400913720848673*^9}, {
   3.4009138946020093`*^9, 3.400913904914707*^9}, {3.40091789471006*^9, 
   3.400917899053893*^9}, {3.400921389214653*^9, 3.4009214402156324`*^9}, {
   3.400921492029127*^9, 3.4009215467489276`*^9}, {3.4009217594717617`*^9, 
   3.4009217705500994`*^9}, {3.401110611225083*^9, 3.4011106255847335`*^9}, {
   3.4011155613669987`*^9, 3.4011155856330895`*^9}, {3.401425790206461*^9, 
   3.401425813269404*^9}, {3.402046069834562*^9, 3.40204607210023*^9}, {
   3.4022357520580764`*^9, 3.4022357573706784`*^9}, {3.4022370965213895`*^9, 
   3.4022371025371304`*^9}, {3.402294637481146*^9, 3.4022946494188747`*^9}, {
   3.4022947595616145`*^9, 3.4022948086094313`*^9}, {3.402294889173478*^9, 
   3.402294916033369*^9}, 3.4022950990368824`*^9, {3.402301718929607*^9, 
   3.4023017207108912`*^9}, {3.4023166196688204`*^9, 3.402316620778217*^9}, {
   3.4023784653580155`*^9, 3.402378488030326*^9}, {3.402388034046956*^9, 
   3.4023880365689564`*^9}, {3.402388095676956*^9, 3.4023880963469563`*^9}, {
   3.4038714736126056`*^9, 3.4038714752220116`*^9}, {3.4038715635049562`*^9, 
   3.4038715747395473`*^9}, {3.4038772479109697`*^9, 3.40387725705177*^9}, {
   3.403877876657417*^9, 3.403877881095002*^9}, {3.403877937096077*^9, 
   3.4038779566120768`*^9}, {3.403880536192854*^9, 3.403880540802317*^9}, {
   3.403940184714801*^9, 3.403940192839957*^9}, {3.403940656239479*^9, 
   3.403940684099389*^9}, {3.403947936582384*^9, 3.4039479660829506`*^9}, {
   3.404148930517335*^9, 3.404148938223735*^9}, {3.404193865752267*^9, 
   3.4041938692054586`*^9}, {3.4042073013852262`*^9, 3.404207330682664*^9}, {
   3.4043000073687344`*^9, 3.4043000324223347`*^9}, {3.4044076957679477`*^9, 
   3.4044077049251475`*^9}, 3.404455930502843*^9, {3.4044640827467957`*^9, 
   3.404464111324372*^9}, {3.404464204650705*^9, 3.4044642094631124`*^9}, 
   3.4044642597277727`*^9, 3.4044643013832226`*^9, {3.4044643462417364`*^9, 
   3.404464360991453*^9}, {3.4044660929738235`*^9, 3.404466107270424*^9}, {
   3.4044699635245075`*^9, 3.4044699655400934`*^9}, {3.404652038611187*^9, 
   3.404652047001973*^9}, 3.4048111977061033`*^9, 3.404811278256071*^9, 
   3.4048265838437834`*^9, 3.4048266791443176`*^9, 3.4064694119544163`*^9, 
   3.4064701340510263`*^9, 3.406557352046472*^9, {3.406558198615019*^9, 
   3.4065582008338256`*^9}, {3.4066126978576913`*^9, 3.406612708045452*^9}, 
   3.406959875508564*^9, 3.4069605454433017`*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["Integration Bi Dimensional", "Subsubtitle",
 CellChangeTimes->{{3.404641430673939*^9, 3.4046414450023394`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PlotRangeScale", "=", "100"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4078518022918*^9, 3.4078518049908*^9}}],

Cell[BoxData["100"], "Output",
 CellChangeTimes->{3.4078518180118*^9, 3.408195945658387*^9, 
  3.408202104388*^9, 3.40820236895*^9, 3.408382052213453*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"SmileBiHestonVanillaAux", "[", 
   RowBox[{
   "S_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "a_", ",", "b_", ",", 
    "KList_", ",", "\[Tau]_", ",", "\[CapitalSigma]_", ",", "M_", ",", 
    "\[CapitalSigma]inf_", ",", "Q_", ",", "\[Rho]_", ",", "\[Mu]_", ",", 
    "\[Beta]_", ",", "\[Lambda]1_", ",", "\[Lambda]2_", ",", 
    RowBox[{"{", 
     RowBox[{
     "LegendreCoef1_", ",", "LegendreCoef1n_", ",", "period1_", ",", 
      "period1n_", ",", "\[Epsilon]1_", ",", "imax_", ",", 
      "startmonitortime_", ",", "plafondexplosion_", ",", "initialTailFlag_", 
      ",", "InitialTailPosition_", ",", "InitialTailPosition2_"}], "}"}], ",",
     
    RowBox[{"{", 
     RowBox[{
     "LegendreCoef2_", ",", "period2_", ",", "period2n_", ",", "\[Epsilon]2_",
       ",", "kmax_", ",", "StartControl_", ",", "IncrementFactor_"}], "}"}], 
    ",", "printflag_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{
   FractionBox["2", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"2", "\[Pi]"}], ")"}], "2"]], 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"as", ",", "res", ",", "res2", ",", 
       RowBox[{"Y", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Log", "[", 
           RowBox[{"S", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
          RowBox[{"Log", "[", 
           RowBox[{"S", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "1"}], " ", "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "1"}], "]"}]}], "  ", ",", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\< S=\>\"", ",", 
           RowBox[{"S", " ", "//", " ", "MatrixForm"}], ",", 
           "\"\< \[CapitalSigma]=\>\"", ",", 
           RowBox[{"\[CapitalSigma]", " ", "//", "MatrixForm"}], ",", 
           "\"\<M=\>\"", ",", 
           RowBox[{"M", "//", "MatrixForm"}], ",", 
           "\"\< \[CapitalSigma]inf=\>\"", ",", 
           RowBox[{"\[CapitalSigma]inf", "//", "MatrixForm"}], " ", ",", 
           "\"\< Q=\>\"", ",", 
           RowBox[{"Q", "//", "MatrixForm"}], " ", ",", "\"\< \[Rho]=\>\"", 
           ",", 
           RowBox[{"\[Rho]", "//", "MatrixForm"}], ",", "\"\< \[Mu]=\>\"", 
           ",", 
           RowBox[{"\[Mu]", "//", "MatrixForm"}], ",", "\"\< \[Beta]=\>\"", 
           ",", "\[Beta]", ",", "\"\< T=\>\"", ",", "\[Tau]"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Inner Integration\>\"", ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\"\<LegendreNbMain\>\"", ",", 
                RowBox[{"Length", "[", "LegendreCoef1", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<LegendreNbIncrement\>\"", ",", 
                RowBox[{"Length", "[", "LegendreCoef1n", "]"}]}], "}"}], ",", 
              
              RowBox[{"{", 
               RowBox[{"\"\<IncrementNbMax\>\"", ",", "imax"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<InitialTailFlag\>\"", ",", "initialTailFlag"}], 
               "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<InitialTailLegendreNb\>\"", ",", 
                RowBox[{"Length", "[", "LegendreCoef2", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<PeriodMain\>\"", ",", "period1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<PeriodnIncrement\>\"", ",", "period1n"}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"\"\<StoppingLevel\>\"", ",", "\[Epsilon]1"}], "}"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"\"\<AbcisseMaxValue\>\"", ",", "kmax"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
               "\"\<InitialTailUpperLimit\>\"", ",", "InitialTailPosition"}], 
               "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
               "\"\<ExplosionMonitoringStartAbcisse\>\"", ",", 
                "StartControl"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
               "\"\<ExplosionMonitoringMaxLevel\>\"", ",", 
                "IncrementFactor"}], "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"\"\<lambda1\>\"", ",", "\[Lambda]1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<lambda2\>\"", ",", "\[Lambda]2"}], "}"}]}], "}"}],
             " ", "//", " ", "MatrixForm"}], ",", "\[IndentingNewLine]", 
           "\"\<Outer Integration\>\"", ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\"\<LegendreNbMain\>\"", ",", 
                RowBox[{"Length", "[", "LegendreCoef2", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<LegendreNbIncrement\>\"", ",", 
                RowBox[{"Length", "[", "LegendreCoef1n", "]"}]}], "}"}], ",", 
              
              RowBox[{"{", 
               RowBox[{"\"\<IncrementNbMax\>\"", ",", "imax"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<InitialTailFlag\>\"", ",", "initialTailFlag"}], 
               "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<InitialTailLegendreNb\>\"", ",", 
                RowBox[{"Length", "[", "LegendreCoef1", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<PeriodMain\>\"", ",", "period2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<PeriodnIncrement\>\"", ",", "period2n"}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"\"\<StoppingLevel\>\"", ",", "\[Epsilon]2"}], "}"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"\"\<AbcisseMaxValue\>\"", ",", "kmax"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
               "\"\<InitialTailUpperLimit\>\"", ",", "InitialTailPosition"}], 
               "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
               "\"\<GrowingControlStartAbcisse\>\"", ",", 
                "startmonitortime"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
               "\"\<GrowingControlMaxFactor\>\"", ",", "plafondexplosion"}], 
               "}"}]}], "}"}], " ", "//", " ", "MatrixForm"}]}], "]"}]}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "2"}], " ", "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "2"}], "]"}]}], "  ", ",", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<BiHestonLaplaceQuickTransform[M,Q,\[Rho], \
\[Mu],\[CapitalSigma],{-\[ImaginaryI] 1,-\[ImaginaryI] \
1},\[Beta],\[Tau]]=\>\"", ",", 
           RowBox[{"BiHestonLaplaceQuickTransform", "[", 
            RowBox[{
            "M", ",", "Q", ",", "\[Rho]", ",", " ", "\[Mu]", ",", 
             "\[CapitalSigma]", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "\[ImaginaryI]"}], " ", "1"}], ",", 
               RowBox[{
                RowBox[{"-", "\[ImaginaryI]"}], " ", "1"}]}], "}"}], ",", 
             "\[Beta]", ",", "\[Tau]"}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<integrand(0.1,0.1)=\>\"", ",", 
           RowBox[{"SmileSymetrizedBiHestonVanillaIntegrandCC", "[", 
            RowBox[{
            "Y", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", "b", ",", 
             "KList", ",", "\[Tau]", ",", "\[CapitalSigma]", ",", "M", ",", 
             "Q", ",", "\[Rho]", ",", "\[Mu]", ",", "\[Beta]", ",", 
             "\[Lambda]1", ",", "\[Lambda]2", ",", "0.1", ",", "0.1"}], 
            "]"}]}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "4"}], "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "4"}], "]"}]}], " ", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Plot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"SmileSymetrizedBiHestonVanillaIntegrand", "[", 
               RowBox[{
               "Y", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", "b", 
                ",", 
                RowBox[{"{", 
                 RowBox[{"KList", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", "\[Tau]", ",", 
                "\[CapitalSigma]", ",", "M", ",", "Q", ",", "\[Rho]", ",", 
                "\[Mu]", ",", "\[Beta]", ",", "\[Lambda]1", ",", "\[Lambda]2",
                 ",", "\[Omega]1", ",", "\[Omega]2"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Omega]2", ",", "0", " ", ",", 
               RowBox[{"2", "period1"}]}], "}"}], ",", 
             RowBox[{"PlotPoints", "\[Rule]", "50"}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
             RowBox[{"PlotLabel", "\[Rule]", 
              RowBox[{"\"\<1st Inverse Fourier: K =\>\"", "<>", 
               RowBox[{"ToString", "[", 
                RowBox[{"KList", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", 
               "\"\< \[Omega]1=\>\"", "<>", 
               RowBox[{"ToString", "[", "\[Omega]1", "]"}]}]}]}], "]"}], ",", 
           
           RowBox[{"{", 
            RowBox[{"\[Omega]1", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.2", ",", "2"}], "}"}]}], "}"}]}], "]"}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "5"}], "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "5"}], "]"}]}], " ", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Plot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"SmileSymetrizedBiHestonVanillaIntegrand", "[", 
               RowBox[{
               "Y", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", "b", 
                ",", 
                RowBox[{"{", 
                 RowBox[{"KList", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", "\[Tau]", ",", 
                "\[CapitalSigma]", ",", "M", ",", "Q", ",", "\[Rho]", ",", 
                "\[Mu]", ",", "\[Beta]", ",", "\[Lambda]1", ",", "\[Lambda]2",
                 ",", "\[Omega]1", ",", "\[Omega]2"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Omega]2", ",", "0", " ", ",", 
               RowBox[{"2", "period1"}]}], "}"}], ",", 
             RowBox[{"PlotPoints", "\[Rule]", "50"}], ",", 
             RowBox[{"PlotLabel", "\[Rule]", 
              RowBox[{"\"\<1st Inverse Fourier: K =\>\"", "<>", 
               RowBox[{"ToString", "[", 
                RowBox[{"KList", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", 
               "\"\< \[Omega]1=\>\"", "<>", 
               RowBox[{"ToString", "[", "\[Omega]1", "]"}]}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "PlotRangeScale"}], ",", "PlotRangeScale"}], 
               "}"}]}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Omega]1", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.2", ",", "2"}], "}"}]}], "}"}]}], "]"}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "6"}], "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "6"}], "]"}]}], " ", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\[Omega]2", ",", 
               RowBox[{
                RowBox[{"VectorAdaptativeIntegrateExplosionSafe", "[", 
                 RowBox[{
                  RowBox[{"Function", "[", 
                   RowBox[{"\[Omega]1", ",", 
                    RowBox[{
                    RowBox[{"SmileSymetrizedBiHestonVanillaIntegrand", "[", 
                    RowBox[{
                    "Y", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", 
                    "b", ",", 
                    RowBox[{"{", 
                    RowBox[{"KList", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", "\[Tau]", ",",
                     "\[CapitalSigma]", ",", "M", ",", "Q", ",", "\[Rho]", 
                    ",", "\[Mu]", ",", "\[Beta]", ",", "\[Lambda]1", ",", 
                    "\[Lambda]2", ",", "\[Omega]1", ",", "\[Omega]2"}], "]"}],
                     "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
                  "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", ",",
                   "period1n", ",", "\[Epsilon]1", ",", "imax", ",", "1", ",",
                   "startmonitortime", ",", "plafondexplosion", ",", 
                  "initialTailFlag", ",", "InitialTailPosition"}], "]"}], "[",
                 
                RowBox[{"[", 
                 RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Omega]2", ",", "0", ",", 
               RowBox[{"2", "period2"}], ",", 
               RowBox[{"period2", "/", "30"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"Joined", "\[Rule]", "True"}], ",", 
           RowBox[{"PlotLabel", "\[Rule]", "\"\<2nd Inverse Fourier:\>\""}], 
           ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "]"}]}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "7"}], "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "7"}], "]"}]}], " ", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<integrand(0.1,0.1)=\>\"", ",", 
          RowBox[{"SmileSymetrizedBiHestonVanillaIntegrandCC", "[", 
           RowBox[{
           "Y", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", "b", ",", 
            "KList", ",", "\[Tau]", ",", "\[CapitalSigma]", ",", "M", ",", 
            "Q", ",", "\[Rho]", ",", "\[Mu]", ",", "\[Beta]", ",", 
            "\[Lambda]1", ",", "\[Lambda]2", ",", "0.1", ",", "0.1"}], 
           "]"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "7"}], "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "7"}], "]"}]}], " ", ",", 
        RowBox[{
         RowBox[{
         "Print", "[", 
          "\"\<code integ 2 : \
{i,exploded<1,Abs[increment[[1]]]>\[Epsilon],(i<imax)}\>\"", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
         "Print", "[", 
          "\"\<code integ 1 : \
{i,exploded<1,Abs[increment[[1]]]>\[Epsilon],(i<imax)}\>\"", "]"}]}]}], "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{"VectorAdaptativeIntegrateUnprotected", "[", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{"\[Omega]2", ",", 
           RowBox[{
            RowBox[{"as", "=", 
             RowBox[{"VectorAdaptativeIntegrateExplosionSafe", "[", 
              RowBox[{
               RowBox[{"Function", "[", 
                RowBox[{"\[Omega]1", ",", 
                 RowBox[{"SmileSymetrizedBiHestonVanillaIntegrandCC", "[", 
                  RowBox[{
                  "Y", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", "b", 
                   ",", "KList", ",", "\[Tau]", ",", "\[CapitalSigma]", ",", 
                   "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", "\[Beta]",
                    ",", "\[Lambda]1", ",", "\[Lambda]2", ",", "\[Omega]1", 
                   ",", "\[Omega]2"}], "]"}]}], "]"}], ",", "LegendreCoef1", 
               ",", "LegendreCoef1n", ",", "period1", ",", "period1n", ",", 
               "\[Epsilon]1", ",", "imax", ",", 
               RowBox[{"Length", "[", "KList", "]"}], ",", "startmonitortime",
                ",", "plafondexplosion", ",", "initialTailFlag", ",", 
               "InitialTailPosition"}], "]"}]}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"printflag", "\[Equal]", "7"}], "||", " ", 
               RowBox[{"MemberQ", "[", 
                RowBox[{"printflag", ",", "7"}], "]"}]}], ",", 
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<\[Omega]2=\>\"", ",", "\[Omega]2", ",", 
                "\"\< Integ_2=\>\"", ",", "as"}], "]"}]}], "]"}], ";", 
            RowBox[{"as", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], ",", "LegendreCoef2", 
         ",", "LegendreCoef1n", ",", "period2", ",", "period2n", ",", 
         "\[Epsilon]2", ",", "imax", ",", 
         RowBox[{"Length", "[", "KList", "]"}], ",", "printflag", ",", 
         "initialTailFlag", ",", "InitialTailPosition2", ",", "kmax", ",", 
         "StartControl", ",", "IncrementFactor"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "7"}], "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "7"}], "]"}]}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Integ_1=\>\"", ",", "res"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"res", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.3997288601267104`*^9, 3.39972890803388*^9, {3.3997289692069297`*^9, 
   3.3997289944261637`*^9}, {3.399729087443575*^9, 3.3997291578199263`*^9}, {
   3.399729214633517*^9, 3.3997292559936857`*^9}, {3.399729338917153*^9, 
   3.399729443137904*^9}, {3.3997297921289797`*^9, 3.399729801332281*^9}, 
   3.3997984631978292`*^9, 3.3997986822957864`*^9, {3.399799475623518*^9, 
   3.3997994825611515`*^9}, {3.399813039024555*^9, 3.3998130523841867`*^9}, {
   3.3998138111956306`*^9, 3.399813818523896*^9}, {3.3998138975254135`*^9, 
   3.3998139300104117`*^9}, {3.399814002074295*^9, 3.3998140680286865`*^9}, {
   3.3998141794214506`*^9, 3.399814187827862*^9}, {3.3998161633189154`*^9, 
   3.399816166818983*^9}, {3.399816989678531*^9, 3.39981701069456*^9}, {
   3.3998175772210617`*^9, 3.3998175797054844`*^9}, {3.3998177980534267`*^9, 
   3.3998178039285393`*^9}, 3.3998191717048006`*^9, {3.399819229424659*^9, 
   3.399819249925052*^9}, {3.3998192996916327`*^9, 3.3998193255202537`*^9}, {
   3.3998194002404385`*^9, 3.399819401990472*^9}, {3.399819437022394*^9, 
   3.399819443678772*^9}, {3.3998195847752314`*^9, 3.3998195956035643`*^9}, {
   3.3998937261423693`*^9, 3.3998937440645885`*^9}, {3.399894673945778*^9, 
   3.3998946780865884`*^9}, 3.399895357951172*^9, {3.3998971752360635`*^9, 
   3.399897202986596*^9}, {3.399995099817901*^9, 3.3999951242558703`*^9}, {
   3.3999951653972855`*^9, 3.3999952424143887`*^9}, {3.399995434089944*^9, 
   3.3999954559809895`*^9}, 3.400214359554536*^9, {3.4002194753715076`*^9, 
   3.4002194862310915`*^9}, {3.400221264780864*^9, 3.400221267812172*^9}, {
   3.400221324438259*^9, 3.4002213249851446`*^9}, {3.4002307045682325`*^9, 
   3.4002307106777253`*^9}, {3.4002309417446613`*^9, 
   3.4002309457603636`*^9}, {3.4002355676772275`*^9, 
   3.4002356840075865`*^9}, {3.4002357813375797`*^9, 3.400235782228222*^9}, {
   3.400238239244146*^9, 3.40023824052542*^9}, {3.4004065560321016`*^9, 
   3.400406572266788*^9}, 3.40040661272069*^9, {3.400406710910075*^9, 
   3.400406802349331*^9}, {3.4004079962316275`*^9, 3.400408003981776*^9}, {
   3.4004080367167797`*^9, 3.400408037591797*^9}, {3.400408141500042*^9, 
   3.4004081422656813`*^9}, 3.400504474791651*^9, {3.4008198209228888`*^9, 
   3.4008198369544463`*^9}, {3.401177200473509*^9, 3.401177296365975*^9}, 
   3.4011776191065464`*^9, 3.4011776885297546`*^9, {3.4011777732345057`*^9, 
   3.4011777815627904`*^9}, {3.4015301347651124`*^9, 3.401530142671514*^9}, {
   3.4015342195318975`*^9, 3.4015342774861345`*^9}, {3.4015343731285963`*^9, 
   3.4015343749255056`*^9}, {3.402033437670154*^9, 3.402033457561161*^9}, {
   3.4020334928118377`*^9, 3.402033502483898*^9}, {3.402143403333747*^9, 
   3.402143421193465*^9}, {3.402143489991661*^9, 3.40214349125731*^9}, {
   3.402143653151044*^9, 3.4021436941674557`*^9}, {3.402205803123693*^9, 
   3.402205848499564*^9}, {3.402294611715026*^9, 3.4022946131681786`*^9}, 
   3.402294775718175*^9, {3.4022949263773174`*^9, 3.4022949270960813`*^9}, 
   3.4023779225819693`*^9, 3.402388039487956*^9, 3.4023881114109564`*^9, 
   3.403871476831417*^9, 3.403871589333577*^9, {3.403871732195695*^9, 
   3.4038719361371107`*^9}, 3.40387197021589*^9, {3.4038729130621176`*^9, 
   3.403872917359075*^9}, {3.4038732665532794`*^9, 3.4038732913350053`*^9}, {
   3.40387338716497*^9, 3.403873392790078*^9}, {3.4038739059561806`*^9, 
   3.403873929300379*^9}, {3.4038757265536356`*^9, 3.403875727100521*^9}, {
   3.4038760173873444`*^9, 3.403876028450057*^9}, {3.4038767128225718`*^9, 
   3.4038767355730085`*^9}, {3.403876883685227*^9, 3.403876894872942*^9}, 
   3.4038770811577682`*^9, {3.403877262489375*^9, 3.403877296927536*^9}, {
   3.4038779003609967`*^9, 3.4038779017516484`*^9}, {3.403877950330706*^9, 
   3.403877995722203*^9}, {3.4038805669746947`*^9, 3.4038805816156006`*^9}, {
   3.403940196949411*^9, 3.403940212309081*^9}, {3.4039402503098106`*^9, 
   3.403940330483225*^9}, {3.403940565097104*^9, 3.4039406320983906`*^9}, {
   3.4039477736886315`*^9, 3.4039478349866834`*^9}, 3.403947942238743*^9, {
   3.4039479736924715`*^9, 3.403948027771635*^9}, 3.403948162852353*^9, {
   3.4039491169487963`*^9, 3.4039491206988688`*^9}, {3.4039492631391034`*^9, 
   3.4039493470938406`*^9}, {3.4039496376931696`*^9, 3.403949723882324*^9}, {
   3.4039498424783516`*^9, 3.4039499998719983`*^9}, {3.404147952397335*^9, 
   3.404147980680135*^9}, {3.404148073983735*^9, 3.404148107492535*^9}, {
   3.404148258531735*^9, 3.4041482678605347`*^9}, {3.404148945009735*^9, 
   3.404148946164135*^9}, {3.4041489846337347`*^9, 3.404149017549735*^9}, {
   3.404149060200135*^9, 3.404149083178935*^9}, {3.404151307641535*^9, 
   3.404151309185935*^9}, {3.404151474499135*^9, 3.404151483219535*^9}, 
   3.404151568223935*^9, 3.4041938717523823`*^9, {3.404193912175033*^9, 
   3.404193917190755*^9}, {3.4042041069801445`*^9, 3.4042041521685123`*^9}, {
   3.4042042123415427`*^9, 3.4042042386076717`*^9}, {3.404204276624027*^9, 
   3.4042044284238167`*^9}, {3.40420452156623*^9, 3.4042045494573903`*^9}, {
   3.404204582895532*^9, 3.4042046181149583`*^9}, {3.404204788415103*^9, 
   3.4042048062748213`*^9}, {3.404204841759877*^9, 3.4042048723542147`*^9}, {
   3.404204936324193*^9, 3.4042052265172644`*^9}, {3.4042052790182724`*^9, 
   3.4042052894403477`*^9}, {3.404205340738208*^9, 3.4042053679418545`*^9}, {
   3.404205400817486*^9, 3.404205419677223*^9}, {3.4042054802252607`*^9, 
   3.404205497178711*^9}, 3.40420552863244*^9, {3.4042072185555105`*^9, 
   3.404207235243331*^9}, {3.4043000701119347`*^9, 3.4043000786295347`*^9}, {
   3.4043001168183346`*^9, 3.4043001401871347`*^9}, {3.4043234063901434`*^9, 
   3.404323420461344*^9}, {3.4043237408853436`*^9, 3.4043237568753433`*^9}, {
   3.4043239580841436`*^9, 3.4043239680837436`*^9}, {3.404389056089944*^9, 
   3.404389064997544*^9}, {3.4044553143383374`*^9, 3.4044553173471303`*^9}, {
   3.404464727328169*^9, 3.4044647793115463`*^9}, {3.4044648634193068`*^9, 
   3.404464895731186*^9}, 3.404464939995961*^9, {3.404466809225696*^9, 
   3.404466820006739*^9}, 3.4044669271765566`*^9, {3.404470193535716*^9, 
   3.404470194207578*^9}, {3.404652102174907*^9, 3.4046521218471603`*^9}, {
   3.404662523952945*^9, 3.4046625707061453`*^9}, {3.4046627912433453`*^9, 
   3.404662802490945*^9}, {3.4046642321459455`*^9, 3.404664234080345*^9}, {
   3.4046642723003454`*^9, 3.404664298679945*^9}, {3.4047349612907963`*^9, 
   3.4047350190586395`*^9}, 3.4048112009093513`*^9, {3.4048112843813066`*^9, 
   3.404811295334852*^9}, {3.4048122778100777`*^9, 3.4048123057486506`*^9}, 
   3.404826576562254*^9, {3.4048266892697067`*^9, 3.404826703692135*^9}, {
   3.404831024244785*^9, 3.404831026635502*^9}, {3.4049792115931997`*^9, 
   3.4049792117922*^9}, {3.405087246152504*^9, 3.4050872465900154`*^9}, {
   3.4057874400886683`*^9, 3.4057874406668043`*^9}, {3.4058685558066044`*^9, 
   3.4058685559941077`*^9}, {3.405868666058721*^9, 3.405868666511855*^9}, {
   3.405870801146589*^9, 3.405870805568549*^9}, {3.4059348794306903`*^9, 
   3.405934879477566*^9}, {3.405935341189556*^9, 3.405935371252633*^9}, 
   3.4059358268238797`*^9, {3.405936151048855*^9, 3.4059361524238815`*^9}, {
   3.4064685458853703`*^9, 3.406468599871127*^9}, {3.406468673951149*^9, 
   3.4064686899671836`*^9}, {3.406542078362503*^9, 3.406542081112573*^9}, {
   3.40654334195735*^9, 3.4065433446292934`*^9}, {3.4065549038588*^9, 
   3.4065549048275747`*^9}, 3.406557370890704*^9, {3.4065579994692955`*^9, 
   3.406558026516863*^9}, {3.4065582133810215`*^9, 3.4065582157873335`*^9}, {
   3.406562183092019*^9, 3.406562199811197*^9}, 3.406612023137294*^9, {
   3.40661206652903*^9, 3.406612068169697*^9}, {3.4069594399533267`*^9, 
   3.4069594454690576`*^9}, 3.406959819101231*^9, 3.4069686605366087`*^9, 
   3.4069734408940144`*^9, {3.407048476521969*^9, 3.4070484922566457`*^9}, {
   3.407585769727401*^9, 3.4075857710964007`*^9}, {3.4075863558724008`*^9, 
   3.4075863657104006`*^9}, {3.4078516893378*^9, 3.4078517913258*^9}, 
   3.4078519658627996`*^9, {3.408424092344942*^9, 3.408424296036353*^9}, {
   3.408425129099222*^9, 3.4084252504609275`*^9}, {3.4084253248998566`*^9, 
   3.40842549616877*^9}, 3.4084275721773787`*^9, {3.408429774125905*^9, 
   3.40842977464154*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SmileBiHestonVanillaAux2", "[", 
   RowBox[{
   "S_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "a_", ",", "b_", ",", 
    "KList_", ",", "\[Tau]_", ",", "\[CapitalSigma]_", ",", "M_", ",", 
    "\[CapitalSigma]inf_", ",", "Q_", ",", "\[Rho]_", ",", "\[Mu]_", ",", 
    "\[Beta]m_", ",", "\[Lambda]1_", ",", "\[Lambda]2_", ",", 
    RowBox[{"{", 
     RowBox[{
     "LegendreCoef1_", ",", "LegendreCoef1n_", ",", "period1_", ",", 
      "period1n_", ",", "\[Epsilon]1_", ",", "imax_", ",", 
      "startmonitortime_", ",", "plafondexplosion_", ",", "initialTailFlag_", 
      ",", "InitialTailPosition_", ",", "InitialTailPosition2_"}], "}"}], ",",
     
    RowBox[{"{", 
     RowBox[{
     "LegendreCoef2_", ",", "period2_", ",", "period2n_", ",", "\[Epsilon]2_",
       ",", "kmax_", ",", "StartControl_", ",", "IncrementFactor_"}], "}"}], 
    ",", "printflag_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{
   FractionBox["2", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"2", "\[Pi]"}], ")"}], "2"]], 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"as", ",", "res", ",", "res2", ",", 
       RowBox[{"Y", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Log", "[", 
           RowBox[{"S", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
          RowBox[{"Log", "[", 
           RowBox[{"S", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "1"}], " ", "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "1"}], "]"}]}], "  ", ",", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\< S=\>\"", ",", 
           RowBox[{"S", " ", "//", " ", "MatrixForm"}], ",", 
           "\"\< \[CapitalSigma]=\>\"", ",", 
           RowBox[{"\[CapitalSigma]", " ", "//", "MatrixForm"}], ",", 
           "\"\<M=\>\"", ",", 
           RowBox[{"M", "//", "MatrixForm"}], ",", 
           "\"\< \[CapitalSigma]inf=\>\"", ",", 
           RowBox[{"\[CapitalSigma]inf", "//", "MatrixForm"}], " ", ",", 
           "\"\< Q=\>\"", ",", 
           RowBox[{"Q", "//", "MatrixForm"}], " ", ",", "\"\< \[Rho]=\>\"", 
           ",", 
           RowBox[{"\[Rho]", "//", "MatrixForm"}], ",", "\"\< \[Mu]=\>\"", 
           ",", 
           RowBox[{"\[Mu]", "//", "MatrixForm"}], ",", "\"\< \[Beta]m=\>\"", 
           ",", 
           RowBox[{"\[Beta]m", " ", "//", " ", "MatrixForm"}], ",", 
           "\"\< T=\>\"", ",", "\[Tau]"}], "]"}], ";", "\[IndentingNewLine]", 
         
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Inner Integration\>\"", ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\"\<LegendreNbMain\>\"", ",", 
                RowBox[{"Length", "[", "LegendreCoef1", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<LegendreNbIncrement\>\"", ",", 
                RowBox[{"Length", "[", "LegendreCoef1n", "]"}]}], "}"}], ",", 
              
              RowBox[{"{", 
               RowBox[{"\"\<IncrementNbMax\>\"", ",", "imax"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<InitialTailFlag\>\"", ",", "initialTailFlag"}], 
               "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<InitialTailLegendreNb\>\"", ",", 
                RowBox[{"Length", "[", "LegendreCoef1", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<PeriodMain\>\"", ",", "period1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<PeriodnIncrement\>\"", ",", "period1n"}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"\"\<StoppingLevel\>\"", ",", "\[Epsilon]1"}], "}"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"\"\<AbcisseMaxValue\>\"", ",", "kmax"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
               "\"\<InitialTailUpperLimit\>\"", ",", "InitialTailPosition"}], 
               "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
               "\"\<ExplosionMonitoringStartAbcisse\>\"", ",", 
                "StartControl"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
               "\"\<ExplosionMonitoringMaxLevel\>\"", ",", 
                "IncrementFactor"}], "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"\"\<lambda1\>\"", ",", "\[Lambda]1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<lambda2\>\"", ",", "\[Lambda]2"}], "}"}]}], "}"}],
             " ", "//", " ", "MatrixForm"}], ",", "\[IndentingNewLine]", 
           "\"\<Outer Integration\>\"", ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\"\<LegendreNbMain\>\"", ",", 
                RowBox[{"Length", "[", "LegendreCoef2", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<LegendreNbIncrement\>\"", ",", 
                RowBox[{"Length", "[", "LegendreCoef1n", "]"}]}], "}"}], ",", 
              
              RowBox[{"{", 
               RowBox[{"\"\<IncrementNbMax\>\"", ",", "imax"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<InitialTailFlag\>\"", ",", "initialTailFlag"}], 
               "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<InitialTailLegendreNb\>\"", ",", 
                RowBox[{"Length", "[", "LegendreCoef1", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<PeriodMain\>\"", ",", "period2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<PeriodnIncrement\>\"", ",", "period2n"}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"\"\<StoppingLevel\>\"", ",", "\[Epsilon]2"}], "}"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"\"\<AbcisseMaxValue\>\"", ",", "kmax"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
               "\"\<InitialTailUpperLimit\>\"", ",", "InitialTailPosition"}], 
               "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
               "\"\<GrowingControlStartAbcisse\>\"", ",", 
                "startmonitortime"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
               "\"\<GrowingControlMaxFactor\>\"", ",", "plafondexplosion"}], 
               "}"}]}], "}"}], " ", "//", " ", "MatrixForm"}]}], "]"}]}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "2"}], "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "2"}], "]"}]}], "  ", ",", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<BiHestonLaplaceQuickTransform2[M,Q,\[Rho], \[Mu],\
\[CapitalSigma],{-\[ImaginaryI] 1,-\[ImaginaryI] 1},\[Beta]m,\[Tau]]=\>\"", 
           ",", 
           RowBox[{"BiHestonLaplaceQuickTransform2", "[", 
            RowBox[{
            "M", ",", "Q", ",", "\[Rho]", ",", " ", "\[Mu]", ",", 
             "\[CapitalSigma]", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "\[ImaginaryI]"}], " ", "1"}], ",", 
               RowBox[{
                RowBox[{"-", "\[ImaginaryI]"}], " ", "1"}]}], "}"}], ",", 
             "\[Beta]m", ",", "\[Tau]"}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<integrand(0.1,0.1)=\>\"", ",", 
           RowBox[{"SmileSymetrizedBiHestonVanillaIntegrand2CC", "[", 
            RowBox[{
            "Y", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", "b", ",", 
             "KList", ",", "\[Tau]", ",", "\[CapitalSigma]", ",", "M", ",", 
             "Q", ",", "\[Rho]", ",", "\[Mu]", ",", "\[Beta]m", ",", 
             "\[Lambda]1", ",", "\[Lambda]2", ",", "0.1", ",", "0.1"}], 
            "]"}]}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "4"}], "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "4"}], "]"}]}], " ", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Plot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"SmileSymetrizedBiHestonVanillaIntegrand2", "[", 
               RowBox[{
               "Y", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", "b", 
                ",", 
                RowBox[{"{", 
                 RowBox[{"KList", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", "\[Tau]", ",", 
                "\[CapitalSigma]", ",", "M", ",", "Q", ",", "\[Rho]", ",", 
                "\[Mu]", ",", "\[Beta]m", ",", "\[Lambda]1", ",", 
                "\[Lambda]2", ",", "\[Omega]1", ",", "\[Omega]2"}], "]"}], 
              "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Omega]2", ",", "0", " ", ",", 
               RowBox[{"2", "period1"}]}], "}"}], ",", 
             RowBox[{"PlotPoints", "\[Rule]", "50"}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
             RowBox[{"PlotLabel", "\[Rule]", 
              RowBox[{"\"\<1st Inverse Fourier: K =\>\"", "<>", 
               RowBox[{"ToString", "[", 
                RowBox[{"KList", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", 
               "\"\< \[Omega]1=\>\"", "<>", 
               RowBox[{"ToString", "[", "\[Omega]1", "]"}]}]}]}], "]"}], ",", 
           
           RowBox[{"{", 
            RowBox[{"\[Omega]1", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.2", ",", "2"}], "}"}]}], "}"}]}], "]"}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "6"}], "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "6"}], "]"}]}], " ", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\[Omega]2", ",", 
               RowBox[{
                RowBox[{"VectorAdaptativeIntegrateExplosionSafe", "[", 
                 RowBox[{
                  RowBox[{"Function", "[", 
                   RowBox[{"\[Omega]1", ",", 
                    RowBox[{
                    RowBox[{
                    "SmileSymetrizedBiHestonVanillaIntegrand2CC", "[", 
                    RowBox[{
                    "Y", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", 
                    "b", ",", 
                    RowBox[{"{", 
                    RowBox[{"KList", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", "\[Tau]", ",",
                     "\[CapitalSigma]", ",", "M", ",", "Q", ",", "\[Rho]", 
                    ",", "\[Mu]", ",", "\[Beta]m", ",", "\[Lambda]1", ",", 
                    "\[Lambda]2", ",", "\[Omega]1", ",", "\[Omega]2"}], "]"}],
                     "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
                  "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", ",",
                   "period1n", ",", "\[Epsilon]1", ",", "imax", ",", "1", ",",
                   "startmonitortime", ",", "plafondexplosion", ",", 
                  "initialTailFlag", ",", "InitialTailPosition"}], "]"}], "[",
                 
                RowBox[{"[", 
                 RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Omega]2", ",", "0", ",", "period2", ",", 
               RowBox[{"period2", "/", "30"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"Joined", "\[Rule]", "True"}], ",", 
           RowBox[{"PlotLabel", "\[Rule]", "\"\<2nd Inverse Fourier:\>\""}], 
           ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "]"}]}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "7"}], "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "7"}], "]"}]}], " ", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<integrand(0.1,0.1)=\>\"", ",", 
          RowBox[{"SmileSymetrizedBiHestonVanillaIntegrand2", "[", 
           RowBox[{
           "Y", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", "b", ",", 
            "KList", ",", "\[Tau]", ",", "\[CapitalSigma]", ",", "M", ",", 
            "Q", ",", "\[Rho]", ",", "\[Mu]", ",", "\[Beta]m", ",", 
            "\[Lambda]1", ",", "\[Lambda]2", ",", "0.1", ",", "0.1"}], 
           "]"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "7"}], "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "7"}], "]"}]}], " ", ",", 
        RowBox[{
         RowBox[{
         "Print", "[", 
          "\"\<code integ 2 : \
{i,exploded<1,Abs[increment[[1]]]>\[Epsilon],(i<imax)}\>\"", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
         "Print", "[", 
          "\"\<code integ 1 : \
{i,exploded<1,Abs[increment[[1]]]>\[Epsilon],(i<imax)}\>\"", "]"}]}]}], "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{"VectorAdaptativeIntegrateUnprotected", "[", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{"\[Omega]2", ",", 
           RowBox[{
            RowBox[{"as", "=", 
             RowBox[{"VectorAdaptativeIntegrateExplosionSafe", "[", 
              RowBox[{
               RowBox[{"Function", "[", 
                RowBox[{"\[Omega]1", ",", 
                 RowBox[{"SmileSymetrizedBiHestonVanillaIntegrand2CC", "[", 
                  RowBox[{
                  "Y", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", "b", 
                   ",", "KList", ",", "\[Tau]", ",", "\[CapitalSigma]", ",", 
                   "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", 
                   "\[Beta]m", ",", "\[Lambda]1", ",", "\[Lambda]2", ",", 
                   "\[Omega]1", ",", "\[Omega]2"}], "]"}]}], "]"}], ",", 
               "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", ",", 
               "period1n", ",", "\[Epsilon]1", ",", "imax", ",", 
               RowBox[{"Length", "[", "KList", "]"}], ",", "startmonitortime",
                ",", "plafondexplosion", ",", "initialTailFlag", ",", 
               "InitialTailPosition"}], "]"}]}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"printflag", "\[Equal]", "7"}], "||", " ", 
               RowBox[{"MemberQ", "[", 
                RowBox[{"printflag", ",", "7"}], "]"}]}], ",", 
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<\[Omega]2=\>\"", ",", "\[Omega]2", ",", 
                "\"\< Integ_2=\>\"", ",", "as"}], "]"}]}], "]"}], ";", 
            RowBox[{"as", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], ",", "LegendreCoef2", 
         ",", "LegendreCoef1n", ",", "period2", ",", "period2n", ",", 
         "\[Epsilon]2", ",", "imax", ",", 
         RowBox[{"Length", "[", "KList", "]"}], ",", "printflag", ",", 
         "initialTailFlag", ",", "InitialTailPosition2", ",", "kmax", ",", 
         "StartControl", ",", "IncrementFactor"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"printflag", "\[Equal]", "2"}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Integ_1=\>\"", ",", "res"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"res", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.3997288601267104`*^9, 3.39972890803388*^9, {3.3997289692069297`*^9, 
   3.3997289944261637`*^9}, {3.399729087443575*^9, 3.3997291578199263`*^9}, {
   3.399729214633517*^9, 3.3997292559936857`*^9}, {3.399729338917153*^9, 
   3.399729443137904*^9}, {3.3997297921289797`*^9, 3.399729801332281*^9}, 
   3.3997984631978292`*^9, 3.3997986822957864`*^9, {3.399799475623518*^9, 
   3.3997994825611515`*^9}, {3.399813039024555*^9, 3.3998130523841867`*^9}, {
   3.3998138111956306`*^9, 3.399813818523896*^9}, {3.3998138975254135`*^9, 
   3.3998139300104117`*^9}, {3.399814002074295*^9, 3.3998140680286865`*^9}, {
   3.3998141794214506`*^9, 3.399814187827862*^9}, {3.3998161633189154`*^9, 
   3.399816166818983*^9}, {3.399816989678531*^9, 3.39981701069456*^9}, {
   3.3998175772210617`*^9, 3.3998175797054844`*^9}, {3.3998177980534267`*^9, 
   3.3998178039285393`*^9}, 3.3998191717048006`*^9, {3.399819229424659*^9, 
   3.399819249925052*^9}, {3.3998192996916327`*^9, 3.3998193255202537`*^9}, {
   3.3998194002404385`*^9, 3.399819401990472*^9}, {3.399819437022394*^9, 
   3.399819443678772*^9}, {3.3998195847752314`*^9, 3.3998195956035643`*^9}, {
   3.3998937261423693`*^9, 3.3998937440645885`*^9}, {3.399894673945778*^9, 
   3.3998946780865884`*^9}, 3.399895357951172*^9, {3.3998971752360635`*^9, 
   3.399897202986596*^9}, {3.399995099817901*^9, 3.3999951242558703`*^9}, {
   3.3999951653972855`*^9, 3.3999952424143887`*^9}, {3.399995434089944*^9, 
   3.3999954559809895`*^9}, 3.400214359554536*^9, {3.4002194753715076`*^9, 
   3.4002194862310915`*^9}, {3.400221264780864*^9, 3.400221267812172*^9}, {
   3.400221324438259*^9, 3.4002213249851446`*^9}, {3.4002307045682325`*^9, 
   3.4002307106777253`*^9}, {3.4002309417446613`*^9, 
   3.4002309457603636`*^9}, {3.4002355676772275`*^9, 
   3.4002356840075865`*^9}, {3.4002357813375797`*^9, 3.400235782228222*^9}, {
   3.400238239244146*^9, 3.40023824052542*^9}, {3.4004065560321016`*^9, 
   3.400406572266788*^9}, 3.40040661272069*^9, {3.400406710910075*^9, 
   3.400406802349331*^9}, {3.4004079962316275`*^9, 3.400408003981776*^9}, {
   3.4004080367167797`*^9, 3.400408037591797*^9}, {3.400408141500042*^9, 
   3.4004081422656813`*^9}, 3.400504474791651*^9, {3.4008198209228888`*^9, 
   3.4008198369544463`*^9}, {3.401177200473509*^9, 3.401177296365975*^9}, 
   3.4011776191065464`*^9, 3.4011776885297546`*^9, {3.4011777732345057`*^9, 
   3.4011777815627904`*^9}, {3.4015301347651124`*^9, 3.401530142671514*^9}, {
   3.4015342195318975`*^9, 3.4015342774861345`*^9}, {3.4015343731285963`*^9, 
   3.4015343749255056`*^9}, {3.402033437670154*^9, 3.402033457561161*^9}, {
   3.4020334928118377`*^9, 3.402033502483898*^9}, {3.402143403333747*^9, 
   3.402143421193465*^9}, {3.402143489991661*^9, 3.40214349125731*^9}, {
   3.402143653151044*^9, 3.4021436941674557`*^9}, {3.402205803123693*^9, 
   3.402205848499564*^9}, {3.402294611715026*^9, 3.4022946131681786`*^9}, 
   3.402294775718175*^9, {3.4022949263773174`*^9, 3.4022949270960813`*^9}, 
   3.4023779225819693`*^9, 3.402388039487956*^9, 3.4023881114109564`*^9, 
   3.403871476831417*^9, 3.403871589333577*^9, {3.403871732195695*^9, 
   3.4038719361371107`*^9}, 3.40387197021589*^9, {3.4038729130621176`*^9, 
   3.403872917359075*^9}, {3.4038732665532794`*^9, 3.4038732913350053`*^9}, {
   3.40387338716497*^9, 3.403873392790078*^9}, {3.4038739059561806`*^9, 
   3.403873929300379*^9}, {3.4038757265536356`*^9, 3.403875727100521*^9}, {
   3.4038760173873444`*^9, 3.403876028450057*^9}, {3.4038767128225718`*^9, 
   3.4038767355730085`*^9}, {3.403876883685227*^9, 3.403876894872942*^9}, 
   3.4038770811577682`*^9, {3.403877262489375*^9, 3.403877296927536*^9}, {
   3.4038779003609967`*^9, 3.4038779017516484`*^9}, {3.403877950330706*^9, 
   3.403877995722203*^9}, {3.4038805669746947`*^9, 3.4038805816156006`*^9}, {
   3.403940196949411*^9, 3.403940212309081*^9}, {3.4039402503098106`*^9, 
   3.403940330483225*^9}, {3.403940565097104*^9, 3.4039406320983906`*^9}, {
   3.4039477736886315`*^9, 3.4039478349866834`*^9}, 3.403947942238743*^9, {
   3.4039479736924715`*^9, 3.403948027771635*^9}, 3.403948162852353*^9, {
   3.4039491169487963`*^9, 3.4039491206988688`*^9}, {3.4039492631391034`*^9, 
   3.4039493470938406`*^9}, {3.4039496376931696`*^9, 3.403949723882324*^9}, {
   3.4039498424783516`*^9, 3.4039499998719983`*^9}, {3.404147952397335*^9, 
   3.404147980680135*^9}, {3.404148073983735*^9, 3.404148107492535*^9}, {
   3.404148258531735*^9, 3.4041482678605347`*^9}, {3.404148945009735*^9, 
   3.404148946164135*^9}, {3.4041489846337347`*^9, 3.404149017549735*^9}, {
   3.404149060200135*^9, 3.404149083178935*^9}, {3.404151307641535*^9, 
   3.404151309185935*^9}, {3.404151474499135*^9, 3.404151483219535*^9}, 
   3.404151568223935*^9, 3.4041938717523823`*^9, {3.404193912175033*^9, 
   3.404193917190755*^9}, {3.4042041069801445`*^9, 3.4042041521685123`*^9}, {
   3.4042042123415427`*^9, 3.4042042386076717`*^9}, {3.404204276624027*^9, 
   3.4042044284238167`*^9}, {3.40420452156623*^9, 3.4042045494573903`*^9}, {
   3.404204582895532*^9, 3.4042046181149583`*^9}, {3.404204788415103*^9, 
   3.4042048062748213`*^9}, {3.404204841759877*^9, 3.4042048723542147`*^9}, {
   3.404204936324193*^9, 3.4042052265172644`*^9}, {3.4042052790182724`*^9, 
   3.4042052894403477`*^9}, {3.404205340738208*^9, 3.4042053679418545`*^9}, {
   3.404205400817486*^9, 3.404205419677223*^9}, {3.4042054802252607`*^9, 
   3.404205497178711*^9}, 3.40420552863244*^9, {3.4042072185555105`*^9, 
   3.404207235243331*^9}, {3.4042169113197336`*^9, 3.404216925101248*^9}, {
   3.4043001505299344`*^9, 3.4043002016355343`*^9}, {3.4043234402889433`*^9, 
   3.4043234487441435`*^9}, {3.4043237751273437`*^9, 
   3.4043237822877436`*^9}, {3.404324132304144*^9, 3.4043241429121437`*^9}, {
   3.404324465254944*^9, 3.4043244826177435`*^9}, 3.404324753246544*^9, 
   3.404389086572344*^9, {3.4044647321249523`*^9, 3.404464746624674*^9}, {
   3.404464795092493*^9, 3.4044648116703*^9}, {3.404464856278818*^9, 
   3.404464859169388*^9}, {3.4044649040279016`*^9, 3.4044649336835823`*^9}, 
   3.4044669516448364`*^9, {3.4044672458266883`*^9, 3.4044672763573523`*^9}, {
   3.4046521047218313`*^9, 3.404652136113059*^9}, {3.404662443222945*^9, 
   3.404662495467345*^9}, 3.404811209190919*^9, {3.4048113022257414`*^9, 
   3.404811310991703*^9}, {3.4048123202804585`*^9, 3.4048123315308905`*^9}, {
   3.404826540560871*^9, 3.404826542826583*^9}, {3.404826714333169*^9, 
   3.404826722989751*^9}, 3.4048312176740875`*^9, {3.405145840438179*^9, 
   3.405145840906941*^9}, 3.405866069665121*^9, {3.405866108822123*^9, 
   3.4058661518229485`*^9}, {3.4059348794931917`*^9, 3.4059348795088167`*^9}, 
   3.405935088997214*^9, {3.4059355527717433`*^9, 3.405935627241923*^9}, {
   3.405936206112412*^9, 3.405936219597046*^9}, {3.4059364734925456`*^9, 
   3.405936524149768*^9}, {3.405939431752468*^9, 3.4059394321587257`*^9}, {
   3.4059525987865205`*^9, 3.40595262664643*^9}, {3.4059533593323727`*^9, 
   3.405953359941759*^9}, {3.406035793364221*^9, 3.406035803942549*^9}, {
   3.406036162996318*^9, 3.4060361652463613`*^9}, {3.4063121525605783`*^9, 
   3.406312166407578*^9}, {3.406313354920578*^9, 3.406313358255578*^9}, {
   3.4063888549966135`*^9, 3.4063889175931673`*^9}, 3.4063900299242477`*^9, {
   3.406390075207526*^9, 3.4063900801764994`*^9}, 3.4063902945454774`*^9, {
   3.4063912794333487`*^9, 3.406391326607337*^9}, {3.406468421429059*^9, 
   3.4064684673364844`*^9}, {3.406468515447091*^9, 3.4064685175252695`*^9}, {
   3.406542089690918*^9, 3.4065420923472357`*^9}, 3.40654335289513*^9, {
   3.406554911718376*^9, 3.406554912718402*^9}, {3.4065573922506266`*^9, 
   3.4065573964694843`*^9}, {3.4065579832970066`*^9, 3.406557983765769*^9}, {
   3.406558224318802*^9, 3.406558226490732*^9}, {3.406562213577174*^9, 
   3.4065622294838314`*^9}, 3.4066120167933817`*^9, 3.4066120868576756`*^9, {
   3.4069594616568685`*^9, 3.406959462156878*^9}, 3.406959813069865*^9, 
   3.4069686670211077`*^9, 3.406973435800167*^9, 3.4084275843651123`*^9, {
   3.4084297790478745`*^9, 3.4084297803291492`*^9}, {3.4084461355025377`*^9, 
   3.408446142237042*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Integrands", "Subsubtitle",
 CellChangeTimes->{{3.404631476967207*^9, 3.4046314788891187`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SmileSymetrizedBiHestonVanillaIntegrand", "[", 
   RowBox[{
   "Y_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "a_", ",", "b_", ",", 
    "KList_", ",", "\[Tau]_", ",", "\[CapitalSigma]_", ",", "M_", ",", "Q_", 
    ",", "\[Rho]_", ",", "\[Mu]_", ",", "\[Beta]_", ",", "\[Lambda]1_", ",", 
    "\[Lambda]2_", ",", "\[Omega]1_", ",", "\[Omega]2_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x1", "=", 
       RowBox[{"Y", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", 
      RowBox[{"x2", "=", 
       RowBox[{"Y", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ",", 
      RowBox[{"k1", "=", 
       RowBox[{"(", 
        RowBox[{"\[Omega]1", "+", 
         RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1"}]}], ")"}]}], ",", 
      RowBox[{"Sk1", "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "\[Omega]1"}], "+", 
         RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1"}]}], ")"}]}], ",", 
      RowBox[{"k2", "=", " ", 
       RowBox[{"(", 
        RowBox[{"\[Omega]2", "+", 
         RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2"}]}], ")"}]}], ",", 
      RowBox[{"Sk2", "=", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "\[Omega]2"}], "+", 
         RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2"}]}], ")"}]}], ",", 
      RowBox[{"Sk1A", "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "\[Omega]1"}], "+", 
         RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1"}]}], ")"}]}], ",", 
      RowBox[{"k1A", "=", 
       RowBox[{"(", 
        RowBox[{"\[Omega]1", "-", 
         RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1"}]}], ")"}]}], ",", 
      RowBox[{"k2A", "=", 
       RowBox[{"(", 
        RowBox[{"\[Omega]2", "-", 
         RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2"}]}], ")"}]}], ",", 
      "\[Alpha]", ",", "\[Alpha]A", ",", "Sym\[Alpha]", ",", "Sym\[Alpha]A", 
      ",", "\[Alpha]2", ",", "\[Alpha]A2", ",", "Sym\[Alpha]2", ",", 
      "Sym\[Alpha]A2", ",", "propagatorDroit", ",", "SympropagatorDroit", ",",
       "propagatorGauche", ",", "SympropagatorGauche", ",", 
      "propagatorDroit2", ",", "SympropagatorDroit2", ",", 
      "propagatorGauche2", ",", "SympropagatorGauche2"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Re", "[", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"KList", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "\[GreaterEqual]", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Alpha]", "=", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", "x1", " ", "k1"}], "-", 
           RowBox[{"\[ImaginaryI]", " ", "x2", " ", "k2"}]}]]}], ";", 
        RowBox[{"\[Alpha]A", "=", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", "x1", " ", "k1"}], "-", 
           RowBox[{"\[ImaginaryI]", " ", "x2", " ", "k2A"}]}]]}], ";", 
        RowBox[{"Sym\[Alpha]", "=", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", "x1", " ", "Sk1"}], "-", 
           RowBox[{"\[ImaginaryI]", " ", "x2", " ", "k2"}]}]]}], ";", 
        RowBox[{"Sym\[Alpha]A", "=", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", "x1", " ", "Sk1A"}], "-", 
           RowBox[{"\[ImaginaryI]", " ", "x2", " ", "k2A"}]}]]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"propagatorDroit", "=", 
         RowBox[{"BiHestonLaplaceQuickTransform", "[", 
          RowBox[{
          "M", ",", "Q", ",", "\[Rho]", ",", " ", "\[Mu]", ",", 
           "\[CapitalSigma]", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "\[ImaginaryI]"}], " ", "k1"}], ",", 
             RowBox[{
              RowBox[{"-", "\[ImaginaryI]"}], " ", "k2"}]}], "}"}], ",", 
           "\[Beta]", ",", "\[Tau]"}], "]"}]}], ";", 
        RowBox[{"SympropagatorDroit", "=", 
         RowBox[{"BiHestonLaplaceQuickTransform", "[", 
          RowBox[{
          "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", " ", 
           "\[CapitalSigma]", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "\[ImaginaryI]"}], " ", "Sk1"}], ",", 
             RowBox[{
              RowBox[{"-", "\[ImaginaryI]"}], " ", "k2"}]}], "}"}], ",", 
           "\[Beta]", ",", "\[Tau]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"propagatorGauche", "=", 
         RowBox[{"BiHestonLaplaceQuickTransform", "[", 
          RowBox[{
          "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", " ", 
           "\[CapitalSigma]", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "\[ImaginaryI]"}], " ", "k1"}], ",", 
             RowBox[{
              RowBox[{"-", "\[ImaginaryI]"}], " ", "k2A"}]}], "}"}], ",", 
           "\[Beta]", ",", "\[Tau]"}], "]"}]}], ";", 
        RowBox[{"SympropagatorGauche", "=", 
         RowBox[{"BiHestonLaplaceQuickTransform", "[", 
          RowBox[{
          "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", " ", 
           "\[CapitalSigma]", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "\[ImaginaryI]"}], " ", "Sk1A"}], ",", 
             RowBox[{
              RowBox[{"-", "\[ImaginaryI]"}], " ", "k2A"}]}], "}"}], ",", 
           "\[Beta]", ",", "\[Tau]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"KList", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ">", "0"}], ",", 
            RowBox[{
             RowBox[{"\[Alpha]", " ", "propagatorDroit", " ", 
              RowBox[{"VanillaPayOffFourierDroite", "[", 
               RowBox[{"k1", ",", "k2", ",", 
                RowBox[{"KList", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", "\[Alpha]1", ",", 
                "\[Beta]1", ",", "a", ",", "b"}], "]"}]}], "+", 
             "\[IndentingNewLine]", 
             RowBox[{"Sym\[Alpha]", " ", "SympropagatorDroit", " ", 
              RowBox[{"VanillaPayOffFourierDroite", "[", 
               RowBox[{"Sk1", ",", "k2", ",", 
                RowBox[{"KList", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", "\[Alpha]1", ",", 
                "\[Beta]1", ",", "a", ",", "b"}], "]"}]}], "+", 
             "\[IndentingNewLine]", 
             RowBox[{"\[Alpha]A", " ", "propagatorGauche", " ", 
              RowBox[{"VanillaPayOffFourierGauche", "[", 
               RowBox[{"k1", ",", "k2A", ",", 
                RowBox[{"KList", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", "\[Alpha]1", ",", 
                "\[Beta]1", ",", "a", ",", "b"}], "]"}]}], "+", 
             "\[IndentingNewLine]", 
             RowBox[{"Sym\[Alpha]A", " ", "SympropagatorGauche", " ", 
              RowBox[{"VanillaPayOffFourierGauche", "[", 
               RowBox[{"Sk1A", ",", "k2A", ",", 
                RowBox[{"KList", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", "\[Alpha]1", ",", 
                "\[Beta]1", ",", "a", ",", "b"}], "]"}]}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"\[Alpha]", " ", "propagatorDroit", " ", 
              RowBox[{"VanillaPayOffFourierDroite", "[", 
               RowBox[{
               "k1", ",", "k2", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", 
                ",", "b"}], "]"}]}], "+", "\[IndentingNewLine]", 
             RowBox[{"Sym\[Alpha]", " ", "SympropagatorDroit", " ", 
              RowBox[{"VanillaPayOffFourierDroite", "[", 
               RowBox[{
               "Sk1", ",", "k2", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", 
                ",", "b"}], "]"}]}], "+", "\[IndentingNewLine]", 
             RowBox[{"\[Alpha]A", " ", "propagatorGauche", " ", 
              RowBox[{"VanillaPayOffFourierGauche", "[", 
               RowBox[{
               "k1", ",", "k2A", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", 
                ",", "b"}], "]"}]}], "+", "\[IndentingNewLine]", 
             RowBox[{"Sym\[Alpha]A", " ", "SympropagatorGauche", " ", 
              RowBox[{"VanillaPayOffFourierGauche", "[", 
               RowBox[{
               "Sk1", ",", "k2A", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a",
                 ",", "b"}], "]"}]}]}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "KList", "]"}]}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Alpha]2", "=", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", "x2", " ", "k1"}], "-", 
           RowBox[{"\[ImaginaryI]", " ", "x1", " ", "k2"}]}]]}], ";", 
        RowBox[{"\[Alpha]A2", "=", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", "x2", " ", "k1"}], "-", 
           RowBox[{"\[ImaginaryI]", " ", "x1", " ", "k2A"}]}]]}], ";", 
        RowBox[{"Sym\[Alpha]2", "=", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", "x2", " ", "Sk1"}], "-", 
           RowBox[{"\[ImaginaryI]", " ", "x1", " ", "k2"}]}]]}], ";", 
        RowBox[{"Sym\[Alpha]A2", "=", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", "x2", " ", "Sk1A"}], "-", 
           RowBox[{"\[ImaginaryI]", " ", "x1", " ", "k2A"}]}]]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"propagatorDroit2", "=", 
         RowBox[{"BiHestonLaplaceQuickTransformReverse", "[", 
          RowBox[{
          "M", ",", "Q", ",", "\[Rho]", ",", " ", "\[Mu]", ",", 
           "\[CapitalSigma]", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "\[ImaginaryI]"}], " ", "k1"}], ",", 
             RowBox[{
              RowBox[{"-", "\[ImaginaryI]"}], " ", "k2"}]}], "}"}], ",", 
           "\[Beta]", ",", "\[Tau]"}], "]"}]}], ";", 
        RowBox[{"SympropagatorDroit2", "=", 
         RowBox[{"BiHestonLaplaceQuickTransformReverse", "[", 
          RowBox[{
          "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", " ", 
           "\[CapitalSigma]", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "\[ImaginaryI]"}], " ", "Sk1"}], ",", 
             RowBox[{
              RowBox[{"-", "\[ImaginaryI]"}], " ", "k2"}]}], "}"}], ",", 
           "\[Beta]", ",", "\[Tau]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"propagatorGauche2", "=", 
         RowBox[{"BiHestonLaplaceQuickTransformReverse", "[", 
          RowBox[{
          "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", " ", 
           "\[CapitalSigma]", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "\[ImaginaryI]"}], " ", "k1"}], ",", 
             RowBox[{
              RowBox[{"-", "\[ImaginaryI]"}], " ", "k2A"}]}], "}"}], ",", 
           "\[Beta]", ",", "\[Tau]"}], "]"}]}], ";", 
        RowBox[{"SympropagatorGauche2", "=", 
         RowBox[{"BiHestonLaplaceQuickTransformReverse", "[", 
          RowBox[{
          "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", " ", 
           "\[CapitalSigma]", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "\[ImaginaryI]"}], " ", "Sk1A"}], ",", 
             RowBox[{
              RowBox[{"-", "\[ImaginaryI]"}], " ", "k2A"}]}], "}"}], ",", 
           "\[Beta]", ",", "\[Tau]"}], "]"}]}], ";", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[Alpha]2", " ", 
              RowBox[{"(", 
               RowBox[{"propagatorDroit2", " ", 
                RowBox[{"(", 
                 RowBox[{"VanillaPayOffFourierDroite", "[", 
                  RowBox[{"k1", ",", "k2", ",", 
                   RowBox[{"-", 
                    RowBox[{"KList", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], ",", "\[Alpha]1", ",", 
                   "\[Beta]1", ",", "a", ",", "b"}], "]"}], ")"}]}], ")"}]}], 
             "+", 
             RowBox[{"Sym\[Alpha]2", " ", 
              RowBox[{"(", 
               RowBox[{"SympropagatorDroit2", 
                RowBox[{"(", 
                 RowBox[{"VanillaPayOffFourierDroite", "[", 
                  RowBox[{"Sk1", ",", "k2", ",", 
                   RowBox[{"-", 
                    RowBox[{"KList", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], ",", "\[Alpha]1", ",", 
                   "\[Beta]1", ",", "a", ",", "b"}], "]"}], ")"}]}], 
               ")"}]}]}], ")"}], " ", "+", "\[IndentingNewLine]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[Alpha]A2", " ", "propagatorGauche2", 
              RowBox[{"(", " ", 
               RowBox[{"VanillaPayOffFourierGauche", "[", 
                RowBox[{"k1", ",", "k2A", ",", 
                 RowBox[{"-", 
                  RowBox[{"KList", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], ",", "\[Alpha]1", ",", 
                 "\[Beta]1", ",", "a", ",", "b"}], "]"}], ")"}]}], "+", 
             RowBox[{"Sym\[Alpha]A2", " ", "SympropagatorGauche2", 
              RowBox[{"(", 
               RowBox[{"VanillaPayOffFourierGauche", "[", 
                RowBox[{"Sk1A", ",", "k2A", ",", 
                 RowBox[{"-", 
                  RowBox[{"KList", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], ",", "\[Alpha]1", ",", 
                 "\[Beta]1", ",", "a", ",", "b"}], "]"}], ")"}]}]}], ")"}]}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "KList", "]"}]}], "}"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.402140085770051*^9, 3.4021400863013115`*^9}, {
   3.4021401238489075`*^9, 3.4021402363666925`*^9}, {3.402140267929798*^9, 
   3.402140316290102*^9}, {3.4021403621347322`*^9, 3.4021403798069468`*^9}, {
   3.402140442948784*^9, 3.4021404698243*^9}, {3.40214052530974*^9, 
   3.4021405261847568`*^9}, {3.402140572076263*^9, 3.4021405730294065`*^9}, {
   3.40214283290092*^9, 3.402142834900958*^9}, 3.402142878995555*^9, {
   3.4021429531532288`*^9, 3.40214297455989*^9}, {3.4021430512488623`*^9, 
   3.4021430865307894`*^9}, {3.402143143625636*^9, 3.4021431463288126`*^9}, {
   3.402143222267771*^9, 3.402143365629898*^9}, {3.4021439797510643`*^9, 
   3.4021440141579747`*^9}, {3.4021444783543873`*^9, 
   3.4021445164332433`*^9}, {3.4021445469025784`*^9, 3.402144574918741*^9}, {
   3.4021446846239724`*^9, 3.4021446895459423`*^9}, {3.4021447226559525`*^9, 
   3.402144729593586*^9}, {3.402144860127342*^9, 3.402144926378614*^9}, {
   3.4021449572542067`*^9, 3.402145180727247*^9}, {3.402149153412896*^9, 
   3.4021491595067635`*^9}, {3.4021496964233217`*^9, 3.402149821410097*^9}, {
   3.40214987416111*^9, 3.402149884755063*^9}, {3.4021499394279876`*^9, 
   3.4021499498344374`*^9}, {3.402150065133526*^9, 3.402150121790864*^9}, {
   3.4021501655260787`*^9, 3.4021502014486437`*^9}, {3.402150388827241*^9, 
   3.4021504643911915`*^9}, {3.4021505016731577`*^9, 3.402150539877016*^9}, {
   3.402150576221464*^9, 3.4021506145190744`*^9}, 3.402150646160307*^9, {
   3.4021507013801165`*^9, 3.402150701614496*^9}, {3.402150792022482*^9, 
   3.4021508226011944`*^9}, {3.4022048852154446`*^9, 
   3.4022049314194565`*^9}, {3.402223441649846*^9, 3.4022234739004655`*^9}, {
   3.4022235664178667`*^9, 3.4022235977934694`*^9}, {3.402225770632062*^9, 
   3.4022257810853877`*^9}, {3.4022260066522183`*^9, 
   3.4022260340902452`*^9}, {3.402227989127781*^9, 3.4022280025967894`*^9}, 
   3.4022280710668545`*^9, {3.4022281624279833`*^9, 3.4022281629904943`*^9}, {
   3.4023193135668306`*^9, 3.4023194603141108`*^9}, {3.402319603150462*^9, 
   3.40231966787294*^9}, {3.4023197252970443`*^9, 3.4023197324378977`*^9}, {
   3.4023205583495092`*^9, 3.4023206749454975`*^9}, {3.4023207399779963`*^9, 
   3.4023207413373976`*^9}, {3.4023208249015017`*^9, 
   3.4023209920765867`*^9}, {3.4023211800958214`*^9, 3.40232123755005*^9}, {
   3.4023216909806304`*^9, 3.4023216975588818`*^9}, {3.402321742184738*^9, 
   3.4023217427316236`*^9}, {3.4023247260232773`*^9, 
   3.4023248331659594`*^9}, {3.4023253919266872`*^9, 
   3.4023255075695324`*^9}, {3.40237831846457*^9, 3.4023783246678143`*^9}, {
   3.4041932487247953`*^9, 3.4041932623344316`*^9}, {3.40419333647648*^9, 
   3.4041933710083933`*^9}, {3.4041937125305753`*^9, 3.404193749953169*^9}, {
   3.4043002135695343`*^9, 3.4043002231947346`*^9}, {3.4044649846669784`*^9, 
   3.4044650123383217`*^9}, {3.4044650477751417`*^9, 
   3.4044651238049316`*^9}, {3.404465582921117*^9, 3.4044656190610476`*^9}, {
   3.4044656599352627`*^9, 3.4044656716225386`*^9}, {3.4044670806423597`*^9, 
   3.404467083939172*^9}, {3.4044685611608086`*^9, 3.4044685642701235`*^9}, {
   3.4044686800022764`*^9, 3.4044687901564116`*^9}, {3.4044707796025887`*^9, 
   3.4044707807275667`*^9}, 3.404652171754368*^9, {3.4046522684124737`*^9, 
   3.404652301397482*^9}, 3.4048112137223434`*^9, {3.4048113224921446`*^9, 
   3.4048113889321957`*^9}, 3.404826533466849*^9, {3.404826732521367*^9, 
   3.404826749568897*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SmileSymetrizedBiHestonVanillaIntegrand2", "[", 
   RowBox[{
   "Y_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "a_", ",", "b_", ",", 
    "KList_", ",", "\[Tau]_", ",", "\[CapitalSigma]_", ",", "M_", ",", "Q_", 
    ",", "\[Rho]_", ",", "\[Mu]_", ",", "\[Beta]m_", ",", "\[Lambda]1_", ",", 
    "\[Lambda]2_", ",", "\[Omega]1_", ",", "\[Omega]2_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x1", "=", 
       RowBox[{"Y", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", 
      RowBox[{"x2", "=", 
       RowBox[{"Y", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ",", 
      RowBox[{"k1", "=", 
       RowBox[{"(", 
        RowBox[{"\[Omega]1", "+", 
         RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1"}]}], ")"}]}], ",", 
      RowBox[{"Sk1", "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "\[Omega]1"}], "+", 
         RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1"}]}], ")"}]}], ",", 
      RowBox[{"k2", "=", " ", 
       RowBox[{"(", 
        RowBox[{"\[Omega]2", "+", 
         RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2"}]}], ")"}]}], ",", 
      RowBox[{"Sk2", "=", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "\[Omega]2"}], "+", 
         RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2"}]}], ")"}]}], ",", 
      RowBox[{"Sk1A", "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "\[Omega]1"}], "+", 
         RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1"}]}], ")"}]}], ",", 
      RowBox[{"k1A", "=", 
       RowBox[{"(", 
        RowBox[{"\[Omega]1", "-", 
         RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1"}]}], ")"}]}], ",", 
      RowBox[{"k2A", "=", 
       RowBox[{"(", 
        RowBox[{"\[Omega]2", "-", 
         RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2"}]}], ")"}]}], ",", 
      "\[Alpha]", ",", "\[Alpha]A", ",", "Sym\[Alpha]", ",", "Sym\[Alpha]A", 
      ",", "\[Alpha]2", ",", "\[Alpha]A2", ",", "Sym\[Alpha]2", ",", 
      "Sym\[Alpha]A2", ",", "propagatorDroit", ",", "SympropagatorDroit", ",",
       "propagatorGauche", ",", "SympropagatorGauche", ",", 
      "propagatorDroit2", ",", "SympropagatorDroit2", ",", 
      "propagatorGauche2", ",", "SympropagatorGauche2"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Re", "[", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"KList", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "\[GreaterEqual]", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Alpha]", "=", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", "x1", " ", "k1"}], "-", 
           RowBox[{"\[ImaginaryI]", " ", "x2", " ", "k2"}]}]]}], ";", 
        RowBox[{"\[Alpha]A", "=", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", "x1", " ", "k1"}], "-", 
           RowBox[{"\[ImaginaryI]", " ", "x2", " ", "k2A"}]}]]}], ";", 
        RowBox[{"Sym\[Alpha]", "=", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", "x1", " ", "Sk1"}], "-", 
           RowBox[{"\[ImaginaryI]", " ", "x2", " ", "k2"}]}]]}], ";", 
        RowBox[{"Sym\[Alpha]A", "=", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", "x1", " ", "Sk1A"}], "-", 
           RowBox[{"\[ImaginaryI]", " ", "x2", " ", "k2A"}]}]]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"propagatorDroit", "=", 
         RowBox[{"BiHestonLaplaceQuickTransform2", "[", 
          RowBox[{
          "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", " ", 
           "\[CapitalSigma]", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "\[ImaginaryI]"}], " ", "k1"}], ",", 
             RowBox[{
              RowBox[{"-", "\[ImaginaryI]"}], " ", "k2"}]}], "}"}], ",", 
           "\[Beta]m", ",", "\[Tau]"}], "]"}]}], ";", 
        RowBox[{"SympropagatorDroit", "=", 
         RowBox[{"BiHestonLaplaceQuickTransform2", "[", 
          RowBox[{
          "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", " ", 
           "\[CapitalSigma]", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "\[ImaginaryI]"}], " ", "Sk1"}], ",", 
             RowBox[{
              RowBox[{"-", "\[ImaginaryI]"}], " ", "k2"}]}], "}"}], ",", 
           "\[Beta]m", ",", "\[Tau]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"propagatorGauche", "=", 
         RowBox[{"BiHestonLaplaceQuickTransform2", "[", 
          RowBox[{
          "M", ",", "Q", ",", "\[Rho]", ",", " ", "\[Mu]", ",", 
           "\[CapitalSigma]", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "\[ImaginaryI]"}], " ", "k1"}], ",", 
             RowBox[{
              RowBox[{"-", "\[ImaginaryI]"}], " ", "k2A"}]}], "}"}], ",", 
           "\[Beta]m", ",", "\[Tau]"}], "]"}]}], ";", 
        RowBox[{"SympropagatorGauche", "=", 
         RowBox[{"BiHestonLaplaceQuickTransform2", "[", 
          RowBox[{
          "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", " ", 
           "\[CapitalSigma]", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "\[ImaginaryI]"}], " ", "Sk1A"}], ",", 
             RowBox[{
              RowBox[{"-", "\[ImaginaryI]"}], " ", "k2A"}]}], "}"}], ",", 
           "\[Beta]m", ",", "\[Tau]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"KList", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ">", "0"}], ",", 
            RowBox[{
             RowBox[{"\[Alpha]", " ", "propagatorDroit", " ", 
              RowBox[{"VanillaPayOffFourierDroite", "[", 
               RowBox[{"k1", ",", "k2", ",", 
                RowBox[{"KList", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", "\[Alpha]1", ",", 
                "\[Beta]1", ",", "a", ",", "b"}], "]"}]}], "+", 
             "\[IndentingNewLine]", 
             RowBox[{"Sym\[Alpha]", " ", "SympropagatorDroit", " ", 
              RowBox[{"VanillaPayOffFourierDroite", "[", 
               RowBox[{"Sk1", ",", "k2", ",", 
                RowBox[{"KList", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", "\[Alpha]1", ",", 
                "\[Beta]1", ",", "a", ",", "b"}], "]"}]}], "+", 
             "\[IndentingNewLine]", 
             RowBox[{"\[Alpha]A", " ", "propagatorGauche", " ", 
              RowBox[{"VanillaPayOffFourierGauche", "[", 
               RowBox[{"k1", ",", "k2A", ",", 
                RowBox[{"KList", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", "\[Alpha]1", ",", 
                "\[Beta]1", ",", "a", ",", "b"}], "]"}]}], "+", 
             "\[IndentingNewLine]", 
             RowBox[{"Sym\[Alpha]A", " ", "SympropagatorGauche", " ", 
              RowBox[{"VanillaPayOffFourierGauche", "[", 
               RowBox[{"Sk1A", ",", "k2A", ",", 
                RowBox[{"KList", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", "\[Alpha]1", ",", 
                "\[Beta]1", ",", "a", ",", "b"}], "]"}]}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"\[Alpha]", " ", "propagatorDroit", " ", 
              RowBox[{"VanillaPayOffFourierDroite", "[", 
               RowBox[{
               "k1", ",", "k2", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", 
                ",", "b"}], "]"}]}], "+", "\[IndentingNewLine]", 
             RowBox[{"Sym\[Alpha]", " ", "SympropagatorDroit", " ", 
              RowBox[{"VanillaPayOffFourierDroite", "[", 
               RowBox[{
               "Sk1", ",", "k2", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", 
                ",", "b"}], "]"}]}], "+", "\[IndentingNewLine]", 
             RowBox[{"\[Alpha]A", " ", "propagatorGauche", " ", 
              RowBox[{"VanillaPayOffFourierGauche", "[", 
               RowBox[{
               "k1", ",", "k2A", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", 
                ",", "b"}], "]"}]}], "+", "\[IndentingNewLine]", 
             RowBox[{"Sym\[Alpha]A", " ", "SympropagatorGauche", " ", 
              RowBox[{"VanillaPayOffFourierGauche", "[", 
               RowBox[{
               "Sk1", ",", "k2A", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a",
                 ",", "b"}], "]"}]}]}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "KList", "]"}]}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Alpha]2", "=", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", "x2", " ", "k1"}], "-", 
           RowBox[{"\[ImaginaryI]", " ", "x1", " ", "k2"}]}]]}], ";", 
        RowBox[{"\[Alpha]A2", "=", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", "x2", " ", "k1"}], "-", 
           RowBox[{"\[ImaginaryI]", " ", "x1", " ", "k2A"}]}]]}], ";", 
        RowBox[{"Sym\[Alpha]2", "=", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", "x2", " ", "Sk1"}], "-", 
           RowBox[{"\[ImaginaryI]", " ", "x1", " ", "k2"}]}]]}], ";", 
        RowBox[{"Sym\[Alpha]A2", "=", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", "x2", " ", "Sk1A"}], "-", 
           RowBox[{"\[ImaginaryI]", " ", "x1", " ", "k2A"}]}]]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"propagatorDroit2", "=", 
         RowBox[{"BiHestonLaplaceQuickTransformReverse2", "[", 
          RowBox[{
          "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", " ", 
           "\[CapitalSigma]", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "\[ImaginaryI]"}], " ", "k1"}], ",", 
             RowBox[{
              RowBox[{"-", "\[ImaginaryI]"}], " ", "k2"}]}], "}"}], ",", 
           "\[Beta]m", ",", "\[Tau]"}], "]"}]}], ";", 
        RowBox[{"SympropagatorDroit2", "=", 
         RowBox[{"BiHestonLaplaceQuickTransformReverse2", "[", 
          RowBox[{
          "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", " ", 
           "\[CapitalSigma]", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "\[ImaginaryI]"}], " ", "Sk1"}], ",", 
             RowBox[{
              RowBox[{"-", "\[ImaginaryI]"}], " ", "k2"}]}], "}"}], ",", 
           "\[Beta]m", ",", "\[Tau]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"propagatorGauche2", "=", 
         RowBox[{"BiHestonLaplaceQuickTransformReverse2", "[", 
          RowBox[{
          "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", " ", 
           "\[CapitalSigma]", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "\[ImaginaryI]"}], " ", "k1"}], ",", 
             RowBox[{
              RowBox[{"-", "\[ImaginaryI]"}], " ", "k2A"}]}], "}"}], ",", 
           "\[Beta]m", ",", "\[Tau]"}], "]"}]}], ";", 
        RowBox[{"SympropagatorGauche2", "=", 
         RowBox[{"BiHestonLaplaceQuickTransformReverse2", "[", 
          RowBox[{
          "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", " ", 
           "\[CapitalSigma]", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "\[ImaginaryI]"}], " ", "Sk1A"}], ",", 
             RowBox[{
              RowBox[{"-", "\[ImaginaryI]"}], " ", "k2A"}]}], "}"}], ",", 
           "\[Beta]m", ",", "\[Tau]"}], "]"}]}], ";", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[Alpha]2", " ", 
              RowBox[{"(", 
               RowBox[{"propagatorDroit2", " ", 
                RowBox[{"(", 
                 RowBox[{"VanillaPayOffFourierDroite", "[", 
                  RowBox[{"k1", ",", "k2", ",", 
                   RowBox[{"-", 
                    RowBox[{"KList", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], ",", "\[Alpha]1", ",", 
                   "\[Beta]1", ",", "a", ",", "b"}], "]"}], ")"}]}], ")"}]}], 
             "+", 
             RowBox[{"Sym\[Alpha]2", " ", 
              RowBox[{"(", 
               RowBox[{"SympropagatorDroit2", 
                RowBox[{"(", 
                 RowBox[{"VanillaPayOffFourierDroite", "[", 
                  RowBox[{"Sk1", ",", "k2", ",", 
                   RowBox[{"-", 
                    RowBox[{"KList", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], ",", "\[Alpha]1", ",", 
                   "\[Beta]1", ",", "a", ",", "b"}], "]"}], ")"}]}], 
               ")"}]}]}], ")"}], " ", "+", "\[IndentingNewLine]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[Alpha]A2", " ", "propagatorGauche2", 
              RowBox[{"(", " ", 
               RowBox[{"VanillaPayOffFourierGauche", "[", 
                RowBox[{"k1", ",", "k2A", ",", 
                 RowBox[{"-", 
                  RowBox[{"KList", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], ",", "\[Alpha]1", ",", 
                 "\[Beta]1", ",", "a", ",", "b"}], "]"}], ")"}]}], "+", 
             RowBox[{"Sym\[Alpha]A2", " ", "SympropagatorGauche2", 
              RowBox[{"(", 
               RowBox[{"VanillaPayOffFourierGauche", "[", 
                RowBox[{"Sk1A", ",", "k2A", ",", 
                 RowBox[{"-", 
                  RowBox[{"KList", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], ",", "\[Alpha]1", ",", 
                 "\[Beta]1", ",", "a", ",", "b"}], "]"}], ")"}]}]}], ")"}]}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "KList", "]"}]}], "}"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.402140085770051*^9, 3.4021400863013115`*^9}, {
   3.4021401238489075`*^9, 3.4021402363666925`*^9}, {3.402140267929798*^9, 
   3.402140316290102*^9}, {3.4021403621347322`*^9, 3.4021403798069468`*^9}, {
   3.402140442948784*^9, 3.4021404698243*^9}, {3.40214052530974*^9, 
   3.4021405261847568`*^9}, {3.402140572076263*^9, 3.4021405730294065`*^9}, {
   3.40214283290092*^9, 3.402142834900958*^9}, 3.402142878995555*^9, {
   3.4021429531532288`*^9, 3.40214297455989*^9}, {3.4021430512488623`*^9, 
   3.4021430865307894`*^9}, {3.402143143625636*^9, 3.4021431463288126`*^9}, {
   3.402143222267771*^9, 3.402143365629898*^9}, {3.4021439797510643`*^9, 
   3.4021440141579747`*^9}, {3.4021444783543873`*^9, 
   3.4021445164332433`*^9}, {3.4021445469025784`*^9, 3.402144574918741*^9}, {
   3.4021446846239724`*^9, 3.4021446895459423`*^9}, {3.4021447226559525`*^9, 
   3.402144729593586*^9}, {3.402144860127342*^9, 3.402144926378614*^9}, {
   3.4021449572542067`*^9, 3.402145180727247*^9}, {3.402149153412896*^9, 
   3.4021491595067635`*^9}, {3.4021496964233217`*^9, 3.402149821410097*^9}, {
   3.40214987416111*^9, 3.402149884755063*^9}, {3.4021499394279876`*^9, 
   3.4021499498344374`*^9}, {3.402150065133526*^9, 3.402150121790864*^9}, {
   3.4021501655260787`*^9, 3.4021502014486437`*^9}, {3.402150388827241*^9, 
   3.4021504643911915`*^9}, {3.4021505016731577`*^9, 3.402150539877016*^9}, {
   3.402150576221464*^9, 3.4021506145190744`*^9}, 3.402150646160307*^9, {
   3.4021507013801165`*^9, 3.402150701614496*^9}, {3.402150792022482*^9, 
   3.4021508226011944`*^9}, {3.4022048852154446`*^9, 
   3.4022049314194565`*^9}, {3.402223441649846*^9, 3.4022234739004655`*^9}, {
   3.4022235664178667`*^9, 3.4022235977934694`*^9}, {3.402225770632062*^9, 
   3.4022257810853877`*^9}, {3.4022260066522183`*^9, 
   3.4022260340902452`*^9}, {3.402227989127781*^9, 3.4022280025967894`*^9}, 
   3.4022280710668545`*^9, {3.4022281624279833`*^9, 3.4022281629904943`*^9}, {
   3.4023193135668306`*^9, 3.4023194603141108`*^9}, {3.402319603150462*^9, 
   3.40231966787294*^9}, {3.4023197252970443`*^9, 3.4023197324378977`*^9}, {
   3.4023205583495092`*^9, 3.4023206749454975`*^9}, {3.4023207399779963`*^9, 
   3.4023207413373976`*^9}, {3.4023208249015017`*^9, 
   3.4023209920765867`*^9}, {3.4023211800958214`*^9, 3.40232123755005*^9}, {
   3.4023216909806304`*^9, 3.4023216975588818`*^9}, {3.402321742184738*^9, 
   3.4023217427316236`*^9}, {3.4023247260232773`*^9, 
   3.4023248331659594`*^9}, {3.4023253919266872`*^9, 
   3.4023255075695324`*^9}, {3.40237831846457*^9, 3.4023783246678143`*^9}, {
   3.4041932487247953`*^9, 3.4041932623344316`*^9}, {3.40419333647648*^9, 
   3.4041933710083933`*^9}, {3.4041937125305753`*^9, 3.404193749953169*^9}, 
   3.4042166550179377`*^9, {3.4042167133471823`*^9, 3.4042167289099813`*^9}, {
   3.404217748663935*^9, 3.404217760742292*^9}, {3.404300251181134*^9, 
   3.4043002603695345`*^9}, {3.4043244217933435`*^9, 
   3.4043244467845435`*^9}, {3.4044649983073416`*^9, 
   3.4044650230724907`*^9}, {3.404465179788232*^9, 3.4044652053658657`*^9}, {
   3.4044653166918535`*^9, 3.404465319879292*^9}, {3.4044653543786297`*^9, 
   3.4044654165493107`*^9}, {3.4044656786536536`*^9, 
   3.4044656885128393`*^9}, {3.4044696058595*^9, 3.404469683545508*^9}, 
   3.40447080164904*^9, {3.404652175676318*^9, 3.404652253318434*^9}, 
   3.4048112174256105`*^9, {3.404811400932657*^9, 3.40481144620002*^9}, {
   3.404826519513188*^9, 3.4048265216382694`*^9}, {3.4048267548972263`*^9, 
   3.4048267654445066`*^9}, {3.405952660006446*^9, 3.4059527236951685`*^9}, {
   3.4059527558207855`*^9, 3.405953010653803*^9}, {3.405953108061923*^9, 
   3.4059531118901215`*^9}, {3.4059531974230137`*^9, 3.4059532056731725`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Fourier Transform of the payoff", "Subsubtitle",
 CellChangeTimes->{{3.4047174737434516`*^9, 3.404717491805258*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"VanillaPayOffFourierDroite", "[", 
   RowBox[{
   "k1_", ",", "k2_", ",", "\[Alpha]_", ",", "\[Beta]_", ",", "a_", ",", 
    "b_"}], "]"}], ":=", 
  FractionBox[
   RowBox[{
    RowBox[{"-", 
     SuperscriptBox["a", "2"]}], " ", "\[Beta]", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox["\[Beta]", "\[Alpha]"], ")"}], 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[ImaginaryI]", " ", "a"}], "-", "k1"}], ")"}], " ", "k1", " ",
     
    RowBox[{"(", 
     RowBox[{
      RowBox[{"a", " ", "b"}], "+", 
      RowBox[{"\[ImaginaryI]", " ", "b", " ", "k1"}], "+", 
      RowBox[{"\[ImaginaryI]", " ", "a", " ", "k2"}]}], ")"}]}]]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4048110341685734`*^9, 3.404811051528615*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"VanillaPayOffFourierGauche", "[", 
   RowBox[{
   "k1_", ",", "k2_", ",", "\[Alpha]_", ",", "\[Beta]_", ",", "a_", ",", 
    "b_"}], "]"}], ":=", 
  FractionBox[
   RowBox[{
    SuperscriptBox["a", "2"], " ", "\[Beta]", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox["\[Beta]", "\[Alpha]"], ")"}], 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[ImaginaryI]", " ", "a"}], "-", "k1"}], ")"}], " ", "k1", " ",
     
    RowBox[{"(", 
     RowBox[{
      RowBox[{"a", " ", "b"}], "+", 
      RowBox[{"\[ImaginaryI]", " ", "b", " ", "k1"}], "+", 
      RowBox[{"\[ImaginaryI]", " ", "a", " ", "k2"}]}], ")"}]}]]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.404810900350935*^9, 3.404810912070135*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"VanillaPayOffFourierDroite", "[", 
   RowBox[{
   "k1_", ",", "k2_", ",", "K_", ",", "\[Alpha]_", ",", "\[Beta]_", ",", "a_",
     ",", "b_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"q", ",", 
      RowBox[{"A", "=", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"q", "=", 
      RowBox[{"A", "+", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}]}], ";", 
     RowBox[{
      FractionBox[
       RowBox[{"\[ImaginaryI]", "    ", 
        SuperscriptBox[
         RowBox[{"(", 
          FractionBox["\[Beta]", "\[Alpha]"], ")"}], "A"], " "}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", "A"}], ")"}], " ", "k1", " ", "b"}]], " ", 
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{"\[Beta]", " ", 
         RowBox[{"(", 
          FractionBox[
           RowBox[{"Hypergeometric2F1", "[", 
            RowBox[{
             RowBox[{"-", "A"}], ",", 
             RowBox[{
              RowBox[{"-", "1"}], "-", "q"}], ",", 
             RowBox[{"-", "q"}], ",", 
             RowBox[{"-", 
              FractionBox[
               RowBox[{" ", "K"}], "\[Beta]"]}]}], "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "+", "q"}], ")"}]], ")"}]}], "+", 
        RowBox[{"K", "  ", 
         RowBox[{"(", 
          FractionBox[
           RowBox[{"  ", 
            RowBox[{"Hypergeometric2F1", "[", 
             RowBox[{
              RowBox[{"-", "A"}], ",", 
              RowBox[{"-", "q"}], ",", 
              RowBox[{"1", "-", "q"}], ",", 
              RowBox[{"-", 
               FractionBox[
                RowBox[{" ", "K"}], "\[Beta]"]}]}], "]"}]}], 
           RowBox[{"(", "q", ")"}]], ")"}]}]}], ")"}]}]}]}], "]"}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.4048102845616646`*^9, 3.404810294702679*^9}, {
  3.4048103293758855`*^9, 3.404810338454359*^9}, {3.404810451536826*^9, 
  3.404810619137012*^9}, {3.40481068953034*^9, 3.404810710187383*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"VanillaPayOffFourierGauche", "[", 
   RowBox[{
   "k1_", ",", "k2_", ",", "K_", ",", "\[Alpha]_", ",", "\[Beta]_", ",", "a_",
     ",", "b_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"H", ",", 
      RowBox[{"q", "=", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ",", 
      RowBox[{"m", "=", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}], ",", "g1", ",", "g2", 
      ",", 
      RowBox[{"Kp", "=", 
       FractionBox["K", "\[Beta]"]}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"H", "=", 
      FractionBox[
       RowBox[{" ", 
        RowBox[{
         RowBox[{"Gamma", "[", 
          RowBox[{
           RowBox[{"-", "1"}], "-", "m", "-", "q"}], "]"}], " ", 
         RowBox[{"Gamma", "[", 
          RowBox[{"1", "+", "q"}], "]"}]}]}], 
       RowBox[{"Gamma", "[", 
        RowBox[{"-", "m"}], "]"}]]}], ";", 
     RowBox[{"g1", "=", 
      SuperscriptBox[
       RowBox[{"(", "Kp", ")"}], "q"]}], ";", 
     RowBox[{"g2", "=", 
      SuperscriptBox[
       RowBox[{"(", "Kp", ")"}], 
       RowBox[{"-", "m"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", 
        RowBox[{"b", 
         RowBox[{"(", 
          RowBox[{"1", "+", "m"}], ")"}], " ", "k1", " ", "k2", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "q"}], ")"}]}]]}], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["K", "\[Alpha]"], ")"}], "m"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"k2", " ", "\[Beta]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Kp", " ", "g1", " ", "H", 
            RowBox[{"(", 
             RowBox[{"1", "+", "q"}], ")"}]}], "+", 
           FractionBox[
            RowBox[{"g2", 
             RowBox[{"(", 
              RowBox[{"1", "+", "q"}], ")"}], "  ", 
             RowBox[{"Hypergeometric2F1", "[", 
              RowBox[{
               RowBox[{"-", "m"}], ",", 
               RowBox[{
                RowBox[{"-", "1"}], "-", "m", "-", "q"}], ",", 
               RowBox[{
                RowBox[{"-", "m"}], "-", "q"}], ",", 
               RowBox[{"-", "Kp"}]}], "]"}]}], 
            RowBox[{"(", 
             RowBox[{"1", "+", "m", "+", "q"}], ")"}]]}], ")"}]}], "+", 
        RowBox[{"K", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", "b"}], "+", "k2"}], ")"}], 
         " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"g1", "  ", "H", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "-", "m", "-", "q"}], ")"}]}], " ", "+", 
           FractionBox[
            RowBox[{"g2", " ", "q", " ", 
             RowBox[{"Hypergeometric2F1", "[", 
              RowBox[{
               RowBox[{"-", "m"}], ",", 
               RowBox[{
                RowBox[{"-", "m"}], "-", "q"}], ",", 
               RowBox[{"1", "-", "m", "-", "q"}], ",", 
               RowBox[{"-", "Kp"}]}], "]"}]}], 
            RowBox[{"(", 
             RowBox[{"m", "+", "q"}], ")"}]]}], ")"}]}]}], ")"}]}]}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.404809293461108*^9, 3.4048092956643176`*^9}, 
   3.4048093674014473`*^9, {3.4048094552954473`*^9, 3.404809463092622*^9}, {
   3.4048095314233704`*^9, 3.4048095442363625`*^9}, {3.404809605191828*^9, 
   3.4048096283333416`*^9}, {3.404809817199969*^9, 3.4048098448885317`*^9}, {
   3.4048099035782857`*^9, 3.4048099656900454`*^9}, {3.4048100079572935`*^9, 
   3.4048100840852165`*^9}, {3.4070797953743267`*^9, 3.407080005362733*^9}, {
   3.4070800416915555`*^9, 3.4070800700827255`*^9}, 3.407080120786824*^9, {
   3.407080235882784*^9, 3.4070802462111073`*^9}, {3.4070802767898197`*^9, 
   3.407080285993121*^9}, {3.4070803286970663`*^9, 3.4070803539631763`*^9}, {
   3.4070803839793777`*^9, 3.407080401979723*^9}, {3.407080471543559*^9, 
   3.407080489934537*^9}, {3.4070805601702604`*^9, 3.407080624062112*^9}, 
   3.407080680938204*^9, 3.407082269734333*^9}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Option Vanille Partielle 1 ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[Alpha]", " ", 
       SuperscriptBox[
        SubscriptBox["S", "1"], "a"]}], "-", "K"}], ")"}], "+"], 
   TraditionalForm]]]
}], "Subtitle",
 CellChangeTimes->{{3.399795779284771*^9, 3.3997957832385283`*^9}, {
  3.4039536500202045`*^9, 3.403953704380624*^9}, {3.4046308201367836`*^9, 
  3.404630821074253*^9}, {3.405009252968748*^9, 3.4050092705967484`*^9}, {
  3.4059398023689585`*^9, 3.4059398053690166`*^9}}],

Cell["Handling", "Text",
 CellChangeTimes->{{3.4059584675710735`*^9, 3.405958469274232*^9}}],

Cell[CellGroupData[{

Cell["High Level interface", "Subsubtitle",
 CellChangeTimes->{{3.404642425693043*^9, 3.404642434083829*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SmileBiHestonUnderlying1Vanilla", "[", 
   RowBox[{
   "S_", ",", "\[Alpha]1_", ",", "a_", ",", "KList1_", ",", "\[Tau]_", ",", 
    "\[CapitalSigma]_", ",", "M_", ",", "\[CapitalSigma]inf_", ",", 
    "\[Beta]_", ",", "\[Rho]_", ",", "\[Mu]_", ",", "printflag_"}], "]"}], ":=",
   
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "KList", ",", "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", 
      ",", "period1n", ",", "\[Epsilon]1", ",", "LegendreCoef2", ",", 
      "period2", ",", "period2n", ",", "\[Epsilon]2", ",", "imax", ",", 
      "\[Lambda]1", ",", "\[Lambda]2", ",", "Q", ",", "prices", ",", 
      "startmonitortime", ",", "plafondexplosion", ",", "initialTailFlag", 
      ",", "InitialTailPosition", ",", "InitialTailPosition2", ",", "kmax", 
      ",", "StartControl", ",", "IncrementFactor"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "KList1", "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{"KList", "=", 
        RowBox[{"{", "KList1", "}"}]}], ",", 
       RowBox[{"KList", "=", "KList1"}]}], "]"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"Q", "=", 
      RowBox[{
       RowBox[{"CholeskyDecomposition", "[", 
        RowBox[{"-", 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"M", ".", "\[CapitalSigma]inf"}], "+", 
            RowBox[{"\[CapitalSigma]inf", ".", " ", 
             RowBox[{"Transpose", "[", "M", "]"}]}]}], "2"], ")"}]}], "]"}], 
       "/", "\[Beta]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", ",", 
          "period1n", ",", "\[Epsilon]1", ",", "startmonitortime", ",", 
          "plafondexplosion", ",", "initialTailFlag", ",", 
          "InitialTailPosition", ",", "InitialTailPosition2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "LegendreCoef2", ",", "period2", ",", "period2n", ",", "\[Epsilon]2",
           ",", "kmax", ",", "StartControl", ",", "IncrementFactor"}], "}"}], 
        ",", "imax", ",", "\[Lambda]1", ",", "\[Lambda]2"}], "}"}], "=", 
      RowBox[{"BiHestonVanillaOptimalParameters", "[", 
       RowBox[{"S", ",", "\[Alpha]1", ",", "1", ",", "a", ",", "1", ",", 
        RowBox[{"KList", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "\[Tau]", ",", 
        "\[CapitalSigma]", ",", "M", ",", "\[CapitalSigma]inf", ",", "Q", ",",
         "\[Rho]", ",", "\[Mu]", ",", "\"\<Underlying1Option\>\"", ",", 
        "printflag"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"prices", "=", 
      RowBox[{"SmileBiHestonUnderlying1Vanilla", "[", 
       RowBox[{
       "S", ",", "\[Alpha]1", ",", "a", ",", "KList", ",", "\[Tau]", ",", 
        "\[CapitalSigma]", ",", "M", ",", "\[CapitalSigma]inf", ",", "Q", ",",
         "\[Rho]", ",", "\[Mu]", ",", "\[Beta]", ",", "\[Lambda]1", ",", 
        "\[Lambda]2", ",", 
        RowBox[{"{", 
         RowBox[{
         "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", ",", 
          "period1n", ",", "\[Epsilon]1", ",", "imax", ",", 
          "startmonitortime", ",", "plafondexplosion", ",", "initialTailFlag",
           ",", "InitialTailPosition", ",", "InitialTailPosition2"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{
         "LegendreCoef2", ",", "period2", ",", "period2n", ",", "\[Epsilon]2",
           ",", "kmax", ",", "StartControl", ",", "IncrementFactor"}], "}"}], 
        ",", "printflag"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Alpha]1", " ", 
           SuperscriptBox[
            RowBox[{"S", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "a"]}], "-", 
          RowBox[{"KList1", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ",", "0", ",", 
         RowBox[{"prices", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "KList1", "]"}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4042074577632284`*^9, 3.4042074770760994`*^9}, {
   3.4042075328115444`*^9, 3.4042077538626633`*^9}, {3.404207970241818*^9, 
   3.404207993351637*^9}, {3.4042080286491895`*^9, 3.404208043665103*^9}, {
   3.4042173037335176`*^9, 3.4042173873444977`*^9}, {3.4042175109093704`*^9, 
   3.404217554472707*^9}, {3.4042999349691343`*^9, 3.4042999555923347`*^9}, 
   3.404325362832144*^9, 3.4043253935953436`*^9, {3.4043813496393437`*^9, 
   3.4043813704653435`*^9}, {3.404456304258438*^9, 3.404456370334422*^9}, {
   3.4046498109902925`*^9, 3.4046498399752235`*^9}, {3.4046509463870916`*^9, 
   3.404650973731366*^9}, {3.404653049614973*^9, 3.404653081803091*^9}, {
   3.404826792070529*^9, 3.404826795492535*^9}, {3.4048268941525736`*^9, 
   3.4048268964651623`*^9}, {3.404838629255556*^9, 3.404838644381137*^9}, {
   3.405003582974747*^9, 3.4050035922723475`*^9}, {3.4050918622706738`*^9, 
   3.4050918685833354`*^9}, 3.405092260780875*^9, {3.405101581745773*^9, 
   3.405101582151373*^9}, {3.4056655211663103`*^9, 3.405665556010729*^9}, 
   3.405666387761073*^9, {3.4064717507017865`*^9, 3.406471774030509*^9}, {
   3.4065574041884317`*^9, 3.4065574100948334`*^9}, {3.406612729124117*^9, 
   3.40661273960876*^9}, {3.406960257359646*^9, 3.4069602629847536`*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "utilise", " ", "une", " ", "matrice", " ", "complete", "  ", "comme", " ", 
   "vol", " ", "de", " ", "vol"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.4043007956367345`*^9, 3.4043008208619347`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SmileBiHestonUnderlying1Vanilla2", "[", 
   RowBox[{
   "S_", ",", "\[Alpha]1_", ",", "a_", ",", "KList1_", ",", "\[Tau]_", ",", 
    "\[CapitalSigma]_", ",", "M_", ",", "\[CapitalSigma]inf_", ",", "Q_", ",",
     "\[Rho]_", ",", "\[Mu]_", ",", "printflag_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "KList", ",", "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", 
      ",", "period1n", ",", "\[Epsilon]1", ",", "LegendreCoef2", ",", 
      "period2", ",", "period2n", ",", "\[Epsilon]2", ",", "imax", ",", 
      "\[Lambda]1", ",", "\[Lambda]2", ",", "\[Beta]m", ",", "prices", ",", 
      "startmonitortime", ",", "plafondexplosion", ",", "initialTailFlag", 
      ",", "InitialTailPosition", ",", "InitialTailPosition2", ",", "kmax", 
      ",", "StartControl", ",", "IncrementFactor"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "KList1", "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{"KList", "=", 
        RowBox[{"{", "KList1", "}"}]}], ",", 
       RowBox[{"KList", "=", "KList1"}]}], "]"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", ",", 
          "period1n", ",", "\[Epsilon]1", ",", "startmonitortime", ",", 
          "plafondexplosion", ",", "initialTailFlag", ",", 
          "InitialTailPosition", ",", "InitialTailPosition2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "LegendreCoef2", ",", "period2", ",", "period2n", ",", "\[Epsilon]2",
           ",", "kmax", ",", "StartControl", ",", "IncrementFactor"}], "}"}], 
        ",", "imax", ",", "\[Lambda]1", ",", "\[Lambda]2"}], "}"}], "=", 
      RowBox[{"BiHestonVanillaOptimalParameters", "[", 
       RowBox[{"S", ",", "\[Alpha]1", ",", "1", ",", "a", ",", "1", ",", 
        RowBox[{"KList", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "\[Tau]", ",", 
        "\[CapitalSigma]", ",", "M", ",", "\[CapitalSigma]inf", ",", "Q", ",",
         "\[Rho]", ",", "\[Mu]", ",", "\"\<Underlying1Option\>\"", ",", 
        "printflag"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Beta]m", "=", 
      RowBox[{"-", 
       RowBox[{
        RowBox[{"(", 
         FractionBox[
          RowBox[{
           RowBox[{"M", ".", "\[CapitalSigma]inf"}], "+", 
           RowBox[{"\[CapitalSigma]inf", ".", 
            RowBox[{"Transpose", "[", "M", "]"}]}]}], "2"], ")"}], ".", 
        RowBox[{"Inverse", "[", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Transpose", "[", "Q", "]"}], ".", "Q"}], ")"}], 
         "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"prices", "=", 
      RowBox[{"SmileBiHestonUnderlying1Vanilla2", "[", 
       RowBox[{
       "S", ",", "\[Alpha]1", ",", "a", ",", "KList", ",", "\[Tau]", ",", 
        "\[CapitalSigma]", ",", "M", ",", "\[CapitalSigma]inf", ",", "Q", ",",
         "\[Rho]", ",", "\[Mu]", ",", "\[Beta]m", ",", "\[Lambda]1", ",", 
        "\[Lambda]2", ",", 
        RowBox[{"{", 
         RowBox[{
         "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", ",", 
          "period1n", ",", "\[Epsilon]1", ",", "imax", ",", 
          "startmonitortime", ",", "plafondexplosion", ",", "initialTailFlag",
           ",", "InitialTailPosition", ",", "InitialTailPosition2"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{
         "LegendreCoef2", ",", "period2", ",", "period2n", ",", "\[Epsilon]2",
           ",", "kmax", ",", "StartControl", ",", "IncrementFactor"}], "}"}], 
        ",", "printflag"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Alpha]1", " ", 
           SuperscriptBox[
            RowBox[{"S", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "a"]}], "-", 
          RowBox[{"KList1", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ",", "0", ",", 
         RowBox[{"prices", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "KList1", "]"}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4042074577632284`*^9, 3.4042074770760994`*^9}, {
   3.4042075328115444`*^9, 3.4042077538626633`*^9}, {3.404207970241818*^9, 
   3.404207993351637*^9}, {3.4042080286491895`*^9, 3.404208043665103*^9}, {
   3.404217016149871*^9, 3.4042170184311647`*^9}, {3.4042174130637417`*^9, 
   3.4042174217982845`*^9}, {3.4042186116648793`*^9, 
   3.4042186161962166`*^9}, {3.4042999781187344`*^9, 
   3.4042999878063345`*^9}, {3.4043245662649436`*^9, 
   3.4043246043289433`*^9}, {3.4043253661237435`*^9, 3.4043253674653435`*^9}, 
   3.4043254021597433`*^9, {3.404381400183344*^9, 3.404381400776144*^9}, {
   3.404455409076337*^9, 3.4044554761121407`*^9}, 3.404649815834135*^9, {
   3.4046498562880373`*^9, 3.404649858959963*^9}, {3.404650954590374*^9, 
   3.4046509658718405`*^9}, {3.4046530547556963`*^9, 3.4046530731623*^9}, 
   3.4048268066804647`*^9, 3.4048269074812107`*^9, {3.404838680148135*^9, 
   3.404838687460916*^9}, {3.4050035469387474`*^9, 3.405003571571147*^9}, {
   3.4050922413272524`*^9, 3.4050922462961297`*^9}, {3.4056655669015627`*^9, 
   3.4056655884019756`*^9}, 3.405666397495635*^9, {3.406471785437051*^9, 
   3.40647179342163*^9}, 3.4064718498762007`*^9, {3.406557413282415*^9, 
   3.4065574180481615`*^9}, {3.406612746124552*^9, 3.4066127591561356`*^9}, {
   3.406960242062477*^9, 3.4069602531720653`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SmileBiHestonUnderlying1Vanilla3", "[", 
   RowBox[{
   "S_", ",", "\[Alpha]1_", ",", "a_", ",", "KList1_", ",", "\[Tau]_", ",", 
    "\[CapitalSigma]_", ",", "M_", ",", "Q_", ",", "\[Beta]_", ",", "\[Rho]_",
     ",", "\[Mu]_", ",", "printflag_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "KList", ",", "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", 
      ",", "period1n", ",", "\[Epsilon]1", ",", "LegendreCoef2", ",", 
      "period2", ",", "period2n", ",", "\[Epsilon]2", ",", "imax", ",", 
      "\[Lambda]1", ",", "\[Lambda]2", ",", "prices", ",", "startmonitortime",
       ",", "plafondexplosion", ",", "initialTailFlag", ",", 
      "InitialTailPosition", ",", "InitialTailPosition2", ",", "kmax", ",", 
      "StartControl", ",", "IncrementFactor", ",", "\[CapitalSigma]inf"}], 
     "}"}], ",", 
    RowBox[{
     RowBox[{"\[CapitalSigma]inf", "=", 
      RowBox[{"SolveSymetricEquation", "[", 
       RowBox[{"M", ",", 
        RowBox[{
         RowBox[{"-", "2"}], 
         SuperscriptBox["\[Beta]", "2"], " ", 
         RowBox[{
          RowBox[{"Transpose", "[", "Q", "]"}], ".", "Q"}]}]}], "]"}]}], " ", 
     ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "KList1", "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{"KList", "=", 
        RowBox[{"{", "KList1", "}"}]}], ",", 
       RowBox[{"KList", "=", "KList1"}]}], "]"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", ",", 
          "period1n", ",", "\[Epsilon]1", ",", "startmonitortime", ",", 
          "plafondexplosion", ",", "initialTailFlag", ",", 
          "InitialTailPosition", ",", "InitialTailPosition2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "LegendreCoef2", ",", "period2", ",", "period2n", ",", "\[Epsilon]2",
           ",", "kmax", ",", "StartControl", ",", "IncrementFactor"}], "}"}], 
        ",", "imax", ",", "\[Lambda]1", ",", "\[Lambda]2"}], "}"}], "=", 
      RowBox[{"BiHestonVanillaOptimalParameters", "[", 
       RowBox[{"S", ",", "\[Alpha]1", ",", "1", ",", "a", ",", "1", ",", 
        RowBox[{"KList", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "\[Tau]", ",", 
        "\[CapitalSigma]", ",", "M", ",", "\[CapitalSigma]inf", ",", "Q", ",",
         "\[Rho]", ",", "\[Mu]", ",", "\"\<Underlying1Option\>\"", ",", 
        "printflag"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"prices", "=", 
      RowBox[{"SmileBiHestonUnderlying1Vanilla", "[", 
       RowBox[{
       "S", ",", "\[Alpha]1", ",", "a", ",", "KList", ",", "\[Tau]", ",", 
        "\[CapitalSigma]", ",", "M", ",", "\[CapitalSigma]inf", ",", "Q", ",",
         "\[Rho]", ",", "\[Mu]", ",", "\[Beta]", ",", "\[Lambda]1", ",", 
        "\[Lambda]2", ",", 
        RowBox[{"{", 
         RowBox[{
         "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", ",", 
          "period1n", ",", "\[Epsilon]1", ",", "imax", ",", 
          "startmonitortime", ",", "plafondexplosion", ",", "initialTailFlag",
           ",", "InitialTailPosition", ",", "InitialTailPosition2"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{
         "LegendreCoef2", ",", "period2", ",", "period2n", ",", "\[Epsilon]2",
           ",", "kmax", ",", "StartControl", ",", "IncrementFactor"}], "}"}], 
        ",", "printflag"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Alpha]1", " ", 
           SuperscriptBox[
            RowBox[{"S", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "a"]}], "-", 
          RowBox[{"KList1", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ",", "0", ",", 
         RowBox[{"prices", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "KList1", "]"}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4042074577632284`*^9, 3.4042074770760994`*^9}, {
   3.4042075328115444`*^9, 3.4042077538626633`*^9}, {3.404207970241818*^9, 
   3.404207993351637*^9}, {3.4042080286491895`*^9, 3.404208043665103*^9}, {
   3.4042173037335176`*^9, 3.4042173873444977`*^9}, {3.4042175109093704`*^9, 
   3.404217554472707*^9}, {3.4042999349691343`*^9, 3.4042999555923347`*^9}, 
   3.404325362832144*^9, 3.4043253935953436`*^9, {3.4043813496393437`*^9, 
   3.4043813704653435`*^9}, {3.404456304258438*^9, 3.404456370334422*^9}, {
   3.4046498109902925`*^9, 3.4046498399752235`*^9}, {3.4046509463870916`*^9, 
   3.404650973731366*^9}, {3.404653049614973*^9, 3.404653081803091*^9}, {
   3.404826792070529*^9, 3.404826795492535*^9}, {3.4048268941525736`*^9, 
   3.4048268964651623`*^9}, {3.404838629255556*^9, 3.404838644381137*^9}, {
   3.405003582974747*^9, 3.4050035922723475`*^9}, {3.4050918622706738`*^9, 
   3.4050918685833354`*^9}, 3.405092260780875*^9, {3.405101581745773*^9, 
   3.405101582151373*^9}, {3.4056655211663103`*^9, 3.405665556010729*^9}, 
   3.405666387761073*^9, {3.4064717507017865`*^9, 3.406471774030509*^9}, {
   3.4065574041884317`*^9, 3.4065574100948334`*^9}, {3.406612729124117*^9, 
   3.40661273960876*^9}, {3.406960257359646*^9, 3.4069602629847536`*^9}, {
   3.4070578284046464`*^9, 3.40705787207736*^9}, 3.4075832317644005`*^9, {
   3.4084467059509897`*^9, 3.408446707622897*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TestBiHestonUnderlying1Vanilla", "[", 
   RowBox[{
   "S_", ",", "\[Alpha]1_", ",", "a_", ",", "K_", ",", "\[Tau]_", ",", 
    "\[CapitalSigma]_", ",", "M_", ",", "\[CapitalSigma]inf_", ",", 
    "\[Beta]_", ",", "\[Rho]_", ",", "\[Mu]_", ",", "\[Lambda]1_", ",", 
    "\[Lambda]2_", ",", "\[Omega]1_", ",", "period_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Q", ",", "as", ",", "res", ",", "res2", ",", 
      RowBox[{"Y", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Log", "[", 
          RowBox[{"S", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
         RowBox[{"Log", "[", 
          RowBox[{"S", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Q", "=", 
      RowBox[{
       RowBox[{"CholeskyDecomposition", "[", 
        RowBox[{"-", 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"M", ".", "\[CapitalSigma]inf"}], "+", 
            RowBox[{"\[CapitalSigma]inf", ".", " ", 
             RowBox[{"Transpose", "[", "M", "]"}]}]}], "2"], ")"}]}], "]"}], 
       "/", "\[Beta]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"SmileSymetrizedBiHestonUnderlying1VanillaIntegrandCC", "[", 
         RowBox[{"Y", ",", "\[Alpha]1", ",", "a", ",", 
          RowBox[{"{", "K", "}"}], ",", "\[Tau]", ",", "\[CapitalSigma]", ",",
           "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", "\[Beta]", ",", 
          "\[Lambda]1", ",", "\[Lambda]2", ",", "\[Omega]1", ",", 
          "\[Omega]2"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Omega]2", ",", "0", " ", ",", 
         RowBox[{"2", "period"}]}], "}"}], ",", 
       RowBox[{"PlotPoints", "\[Rule]", "50"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "0.5"}], ",", "0.5"}], "}"}]}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", 
        RowBox[{"\"\<Integrand Underlying 1: K =\>\"", "<>", 
         RowBox[{"ToString", "[", "K", "]"}], "<>", "\"\< \[Omega]1=\>\"", "<>",
          
         RowBox[{"ToString", "[", "\[Omega]1", "]"}]}]}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4042074577632284`*^9, 3.4042074770760994`*^9}, {
   3.4042075328115444`*^9, 3.4042077538626633`*^9}, {3.404207970241818*^9, 
   3.404207993351637*^9}, {3.4042080286491895`*^9, 3.404208043665103*^9}, {
   3.4042173037335176`*^9, 3.4042173873444977`*^9}, {3.4042175109093704`*^9, 
   3.404217554472707*^9}, {3.4042999349691343`*^9, 3.4042999555923347`*^9}, {
   3.404381253215744*^9, 3.404381270172944*^9}, {3.4044634862113743`*^9, 
   3.4044635745846777`*^9}, {3.404463622474383*^9, 3.4044637577842846`*^9}, {
   3.4044637895649247`*^9, 3.4044638511887417`*^9}, {3.404463881485035*^9, 
   3.404463962092862*^9}, {3.4044646348143206`*^9, 3.4044646352830615`*^9}, {
   3.4044659090554795`*^9, 3.4044659091648526`*^9}, {3.404466252111393*^9, 
   3.4044662673767247`*^9}, {3.4044662976417685`*^9, 
   3.4044662980323863`*^9}, {3.4044673732461166`*^9, 
   3.4044673808397207`*^9}, {3.4046519546877003`*^9, 
   3.4046519750474663`*^9}, {3.4046528875181103`*^9, 3.404652993051387*^9}, 
   3.404811180721076*^9, {3.404811251817556*^9, 3.404811256317729*^9}, 
   3.404826602406996*^9, {3.4048266367520647`*^9, 3.4048266473149705`*^9}, {
   3.404838584300705*^9, 3.404838585847639*^9}, {3.404888355750947*^9, 
   3.4048883751261473`*^9}, {3.404888409087347*^9, 3.4048884100857472`*^9}, 
   3.404888482298147*^9, {3.404888523107747*^9, 3.404888593260947*^9}, {
   3.4048886239773474`*^9, 3.404888647377347*^9}, {3.4048888242189474`*^9, 
   3.4048888357941475`*^9}, {3.4048891031157475`*^9, 3.404889148121747*^9}, {
   3.404889229444547*^9, 3.404889260831747*^9}, {3.404889328176947*^9, 
   3.404889408579347*^9}, 3.4048894927725472`*^9, {3.404889523270547*^9, 
   3.404889539650547*^9}, {3.4048896202557473`*^9, 3.404889621129347*^9}, {
   3.4048906274507475`*^9, 3.404890630118347*^9}, 3.404890709865547*^9, {
   3.404890864399147*^9, 3.404890865771947*^9}, {3.404891178645547*^9, 
   3.404891216054347*^9}, {3.405760351858841*^9, 3.405760355015151*^9}, {
   3.4057604942990756`*^9, 3.4057605316435423`*^9}, {3.4057607697887397`*^9, 
   3.4057607703981266`*^9}, {3.405760946948391*^9, 3.405760949964074*^9}, {
   3.405760993183654*^9, 3.405760998246251*^9}, {3.405761486114993*^9, 
   3.405761486286871*^9}, {3.406446474989156*^9, 3.4064464915985312`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TestBiHestonUnderlying1Vanilla3", "[", 
   RowBox[{
   "S_", ",", "\[Alpha]1_", ",", "a_", ",", "K_", ",", "\[Tau]_", ",", 
    "\[CapitalSigma]_", ",", "M_", ",", "Q_", ",", "\[Beta]_", ",", "\[Rho]_",
     ",", "\[Mu]_", ",", "\[Lambda]1_", ",", "\[Lambda]2_", ",", "\[Omega]1_",
     ",", "period_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"as", ",", "res", ",", "res2", ",", 
      RowBox[{"Y", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Log", "[", 
          RowBox[{"S", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
         RowBox[{"Log", "[", 
          RowBox[{"S", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"SmileSymetrizedBiHestonUnderlying1VanillaIntegrandCC", "[", 
        RowBox[{"Y", ",", "\[Alpha]1", ",", "a", ",", 
         RowBox[{"{", "K", "}"}], ",", "\[Tau]", ",", "\[CapitalSigma]", ",", 
         "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", "\[Beta]", ",", 
         "\[Lambda]1", ",", "\[Lambda]2", ",", "\[Omega]1", ",", 
         "\[Omega]2"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Omega]2", ",", "0", " ", ",", 
        RowBox[{"2", "period"}]}], "}"}], ",", 
      RowBox[{"PlotPoints", "\[Rule]", "50"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "0.5"}], ",", "0.5"}], "}"}]}], ",", 
      RowBox[{"PlotLabel", "\[Rule]", 
       RowBox[{"\"\<Integrand Underlying 1: K =\>\"", "<>", 
        RowBox[{"ToString", "[", "K", "]"}], "<>", "\"\< \[Omega]1=\>\"", "<>",
         
        RowBox[{"ToString", "[", "\[Omega]1", "]"}]}]}]}], "]"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4042074577632284`*^9, 3.4042074770760994`*^9}, {
   3.4042075328115444`*^9, 3.4042077538626633`*^9}, {3.404207970241818*^9, 
   3.404207993351637*^9}, {3.4042080286491895`*^9, 3.404208043665103*^9}, {
   3.4042173037335176`*^9, 3.4042173873444977`*^9}, {3.4042175109093704`*^9, 
   3.404217554472707*^9}, {3.4042999349691343`*^9, 3.4042999555923347`*^9}, {
   3.404381253215744*^9, 3.404381270172944*^9}, {3.4044634862113743`*^9, 
   3.4044635745846777`*^9}, {3.404463622474383*^9, 3.4044637577842846`*^9}, {
   3.4044637895649247`*^9, 3.4044638511887417`*^9}, {3.404463881485035*^9, 
   3.404463962092862*^9}, {3.4044646348143206`*^9, 3.4044646352830615`*^9}, {
   3.4044659090554795`*^9, 3.4044659091648526`*^9}, {3.404466252111393*^9, 
   3.4044662673767247`*^9}, {3.4044662976417685`*^9, 
   3.4044662980323863`*^9}, {3.4044673732461166`*^9, 
   3.4044673808397207`*^9}, {3.4046519546877003`*^9, 
   3.4046519750474663`*^9}, {3.4046528875181103`*^9, 3.404652993051387*^9}, 
   3.404811180721076*^9, {3.404811251817556*^9, 3.404811256317729*^9}, 
   3.404826602406996*^9, {3.4048266367520647`*^9, 3.4048266473149705`*^9}, {
   3.404838584300705*^9, 3.404838585847639*^9}, {3.404888355750947*^9, 
   3.4048883751261473`*^9}, {3.404888409087347*^9, 3.4048884100857472`*^9}, 
   3.404888482298147*^9, {3.404888523107747*^9, 3.404888593260947*^9}, {
   3.4048886239773474`*^9, 3.404888647377347*^9}, {3.4048888242189474`*^9, 
   3.4048888357941475`*^9}, {3.4048891031157475`*^9, 3.404889148121747*^9}, {
   3.404889229444547*^9, 3.404889260831747*^9}, {3.404889328176947*^9, 
   3.404889408579347*^9}, 3.4048894927725472`*^9, {3.404889523270547*^9, 
   3.404889539650547*^9}, {3.4048896202557473`*^9, 3.404889621129347*^9}, {
   3.4048906274507475`*^9, 3.404890630118347*^9}, 3.404890709865547*^9, {
   3.404890864399147*^9, 3.404890865771947*^9}, {3.404891178645547*^9, 
   3.404891216054347*^9}, {3.405760351858841*^9, 3.405760355015151*^9}, {
   3.4057604942990756`*^9, 3.4057605316435423`*^9}, {3.4057607697887397`*^9, 
   3.4057607703981266`*^9}, {3.405760946948391*^9, 3.405760949964074*^9}, {
   3.405760993183654*^9, 3.405760998246251*^9}, {3.405761486114993*^9, 
   3.405761486286871*^9}, {3.406446474989156*^9, 3.4064464915985312`*^9}, {
   3.407479543251588*^9, 3.4074795641615877`*^9}, 3.4074808290739875`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Test2BiHestonUnderlying1Vanilla", "[", 
   RowBox[{
   "S_", ",", "\[Alpha]1_", ",", "a_", ",", "K_", ",", "\[Tau]_", ",", 
    "\[CapitalSigma]_", ",", "M_", ",", "\[CapitalSigma]inf_", ",", 
    "\[Beta]_", ",", "\[Rho]_", ",", "\[Mu]_", ",", "\[Lambda]1_", ",", 
    "\[Lambda]2_", ",", 
    RowBox[{"{", 
     RowBox[{
     "LegendreCoef1_", ",", "LegendreCoef1n_", ",", "period1_", ",", 
      "period1n_", ",", "\[Epsilon]1_", ",", "imax_", ",", 
      "startmonitortime_", ",", "plafondexplosion_", ",", "initialTailFlag_", 
      ",", "InitialTailPosition_"}], "}"}], ",", "period_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Q", ",", "as", ",", "res", ",", "res2", ",", 
      RowBox[{"Y", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Log", "[", 
          RowBox[{"S", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
         RowBox[{"Log", "[", 
          RowBox[{"S", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}], ",", "tt"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Q", "=", 
      RowBox[{
       RowBox[{"CholeskyDecomposition", "[", 
        RowBox[{"-", 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"M", ".", "\[CapitalSigma]inf"}], "+", 
            RowBox[{"\[CapitalSigma]inf", ".", " ", 
             RowBox[{"Transpose", "[", "M", "]"}]}]}], "2"], ")"}]}], "]"}], 
       "/", "\[Beta]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tt", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Omega]2", ",", 
          RowBox[{
           RowBox[{"VectorAdaptativeIntegrateExplosionSafe", "[", 
            RowBox[{
             RowBox[{"Function", "[", 
              RowBox[{"\[Omega]1", ",", 
               RowBox[{
                RowBox[{
                "SmileSymetrizedBiHestonUnderlying1VanillaIntegrandCC", "[", 
                 RowBox[{"Y", ",", "\[Alpha]1", ",", "a", ",", 
                  RowBox[{"{", "K", "}"}], ",", "\[Tau]", ",", 
                  "\[CapitalSigma]", ",", "M", ",", "Q", ",", "\[Rho]", ",", 
                  "\[Mu]", ",", "\[Beta]", ",", "\[Lambda]1", ",", 
                  "\[Lambda]2", ",", "\[Omega]1", ",", "\[Omega]2"}], "]"}], 
                "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", "LegendreCoef1",
              ",", "LegendreCoef1n", ",", "period1", ",", "period1n", ",", 
             "\[Epsilon]1", ",", "imax", ",", "1", ",", "startmonitortime", 
             ",", "plafondexplosion", ",", "initialTailFlag", ",", 
             "InitialTailPosition"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Omega]2", ",", "0", ",", "period", ",", 
          RowBox[{"period", "/", "100"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ListPlot", "[", 
      RowBox[{"tt", ",", 
       RowBox[{"Joined", "\[Rule]", "True"}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", "\"\<U1:2nd Inv. Fourier:\>\""}], ",", 
       
       RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}]}], "]"}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.4042074577632284`*^9, 3.4042074770760994`*^9}, {
   3.4042075328115444`*^9, 3.4042077538626633`*^9}, {3.404207970241818*^9, 
   3.404207993351637*^9}, {3.4042080286491895`*^9, 3.404208043665103*^9}, {
   3.4042173037335176`*^9, 3.4042173873444977`*^9}, {3.4042175109093704`*^9, 
   3.404217554472707*^9}, {3.4042999349691343`*^9, 3.4042999555923347`*^9}, {
   3.404381253215744*^9, 3.404381270172944*^9}, {3.4044634862113743`*^9, 
   3.4044635745846777`*^9}, {3.404463622474383*^9, 3.4044637577842846`*^9}, {
   3.4044637895649247`*^9, 3.4044638511887417`*^9}, {3.404463881485035*^9, 
   3.404463962092862*^9}, {3.4044646348143206`*^9, 3.4044646352830615`*^9}, {
   3.4044659090554795`*^9, 3.4044659091648526`*^9}, {3.404466252111393*^9, 
   3.4044662673767247`*^9}, {3.4044662976417685`*^9, 
   3.4044662980323863`*^9}, {3.4044673732461166`*^9, 
   3.4044673808397207`*^9}, {3.4046519546877003`*^9, 
   3.4046519750474663`*^9}, {3.4046528875181103`*^9, 3.404652993051387*^9}, 
   3.404811180721076*^9, {3.404811251817556*^9, 3.404811256317729*^9}, 
   3.404826602406996*^9, {3.4048266367520647`*^9, 3.4048266473149705`*^9}, {
   3.404838584300705*^9, 3.404838585847639*^9}, {3.404888355750947*^9, 
   3.4048883751261473`*^9}, {3.404888409087347*^9, 3.4048884100857472`*^9}, 
   3.404888482298147*^9, {3.404888523107747*^9, 3.404888593260947*^9}, {
   3.4048886239773474`*^9, 3.404888647377347*^9}, {3.4048888242189474`*^9, 
   3.4048888357941475`*^9}, {3.4048891031157475`*^9, 3.404889148121747*^9}, {
   3.404889229444547*^9, 3.404889260831747*^9}, {3.404889328176947*^9, 
   3.404889408579347*^9}, 3.4048894927725472`*^9, {3.404889523270547*^9, 
   3.404889539650547*^9}, {3.4048896202557473`*^9, 3.404889621129347*^9}, {
   3.4048906274507475`*^9, 3.404890630118347*^9}, 3.404890709865547*^9, {
   3.404890864399147*^9, 3.404890865771947*^9}, {3.404891178645547*^9, 
   3.404891216054347*^9}, {3.405760351858841*^9, 3.405760355015151*^9}, {
   3.4057604942990756`*^9, 3.4057605316435423`*^9}, {3.4057607697887397`*^9, 
   3.4057607703981266`*^9}, {3.405760946948391*^9, 3.405760949964074*^9}, {
   3.405760993183654*^9, 3.405760998246251*^9}, {3.405761486114993*^9, 
   3.405761486286871*^9}, 3.4057618534345455`*^9, {3.405761894341581*^9, 
   3.4057619368423967`*^9}, {3.4057619887965193`*^9, 
   3.4057620280472727`*^9}, {3.4057621936361403`*^9, 3.405762195089507*^9}, {
   3.405762368881112*^9, 3.405762475670563*^9}, {3.405762968882745*^9, 
   3.4057629990866427`*^9}, {3.4064464253485312`*^9, 3.4064464383485312`*^9}, 
   3.4064694397363772`*^9, {3.4064701855210943`*^9, 3.406470206646635*^9}, {
   3.406474265500539*^9, 3.406474269500641*^9}, {3.4065275165991063`*^9, 
   3.40652753509958*^9}, 3.406557427235897*^9, {3.4065582399442015`*^9, 
   3.4065582421786337`*^9}, {3.406559181874564*^9, 3.4065591828120885`*^9}, {
   3.4065593167530174`*^9, 3.406559317518662*^9}, {3.406612767750106*^9, 
   3.406612802407243*^9}, {3.4066128872375393`*^9, 3.4066128876438*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TestBiHestonUnderlying1Vanilla2", "[", 
   RowBox[{
   "S_", ",", "\[Alpha]1_", ",", "a_", ",", "K_", ",", "\[Tau]_", ",", 
    "\[CapitalSigma]_", ",", "M_", ",", "\[CapitalSigma]inf_", ",", "Q_", ",",
     "\[Rho]_", ",", "\[Mu]_", ",", "\[Lambda]1_", ",", "\[Lambda]2_", ",", 
    "\[Omega]1_", ",", "period_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[Beta]m", ",", "as", ",", "res", ",", "res2", ",", 
      RowBox[{"Y", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Log", "[", 
          RowBox[{"S", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
         RowBox[{"Log", "[", 
          RowBox[{"S", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Beta]m", "=", 
      RowBox[{"-", 
       RowBox[{
        RowBox[{"(", 
         FractionBox[
          RowBox[{
           RowBox[{"M", ".", "\[CapitalSigma]inf"}], "+", 
           RowBox[{"\[CapitalSigma]inf", ".", 
            RowBox[{"Transpose", "[", "M", "]"}]}]}], "2"], ")"}], ".", 
        RowBox[{"Inverse", "[", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Transpose", "[", "Q", "]"}], ".", "Q"}], ")"}], 
         "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
        "SmileSymetrizedBiHestonUnderlying1VanillaIntegrand2CC", "[", 
         RowBox[{"Y", ",", "\[Alpha]1", ",", "a", ",", 
          RowBox[{"{", "K", "}"}], ",", "\[Tau]", ",", "\[CapitalSigma]", ",",
           "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", "\[Beta]m", ",", 
          "\[Lambda]1", ",", "\[Lambda]2", ",", "\[Omega]1", ",", 
          "\[Omega]2"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Omega]2", ",", "0", " ", ",", 
         RowBox[{"2", "period"}]}], "}"}], ",", 
       RowBox[{"PlotPoints", "\[Rule]", "50"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "0.5"}], ",", "0.5"}], "}"}]}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", 
        RowBox[{"\"\<Integrand Underlying 1: K =\>\"", "<>", 
         RowBox[{"ToString", "[", "K", "]"}], "<>", "\"\< \[Omega]1=\>\"", "<>",
          
         RowBox[{"ToString", "[", "\[Omega]1", "]"}]}]}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4042074577632284`*^9, 3.4042074770760994`*^9}, {
   3.4042075328115444`*^9, 3.4042077538626633`*^9}, {3.404207970241818*^9, 
   3.404207993351637*^9}, {3.4042080286491895`*^9, 3.404208043665103*^9}, {
   3.4042173037335176`*^9, 3.4042173873444977`*^9}, {3.4042175109093704`*^9, 
   3.404217554472707*^9}, {3.4042999349691343`*^9, 3.4042999555923347`*^9}, {
   3.404381253215744*^9, 3.404381270172944*^9}, {3.4044634862113743`*^9, 
   3.4044635745846777`*^9}, {3.404463622474383*^9, 3.4044637577842846`*^9}, {
   3.4044637895649247`*^9, 3.4044638511887417`*^9}, {3.404463881485035*^9, 
   3.404463962092862*^9}, {3.4044646348143206`*^9, 3.4044646352830615`*^9}, {
   3.4044659090554795`*^9, 3.4044659091648526`*^9}, {3.404466252111393*^9, 
   3.4044662673767247`*^9}, {3.4044662976417685`*^9, 
   3.4044662980323863`*^9}, {3.4044673732461166`*^9, 
   3.4044673808397207`*^9}, {3.4046519546877003`*^9, 
   3.4046519750474663`*^9}, {3.4046528875181103`*^9, 3.404652993051387*^9}, 
   3.404811180721076*^9, {3.404811251817556*^9, 3.404811256317729*^9}, 
   3.404826602406996*^9, {3.4048266367520647`*^9, 3.4048266473149705`*^9}, {
   3.404838584300705*^9, 3.404838585847639*^9}, {3.404888355750947*^9, 
   3.4048883751261473`*^9}, {3.404888409087347*^9, 3.4048884100857472`*^9}, 
   3.404888482298147*^9, {3.404888523107747*^9, 3.404888593260947*^9}, {
   3.4048886239773474`*^9, 3.404888647377347*^9}, {3.4048888242189474`*^9, 
   3.4048888357941475`*^9}, {3.4048891031157475`*^9, 3.404889148121747*^9}, {
   3.404889229444547*^9, 3.404889260831747*^9}, {3.404889328176947*^9, 
   3.404889408579347*^9}, 3.4048894927725472`*^9, {3.404889523270547*^9, 
   3.404889539650547*^9}, {3.4048896202557473`*^9, 3.404889621129347*^9}, {
   3.4048906274507475`*^9, 3.404890630118347*^9}, 3.404890709865547*^9, {
   3.404890864399147*^9, 3.404890865771947*^9}, {3.404891178645547*^9, 
   3.404891216054347*^9}, {3.405760351858841*^9, 3.405760355015151*^9}, {
   3.4057604942990756`*^9, 3.4057605316435423`*^9}, {3.4057607697887397`*^9, 
   3.4057607703981266`*^9}, {3.405760946948391*^9, 3.405760949964074*^9}, {
   3.405760993183654*^9, 3.405760998246251*^9}, {3.405761486114993*^9, 
   3.405761486286871*^9}, {3.4059566440048122`*^9, 3.4059566628489237`*^9}, {
   3.4059567069278955`*^9, 3.4059567221000614`*^9}, {3.406446388364156*^9, 
   3.406446408239156*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Test2BiHestonUnderlying1Vanilla2", "[", 
   RowBox[{
   "S_", ",", "\[Alpha]1_", ",", "a_", ",", "K_", ",", "\[Tau]_", ",", 
    "\[CapitalSigma]_", ",", "M_", ",", "\[CapitalSigma]inf_", ",", "Q_", ",",
     "\[Rho]_", ",", "\[Mu]_", ",", "\[Lambda]1_", ",", "\[Lambda]2_", ",", 
    RowBox[{"{", 
     RowBox[{
     "LegendreCoef1_", ",", "LegendreCoef1n_", ",", "period1_", ",", 
      "period1n_", ",", "\[Epsilon]1_", ",", "imax_", ",", 
      "startmonitortime_", ",", "plafondexplosion_", ",", "initialTailFlag_", 
      ",", "InitialTailPosition_"}], "}"}], ",", "period_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[Beta]m", ",", "as", ",", "res", ",", "res2", ",", 
      RowBox[{"Y", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Log", "[", 
          RowBox[{"S", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
         RowBox[{"Log", "[", 
          RowBox[{"S", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}], ",", "tt"}], 
     "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Beta]m", "=", 
      RowBox[{"-", 
       RowBox[{
        RowBox[{"(", 
         FractionBox[
          RowBox[{
           RowBox[{"M", ".", "\[CapitalSigma]inf"}], "+", 
           RowBox[{"\[CapitalSigma]inf", ".", 
            RowBox[{"Transpose", "[", "M", "]"}]}]}], "2"], ")"}], ".", 
        RowBox[{"Inverse", "[", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Transpose", "[", "Q", "]"}], ".", "Q"}], ")"}], 
         "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tt", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Omega]2", ",", 
          RowBox[{
           RowBox[{"VectorAdaptativeIntegrateExplosionSafe", "[", 
            RowBox[{
             RowBox[{"Function", "[", 
              RowBox[{"\[Omega]1", ",", 
               RowBox[{
                RowBox[{
                "SmileSymetrizedBiHestonUnderlying1VanillaIntegrand2CC", "[", 
                 
                 RowBox[{"Y", ",", "\[Alpha]1", ",", "a", ",", 
                  RowBox[{"{", "K", "}"}], ",", "\[Tau]", ",", 
                  "\[CapitalSigma]", ",", "M", ",", "Q", ",", "\[Rho]", ",", 
                  "\[Mu]", ",", "\[Beta]m", ",", "\[Lambda]1", ",", 
                  "\[Lambda]2", ",", "\[Omega]1", ",", "\[Omega]2"}], "]"}], 
                "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", "LegendreCoef1",
              ",", "LegendreCoef1n", ",", "period1", ",", "period1n", ",", 
             "\[Epsilon]1", ",", "imax", ",", "1", ",", "startmonitortime", 
             ",", "plafondexplosion", ",", "initialTailFlag", ",", 
             "InitialTailPosition"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Omega]2", ",", "0", ",", "period", ",", 
          RowBox[{"period", "/", "100"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ListPlot", "[", 
      RowBox[{"tt", ",", 
       RowBox[{"Joined", "\[Rule]", "True"}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", "\"\<U1:2nd Inv. Fourier:\>\""}], ",", 
       
       RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}]}], "]"}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.4042074577632284`*^9, 3.4042074770760994`*^9}, {
   3.4042075328115444`*^9, 3.4042077538626633`*^9}, {3.404207970241818*^9, 
   3.404207993351637*^9}, {3.4042080286491895`*^9, 3.404208043665103*^9}, {
   3.4042173037335176`*^9, 3.4042173873444977`*^9}, {3.4042175109093704`*^9, 
   3.404217554472707*^9}, {3.4042999349691343`*^9, 3.4042999555923347`*^9}, {
   3.404381253215744*^9, 3.404381270172944*^9}, {3.4044634862113743`*^9, 
   3.4044635745846777`*^9}, {3.404463622474383*^9, 3.4044637577842846`*^9}, {
   3.4044637895649247`*^9, 3.4044638511887417`*^9}, {3.404463881485035*^9, 
   3.404463962092862*^9}, {3.4044646348143206`*^9, 3.4044646352830615`*^9}, {
   3.4044659090554795`*^9, 3.4044659091648526`*^9}, {3.404466252111393*^9, 
   3.4044662673767247`*^9}, {3.4044662976417685`*^9, 
   3.4044662980323863`*^9}, {3.4044673732461166`*^9, 
   3.4044673808397207`*^9}, {3.4046519546877003`*^9, 
   3.4046519750474663`*^9}, {3.4046528875181103`*^9, 3.404652993051387*^9}, 
   3.404811180721076*^9, {3.404811251817556*^9, 3.404811256317729*^9}, 
   3.404826602406996*^9, {3.4048266367520647`*^9, 3.4048266473149705`*^9}, {
   3.404838584300705*^9, 3.404838585847639*^9}, {3.404888355750947*^9, 
   3.4048883751261473`*^9}, {3.404888409087347*^9, 3.4048884100857472`*^9}, 
   3.404888482298147*^9, {3.404888523107747*^9, 3.404888593260947*^9}, {
   3.4048886239773474`*^9, 3.404888647377347*^9}, {3.4048888242189474`*^9, 
   3.4048888357941475`*^9}, {3.4048891031157475`*^9, 3.404889148121747*^9}, {
   3.404889229444547*^9, 3.404889260831747*^9}, {3.404889328176947*^9, 
   3.404889408579347*^9}, 3.4048894927725472`*^9, {3.404889523270547*^9, 
   3.404889539650547*^9}, {3.4048896202557473`*^9, 3.404889621129347*^9}, {
   3.4048906274507475`*^9, 3.404890630118347*^9}, 3.404890709865547*^9, {
   3.404890864399147*^9, 3.404890865771947*^9}, {3.404891178645547*^9, 
   3.404891216054347*^9}, {3.405760351858841*^9, 3.405760355015151*^9}, {
   3.4057604942990756`*^9, 3.4057605316435423`*^9}, {3.4057607697887397`*^9, 
   3.4057607703981266`*^9}, {3.405760946948391*^9, 3.405760949964074*^9}, {
   3.405760993183654*^9, 3.405760998246251*^9}, {3.405761486114993*^9, 
   3.405761486286871*^9}, 3.4057618534345455`*^9, {3.405761894341581*^9, 
   3.4057619368423967`*^9}, {3.4057619887965193`*^9, 
   3.4057620280472727`*^9}, {3.4057621936361403`*^9, 3.405762195089507*^9}, {
   3.405762368881112*^9, 3.405762475670563*^9}, {3.405762968882745*^9, 
   3.4057629990866427`*^9}, {3.4059574493171487`*^9, 3.4059574908648214`*^9}, 
   3.4059581900969963`*^9, {3.4064464528485312`*^9, 3.4064464651610312`*^9}, {
   3.406446576364156*^9, 3.406446580957906*^9}, 3.4064695097537947`*^9, {
   3.406470904055113*^9, 3.406470933946503*^9}, {3.406474383753566*^9, 
   3.4064743912381325`*^9}, {3.406530625413065*^9, 3.4065306341476636`*^9}, {
   3.4065306783675456`*^9, 3.4065306788831835`*^9}, 3.4065574354236064`*^9, {
   3.4065582521476393`*^9, 3.406558254085189*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Test2BiHestonUnderlying1Vanilla3", "[", 
   RowBox[{
   "S_", ",", "\[Alpha]1_", ",", "a_", ",", "K_", ",", "\[Tau]_", ",", 
    "\[CapitalSigma]_", ",", "M_", ",", "Q_", ",", "\[Beta]_", ",", "\[Rho]_",
     ",", "\[Mu]_", ",", "\[Lambda]1_", ",", "\[Lambda]2_", ",", 
    RowBox[{"{", 
     RowBox[{
     "LegendreCoef1_", ",", "LegendreCoef1n_", ",", "period1_", ",", 
      "period1n_", ",", "\[Epsilon]1_", ",", "imax_", ",", 
      "startmonitortime_", ",", "plafondexplosion_", ",", "initialTailFlag_", 
      ",", "InitialTailPosition_"}], "}"}], ",", "period_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[Beta]m", ",", "as", ",", "res", ",", "res2", ",", 
      RowBox[{"Y", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Log", "[", 
          RowBox[{"S", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
         RowBox[{"Log", "[", 
          RowBox[{"S", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}], ",", "tt"}], 
     "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"tt", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Omega]2", ",", 
          RowBox[{
           RowBox[{"VectorAdaptativeIntegrateExplosionSafe", "[", 
            RowBox[{
             RowBox[{"Function", "[", 
              RowBox[{"\[Omega]1", ",", 
               RowBox[{
                RowBox[{
                "SmileSymetrizedBiHestonUnderlying1VanillaIntegrandCC", "[", 
                 RowBox[{"Y", ",", "\[Alpha]1", ",", "a", ",", 
                  RowBox[{"{", "K", "}"}], ",", "\[Tau]", ",", 
                  "\[CapitalSigma]", ",", "M", ",", "Q", ",", "\[Rho]", ",", 
                  "\[Mu]", ",", "\[Beta]", ",", "\[Lambda]1", ",", 
                  "\[Lambda]2", ",", "\[Omega]1", ",", "\[Omega]2"}], "]"}], 
                "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", "LegendreCoef1",
              ",", "LegendreCoef1n", ",", "period1", ",", "period1n", ",", 
             "\[Epsilon]1", ",", "imax", ",", "1", ",", "startmonitortime", 
             ",", "plafondexplosion", ",", "initialTailFlag", ",", 
             "InitialTailPosition"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Omega]2", ",", "0", ",", "period", ",", 
          RowBox[{"period", "/", "100"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ListPlot", "[", 
      RowBox[{"tt", ",", 
       RowBox[{"Joined", "\[Rule]", "True"}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", "\"\<U1:2nd Inv. Fourier:\>\""}], ",", 
       
       RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}]}], "]"}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.4042074577632284`*^9, 3.4042074770760994`*^9}, {
   3.4042075328115444`*^9, 3.4042077538626633`*^9}, {3.404207970241818*^9, 
   3.404207993351637*^9}, {3.4042080286491895`*^9, 3.404208043665103*^9}, {
   3.4042173037335176`*^9, 3.4042173873444977`*^9}, {3.4042175109093704`*^9, 
   3.404217554472707*^9}, {3.4042999349691343`*^9, 3.4042999555923347`*^9}, {
   3.404381253215744*^9, 3.404381270172944*^9}, {3.4044634862113743`*^9, 
   3.4044635745846777`*^9}, {3.404463622474383*^9, 3.4044637577842846`*^9}, {
   3.4044637895649247`*^9, 3.4044638511887417`*^9}, {3.404463881485035*^9, 
   3.404463962092862*^9}, {3.4044646348143206`*^9, 3.4044646352830615`*^9}, {
   3.4044659090554795`*^9, 3.4044659091648526`*^9}, {3.404466252111393*^9, 
   3.4044662673767247`*^9}, {3.4044662976417685`*^9, 
   3.4044662980323863`*^9}, {3.4044673732461166`*^9, 
   3.4044673808397207`*^9}, {3.4046519546877003`*^9, 
   3.4046519750474663`*^9}, {3.4046528875181103`*^9, 3.404652993051387*^9}, 
   3.404811180721076*^9, {3.404811251817556*^9, 3.404811256317729*^9}, 
   3.404826602406996*^9, {3.4048266367520647`*^9, 3.4048266473149705`*^9}, {
   3.404838584300705*^9, 3.404838585847639*^9}, {3.404888355750947*^9, 
   3.4048883751261473`*^9}, {3.404888409087347*^9, 3.4048884100857472`*^9}, 
   3.404888482298147*^9, {3.404888523107747*^9, 3.404888593260947*^9}, {
   3.4048886239773474`*^9, 3.404888647377347*^9}, {3.4048888242189474`*^9, 
   3.4048888357941475`*^9}, {3.4048891031157475`*^9, 3.404889148121747*^9}, {
   3.404889229444547*^9, 3.404889260831747*^9}, {3.404889328176947*^9, 
   3.404889408579347*^9}, 3.4048894927725472`*^9, {3.404889523270547*^9, 
   3.404889539650547*^9}, {3.4048896202557473`*^9, 3.404889621129347*^9}, {
   3.4048906274507475`*^9, 3.404890630118347*^9}, 3.404890709865547*^9, {
   3.404890864399147*^9, 3.404890865771947*^9}, {3.404891178645547*^9, 
   3.404891216054347*^9}, {3.405760351858841*^9, 3.405760355015151*^9}, {
   3.4057604942990756`*^9, 3.4057605316435423`*^9}, {3.4057607697887397`*^9, 
   3.4057607703981266`*^9}, {3.405760946948391*^9, 3.405760949964074*^9}, {
   3.405760993183654*^9, 3.405760998246251*^9}, {3.405761486114993*^9, 
   3.405761486286871*^9}, 3.4057618534345455`*^9, {3.405761894341581*^9, 
   3.4057619368423967`*^9}, {3.4057619887965193`*^9, 
   3.4057620280472727`*^9}, {3.4057621936361403`*^9, 3.405762195089507*^9}, {
   3.405762368881112*^9, 3.405762475670563*^9}, {3.405762968882745*^9, 
   3.4057629990866427`*^9}, {3.4059574493171487`*^9, 3.4059574908648214`*^9}, 
   3.4059581900969963`*^9, {3.4064464528485312`*^9, 3.4064464651610312`*^9}, {
   3.406446576364156*^9, 3.406446580957906*^9}, 3.4064695097537947`*^9, {
   3.406470904055113*^9, 3.406470933946503*^9}, {3.406474383753566*^9, 
   3.4064743912381325`*^9}, {3.406530625413065*^9, 3.4065306341476636`*^9}, {
   3.4065306783675456`*^9, 3.4065306788831835`*^9}, 3.4065574354236064`*^9, {
   3.4065582521476393`*^9, 3.406558254085189*^9}, {3.4074796315655875`*^9, 
   3.4074796639585876`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Handling of (\[Beta] or Q input)", "Subsubtitle",
 CellChangeTimes->{{3.404641877166887*^9, 3.4046419260584507`*^9}, 
   3.404642329628699*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SmileBiHestonUnderlying1Vanilla", "[", 
   RowBox[{
   "S_", ",", "\[Alpha]1_", ",", "a_", ",", "KList_", ",", "\[Tau]_", ",", 
    "\[CapitalSigma]_", ",", "M_", ",", "\[CapitalSigma]inf_", ",", "Q_", ",",
     "\[Rho]_", ",", "\[Mu]_", ",", "\[Beta]_", ",", "\[Lambda]1_", ",", 
    "\[Lambda]2_", ",", 
    RowBox[{"{", 
     RowBox[{
     "LegendreCoef1_", ",", "LegendreCoef1n_", ",", "period1_", ",", 
      "period1n_", ",", "\[Epsilon]1_", ",", "imax_", ",", 
      "startmonitortime_", ",", "plafondexplosion_", ",", "initialTailFlag_", 
      ",", "InitialTailPosition_", ",", "InitialTailPosition2_"}], "}"}], ",",
     
    RowBox[{"{", 
     RowBox[{
     "LegendreCoef2_", ",", "period2_", ",", "period2n_", ",", "\[Epsilon]2_",
       ",", "kmax_", ",", "StartControl_", ",", "IncrementFactor_"}], "}"}], 
    ",", "printflag_"}], "]"}], ":=", 
  RowBox[{"SmileBiHestonUnderlying1VanillaAux", "[", 
   RowBox[{
   "S", ",", "\[Alpha]1", ",", "a", ",", "KList", ",", "\[Tau]", ",", 
    "\[CapitalSigma]", ",", "M", ",", "\[CapitalSigma]inf", ",", "Q", ",", 
    "\[Rho]", ",", "\[Mu]", ",", "\[Beta]", ",", "\[Lambda]1", ",", 
    "\[Lambda]2", ",", 
    RowBox[{"{", 
     RowBox[{
     "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", ",", "period1n", 
      ",", "\[Epsilon]1", ",", "imax", ",", "startmonitortime", ",", 
      "plafondexplosion", ",", "initialTailFlag", ",", "InitialTailPosition", 
      ",", "InitialTailPosition2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "LegendreCoef2", ",", "period2", ",", "period2n", ",", "\[Epsilon]2", 
      ",", "kmax", ",", "StartControl", ",", "IncrementFactor"}], "}"}], ",", 
    "printflag"}], "]"}], " "}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.399897194377056*^9, 3.399897245940546*^9}, {
   3.3998976692611732`*^9, 3.3998976795269957`*^9}, {3.4002144512750473`*^9, 
   3.4002144569782815`*^9}, {3.400238263213356*^9, 3.400238300573448*^9}, {
   3.400408049201395*^9, 3.4004080510451803`*^9}, 3.400504474791651*^9, {
   3.4005667653701477`*^9, 3.400566798886416*^9}, {3.400819839626373*^9, 
   3.4008198425014277`*^9}, {3.4009134614843187`*^9, 
   3.4009134792034087`*^9}, {3.4009135487047434`*^9, 3.400913581252243*^9}, {
   3.4009136129872274`*^9, 3.4009136377220774`*^9}, {3.4009136698945704`*^9, 
   3.400913678910368*^9}, {3.400913713848539*^9, 3.400913720848673*^9}, {
   3.4009138946020093`*^9, 3.400913904914707*^9}, {3.40091789471006*^9, 
   3.400917899053893*^9}, {3.400921389214653*^9, 3.4009214402156324`*^9}, {
   3.400921492029127*^9, 3.4009215467489276`*^9}, {3.4009217594717617`*^9, 
   3.4009217705500994`*^9}, {3.401110611225083*^9, 3.4011106255847335`*^9}, {
   3.4011155613669987`*^9, 3.4011155856330895`*^9}, {3.401425790206461*^9, 
   3.401425813269404*^9}, {3.402046069834562*^9, 3.40204607210023*^9}, {
   3.4022357520580764`*^9, 3.4022357573706784`*^9}, {3.4022370965213895`*^9, 
   3.4022371025371304`*^9}, {3.402294637481146*^9, 3.4022946494188747`*^9}, {
   3.4022947595616145`*^9, 3.4022948086094313`*^9}, {3.4022949118926644`*^9, 
   3.4022949123770485`*^9}, 3.4022950944274187`*^9, {3.4023880298479567`*^9, 
   3.4023880317599564`*^9}, {3.403871467549989*^9, 3.4038715521922393`*^9}, {
   3.4038772034257407`*^9, 3.4038772338482*^9}, {3.4038778690791464`*^9, 
   3.4038778880951366`*^9}, {3.403877923330188*^9, 3.403877959690261*^9}, {
   3.403880525208268*^9, 3.403880528802087*^9}, {3.4039401668863335`*^9, 
   3.403940181277235*^9}, {3.403940658427021*^9, 3.403940660661439*^9}, 
   3.403940704459155*^9, {3.403947868049818*^9, 3.4039479096443667`*^9}, {
   3.4039621859965925`*^9, 3.4039621885122657`*^9}, {3.404149535953335*^9, 
   3.404149547107335*^9}, {3.404198055801464*^9, 3.4041980594734097`*^9}, {
   3.4043002987767344`*^9, 3.4043003215995345`*^9}, {3.404325523574544*^9, 
   3.4043255265385437`*^9}, 3.4043255927293434`*^9, {3.404455401905121*^9, 
   3.404455403947358*^9}, {3.404455464994901*^9, 3.4044554680552645`*^9}, 
   3.404456097176443*^9, 3.404649963321342*^9, {3.4046505214258075`*^9, 
   3.4046505251290035`*^9}, {3.404650901026846*^9, 3.404650903276889*^9}, 
   3.404826818368414*^9, 3.404826912153265*^9, {3.405003519701147*^9, 
   3.4050035276571474`*^9}, 3.4064694616119375`*^9, {3.4064702591792297`*^9, 
   3.4064702634605894`*^9}, 3.4065574404237347`*^9, {3.4065582606478567`*^9, 
   3.406558262726035*^9}, {3.406612946410929*^9, 3.406612954879896*^9}, 
   3.406959900134037*^9, 3.4069605709437914`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SmileBiHestonUnderlying1Vanilla2", "[", 
   RowBox[{
   "S_", ",", "\[Alpha]1_", ",", "a_", ",", "KList_", ",", "\[Tau]_", ",", 
    "\[CapitalSigma]_", ",", "M_", ",", "\[CapitalSigma]inf_", ",", "Q_", ",",
     "\[Rho]_", ",", "\[Mu]_", ",", "\[Beta]m_", ",", "\[Lambda]1_", ",", 
    "\[Lambda]2_", ",", 
    RowBox[{"{", 
     RowBox[{
     "LegendreCoef1_", ",", "LegendreCoef1n_", ",", "period1_", ",", 
      "period1n_", ",", "\[Epsilon]1_", ",", "imax_", ",", 
      "startmonitortime_", ",", "plafondexplosion_", ",", "initialTailFlag_", 
      ",", "InitialTailPosition_", ",", "InitialTailPosition2_"}], "}"}], ",",
     
    RowBox[{"{", 
     RowBox[{
     "LegendreCoef2_", ",", "period2_", ",", "period2n_", ",", "\[Epsilon]2_",
       ",", "kmax_", ",", "StartControl_", ",", "IncrementFactor_"}], "}"}], 
    ",", "printflag_"}], "]"}], ":=", 
  RowBox[{"SmileBiHestonUnderlying1VanillaAux2", "[", 
   RowBox[{
   "S", ",", "\[Alpha]1", ",", "a", ",", "KList", ",", "\[Tau]", ",", 
    "\[CapitalSigma]", ",", "M", ",", "\[CapitalSigma]inf", ",", "Q", ",", 
    "\[Rho]", ",", "\[Mu]", ",", "\[Beta]m", ",", "\[Lambda]1", ",", 
    "\[Lambda]2", ",", 
    RowBox[{"{", 
     RowBox[{
     "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", ",", "period1n", 
      ",", "\[Epsilon]1", ",", "imax", ",", "startmonitortime", ",", 
      "plafondexplosion", ",", "initialTailFlag", ",", "InitialTailPosition", 
      ",", "InitialTailPosition2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "LegendreCoef2", ",", "period2", ",", "period2n", ",", "\[Epsilon]2", 
      ",", "kmax", ",", "StartControl", ",", "IncrementFactor"}], "}"}], ",", 
    "printflag"}], "]"}], " "}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.399897194377056*^9, 3.399897245940546*^9}, {
   3.3998976692611732`*^9, 3.3998976795269957`*^9}, {3.4002144512750473`*^9, 
   3.4002144569782815`*^9}, {3.400238263213356*^9, 3.400238300573448*^9}, {
   3.400408049201395*^9, 3.4004080510451803`*^9}, 3.400504474791651*^9, {
   3.4005667653701477`*^9, 3.400566798886416*^9}, {3.400819839626373*^9, 
   3.4008198425014277`*^9}, {3.4009134614843187`*^9, 
   3.4009134792034087`*^9}, {3.4009135487047434`*^9, 3.400913581252243*^9}, {
   3.4009136129872274`*^9, 3.4009136377220774`*^9}, {3.4009136698945704`*^9, 
   3.400913678910368*^9}, {3.400913713848539*^9, 3.400913720848673*^9}, {
   3.4009138946020093`*^9, 3.400913904914707*^9}, {3.40091789471006*^9, 
   3.400917899053893*^9}, {3.400921389214653*^9, 3.4009214402156324`*^9}, {
   3.400921492029127*^9, 3.4009215467489276`*^9}, {3.4009217594717617`*^9, 
   3.4009217705500994`*^9}, {3.401110611225083*^9, 3.4011106255847335`*^9}, {
   3.4011155613669987`*^9, 3.4011155856330895`*^9}, {3.401425790206461*^9, 
   3.401425813269404*^9}, {3.402046069834562*^9, 3.40204607210023*^9}, {
   3.4022357520580764`*^9, 3.4022357573706784`*^9}, {3.4022370965213895`*^9, 
   3.4022371025371304`*^9}, {3.402294637481146*^9, 3.4022946494188747`*^9}, {
   3.4022947595616145`*^9, 3.4022948086094313`*^9}, {3.4022949118926644`*^9, 
   3.4022949123770485`*^9}, 3.4022950944274187`*^9, {3.4023880298479567`*^9, 
   3.4023880317599564`*^9}, {3.403871467549989*^9, 3.4038715521922393`*^9}, {
   3.4038772034257407`*^9, 3.4038772338482*^9}, {3.4038778690791464`*^9, 
   3.4038778880951366`*^9}, {3.403877923330188*^9, 3.403877959690261*^9}, {
   3.403880525208268*^9, 3.403880528802087*^9}, {3.4039401668863335`*^9, 
   3.403940181277235*^9}, {3.403940658427021*^9, 3.403940660661439*^9}, 
   3.403940704459155*^9, {3.403947868049818*^9, 3.4039479096443667`*^9}, {
   3.4039621859965925`*^9, 3.4039621885122657`*^9}, {3.404149535953335*^9, 
   3.404149547107335*^9}, {3.404198055801464*^9, 3.4041980594734097`*^9}, {
   3.4043002987767344`*^9, 3.4043003215995345`*^9}, {3.404325523574544*^9, 
   3.4043255265385437`*^9}, 3.4043255927293434`*^9, {3.4043273738021436`*^9, 
   3.4043273906969433`*^9}, {3.4044553914289093`*^9, 3.4044553939076557`*^9}, 
   3.4044560995203576`*^9, {3.4044561637436285`*^9, 3.4044561674626403`*^9}, 
   3.4046499658526406`*^9, {3.4046505273321705`*^9, 3.404650530988491*^9}, {
   3.404650905511307*^9, 3.4046509079488535`*^9}, 3.404826822524823*^9, 
   3.4048269152471333`*^9, {3.4050035325243473`*^9, 3.405003537609947*^9}, 
   3.406469464924522*^9, 3.4064702726170735`*^9, 3.4065574422675314`*^9, {
   3.4065582697887154`*^9, 3.406558272351281*^9}, {3.4066129599269*^9, 
   3.4066129687708764`*^9}, 3.4069598932745304`*^9, 3.4069605737563453`*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["Integration Bi Dimensional", "Subsubtitle",
 CellChangeTimes->{{3.404641430673939*^9, 3.4046414450023394`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SmileBiHestonUnderlying1VanillaAux", "[", 
   RowBox[{
   "S_", ",", "\[Alpha]1_", ",", "a1_", ",", "KList_", ",", "\[Tau]_", ",", 
    "\[CapitalSigma]_", ",", "M_", ",", "\[CapitalSigma]inf_", ",", "Q_", ",",
     "\[Rho]_", ",", "\[Mu]_", ",", "\[Beta]_", ",", "\[Lambda]1_", ",", 
    "\[Lambda]2_", ",", 
    RowBox[{"{", 
     RowBox[{
     "LegendreCoef1_", ",", "LegendreCoef1n_", ",", "period1_", ",", 
      "period1n_", ",", "\[Epsilon]1_", ",", "imax_", ",", 
      "startmonitortime_", ",", "plafondexplosion_", ",", "initialTailFlag_", 
      ",", "InitialTailPosition_", ",", "InitialTailPosition2_"}], "}"}], ",",
     
    RowBox[{"{", 
     RowBox[{
     "LegendreCoef2_", ",", "period2_", ",", "period2n_", ",", "\[Epsilon]2_",
       ",", "kmax_", ",", "StartControl_", ",", "IncrementFactor_"}], "}"}], 
    ",", "printflag_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{
   FractionBox["2", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"2", "\[Pi]"}], ")"}], "2"]], 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "res", ",", "res2", ",", 
       RowBox[{"Y", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Log", "[", 
           RowBox[{"S", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
          RowBox[{"Log", "[", 
           RowBox[{"S", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "1"}], " ", "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "1"}], "]"}]}], "  ", ",", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\< S=\>\"", ",", 
           RowBox[{"S", " ", "//", " ", "MatrixForm"}], ",", 
           "\"\< \[CapitalSigma]=\>\"", ",", 
           RowBox[{"\[CapitalSigma]", " ", "//", "MatrixForm"}], ",", 
           "\"\<M=\>\"", ",", 
           RowBox[{"M", "//", "MatrixForm"}], ",", 
           "\"\< \[CapitalSigma]inf=\>\"", ",", 
           RowBox[{"\[CapitalSigma]inf", "//", "MatrixForm"}], " ", ",", 
           "\"\< Q=\>\"", ",", 
           RowBox[{"Q", "//", "MatrixForm"}], " ", ",", "\"\< \[Rho]=\>\"", 
           ",", 
           RowBox[{"\[Rho]", "//", "MatrixForm"}], ",", "\"\< \[Mu]=\>\"", 
           ",", 
           RowBox[{"\[Mu]", "//", "MatrixForm"}], ",", "\"\< \[Beta]=\>\"", 
           ",", "\[Beta]", ",", "\"\< T=\>\"", ",", "\[Tau]"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Inner Integration\>\"", ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\"\<LegendreNbMain\>\"", ",", 
                RowBox[{"Length", "[", "LegendreCoef1", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<LegendreNbIncrement\>\"", ",", 
                RowBox[{"Length", "[", "LegendreCoef1n", "]"}]}], "}"}], ",", 
              
              RowBox[{"{", 
               RowBox[{"\"\<IncrementNbMax\>\"", ",", "imax"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<InitialTailFlag\>\"", ",", "initialTailFlag"}], 
               "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<InitialTailLegendreNb\>\"", ",", 
                RowBox[{"Length", "[", "LegendreCoef2", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<PeriodMain\>\"", ",", "period1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<PeriodnIncrement\>\"", ",", "period1n"}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"\"\<StoppingLevel\>\"", ",", "\[Epsilon]1"}], "}"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"\"\<AbcisseMaxValue\>\"", ",", "kmax"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
               "\"\<InitialTailUpperLimit\>\"", ",", "InitialTailPosition"}], 
               "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
               "\"\<ExplosionMonitoringStartAbcisse\>\"", ",", 
                "StartControl"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
               "\"\<ExplosionMonitoringMaxLevel\>\"", ",", 
                "IncrementFactor"}], "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"\"\<lambda1\>\"", ",", "\[Lambda]1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<lambda2\>\"", ",", "\[Lambda]2"}], "}"}]}], "}"}],
             " ", "//", " ", "MatrixForm"}], ",", "\[IndentingNewLine]", 
           "\"\<Outer Integration\>\"", ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\"\<LegendreNbMain\>\"", ",", 
                RowBox[{"Length", "[", "LegendreCoef2", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<LegendreNbIncrement\>\"", ",", 
                RowBox[{"Length", "[", "LegendreCoef1n", "]"}]}], "}"}], ",", 
              
              RowBox[{"{", 
               RowBox[{"\"\<IncrementNbMax\>\"", ",", "imax"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<InitialTailFlag\>\"", ",", "initialTailFlag"}], 
               "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<InitialTailLegendreNb\>\"", ",", 
                RowBox[{"Length", "[", "LegendreCoef2", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<PeriodMain\>\"", ",", "period2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<PeriodnIncrement\>\"", ",", "period2n"}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"\"\<StoppingLevel\>\"", ",", "\[Epsilon]2"}], "}"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"\"\<AbcisseMaxValue\>\"", ",", "kmax"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
               "\"\<InitialTailUpperLimit\>\"", ",", "InitialTailPosition"}], 
               "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
               "\"\<GrowingControlStartAbcisse\>\"", ",", 
                "startmonitortime"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
               "\"\<GrowingControlMaxFactor\>\"", ",", "plafondexplosion"}], 
               "}"}]}], "}"}], " ", "//", " ", "MatrixForm"}]}], "]"}]}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "2"}], " ", "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "2"}], "]"}]}], "  ", ",", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<BiHestonLaplaceQuickTransform[M,Q,\[Rho], \
\[Mu],\[CapitalSigma],{-\[ImaginaryI] 1,-\[ImaginaryI] \
1},\[Beta],\[Tau]]=\>\"", ",", 
           RowBox[{"BiHestonLaplaceQuickTransform", "[", 
            RowBox[{
            "M", ",", "Q", ",", "\[Rho]", ",", " ", "\[Mu]", ",", 
             "\[CapitalSigma]", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "\[ImaginaryI]"}], " ", "1"}], ",", 
               RowBox[{
                RowBox[{"-", "\[ImaginaryI]"}], " ", "1"}]}], "}"}], ",", 
             "\[Beta]", ",", "\[Tau]"}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<integrand(0.1,0.1)=\>\"", ",", 
           RowBox[{
           "SmileSymetrizedBiHestonUnderlying1VanillaIntegrandCC", "[", 
            RowBox[{
            "Y", ",", "\[Alpha]1", ",", "a1", ",", "KList", ",", "\[Tau]", 
             ",", "\[CapitalSigma]", ",", "M", ",", "Q", ",", "\[Rho]", ",", 
             "\[Mu]", ",", "\[Beta]", ",", "\[Lambda]1", ",", "\[Lambda]2", 
             ",", "0.1", ",", "0.1"}], "]"}]}], "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "4"}], "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "4"}], "]"}]}], " ", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Plot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
              "SmileSymetrizedBiHestonUnderlying1VanillaIntegrandCC", "[", 
               RowBox[{"Y", ",", "\[Alpha]1", ",", "a1", ",", 
                RowBox[{"{", 
                 RowBox[{"KList", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", "\[Tau]", ",", 
                "\[CapitalSigma]", ",", "M", ",", "Q", ",", "\[Rho]", ",", 
                "\[Mu]", ",", "\[Beta]", ",", "\[Lambda]1", ",", "\[Lambda]2",
                 ",", "\[Omega]1", ",", "\[Omega]2"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Omega]2", ",", "0", " ", ",", 
               RowBox[{"2", "period1"}]}], "}"}], ",", 
             RowBox[{"PlotPoints", "\[Rule]", "50"}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
             RowBox[{"PlotLabel", "\[Rule]", 
              RowBox[{"\"\<U1:1st Inv. Fourier: K =\>\"", "<>", 
               RowBox[{"ToString", "[", 
                RowBox[{"KList", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", 
               "\"\< \[Omega]1=\>\"", "<>", 
               RowBox[{"ToString", "[", "\[Omega]1", "]"}]}]}]}], "]"}], ",", 
           
           RowBox[{"{", 
            RowBox[{"\[Omega]1", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.2", ",", "2"}], "}"}]}], "}"}]}], "]"}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "5"}], "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "5"}], "]"}]}], " ", ",", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<{Y,\[Alpha]1,a1,{KList[[1]]},\[Tau],\[CapitalSigma],M,Q,\[Rho],\
\[Mu],\[Beta],\[Lambda]1,\[Lambda]2}=\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"Y", ",", "\[Alpha]1", ",", "a1", ",", 
             RowBox[{"{", 
              RowBox[{"KList", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", "\[Tau]", ",", 
             "\[CapitalSigma]", ",", "M", ",", "Q", ",", "\[Rho]", ",", 
             "\[Mu]", ",", "\[Beta]", ",", "\[Lambda]1", ",", "\[Lambda]2"}], 
            "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<LegendreCoeffsFromLegendre[LegendreCoef1,0,period1]=\>\"", ",",
            
           RowBox[{"LegendreCoeffsFromLegendre", "[", 
            RowBox[{"LegendreCoef1", ",", "0", ",", "period1"}], "]"}]}], 
          "]"}], ";"}]}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Integrand over period1=\>\"", ",", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
               "SmileSymetrizedBiHestonUnderlying1VanillaIntegrandCC", "[", 
                RowBox[{"Y", ",", "\[Alpha]1", ",", "a1", ",", 
                 RowBox[{"{", 
                  RowBox[{"KList", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", "\[Tau]", ",", 
                 "\[CapitalSigma]", ",", "M", ",", "Q", ",", "\[Rho]", ",", 
                 "\[Mu]", ",", "\[Beta]", ",", "\[Lambda]1", ",", 
                 "\[Lambda]2", ",", "#", ",", "0"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ")"}], "&"}], ",", 
            RowBox[{"LegendreCoeffsFromLegendre", "[", 
             RowBox[{"LegendreCoef1", ",", "0", ",", "period1"}], "]"}]}], 
           "]"}]}], "]"}], "*)"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "6"}], "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "6"}], "]"}]}], " ", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\[Omega]2", ",", 
               RowBox[{
                RowBox[{"VectorAdaptativeIntegrateExplosionSafe", "[", 
                 RowBox[{
                  RowBox[{"Function", "[", 
                   RowBox[{"\[Omega]1", ",", 
                    RowBox[{
                    RowBox[{
                    "SmileSymetrizedBiHestonUnderlying1VanillaIntegrandCC", 
                    "[", 
                    RowBox[{"Y", ",", "\[Alpha]1", ",", "a1", ",", 
                    RowBox[{"{", 
                    RowBox[{"KList", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", "\[Tau]", ",",
                     "\[CapitalSigma]", ",", "M", ",", "Q", ",", "\[Rho]", 
                    ",", "\[Mu]", ",", "\[Beta]", ",", "\[Lambda]1", ",", 
                    "\[Lambda]2", ",", "\[Omega]1", ",", "\[Omega]2"}], "]"}],
                     "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
                  "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", ",",
                   "period1n", ",", "\[Epsilon]1", ",", "imax", ",", "1", ",",
                   "startmonitortime", ",", "plafondexplosion", ",", 
                  "initialTailFlag", ",", "InitialTailPosition"}], "]"}], "[",
                 
                RowBox[{"[", 
                 RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Omega]2", ",", "0", ",", 
               RowBox[{"2", "period2"}], ",", 
               RowBox[{"period2", "/", "30"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"Joined", "\[Rule]", "True"}], ",", 
           RowBox[{"PlotLabel", "\[Rule]", "\"\<U1:2nd Inv. Fourier:\>\""}], 
           ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "]"}]}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "7"}], "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "7"}], "]"}]}], " ", ",", 
        RowBox[{
         RowBox[{
         "Print", "[", 
          "\"\<code integ 2 : \
{i,exploded<1,Abs[increment[[1]]]>\[Epsilon],(i<imax)}\>\"", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
         "Print", "[", 
          "\"\<code integ 1 : \
{i,exploded<1,Abs[increment[[1]]]>\[Epsilon],(i<imax)}\>\"", "]"}]}]}], "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{"VectorAdaptativeIntegrateUnprotected", "[", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{"\[Omega]2", ",", 
           RowBox[{
            RowBox[{"a", "=", 
             RowBox[{"VectorAdaptativeIntegrateExplosionSafe", "[", 
              RowBox[{
               RowBox[{"Function", "[", 
                RowBox[{"\[Omega]1", ",", 
                 RowBox[{
                 "SmileSymetrizedBiHestonUnderlying1VanillaIntegrandCC", "[", 
                  
                  RowBox[{
                  "Y", ",", "\[Alpha]1", ",", "a1", ",", "KList", ",", 
                   "\[Tau]", ",", "\[CapitalSigma]", ",", "M", ",", "Q", ",", 
                   "\[Rho]", ",", "\[Mu]", ",", "\[Beta]", ",", "\[Lambda]1", 
                   ",", "\[Lambda]2", ",", "\[Omega]1", ",", "\[Omega]2"}], 
                  "]"}]}], "]"}], ",", "LegendreCoef1", ",", "LegendreCoef1n",
                ",", "period1", ",", "period1n", ",", "\[Epsilon]1", ",", 
               "imax", ",", 
               RowBox[{"Length", "[", "KList", "]"}], ",", "startmonitortime",
                ",", "plafondexplosion", ",", "initialTailFlag", ",", 
               "InitialTailPosition"}], "]"}]}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"printflag", "\[Equal]", "7"}], "||", " ", 
               RowBox[{"MemberQ", "[", 
                RowBox[{"printflag", ",", "7"}], "]"}]}], " ", ",", 
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<\[Omega]2=\>\"", ",", "\[Omega]2", ",", 
                "\"\< Integ_2=\>\"", ",", "a"}], "]"}]}], "]"}], ";", 
            RowBox[{"a", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], ",", "LegendreCoef2", 
         ",", "LegendreCoef1n", ",", "period2", ",", "period2n", ",", 
         "\[Epsilon]2", ",", "imax", ",", 
         RowBox[{"Length", "[", "KList", "]"}], ",", "printflag", ",", 
         "initialTailFlag", ",", "InitialTailPosition2", ",", "kmax", ",", 
         "StartControl", ",", "IncrementFactor"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "7"}], "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "7"}], "]"}]}], " ", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Integ_1=\>\"", ",", "res"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"res", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.3997288601267104`*^9, 3.39972890803388*^9, {3.3997289692069297`*^9, 
   3.3997289944261637`*^9}, {3.399729087443575*^9, 3.3997291578199263`*^9}, {
   3.399729214633517*^9, 3.3997292559936857`*^9}, {3.399729338917153*^9, 
   3.399729443137904*^9}, {3.3997297921289797`*^9, 3.399729801332281*^9}, 
   3.3997984631978292`*^9, 3.3997986822957864`*^9, {3.399799475623518*^9, 
   3.3997994825611515`*^9}, {3.399813039024555*^9, 3.3998130523841867`*^9}, {
   3.3998138111956306`*^9, 3.399813818523896*^9}, {3.3998138975254135`*^9, 
   3.3998139300104117`*^9}, {3.399814002074295*^9, 3.3998140680286865`*^9}, {
   3.3998141794214506`*^9, 3.399814187827862*^9}, {3.3998161633189154`*^9, 
   3.399816166818983*^9}, {3.399816989678531*^9, 3.39981701069456*^9}, {
   3.3998175772210617`*^9, 3.3998175797054844`*^9}, {3.3998177980534267`*^9, 
   3.3998178039285393`*^9}, 3.3998191717048006`*^9, {3.399819229424659*^9, 
   3.399819249925052*^9}, {3.3998192996916327`*^9, 3.3998193255202537`*^9}, {
   3.3998194002404385`*^9, 3.399819401990472*^9}, {3.399819437022394*^9, 
   3.399819443678772*^9}, {3.3998195847752314`*^9, 3.3998195956035643`*^9}, {
   3.3998937261423693`*^9, 3.3998937440645885`*^9}, {3.399894673945778*^9, 
   3.3998946780865884`*^9}, 3.399895357951172*^9, {3.3998971752360635`*^9, 
   3.399897202986596*^9}, {3.399995099817901*^9, 3.3999951242558703`*^9}, {
   3.3999951653972855`*^9, 3.3999952424143887`*^9}, {3.399995434089944*^9, 
   3.3999954559809895`*^9}, 3.400214359554536*^9, {3.4002194753715076`*^9, 
   3.4002194862310915`*^9}, {3.400221264780864*^9, 3.400221267812172*^9}, {
   3.400221324438259*^9, 3.4002213249851446`*^9}, {3.4002307045682325`*^9, 
   3.4002307106777253`*^9}, {3.4002309417446613`*^9, 
   3.4002309457603636`*^9}, {3.4002355676772275`*^9, 
   3.4002356840075865`*^9}, {3.4002357813375797`*^9, 3.400235782228222*^9}, {
   3.400238239244146*^9, 3.40023824052542*^9}, {3.4004065560321016`*^9, 
   3.400406572266788*^9}, 3.40040661272069*^9, {3.400406710910075*^9, 
   3.400406802349331*^9}, {3.4004079962316275`*^9, 3.400408003981776*^9}, {
   3.4004080367167797`*^9, 3.400408037591797*^9}, {3.400408141500042*^9, 
   3.4004081422656813`*^9}, 3.400504474791651*^9, {3.4008198209228888`*^9, 
   3.4008198369544463`*^9}, {3.401177200473509*^9, 3.401177296365975*^9}, 
   3.4011776191065464`*^9, 3.4011776885297546`*^9, {3.4011777732345057`*^9, 
   3.4011777815627904`*^9}, {3.4015301347651124`*^9, 3.401530142671514*^9}, {
   3.4015342195318975`*^9, 3.4015342774861345`*^9}, {3.4015343731285963`*^9, 
   3.4015343749255056`*^9}, {3.402033437670154*^9, 3.402033457561161*^9}, {
   3.4020334928118377`*^9, 3.402033502483898*^9}, {3.402143403333747*^9, 
   3.402143421193465*^9}, {3.402143489991661*^9, 3.40214349125731*^9}, {
   3.402143653151044*^9, 3.4021436941674557`*^9}, {3.402205803123693*^9, 
   3.402205848499564*^9}, {3.402294611715026*^9, 3.4022946131681786`*^9}, 
   3.402294775718175*^9, {3.4022949263773174`*^9, 3.4022949270960813`*^9}, 
   3.4023779225819693`*^9, 3.402388039487956*^9, 3.4023881114109564`*^9, 
   3.403871476831417*^9, 3.403871589333577*^9, {3.403871732195695*^9, 
   3.4038719361371107`*^9}, 3.40387197021589*^9, {3.4038729130621176`*^9, 
   3.403872917359075*^9}, {3.4038732665532794`*^9, 3.4038732913350053`*^9}, {
   3.40387338716497*^9, 3.403873392790078*^9}, {3.4038739059561806`*^9, 
   3.403873929300379*^9}, {3.4038757265536356`*^9, 3.403875727100521*^9}, {
   3.4038760173873444`*^9, 3.403876028450057*^9}, {3.4038767128225718`*^9, 
   3.4038767355730085`*^9}, {3.403876883685227*^9, 3.403876894872942*^9}, 
   3.4038770811577682`*^9, {3.403877262489375*^9, 3.403877296927536*^9}, {
   3.4038779003609967`*^9, 3.4038779017516484`*^9}, {3.403877950330706*^9, 
   3.403877995722203*^9}, {3.4038805669746947`*^9, 3.4038805816156006`*^9}, {
   3.403940196949411*^9, 3.403940212309081*^9}, {3.4039402503098106`*^9, 
   3.403940330483225*^9}, {3.403940565097104*^9, 3.4039406320983906`*^9}, {
   3.4039477736886315`*^9, 3.4039478349866834`*^9}, 3.403947942238743*^9, {
   3.4039479736924715`*^9, 3.403948027771635*^9}, 3.403948162852353*^9, {
   3.4039491169487963`*^9, 3.4039491206988688`*^9}, {3.4039492631391034`*^9, 
   3.4039493470938406`*^9}, {3.4039496376931696`*^9, 3.403949723882324*^9}, {
   3.4039498424783516`*^9, 3.4039499998719983`*^9}, 3.403962196184288*^9, 
   3.403962253482263*^9, {3.4041495661393347`*^9, 3.404149603407735*^9}, {
   3.4041552539579353`*^9, 3.404155264519135*^9}, {3.404197468258934*^9, 
   3.404197471821502*^9}, 3.4041980689267163`*^9, {3.404300362346734*^9, 
   3.4043004127347345`*^9}, 3.4043255380825434`*^9, {3.4043255819497433`*^9, 
   3.404325585849744*^9}, {3.4043271034385433`*^9, 3.4043271075257435`*^9}, {
   3.4043271542477436`*^9, 3.4043271966641436`*^9}, 3.4043891110643435`*^9, {
   3.4044542687729845`*^9, 3.4044543454498854`*^9}, {3.4044545226986666`*^9, 
   3.404454607659238*^9}, {3.404455052659801*^9, 3.404455080073345*^9}, {
   3.404455161108159*^9, 3.404455195249383*^9}, 3.4044669937065287`*^9, {
   3.4045602771270933`*^9, 3.4045602793771367`*^9}, {3.404650738023716*^9, 
   3.4046507705555906`*^9}, {3.404650852900922*^9, 3.4046508615260873`*^9}, {
   3.4046626139337454`*^9, 3.404662657722945*^9}, {3.404662759856145*^9, 
   3.4046627639589453`*^9}, 3.404826827728148*^9, {3.404826923934967*^9, 
   3.404826926950708*^9}, {3.404839101726823*^9, 3.4048391029612455`*^9}, {
   3.4050034867695475`*^9, 3.405003509436347*^9}, {3.405010742549548*^9, 
   3.405010747759948*^9}, {3.4051038457409725`*^9, 3.405103876691373*^9}, {
   3.405677291454795*^9, 3.4056773207522326`*^9}, {3.4056776478522625`*^9, 
   3.4056777561668425`*^9}, {3.4056779383734655`*^9, 
   3.4056779930307655`*^9}, {3.4056780244376183`*^9, 
   3.4056780920014153`*^9}, {3.4056785951517005`*^9, 
   3.4056786884191165`*^9}, {3.4056788500003433`*^9, 3.405678893407427*^9}, {
   3.405783271227378*^9, 3.40578327733687*^9}, {3.40578489299289*^9, 
   3.4057848934772744`*^9}, {3.4058344596789274`*^9, 3.40583449760153*^9}, {
   3.405934879540067*^9, 3.4059348795556927`*^9}, {3.4059354275193386`*^9, 
   3.4059354286599855`*^9}, 3.405935837933468*^9, {3.405936245597545*^9, 
   3.4059362467069416`*^9}, {3.405936557884791*^9, 3.4059366416520243`*^9}, {
   3.4059393617198734`*^9, 3.4059393886891413`*^9}, 3.4064694729872284`*^9, {
   3.40647029277384*^9, 3.406470300914673*^9}, {3.406470410026841*^9, 
   3.4064704293398356`*^9}, 3.406471547774717*^9, {3.40652772868266*^9, 
   3.406527767480529*^9}, {3.4065278254351373`*^9, 3.40652788432727*^9}, {
   3.406527973517053*^9, 3.406527981251626*^9}, {3.4065280148149853`*^9, 
   3.4065280340342274`*^9}, {3.40652807926976*^9, 3.406528125145935*^9}, {
   3.4065420425803366`*^9, 3.4065420452054043`*^9}, {3.4065433179567356`*^9, 
   3.4065433190348883`*^9}, {3.4065548613889627`*^9, 
   3.4065548624202394`*^9}, {3.4065574509865046`*^9, 
   3.4065574543459663`*^9}, {3.40655797190609*^9, 3.406557972406103*^9}, {
   3.406558277351409*^9, 3.4065582793045845`*^9}, {3.4065598990335484`*^9, 
   3.4065600034580965`*^9}, 3.406561784316185*^9, {3.406611326431959*^9, 
   3.4066113286195145`*^9}, 3.4066121731411343`*^9, {3.406959479750966*^9, 
   3.4069594807822356`*^9}, 3.406959801491518*^9, 3.4069640386353693`*^9, {
   3.4069640741048007`*^9, 3.40696410765232*^9}, {3.4069684951115575`*^9, 
   3.4069685567221155`*^9}, {3.4069733525329432`*^9, 3.406973392424334*^9}, 
   3.408205667505*^9, {3.4082105892842073`*^9, 3.408210589859207*^9}, {
   3.4084255555605354`*^9, 3.4084255570293136`*^9}, {3.4084256102647104`*^9, 
   3.408425643359096*^9}, {3.4084256767659874`*^9, 3.4084257112510242`*^9}, {
   3.408425793065095*^9, 3.408425871754106*^9}, 3.4084259037234697`*^9, {
   3.408425938208507*^9, 3.4084259673028154`*^9}, {3.4084260155849924`*^9, 
   3.4084260423355064`*^9}, {3.408426085883217*^9, 3.408426110289936*^9}, {
   3.408429428697398*^9, 3.408429429275534*^9}, {3.4084297500941935`*^9, 
   3.408429750625454*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SmileBiHestonUnderlying1VanillaAux2", "[", 
   RowBox[{
   "S_", ",", "\[Alpha]1_", ",", "a1_", ",", "KList_", ",", "\[Tau]_", ",", 
    "\[CapitalSigma]_", ",", "M_", ",", "\[CapitalSigma]inf_", ",", "Q_", ",",
     "\[Rho]_", ",", "\[Mu]_", ",", "\[Beta]m_", ",", "\[Lambda]1_", ",", 
    "\[Lambda]2_", ",", 
    RowBox[{"{", 
     RowBox[{
     "LegendreCoef1_", ",", "LegendreCoef1n_", ",", "period1_", ",", 
      "period1n_", ",", "\[Epsilon]1_", ",", "imax_", ",", 
      "startmonitortime_", ",", "plafondexplosion_", ",", "initialTailFlag_", 
      ",", "InitialTailPosition_", ",", "InitialTailPosition2_"}], "}"}], ",",
     
    RowBox[{"{", 
     RowBox[{
     "LegendreCoef2_", ",", "period2_", ",", "period2n_", ",", "\[Epsilon]2_",
       ",", "kmax_", ",", "StartControl_", ",", "IncrementFactor_"}], "}"}], 
    ",", "printflag_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{
   FractionBox["2", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"2", "\[Pi]"}], ")"}], "2"]], 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "res", ",", "res2", ",", 
       RowBox[{"Y", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Log", "[", 
           RowBox[{"S", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
          RowBox[{"Log", "[", 
           RowBox[{"S", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "1"}], " ", "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "1"}], "]"}]}], "  ", ",", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\< S=\>\"", ",", 
           RowBox[{"S", " ", "//", " ", "MatrixForm"}], ",", 
           "\"\< \[CapitalSigma]=\>\"", ",", 
           RowBox[{"\[CapitalSigma]", " ", "//", "MatrixForm"}], ",", 
           "\"\<M=\>\"", ",", 
           RowBox[{"M", "//", "MatrixForm"}], ",", 
           "\"\< \[CapitalSigma]inf=\>\"", ",", 
           RowBox[{"\[CapitalSigma]inf", "//", "MatrixForm"}], " ", ",", 
           "\"\< Q=\>\"", ",", 
           RowBox[{"Q", "//", "MatrixForm"}], " ", ",", "\"\< \[Rho]=\>\"", 
           ",", 
           RowBox[{"\[Rho]", "//", "MatrixForm"}], ",", "\"\< \[Mu]=\>\"", 
           ",", 
           RowBox[{"\[Mu]", "//", "MatrixForm"}], ",", "\"\< \[Beta]m=\>\"", 
           ",", 
           RowBox[{"\[Beta]m", " ", "//", "MatrixForm"}], ",", "\"\< T=\>\"", 
           ",", "\[Tau]"}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Inner Integration\>\"", ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\"\<LegendreNbMain\>\"", ",", 
                RowBox[{"Length", "[", "LegendreCoef1", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<LegendreNbIncrement\>\"", ",", 
                RowBox[{"Length", "[", "LegendreCoef1n", "]"}]}], "}"}], ",", 
              
              RowBox[{"{", 
               RowBox[{"\"\<IncrementNbMax\>\"", ",", "imax"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<InitialTailFlag\>\"", ",", "initialTailFlag"}], 
               "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<InitialTailLegendreNb\>\"", ",", 
                RowBox[{"Length", "[", "LegendreCoef2", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<PeriodMain\>\"", ",", "period1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<PeriodnIncrement\>\"", ",", "period1n"}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"\"\<StoppingLevel\>\"", ",", "\[Epsilon]1"}], "}"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"\"\<AbcisseMaxValue\>\"", ",", "kmax"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
               "\"\<InitialTailUpperLimit\>\"", ",", "InitialTailPosition"}], 
               "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
               "\"\<ExplosionMonitoringStartAbcisse\>\"", ",", 
                "StartControl"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
               "\"\<ExplosionMonitoringMaxLevel\>\"", ",", 
                "IncrementFactor"}], "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"\"\<lambda1\>\"", ",", "\[Lambda]1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<lambda2\>\"", ",", "\[Lambda]2"}], "}"}]}], "}"}],
             " ", "//", " ", "MatrixForm"}], ",", "\[IndentingNewLine]", 
           "\"\<Outer Integration\>\"", ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\"\<LegendreNbMain\>\"", ",", 
                RowBox[{"Length", "[", "LegendreCoef2", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<LegendreNbIncrement\>\"", ",", 
                RowBox[{"Length", "[", "LegendreCoef1n", "]"}]}], "}"}], ",", 
              
              RowBox[{"{", 
               RowBox[{"\"\<IncrementNbMax\>\"", ",", "imax"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<InitialTailFlag\>\"", ",", "initialTailFlag"}], 
               "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<InitialTailLegendreNb\>\"", ",", 
                RowBox[{"Length", "[", "LegendreCoef1", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<PeriodMain\>\"", ",", "period2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<PeriodnIncrement\>\"", ",", "period2n"}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"\"\<StoppingLevel\>\"", ",", "\[Epsilon]2"}], "}"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"\"\<AbcisseMaxValue\>\"", ",", "kmax"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
               "\"\<InitialTailUpperLimit\>\"", ",", "InitialTailPosition"}], 
               "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
               "\"\<GrowingControlStartAbcisse\>\"", ",", 
                "startmonitortime"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
               "\"\<GrowingControlMaxFactor\>\"", ",", "plafondexplosion"}], 
               "}"}]}], "}"}], " ", "//", " ", "MatrixForm"}]}], "]"}]}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "1"}], " ", "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "1"}], "]"}]}], "  ", ",", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<BiHestonLaplaceQuickTransform2[M,Q,\[Rho], \[Mu],\
\[CapitalSigma],{-\[ImaginaryI] 1,-\[ImaginaryI] 1},\[Beta]m,\[Tau]]=\>\"", 
           ",", 
           RowBox[{"BiHestonLaplaceQuickTransform2", "[", 
            RowBox[{
            "M", ",", "Q", ",", "\[Rho]", ",", " ", "\[Mu]", ",", 
             "\[CapitalSigma]", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "\[ImaginaryI]"}], " ", "1"}], ",", 
               RowBox[{
                RowBox[{"-", "\[ImaginaryI]"}], " ", "1"}]}], "}"}], ",", 
             "\[Beta]m", ",", "\[Tau]"}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<integrand(0.1,0.1)=\>\"", ",", 
           RowBox[{
           "SmileSymetrizedBiHestonUnderlying1VanillaIntegrand2CC", "[", 
            RowBox[{
            "Y", ",", "\[Alpha]1", ",", "a1", ",", "KList", ",", "\[Tau]", 
             ",", "\[CapitalSigma]", ",", "M", ",", "Q", ",", "\[Rho]", ",", 
             "\[Mu]", ",", "\[Beta]m", ",", "\[Lambda]1", ",", "\[Lambda]2", 
             ",", "0.1", ",", "0.1"}], "]"}]}], "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "4"}], "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "4"}], "]"}]}], " ", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Plot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
              "SmileSymetrizedBiHestonUnderlying1VanillaIntegrand2CC", "[", 
               RowBox[{"Y", ",", "\[Alpha]1", ",", "a1", ",", 
                RowBox[{"{", 
                 RowBox[{"KList", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", "\[Tau]", ",", 
                "\[CapitalSigma]", ",", "M", ",", "Q", ",", "\[Rho]", ",", 
                "\[Beta]m", ",", "\[Lambda]1", ",", "\[Lambda]2", ",", 
                "\[Omega]1", ",", "\[Omega]2"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Omega]2", ",", "0", " ", ",", 
               RowBox[{"2", "period1"}]}], "}"}], ",", 
             RowBox[{"PlotPoints", "\[Rule]", "50"}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
             RowBox[{"PlotLabel", "\[Rule]", 
              RowBox[{"\"\<1st Inverse Fourier: K =\>\"", "<>", 
               RowBox[{"ToString", "[", 
                RowBox[{"KList", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", 
               "\"\< \[Omega]1=\>\"", "<>", 
               RowBox[{"ToString", "[", "\[Omega]1", "]"}]}]}]}], "]"}], ",", 
           
           RowBox[{"{", 
            RowBox[{"\[Omega]1", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.2", ",", "2"}], "}"}]}], "}"}]}], "]"}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "6"}], "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "6"}], "]"}]}], " ", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\[Omega]2", ",", 
               RowBox[{
                RowBox[{"VectorAdaptativeIntegrateExplosionSafe", "[", 
                 RowBox[{
                  RowBox[{"Function", "[", 
                   RowBox[{"\[Omega]1", ",", 
                    RowBox[{
                    RowBox[{
                    "SmileSymetrizedBiHestonUnderlying1VanillaIntegrand2CC", 
                    "[", 
                    RowBox[{"Y", ",", "\[Alpha]1", ",", "a1", ",", 
                    RowBox[{"{", 
                    RowBox[{"KList", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", "\[Tau]", ",",
                     "\[CapitalSigma]", ",", "M", ",", "Q", ",", "\[Rho]", 
                    ",", "\[Mu]", ",", "\[Beta]m", ",", "\[Lambda]1", ",", 
                    "\[Lambda]2", ",", "\[Omega]1", ",", "\[Omega]2"}], "]"}],
                     "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
                  "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", ",",
                   "period1n", ",", "\[Epsilon]1", ",", "imax", ",", "1", ",",
                   "startmonitortime", ",", "plafondexplosion", ",", 
                  "initialTailFlag", ",", "InitialTailPosition"}], "]"}], "[",
                 
                RowBox[{"[", 
                 RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Omega]2", ",", "0", ",", "period2", ",", 
               RowBox[{"period2", "/", "30"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"Joined", "\[Rule]", "True"}], ",", 
           RowBox[{"PlotLabel", "\[Rule]", "\"\<2nd Inverse Fourier:\>\""}]}],
           "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "7"}], "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "7"}], "]"}]}], " ", ",", 
        RowBox[{
         RowBox[{
         "Print", "[", 
          "\"\<code integ 2 : \
{i,exploded<1,Abs[increment[[1]]]>\[Epsilon],(i<imax)}\>\"", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
         "Print", "[", 
          "\"\<code integ 1 : \
{i,exploded<1,Abs[increment[[1]]]>\[Epsilon],(i<imax)}\>\"", "]"}]}]}], "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{"VectorAdaptativeIntegrateUnprotected", "[", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{"\[Omega]2", ",", 
           RowBox[{
            RowBox[{"a", "=", 
             RowBox[{"VectorAdaptativeIntegrateExplosionSafe", "[", 
              RowBox[{
               RowBox[{"Function", "[", 
                RowBox[{"\[Omega]1", ",", 
                 RowBox[{
                 "SmileSymetrizedBiHestonUnderlying1VanillaIntegrand2CC", "[",
                   
                  RowBox[{
                  "Y", ",", "\[Alpha]1", ",", "a1", ",", "KList", ",", 
                   "\[Tau]", ",", "\[CapitalSigma]", ",", "M", ",", "Q", ",", 
                   "\[Rho]", ",", "\[Mu]", ",", "\[Beta]m", ",", "\[Lambda]1",
                    ",", "\[Lambda]2", ",", "\[Omega]1", ",", "\[Omega]2"}], 
                  "]"}]}], "]"}], ",", "LegendreCoef1", ",", "LegendreCoef1n",
                ",", "period1", ",", "period1n", ",", "\[Epsilon]1", ",", 
               "imax", ",", 
               RowBox[{"Length", "[", "KList", "]"}], ",", "startmonitortime",
                ",", "plafondexplosion", ",", "initialTailFlag", ",", 
               "InitialTailPosition"}], "]"}]}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"printflag", "\[Equal]", "7"}], "||", " ", 
               RowBox[{"MemberQ", "[", 
                RowBox[{"printflag", ",", "7"}], "]"}]}], " ", ",", 
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<\[Omega]2=\>\"", ",", "\[Omega]2", ",", 
                "\"\< Integ_2=\>\"", ",", "a"}], "]"}]}], "]"}], ";", 
            RowBox[{"a", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], ",", "LegendreCoef2", 
         ",", "LegendreCoef1n", ",", "period2", ",", "period2n", ",", 
         "\[Epsilon]2", ",", "imax", ",", 
         RowBox[{"Length", "[", "KList", "]"}], ",", "printflag", ",", 
         "initialTailFlag", ",", "InitialTailPosition2", ",", "kmax", ",", 
         "StartControl", ",", "IncrementFactor"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "7"}], "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "7"}], "]"}]}], " ", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Integ_1=\>\"", ",", "res"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"res", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.3997288601267104`*^9, 3.39972890803388*^9, {3.3997289692069297`*^9, 
   3.3997289944261637`*^9}, {3.399729087443575*^9, 3.3997291578199263`*^9}, {
   3.399729214633517*^9, 3.3997292559936857`*^9}, {3.399729338917153*^9, 
   3.399729443137904*^9}, {3.3997297921289797`*^9, 3.399729801332281*^9}, 
   3.3997984631978292`*^9, 3.3997986822957864`*^9, {3.399799475623518*^9, 
   3.3997994825611515`*^9}, {3.399813039024555*^9, 3.3998130523841867`*^9}, {
   3.3998138111956306`*^9, 3.399813818523896*^9}, {3.3998138975254135`*^9, 
   3.3998139300104117`*^9}, {3.399814002074295*^9, 3.3998140680286865`*^9}, {
   3.3998141794214506`*^9, 3.399814187827862*^9}, {3.3998161633189154`*^9, 
   3.399816166818983*^9}, {3.399816989678531*^9, 3.39981701069456*^9}, {
   3.3998175772210617`*^9, 3.3998175797054844`*^9}, {3.3998177980534267`*^9, 
   3.3998178039285393`*^9}, 3.3998191717048006`*^9, {3.399819229424659*^9, 
   3.399819249925052*^9}, {3.3998192996916327`*^9, 3.3998193255202537`*^9}, {
   3.3998194002404385`*^9, 3.399819401990472*^9}, {3.399819437022394*^9, 
   3.399819443678772*^9}, {3.3998195847752314`*^9, 3.3998195956035643`*^9}, {
   3.3998937261423693`*^9, 3.3998937440645885`*^9}, {3.399894673945778*^9, 
   3.3998946780865884`*^9}, 3.399895357951172*^9, {3.3998971752360635`*^9, 
   3.399897202986596*^9}, {3.399995099817901*^9, 3.3999951242558703`*^9}, {
   3.3999951653972855`*^9, 3.3999952424143887`*^9}, {3.399995434089944*^9, 
   3.3999954559809895`*^9}, 3.400214359554536*^9, {3.4002194753715076`*^9, 
   3.4002194862310915`*^9}, {3.400221264780864*^9, 3.400221267812172*^9}, {
   3.400221324438259*^9, 3.4002213249851446`*^9}, {3.4002307045682325`*^9, 
   3.4002307106777253`*^9}, {3.4002309417446613`*^9, 
   3.4002309457603636`*^9}, {3.4002355676772275`*^9, 
   3.4002356840075865`*^9}, {3.4002357813375797`*^9, 3.400235782228222*^9}, {
   3.400238239244146*^9, 3.40023824052542*^9}, {3.4004065560321016`*^9, 
   3.400406572266788*^9}, 3.40040661272069*^9, {3.400406710910075*^9, 
   3.400406802349331*^9}, {3.4004079962316275`*^9, 3.400408003981776*^9}, {
   3.4004080367167797`*^9, 3.400408037591797*^9}, {3.400408141500042*^9, 
   3.4004081422656813`*^9}, 3.400504474791651*^9, {3.4008198209228888`*^9, 
   3.4008198369544463`*^9}, {3.401177200473509*^9, 3.401177296365975*^9}, 
   3.4011776191065464`*^9, 3.4011776885297546`*^9, {3.4011777732345057`*^9, 
   3.4011777815627904`*^9}, {3.4015301347651124`*^9, 3.401530142671514*^9}, {
   3.4015342195318975`*^9, 3.4015342774861345`*^9}, {3.4015343731285963`*^9, 
   3.4015343749255056`*^9}, {3.402033437670154*^9, 3.402033457561161*^9}, {
   3.4020334928118377`*^9, 3.402033502483898*^9}, {3.402143403333747*^9, 
   3.402143421193465*^9}, {3.402143489991661*^9, 3.40214349125731*^9}, {
   3.402143653151044*^9, 3.4021436941674557`*^9}, {3.402205803123693*^9, 
   3.402205848499564*^9}, {3.402294611715026*^9, 3.4022946131681786`*^9}, 
   3.402294775718175*^9, {3.4022949263773174`*^9, 3.4022949270960813`*^9}, 
   3.4023779225819693`*^9, 3.402388039487956*^9, 3.4023881114109564`*^9, 
   3.403871476831417*^9, 3.403871589333577*^9, {3.403871732195695*^9, 
   3.4038719361371107`*^9}, 3.40387197021589*^9, {3.4038729130621176`*^9, 
   3.403872917359075*^9}, {3.4038732665532794`*^9, 3.4038732913350053`*^9}, {
   3.40387338716497*^9, 3.403873392790078*^9}, {3.4038739059561806`*^9, 
   3.403873929300379*^9}, {3.4038757265536356`*^9, 3.403875727100521*^9}, {
   3.4038760173873444`*^9, 3.403876028450057*^9}, {3.4038767128225718`*^9, 
   3.4038767355730085`*^9}, {3.403876883685227*^9, 3.403876894872942*^9}, 
   3.4038770811577682`*^9, {3.403877262489375*^9, 3.403877296927536*^9}, {
   3.4038779003609967`*^9, 3.4038779017516484`*^9}, {3.403877950330706*^9, 
   3.403877995722203*^9}, {3.4038805669746947`*^9, 3.4038805816156006`*^9}, {
   3.403940196949411*^9, 3.403940212309081*^9}, {3.4039402503098106`*^9, 
   3.403940330483225*^9}, {3.403940565097104*^9, 3.4039406320983906`*^9}, {
   3.4039477736886315`*^9, 3.4039478349866834`*^9}, 3.403947942238743*^9, {
   3.4039479736924715`*^9, 3.403948027771635*^9}, 3.403948162852353*^9, {
   3.4039491169487963`*^9, 3.4039491206988688`*^9}, {3.4039492631391034`*^9, 
   3.4039493470938406`*^9}, {3.4039496376931696`*^9, 3.403949723882324*^9}, {
   3.4039498424783516`*^9, 3.4039499998719983`*^9}, 3.403962196184288*^9, 
   3.403962253482263*^9, {3.4041495661393347`*^9, 3.404149603407735*^9}, {
   3.4041552539579353`*^9, 3.404155264519135*^9}, {3.404197468258934*^9, 
   3.404197471821502*^9}, 3.4041980689267163`*^9, {3.404300362346734*^9, 
   3.4043004127347345`*^9}, 3.4043255380825434`*^9, {3.4043255819497433`*^9, 
   3.404325585849744*^9}, {3.4043271034385433`*^9, 3.4043271075257435`*^9}, {
   3.4043271542477436`*^9, 3.4043271966641436`*^9}, {3.4043274203057437`*^9, 
   3.4043274586505437`*^9}, {3.404453192704331*^9, 3.4044532813365474`*^9}, {
   3.4044540769120183`*^9, 3.404454089315847*^9}, {3.404454135598143*^9, 
   3.4044541796335344`*^9}, 3.404454230253804*^9, {3.404454629314625*^9, 
   3.404454629486991*^9}, {3.4044546714031706`*^9, 3.4044547047950883`*^9}, {
   3.404455137623011*^9, 3.404455143600165*^9}, {3.404455203698946*^9, 
   3.4044552153443775`*^9}, 3.404466982034878*^9, 3.404650744008206*^9, {
   3.4046507867121506`*^9, 3.4046507973373547`*^9}, {3.404650837744381*^9, 
   3.404650845244525*^9}, {3.404662679687745*^9, 3.404662733367345*^9}, 
   3.4048268321033163`*^9, {3.4048269413106346`*^9, 3.404826942920071*^9}, {
   3.405003433183547*^9, 3.405003467222747*^9}, {3.4050107262163477`*^9, 
   3.405010732050748*^9}, {3.4051458245158963`*^9, 3.405145824922157*^9}, {
   3.4059348795713177`*^9, 3.4059348796025686`*^9}, {3.405934959744732*^9, 
   3.405934968651153*^9}, {3.40593507445006*^9, 3.4059350763250957`*^9}, 
   3.405935655320587*^9, {3.4059362576446514`*^9, 3.405936259035303*^9}, {
   3.405936652730362*^9, 3.4059366576367064`*^9}, 3.405936700496904*^9, {
   3.405939398408078*^9, 3.40593939876746*^9}, 3.4064694916283307`*^9, {
   3.406470311118059*^9, 3.406470328196621*^9}, {3.4064703605255737`*^9, 
   3.4064703643381715`*^9}, 3.406471543258976*^9, {3.4065296000586915`*^9, 
   3.406529641731633*^9}, {3.406542053940003*^9, 3.4065420560650573`*^9}, {
   3.4065433252694225`*^9, 3.4065433268788395`*^9}, {3.406554867248488*^9, 
   3.4065548681860123`*^9}, {3.406557467471302*^9, 3.406557470799512*^9}, {
   3.406557965109041*^9, 3.406557965577803*^9}, {3.4065582958675084`*^9, 
   3.406558298242569*^9}, 3.4065618811467896`*^9, 3.4066113509325857`*^9, 
   3.4066121594376583`*^9, 3.406959496157531*^9, 3.4069597965226727`*^9, 
   3.406968582863242*^9, 3.406973423424929*^9, {3.408427507691766*^9, 
   3.408427532614119*^9}, {3.4084295144646697`*^9, 3.4084295150428057`*^9}, {
   3.4084297403752575`*^9, 3.4084297415002785`*^9}, {3.4084461858785048`*^9, 
   3.408446191409861*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Integrands", "Subsubtitle",
 CellChangeTimes->{{3.404631476967207*^9, 3.4046314788891187`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SmileSymetrizedBiHestonUnderlying1VanillaIntegrand", "[", 
    RowBox[{
    "Y_", ",", "\[Alpha]1_", ",", "a_", ",", "KList_", ",", "\[Tau]_", ",", 
     "\[CapitalSigma]_", ",", "M_", ",", "Q_", ",", "\[Rho]_", ",", "\[Mu]_", 
     ",", "\[Beta]_", ",", "\[Lambda]1_", ",", "\[Lambda]2_", ",", 
     "\[Omega]1_", ",", "\[Omega]2_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x1", "=", 
        RowBox[{"Y", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", 
       RowBox[{"x2", "=", 
        RowBox[{"Y", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ",", 
       RowBox[{"k1", "=", 
        RowBox[{"(", 
         RowBox[{"\[Omega]1", "+", 
          RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1"}]}], ")"}]}], ",", 
       RowBox[{"Sk1", "=", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "\[Omega]1"}], "+", 
          RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1"}]}], ")"}]}], ",", 
       RowBox[{"k2", "=", " ", 
        RowBox[{"(", 
         RowBox[{"\[Omega]2", "+", 
          RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2"}]}], ")"}]}], ",", 
       RowBox[{"Sk2", "=", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "\[Omega]2"}], "+", 
          RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2"}]}], ")"}]}], ",", 
       RowBox[{"Sk1A", "=", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "\[Omega]1"}], "+", 
          RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1"}]}], ")"}]}], ",", 
       RowBox[{"k1A", "=", 
        RowBox[{"(", 
         RowBox[{"\[Omega]1", "-", 
          RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1"}]}], ")"}]}], ",", 
       RowBox[{"k2A", "=", 
        RowBox[{"(", 
         RowBox[{"\[Omega]2", "-", 
          RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2"}]}], ")"}]}], ",", 
       "\[Alpha]", ",", "\[Alpha]A", ",", "Sym\[Alpha]", ",", "Sym\[Alpha]A", 
       ",", "\[Alpha]2", ",", "\[Alpha]A2", ",", "Sym\[Alpha]2", ",", 
       "Sym\[Alpha]A2", ",", "propagatorDroit", ",", "SympropagatorDroit", 
       ",", "propagatorGauche", ",", "SympropagatorGauche", ",", 
       "propagatorDroit2", ",", "SympropagatorDroit2", ",", 
       "propagatorGauche2", ",", "SympropagatorGauche2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Re", "[", 
      RowBox[{
       RowBox[{"\[Alpha]", "=", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", "x1", " ", "k1"}], "-", 
          RowBox[{"\[ImaginaryI]", " ", "x2", " ", "k2"}]}]]}], ";", 
       RowBox[{"\[Alpha]A", "=", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", "x1", " ", "k1"}], "-", 
          RowBox[{"\[ImaginaryI]", " ", "x2", " ", "k2A"}]}]]}], ";", 
       RowBox[{"Sym\[Alpha]", "=", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", "x1", " ", "Sk1"}], "-", 
          RowBox[{"\[ImaginaryI]", " ", "x2", " ", "k2"}]}]]}], ";", 
       RowBox[{"Sym\[Alpha]A", "=", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", "x1", " ", "Sk1A"}], "-", 
          RowBox[{"\[ImaginaryI]", " ", "x2", " ", "k2A"}]}]]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"propagatorDroit", "=", 
        RowBox[{"BiHestonLaplaceQuickTransform", "[", 
         RowBox[{
         "M", ",", "Q", ",", "\[Rho]", ",", " ", "\[Mu]", ",", 
          "\[CapitalSigma]", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], " ", "k1"}], ",", 
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], " ", "k2"}]}], "}"}], ",", 
          "\[Beta]", ",", "\[Tau]"}], "]"}]}], ";", 
       RowBox[{"SympropagatorDroit", "=", 
        RowBox[{"BiHestonLaplaceQuickTransform", "[", 
         RowBox[{
         "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", " ", 
          "\[CapitalSigma]", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], " ", "Sk1"}], ",", 
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], " ", "k2"}]}], "}"}], ",", 
          "\[Beta]", ",", "\[Tau]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"propagatorGauche", "=", 
        RowBox[{"BiHestonLaplaceQuickTransform", "[", 
         RowBox[{
         "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", " ", 
          "\[CapitalSigma]", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], " ", "k1"}], ",", 
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], " ", "k2A"}]}], "}"}], ",", 
          "\[Beta]", ",", "\[Tau]"}], "]"}]}], ";", 
       RowBox[{"SympropagatorGauche", "=", 
        RowBox[{"BiHestonLaplaceQuickTransform", "[", 
         RowBox[{
         "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", " ", 
          "\[CapitalSigma]", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], " ", "Sk1A"}], ",", 
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], " ", "k2A"}]}], "}"}], ",", 
          "\[Beta]", ",", "\[Tau]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Alpha]", " ", "propagatorDroit", " ", 
           RowBox[{"FirstUnderlyingVanillaPayOffFourierDroite", "[", 
            RowBox[{"k1", ",", "k2", ",", 
             RowBox[{"KList", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "\[Alpha]1", ",", "a"}], 
            "]"}]}], "+", "\[IndentingNewLine]", 
          RowBox[{"Sym\[Alpha]", " ", "SympropagatorDroit", " ", 
           RowBox[{"FirstUnderlyingVanillaPayOffFourierDroite", "[", 
            RowBox[{"Sk1", ",", "k2", ",", 
             RowBox[{"KList", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "\[Alpha]1", ",", "a"}], 
            "]"}]}], "+", "\[IndentingNewLine]", 
          RowBox[{"\[Alpha]A", " ", "propagatorGauche", " ", 
           RowBox[{"FirstUnderlyingVanillaPayOffFourierGauche", "[", 
            RowBox[{"k1", ",", "k2A", ",", 
             RowBox[{"KList", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "\[Alpha]1", ",", "a"}], 
            "]"}]}], "+", "\[IndentingNewLine]", 
          RowBox[{"Sym\[Alpha]A", " ", "SympropagatorGauche", " ", 
           RowBox[{"FirstUnderlyingVanillaPayOffFourierGauche", "[", 
            RowBox[{"Sk1A", ",", "k2A", ",", 
             RowBox[{"KList", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "\[Alpha]1", ",", "a"}], 
            "]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "KList", "]"}]}], "}"}]}], "]"}]}], "]"}]}],
     "]"}]}], "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.402140085770051*^9, 3.4021400863013115`*^9}, {
   3.4021401238489075`*^9, 3.4021402363666925`*^9}, {3.402140267929798*^9, 
   3.402140316290102*^9}, {3.4021403621347322`*^9, 3.4021403798069468`*^9}, {
   3.402140442948784*^9, 3.4021404698243*^9}, {3.40214052530974*^9, 
   3.4021405261847568`*^9}, {3.402140572076263*^9, 3.4021405730294065`*^9}, {
   3.40214283290092*^9, 3.402142834900958*^9}, 3.402142878995555*^9, {
   3.4021429531532288`*^9, 3.40214297455989*^9}, {3.4021430512488623`*^9, 
   3.4021430865307894`*^9}, {3.402143143625636*^9, 3.4021431463288126`*^9}, {
   3.402143222267771*^9, 3.402143365629898*^9}, {3.4021439797510643`*^9, 
   3.4021440141579747`*^9}, {3.4021444783543873`*^9, 
   3.4021445164332433`*^9}, {3.4021445469025784`*^9, 3.402144574918741*^9}, {
   3.4021446846239724`*^9, 3.4021446895459423`*^9}, {3.4021447226559525`*^9, 
   3.402144729593586*^9}, {3.402144860127342*^9, 3.402144926378614*^9}, {
   3.4021449572542067`*^9, 3.402145180727247*^9}, {3.402149153412896*^9, 
   3.4021491595067635`*^9}, {3.4021496964233217`*^9, 3.402149821410097*^9}, {
   3.40214987416111*^9, 3.402149884755063*^9}, {3.4021499394279876`*^9, 
   3.4021499498344374`*^9}, {3.402150065133526*^9, 3.402150121790864*^9}, {
   3.4021501655260787`*^9, 3.4021502014486437`*^9}, {3.402150388827241*^9, 
   3.4021504643911915`*^9}, {3.4021505016731577`*^9, 3.402150539877016*^9}, {
   3.402150576221464*^9, 3.4021506145190744`*^9}, 3.402150646160307*^9, {
   3.4021507013801165`*^9, 3.402150701614496*^9}, {3.402150792022482*^9, 
   3.4021508226011944`*^9}, {3.4022048852154446`*^9, 
   3.4022049314194565`*^9}, {3.402223441649846*^9, 3.4022234739004655`*^9}, {
   3.4022235664178667`*^9, 3.4022235977934694`*^9}, {3.402225770632062*^9, 
   3.4022257810853877`*^9}, {3.4022260066522183`*^9, 
   3.4022260340902452`*^9}, {3.402227989127781*^9, 3.4022280025967894`*^9}, 
   3.4022280710668545`*^9, {3.4022281624279833`*^9, 3.4022281629904943`*^9}, {
   3.4023193135668306`*^9, 3.4023194603141108`*^9}, {3.402319603150462*^9, 
   3.40231966787294*^9}, {3.4023197252970443`*^9, 3.4023197324378977`*^9}, {
   3.4023205583495092`*^9, 3.4023206749454975`*^9}, {3.4023207399779963`*^9, 
   3.4023207413373976`*^9}, {3.4023208249015017`*^9, 
   3.4023209920765867`*^9}, {3.4023211800958214`*^9, 3.40232123755005*^9}, {
   3.4023216909806304`*^9, 3.4023216975588818`*^9}, {3.402321742184738*^9, 
   3.4023217427316236`*^9}, {3.4023247260232773`*^9, 
   3.4023248331659594`*^9}, {3.4023253919266872`*^9, 
   3.4023255075695324`*^9}, {3.40237831846457*^9, 3.4023783246678143`*^9}, {
   3.403961973148756*^9, 3.4039620282435637`*^9}, {3.4039620755257215`*^9, 
   3.403962089885372*^9}, 3.4041951327140923`*^9, {3.4041952182469845`*^9, 
   3.404195247966305*^9}, {3.4043004279447346`*^9, 3.4043004361659346`*^9}, {
   3.404453038451704*^9, 3.4044531263552675`*^9}, {3.4044565137408104`*^9, 
   3.404456514443904*^9}, {3.4046512370645475`*^9, 3.404651273612124*^9}, 
   3.4048268364472327`*^9, {3.404826954295508*^9, 3.4048269601082315`*^9}, {
   3.4050033932631474`*^9, 3.4050034180827475`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SmileSymetrizedBiHestonUnderlying1VanillaIntegrand2", "[", 
    RowBox[{
    "Y_", ",", "\[Alpha]1_", ",", "a_", ",", "KList_", ",", "\[Tau]_", ",", 
     "\[CapitalSigma]_", ",", "M_", ",", "Q_", ",", "\[Rho]_", ",", "\[Mu]_", 
     ",", "\[Beta]m_", ",", "\[Lambda]1_", ",", "\[Lambda]2_", ",", 
     "\[Omega]1_", ",", "\[Omega]2_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x1", "=", 
        RowBox[{"Y", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", 
       RowBox[{"x2", "=", 
        RowBox[{"Y", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ",", 
       RowBox[{"k1", "=", 
        RowBox[{"(", 
         RowBox[{"\[Omega]1", "+", 
          RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1"}]}], ")"}]}], ",", 
       RowBox[{"Sk1", "=", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "\[Omega]1"}], "+", 
          RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1"}]}], ")"}]}], ",", 
       RowBox[{"k2", "=", " ", 
        RowBox[{"(", 
         RowBox[{"\[Omega]2", "+", 
          RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2"}]}], ")"}]}], ",", 
       RowBox[{"Sk2", "=", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "\[Omega]2"}], "+", 
          RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2"}]}], ")"}]}], ",", 
       RowBox[{"Sk1A", "=", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "\[Omega]1"}], "+", 
          RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1"}]}], ")"}]}], ",", 
       RowBox[{"k1A", "=", 
        RowBox[{"(", 
         RowBox[{"\[Omega]1", "-", 
          RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1"}]}], ")"}]}], ",", 
       RowBox[{"k2A", "=", 
        RowBox[{"(", 
         RowBox[{"\[Omega]2", "-", 
          RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2"}]}], ")"}]}], ",", 
       "\[Alpha]", ",", "\[Alpha]A", ",", "Sym\[Alpha]", ",", "Sym\[Alpha]A", 
       ",", "\[Alpha]2", ",", "\[Alpha]A2", ",", "Sym\[Alpha]2", ",", 
       "Sym\[Alpha]A2", ",", "propagatorDroit", ",", "SympropagatorDroit", 
       ",", "propagatorGauche", ",", "SympropagatorGauche", ",", 
       "propagatorDroit2", ",", "SympropagatorDroit2", ",", 
       "propagatorGauche2", ",", "SympropagatorGauche2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Re", "[", 
      RowBox[{
       RowBox[{"\[Alpha]", "=", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", "x1", " ", "k1"}], "-", 
          RowBox[{"\[ImaginaryI]", " ", "x2", " ", "k2"}]}]]}], ";", 
       RowBox[{"\[Alpha]A", "=", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", "x1", " ", "k1"}], "-", 
          RowBox[{"\[ImaginaryI]", " ", "x2", " ", "k2A"}]}]]}], ";", 
       RowBox[{"Sym\[Alpha]", "=", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", "x1", " ", "Sk1"}], "-", 
          RowBox[{"\[ImaginaryI]", " ", "x2", " ", "k2"}]}]]}], ";", 
       RowBox[{"Sym\[Alpha]A", "=", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", "x1", " ", "Sk1A"}], "-", 
          RowBox[{"\[ImaginaryI]", " ", "x2", " ", "k2A"}]}]]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"propagatorDroit", "=", 
        RowBox[{"BiHestonLaplaceQuickTransform2", "[", 
         RowBox[{
         "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", " ", 
          "\[CapitalSigma]", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], " ", "k1"}], ",", 
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], " ", "k2"}]}], "}"}], ",", 
          "\[Beta]m", ",", "\[Tau]"}], "]"}]}], ";", 
       RowBox[{"SympropagatorDroit", "=", 
        RowBox[{"BiHestonLaplaceQuickTransform2", "[", 
         RowBox[{
         "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", " ", 
          "\[CapitalSigma]", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], " ", "Sk1"}], ",", 
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], " ", "k2"}]}], "}"}], ",", 
          "\[Beta]m", ",", "\[Tau]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"propagatorGauche", "=", 
        RowBox[{"BiHestonLaplaceQuickTransform2", "[", 
         RowBox[{
         "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", " ", 
          "\[CapitalSigma]", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], " ", "k1"}], ",", 
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], " ", "k2A"}]}], "}"}], ",", 
          "\[Beta]m", ",", "\[Tau]"}], "]"}]}], ";", 
       RowBox[{"SympropagatorGauche", "=", 
        RowBox[{"BiHestonLaplaceQuickTransform2", "[", 
         RowBox[{
         "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", " ", 
          "\[CapitalSigma]", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], " ", "Sk1A"}], ",", 
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], " ", "k2A"}]}], "}"}], ",", 
          "\[Beta]m", ",", "\[Tau]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Alpha]", " ", "propagatorDroit", " ", 
           RowBox[{"FirstUnderlyingVanillaPayOffFourierDroite", "[", 
            RowBox[{"k1", ",", "k2", ",", 
             RowBox[{"KList", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "\[Alpha]1", ",", "a"}], 
            "]"}]}], "+", "\[IndentingNewLine]", 
          RowBox[{"Sym\[Alpha]", " ", "SympropagatorDroit", " ", 
           RowBox[{"FirstUnderlyingVanillaPayOffFourierDroite", "[", 
            RowBox[{"Sk1", ",", "k2", ",", 
             RowBox[{"KList", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "\[Alpha]1", ",", "a"}], 
            "]"}]}], "+", "\[IndentingNewLine]", 
          RowBox[{"\[Alpha]A", " ", "propagatorGauche", " ", 
           RowBox[{"FirstUnderlyingVanillaPayOffFourierGauche", "[", 
            RowBox[{"k1", ",", "k2A", ",", 
             RowBox[{"KList", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "\[Alpha]1", ",", "a"}], 
            "]"}]}], "+", "\[IndentingNewLine]", 
          RowBox[{"Sym\[Alpha]A", " ", "SympropagatorGauche", " ", 
           RowBox[{"FirstUnderlyingVanillaPayOffFourierGauche", "[", 
            RowBox[{"Sk1A", ",", "k2A", ",", 
             RowBox[{"KList", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "\[Alpha]1", ",", "a"}], 
            "]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "KList", "]"}]}], "}"}]}], "]"}]}], "]"}]}],
     "]"}]}], "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.402140085770051*^9, 3.4021400863013115`*^9}, {
   3.4021401238489075`*^9, 3.4021402363666925`*^9}, {3.402140267929798*^9, 
   3.402140316290102*^9}, {3.4021403621347322`*^9, 3.4021403798069468`*^9}, {
   3.402140442948784*^9, 3.4021404698243*^9}, {3.40214052530974*^9, 
   3.4021405261847568`*^9}, {3.402140572076263*^9, 3.4021405730294065`*^9}, {
   3.40214283290092*^9, 3.402142834900958*^9}, 3.402142878995555*^9, {
   3.4021429531532288`*^9, 3.40214297455989*^9}, {3.4021430512488623`*^9, 
   3.4021430865307894`*^9}, {3.402143143625636*^9, 3.4021431463288126`*^9}, {
   3.402143222267771*^9, 3.402143365629898*^9}, {3.4021439797510643`*^9, 
   3.4021440141579747`*^9}, {3.4021444783543873`*^9, 
   3.4021445164332433`*^9}, {3.4021445469025784`*^9, 3.402144574918741*^9}, {
   3.4021446846239724`*^9, 3.4021446895459423`*^9}, {3.4021447226559525`*^9, 
   3.402144729593586*^9}, {3.402144860127342*^9, 3.402144926378614*^9}, {
   3.4021449572542067`*^9, 3.402145180727247*^9}, {3.402149153412896*^9, 
   3.4021491595067635`*^9}, {3.4021496964233217`*^9, 3.402149821410097*^9}, {
   3.40214987416111*^9, 3.402149884755063*^9}, {3.4021499394279876`*^9, 
   3.4021499498344374`*^9}, {3.402150065133526*^9, 3.402150121790864*^9}, {
   3.4021501655260787`*^9, 3.4021502014486437`*^9}, {3.402150388827241*^9, 
   3.4021504643911915`*^9}, {3.4021505016731577`*^9, 3.402150539877016*^9}, {
   3.402150576221464*^9, 3.4021506145190744`*^9}, 3.402150646160307*^9, {
   3.4021507013801165`*^9, 3.402150701614496*^9}, {3.402150792022482*^9, 
   3.4021508226011944`*^9}, {3.4022048852154446`*^9, 
   3.4022049314194565`*^9}, {3.402223441649846*^9, 3.4022234739004655`*^9}, {
   3.4022235664178667`*^9, 3.4022235977934694`*^9}, {3.402225770632062*^9, 
   3.4022257810853877`*^9}, {3.4022260066522183`*^9, 
   3.4022260340902452`*^9}, {3.402227989127781*^9, 3.4022280025967894`*^9}, 
   3.4022280710668545`*^9, {3.4022281624279833`*^9, 3.4022281629904943`*^9}, {
   3.4023193135668306`*^9, 3.4023194603141108`*^9}, {3.402319603150462*^9, 
   3.40231966787294*^9}, {3.4023197252970443`*^9, 3.4023197324378977`*^9}, {
   3.4023205583495092`*^9, 3.4023206749454975`*^9}, {3.4023207399779963`*^9, 
   3.4023207413373976`*^9}, {3.4023208249015017`*^9, 
   3.4023209920765867`*^9}, {3.4023211800958214`*^9, 3.40232123755005*^9}, {
   3.4023216909806304`*^9, 3.4023216975588818`*^9}, {3.402321742184738*^9, 
   3.4023217427316236`*^9}, {3.4023247260232773`*^9, 
   3.4023248331659594`*^9}, {3.4023253919266872`*^9, 
   3.4023255075695324`*^9}, {3.40237831846457*^9, 3.4023783246678143`*^9}, {
   3.403961973148756*^9, 3.4039620282435637`*^9}, {3.4039620755257215`*^9, 
   3.403962089885372*^9}, 3.4041951327140923`*^9, {3.4041952182469845`*^9, 
   3.404195247966305*^9}, {3.4043004279447346`*^9, 3.4043004361659346`*^9}, {
   3.404327490209344*^9, 3.4043275159493437`*^9}, {3.4044528975572577`*^9, 
   3.4044530030796824`*^9}, 3.404453052355702*^9, 3.404453130014395*^9, {
   3.404456519474929*^9, 3.404456520006155*^9}, 3.4046512403302355`*^9, {
   3.404651281627903*^9, 3.404651291253088*^9}, 3.404826839728609*^9, {
   3.4048269669366183`*^9, 3.404826973905636*^9}, {3.405003350207147*^9, 
   3.405003378614747*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Fourier Transform of the payoff", "Subsubtitle",
 CellChangeTimes->{{3.4047174737434516`*^9, 3.404717491805258*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FirstUnderlyingVanillaPayOffFourierDroite", "[", 
   RowBox[{"k1_", ",", "k2_", ",", "K_", ",", "\[Alpha]_", ",", "a_"}], "]"}],
   ":=", 
  FractionBox[
   RowBox[{"a", " ", "K", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox["K", "\[Alpha]"], ")"}], 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]]}], 
   RowBox[{
    RowBox[{"a", " ", "k1", " ", "k2"}], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     SuperscriptBox["k1", "2"], " ", "k2"}]}]]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.403954614991857*^9, 3.403954664367805*^9}, {
   3.404624481208702*^9, 3.404624482833744*^9}, 3.404624517584634*^9, 
   3.4046315442653737`*^9, {3.404636352529566*^9, 3.4046363551233654`*^9}, {
   3.405003271723547*^9, 3.405003287432747*^9}, 3.405003336354347*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FirstUnderlyingVanillaPayOffFourierGauche", "[", 
   RowBox[{"k1_", ",", "k2_", ",", "K_", ",", "\[Alpha]_", ",", "a_"}], "]"}],
   ":=", 
  FractionBox[
   RowBox[{
    RowBox[{"-", "a"}], " ", "K", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox["K", "\[Alpha]"], ")"}], 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]]}], 
   RowBox[{
    RowBox[{"a", " ", "k1", " ", "k2"}], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     SuperscriptBox["k1", "2"], " ", "k2"}]}]]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4039546461018295`*^9, 3.4039546738523617`*^9}, {
   3.4046244873494844`*^9, 3.40462448970892*^9}, 3.4046245348819513`*^9, 
   3.4046315281556897`*^9, {3.404636357764041*^9, 3.404636360357841*^9}, {
   3.4050032770743475`*^9, 3.4050032921907473`*^9}, 3.4050033384759474`*^9}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Option Vanille Partielle 2 ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[Beta]", " ", 
       SuperscriptBox[
        SubscriptBox["S", "2"], "b"]}], "-", "K"}], ")"}], "+"], 
   TraditionalForm]]]
}], "Subtitle",
 CellChangeTimes->{{3.399795779284771*^9, 3.3997957832385283`*^9}, {
  3.4039536500202045`*^9, 3.403953704380624*^9}, {3.4039838619091463`*^9, 
  3.4039838625175457`*^9}, {3.4046308234491777`*^9, 3.4046308244647703`*^9}, {
  3.405009283622748*^9, 3.405009286149948*^9}, {3.405939807025298*^9, 
  3.405939807322179*^9}}],

Cell["Handling", "Text",
 CellChangeTimes->{{3.4059584675710735`*^9, 3.405958469274232*^9}}],

Cell[CellGroupData[{

Cell["High Level interface", "Subsubtitle",
 CellChangeTimes->{{3.404642425693043*^9, 3.404642434083829*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SmileBiHestonUnderlying2Vanilla", "[", 
   RowBox[{
   "S_", ",", "\[Beta]1_", ",", "b_", ",", "KList1_", ",", "\[Tau]_", ",", 
    "\[CapitalSigma]_", ",", "M_", ",", "\[CapitalSigma]inf_", ",", 
    "\[Beta]_", ",", "\[Rho]_", ",", "\[Mu]_", ",", "printflag_"}], "]"}], ":=",
   
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "KList", ",", "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", 
      ",", "period1n", ",", "\[Epsilon]1", ",", "LegendreCoef2", ",", 
      "period2", ",", "period2n", ",", "\[Epsilon]2", ",", "imax", ",", 
      "\[Lambda]1", ",", "\[Lambda]2", ",", "Q", ",", "prices", ",", 
      "startmonitortime", ",", "plafondexplosion", ",", "initialTailFlag", 
      ",", "InitialTailPosition", ",", "InitialTailPosition2", ",", "kmax", 
      ",", "StartControl", ",", "IncrementFactor"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "KList1", "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{"KList", "=", 
        RowBox[{"{", "KList1", "}"}]}], ",", 
       RowBox[{"KList", "=", "KList1"}]}], "]"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"Q", "=", 
      RowBox[{
       RowBox[{"CholeskyDecomposition", "[", 
        RowBox[{"-", 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"M", ".", "\[CapitalSigma]inf"}], "+", 
            RowBox[{"\[CapitalSigma]inf", ".", " ", 
             RowBox[{"Transpose", "[", "M", "]"}]}]}], "2"], ")"}]}], "]"}], 
       "/", "\[Beta]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", ",", 
          "period1n", ",", "\[Epsilon]1", ",", "startmonitortime", ",", 
          "plafondexplosion", ",", "initialTailFlag", ",", 
          "InitialTailPosition", ",", "InitialTailPosition2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "LegendreCoef2", ",", "period2", ",", "period2n", ",", "\[Epsilon]2",
           ",", "kmax", ",", "StartControl", ",", "IncrementFactor"}], "}"}], 
        ",", "imax", ",", "\[Lambda]1", ",", "\[Lambda]2"}], "}"}], "=", 
      RowBox[{"BiHestonVanillaOptimalParameters", "[", 
       RowBox[{"S", ",", "1", ",", "\[Beta]1", ",", "1", ",", "b", ",", 
        RowBox[{"KList", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "\[Tau]", ",", 
        "\[CapitalSigma]", ",", "M", ",", "\[CapitalSigma]inf", ",", "Q", ",",
         "\[Rho]", ",", "\[Mu]", ",", "\"\<Underlying2Option\>\"", ",", 
        "printflag"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"prices", "=", 
      RowBox[{"SmileBiHestonUnderlying2Vanilla", "[", 
       RowBox[{
       "S", ",", "\[Beta]1", ",", "b", ",", "KList", ",", "\[Tau]", ",", 
        "\[CapitalSigma]", ",", "M", ",", "\[CapitalSigma]inf", ",", "Q", ",",
         "\[Rho]", ",", "\[Mu]", ",", "\[Beta]", ",", "\[Lambda]1", ",", 
        "\[Lambda]2", ",", 
        RowBox[{"{", 
         RowBox[{
         "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", ",", 
          "period1n", ",", "\[Epsilon]1", ",", "imax", ",", 
          "startmonitortime", ",", "plafondexplosion", ",", "initialTailFlag",
           ",", "InitialTailPosition", ",", "InitialTailPosition2"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{
         "LegendreCoef2", ",", "period2", ",", "period2n", ",", "\[Epsilon]2",
           ",", "kmax", ",", "StartControl", ",", "IncrementFactor"}], "}"}], 
        ",", "printflag"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Beta]1", " ", 
           SuperscriptBox[
            RowBox[{"S", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "b"]}], "-", 
          RowBox[{"KList1", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ",", "0", ",", 
         RowBox[{"prices", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "KList1", "]"}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4042074577632284`*^9, 3.4042074770760994`*^9}, {
   3.4042075328115444`*^9, 3.4042077538626633`*^9}, {3.404207970241818*^9, 
   3.404207993351637*^9}, {3.4042080286491895`*^9, 3.404208043665103*^9}, {
   3.4042173037335176`*^9, 3.4042173873444977`*^9}, {3.4042175109093704`*^9, 
   3.404217554472707*^9}, {3.4042999349691343`*^9, 3.4042999555923347`*^9}, 
   3.404325362832144*^9, 3.4043253935953436`*^9, {3.4043813496393437`*^9, 
   3.4043813704653435`*^9}, {3.404456304258438*^9, 3.404456370334422*^9}, {
   3.404456965314081*^9, 3.404456976064494*^9}, 3.404651338769625*^9, {
   3.4046513700514755`*^9, 3.4046513744265594`*^9}, {3.4046531049597855`*^9, 
   3.4046531241945295`*^9}, 3.4048268453069477`*^9, 3.4048269809527817`*^9, {
   3.4048386945236874`*^9, 3.4048387248998537`*^9}, {3.405009291407148*^9, 
   3.4050093108291483`*^9}, 3.405092286812792*^9, {3.405104227722573*^9, 
   3.4051042283309727`*^9}, {3.405665610918033*^9, 3.4056656762005367`*^9}, {
   3.405666334353798*^9, 3.4056663364163375`*^9}, {3.406471891221009*^9, 
   3.4064719160966454`*^9}, {3.406557478455958*^9, 3.406557483252956*^9}, {
   3.4065616711726637`*^9, 3.4065616717351785`*^9}, {3.4066130074906178`*^9, 
   3.4066130348194427`*^9}, {3.4069601593577642`*^9, 3.4069601655922585`*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "utilise", " ", "une", " ", "matrice", " ", "complete", "  ", "comme", " ", 
   "vol", " ", "de", " ", "vol"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.4043007956367345`*^9, 3.4043008208619347`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SmileBiHestonUnderlying2Vanilla2", "[", 
   RowBox[{
   "S_", ",", "\[Beta]1_", ",", "b_", ",", "KList1_", ",", "\[Tau]_", ",", 
    "\[CapitalSigma]_", ",", "M_", ",", "\[CapitalSigma]inf_", ",", "Q_", ",",
     "\[Rho]_", ",", "\[Mu]_", ",", "printflag_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "KList", ",", "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", 
      ",", "period1n", ",", "\[Epsilon]1", ",", "LegendreCoef2", ",", 
      "period2", ",", "period2n", ",", "\[Epsilon]2", ",", "imax", ",", 
      "\[Lambda]1", ",", "\[Lambda]2", ",", "\[Beta]m", ",", "prices", ",", 
      "startmonitortime", ",", "plafondexplosion", ",", "initialTailFlag", 
      ",", "InitialTailPosition", ",", "InitialTailPosition2", ",", "kmax", 
      ",", "StartControl", ",", "IncrementFactor"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "KList1", "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{"KList", "=", 
        RowBox[{"{", "KList1", "}"}]}], ",", 
       RowBox[{"KList", "=", "KList1"}]}], "]"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", ",", 
          "period1n", ",", "\[Epsilon]1", ",", "startmonitortime", ",", 
          "plafondexplosion", ",", "initialTailFlag", ",", 
          "InitialTailPosition", ",", "InitialTailPosition2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "LegendreCoef2", ",", "period2", ",", "period2n", ",", "\[Epsilon]2",
           ",", "kmax", ",", "StartControl", ",", "IncrementFactor"}], "}"}], 
        ",", "imax", ",", "\[Lambda]1", ",", "\[Lambda]2"}], "}"}], "=", 
      RowBox[{"BiHestonVanillaOptimalParameters", "[", 
       RowBox[{"S", ",", "1", ",", "\[Beta]1", ",", "1", ",", "b", ",", 
        RowBox[{"KList", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "\[Tau]", ",", 
        "\[CapitalSigma]", ",", "M", ",", "\[CapitalSigma]inf", ",", "Q", ",",
         "\[Rho]", ",", "\[Mu]", ",", "\"\<Underlying2Option\>\"", ",", 
        "printflag"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Beta]m", "=", 
      RowBox[{"-", 
       RowBox[{
        RowBox[{"(", 
         FractionBox[
          RowBox[{
           RowBox[{"M", ".", "\[CapitalSigma]inf"}], "+", 
           RowBox[{"\[CapitalSigma]inf", ".", 
            RowBox[{"Transpose", "[", "M", "]"}]}]}], "2"], ")"}], ".", 
        RowBox[{"Inverse", "[", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Transpose", "[", "Q", "]"}], ".", "Q"}], ")"}], 
         "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"prices", "=", 
      RowBox[{"SmileBiHestonUnderlying2Vanilla2", "[", 
       RowBox[{
       "S", ",", "\[Beta]1", ",", "b", ",", "KList", ",", "\[Tau]", ",", 
        "\[CapitalSigma]", ",", "M", ",", "\[CapitalSigma]inf", ",", "Q", ",",
         "\[Rho]", ",", "\[Mu]", ",", "\[Beta]m", ",", "\[Lambda]1", ",", 
        "\[Lambda]2", ",", 
        RowBox[{"{", 
         RowBox[{
         "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", ",", 
          "period1n", ",", "\[Epsilon]1", ",", "imax", ",", 
          "startmonitortime", ",", "plafondexplosion", ",", "initialTailFlag",
           ",", "InitialTailPosition", ",", "InitialTailPosition2"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{
         "LegendreCoef2", ",", "period2", ",", "period2n", ",", "\[Epsilon]2",
           ",", "kmax", ",", "StartControl", ",", "IncrementFactor"}], "}"}], 
        ",", "printflag"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Beta]1", " ", 
           SuperscriptBox[
            RowBox[{"S", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "b"]}], "-", 
          RowBox[{"KList1", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ",", "0", ",", 
         RowBox[{"prices", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "KList1", "]"}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4042074577632284`*^9, 3.4042074770760994`*^9}, {
   3.4042075328115444`*^9, 3.4042077538626633`*^9}, {3.404207970241818*^9, 
   3.404207993351637*^9}, {3.4042080286491895`*^9, 3.404208043665103*^9}, {
   3.404217016149871*^9, 3.4042170184311647`*^9}, {3.4042174130637417`*^9, 
   3.4042174217982845`*^9}, {3.4042186116648793`*^9, 
   3.4042186161962166`*^9}, {3.4042999781187344`*^9, 
   3.4042999878063345`*^9}, {3.4043245662649436`*^9, 
   3.4043246043289433`*^9}, {3.4043253661237435`*^9, 3.4043253674653435`*^9}, 
   3.4043254021597433`*^9, {3.404381400183344*^9, 3.404381400776144*^9}, {
   3.404455409076337*^9, 3.4044554761121407`*^9}, {3.404456981002184*^9, 
   3.4044569860023756`*^9}, {3.404651341441551*^9, 3.4046513647388735`*^9}, {
   3.4046530997096844`*^9, 3.4046531220382385`*^9}, 3.404826847838295*^9, 
   3.404826989406231*^9, {3.4048387121806154`*^9, 3.4048387443068485`*^9}, {
   3.4048387883397894`*^9, 3.40483878887106*^9}, {3.405009321686748*^9, 
   3.405009332840748*^9}, 3.4050922895316114`*^9, {3.405104231326173*^9, 
   3.405104231778573*^9}, {3.405665622074497*^9, 3.405665630715288*^9}, {
   3.4056656957165365`*^9, 3.4056656972009397`*^9}, {3.405666344322739*^9, 
   3.405666345557138*^9}, {3.4064719262531557`*^9, 3.406471939784752*^9}, {
   3.4065574872843094`*^9, 3.40655749356572*^9}, {3.4066130469760036`*^9, 
   3.4066130647577085`*^9}, {3.406960150935727*^9, 3.406960156498334*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SmileBiHestonUnderlying2Vanilla3", "[", 
   RowBox[{
   "S_", ",", "\[Beta]1_", ",", "b_", ",", "KList1_", ",", "\[Tau]_", ",", 
    "\[CapitalSigma]_", ",", "M_", ",", "Q_", ",", "\[Beta]_", ",", "\[Rho]_",
     ",", "\[Mu]_", ",", "printflag_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "KList", ",", "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", 
      ",", "period1n", ",", "\[Epsilon]1", ",", "LegendreCoef2", ",", 
      "period2", ",", "period2n", ",", "\[Epsilon]2", ",", "imax", ",", 
      "\[Lambda]1", ",", "\[Lambda]2", ",", "\[CapitalSigma]inf", ",", 
      "prices", ",", "startmonitortime", ",", "plafondexplosion", ",", 
      "initialTailFlag", ",", "InitialTailPosition", ",", 
      "InitialTailPosition2", ",", "kmax", ",", "StartControl", ",", 
      "IncrementFactor"}], "}"}], ",", 
    RowBox[{
     RowBox[{"\[CapitalSigma]inf", "=", 
      RowBox[{"\[CapitalSigma]inf", "=", 
       RowBox[{"SolveSymetricEquation", "[", 
        RowBox[{"M", ",", 
         RowBox[{
          RowBox[{"-", "2"}], 
          SuperscriptBox["\[Beta]", "2"], " ", 
          RowBox[{
           RowBox[{"Transpose", "[", "Q", "]"}], ".", "Q"}]}]}], "]"}]}]}], 
     " ", ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "KList1", "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{"KList", "=", 
        RowBox[{"{", "KList1", "}"}]}], ",", 
       RowBox[{"KList", "=", "KList1"}]}], "]"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", ",", 
          "period1n", ",", "\[Epsilon]1", ",", "startmonitortime", ",", 
          "plafondexplosion", ",", "initialTailFlag", ",", 
          "InitialTailPosition", ",", "InitialTailPosition2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "LegendreCoef2", ",", "period2", ",", "period2n", ",", "\[Epsilon]2",
           ",", "kmax", ",", "StartControl", ",", "IncrementFactor"}], "}"}], 
        ",", "imax", ",", "\[Lambda]1", ",", "\[Lambda]2"}], "}"}], "=", 
      RowBox[{"BiHestonVanillaOptimalParameters", "[", 
       RowBox[{"S", ",", "1", ",", "\[Beta]1", ",", "1", ",", "b", ",", 
        RowBox[{"KList", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "\[Tau]", ",", 
        "\[CapitalSigma]", ",", "M", ",", "\[CapitalSigma]inf", ",", "Q", ",",
         "\[Rho]", ",", "\[Mu]", ",", "\"\<Underlying2Option\>\"", ",", 
        "printflag"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"prices", "=", 
      RowBox[{"SmileBiHestonUnderlying2Vanilla", "[", 
       RowBox[{
       "S", ",", "\[Beta]1", ",", "b", ",", "KList", ",", "\[Tau]", ",", 
        "\[CapitalSigma]", ",", "M", ",", "\[CapitalSigma]inf", ",", "Q", ",",
         "\[Rho]", ",", "\[Mu]", ",", "\[Beta]", ",", "\[Lambda]1", ",", 
        "\[Lambda]2", ",", 
        RowBox[{"{", 
         RowBox[{
         "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", ",", 
          "period1n", ",", "\[Epsilon]1", ",", "imax", ",", 
          "startmonitortime", ",", "plafondexplosion", ",", "initialTailFlag",
           ",", "InitialTailPosition", ",", "InitialTailPosition2"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{
         "LegendreCoef2", ",", "period2", ",", "period2n", ",", "\[Epsilon]2",
           ",", "kmax", ",", "StartControl", ",", "IncrementFactor"}], "}"}], 
        ",", "printflag"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Beta]1", " ", 
           SuperscriptBox[
            RowBox[{"S", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "b"]}], "-", 
          RowBox[{"KList1", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ",", "0", ",", 
         RowBox[{"prices", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "KList1", "]"}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4042074577632284`*^9, 3.4042074770760994`*^9}, {
   3.4042075328115444`*^9, 3.4042077538626633`*^9}, {3.404207970241818*^9, 
   3.404207993351637*^9}, {3.4042080286491895`*^9, 3.404208043665103*^9}, {
   3.4042173037335176`*^9, 3.4042173873444977`*^9}, {3.4042175109093704`*^9, 
   3.404217554472707*^9}, {3.4042999349691343`*^9, 3.4042999555923347`*^9}, 
   3.404325362832144*^9, 3.4043253935953436`*^9, {3.4043813496393437`*^9, 
   3.4043813704653435`*^9}, {3.404456304258438*^9, 3.404456370334422*^9}, {
   3.404456965314081*^9, 3.404456976064494*^9}, 3.404651338769625*^9, {
   3.4046513700514755`*^9, 3.4046513744265594`*^9}, {3.4046531049597855`*^9, 
   3.4046531241945295`*^9}, 3.4048268453069477`*^9, 3.4048269809527817`*^9, {
   3.4048386945236874`*^9, 3.4048387248998537`*^9}, {3.405009291407148*^9, 
   3.4050093108291483`*^9}, 3.405092286812792*^9, {3.405104227722573*^9, 
   3.4051042283309727`*^9}, {3.405665610918033*^9, 3.4056656762005367`*^9}, {
   3.405666334353798*^9, 3.4056663364163375`*^9}, {3.406471891221009*^9, 
   3.4064719160966454`*^9}, {3.406557478455958*^9, 3.406557483252956*^9}, {
   3.4065616711726637`*^9, 3.4065616717351785`*^9}, {3.4066130074906178`*^9, 
   3.4066130348194427`*^9}, {3.4069601593577642`*^9, 
   3.4069601655922585`*^9}, {3.4070579106249747`*^9, 3.4070579441412435`*^9}, 
   3.4075832775114007`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TestBiHestonUnderlying2Vanilla", "[", 
   RowBox[{
   "S_", ",", "\[Alpha]1_", ",", "a_", ",", "K_", ",", "\[Tau]_", ",", 
    "\[CapitalSigma]_", ",", "M_", ",", "\[CapitalSigma]inf_", ",", 
    "\[Beta]_", ",", "\[Rho]_", ",", "\[Mu]_", ",", "\[Lambda]1_", ",", 
    "\[Lambda]2_", ",", "\[Omega]1_", ",", "period_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Q", ",", "as", ",", "res", ",", "res2", ",", 
      RowBox[{"Y", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Log", "[", 
          RowBox[{"S", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
         RowBox[{"Log", "[", 
          RowBox[{"S", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Q", "=", 
      RowBox[{
       RowBox[{"CholeskyDecomposition", "[", 
        RowBox[{"-", 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"M", ".", "\[CapitalSigma]inf"}], "+", 
            RowBox[{"\[CapitalSigma]inf", ".", " ", 
             RowBox[{"Transpose", "[", "M", "]"}]}]}], "2"], ")"}]}], "]"}], 
       "/", "\[Beta]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Valeur en 0 : \>\"", ",", 
       RowBox[{
        RowBox[{"SmileSymetrizedBiHestonUnderlying2VanillaIntegrandCC", "[", 
         RowBox[{"Y", ",", "\[Alpha]1", ",", "a", ",", 
          RowBox[{"{", "K", "}"}], ",", "\[Tau]", ",", "\[CapitalSigma]", ",",
           "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", "\[Beta]", ",", 
          "\[Lambda]1", ",", "\[Lambda]2", ",", "\[Omega]1", ",", "0"}], 
         "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"SmileSymetrizedBiHestonUnderlying2VanillaIntegrandCC", "[", 
         RowBox[{"Y", ",", "\[Alpha]1", ",", "a", ",", 
          RowBox[{"{", "K", "}"}], ",", "\[Tau]", ",", "\[CapitalSigma]", ",",
           "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", "\[Beta]", ",", 
          "\[Lambda]1", ",", "\[Lambda]2", ",", "\[Omega]1", ",", 
          "\[Omega]2"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Omega]2", ",", "0", " ", ",", 
         RowBox[{"2", "period"}]}], "}"}], ",", 
       RowBox[{"PlotPoints", "\[Rule]", "50"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "0.5"}], ",", "0.5"}], "}"}]}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", 
        RowBox[{"\"\<Integrand Underlying 1: K =\>\"", "<>", 
         RowBox[{"ToString", "[", "K", "]"}], "<>", "\"\< \[Omega]1=\>\"", "<>",
          
         RowBox[{"ToString", "[", "\[Omega]1", "]"}]}]}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4042074577632284`*^9, 3.4042074770760994`*^9}, {
   3.4042075328115444`*^9, 3.4042077538626633`*^9}, {3.404207970241818*^9, 
   3.404207993351637*^9}, {3.4042080286491895`*^9, 3.404208043665103*^9}, {
   3.4042173037335176`*^9, 3.4042173873444977`*^9}, {3.4042175109093704`*^9, 
   3.404217554472707*^9}, {3.4042999349691343`*^9, 3.4042999555923347`*^9}, {
   3.404381253215744*^9, 3.404381270172944*^9}, {3.4044634862113743`*^9, 
   3.4044635745846777`*^9}, {3.404463622474383*^9, 3.4044637577842846`*^9}, {
   3.4044637895649247`*^9, 3.4044638511887417`*^9}, {3.404463881485035*^9, 
   3.404463962092862*^9}, {3.4044646348143206`*^9, 3.4044646352830615`*^9}, {
   3.4044659090554795`*^9, 3.4044659091648526`*^9}, {3.404466252111393*^9, 
   3.4044662673767247`*^9}, {3.4044662976417685`*^9, 
   3.4044662980323863`*^9}, {3.4044673732461166`*^9, 
   3.4044673808397207`*^9}, {3.4046519546877003`*^9, 
   3.4046519750474663`*^9}, {3.4046528875181103`*^9, 3.404652993051387*^9}, 
   3.404811180721076*^9, {3.404811251817556*^9, 3.404811256317729*^9}, 
   3.404826602406996*^9, {3.4048266367520647`*^9, 3.4048266473149705`*^9}, {
   3.404838584300705*^9, 3.404838585847639*^9}, {3.404888355750947*^9, 
   3.4048883751261473`*^9}, {3.404888409087347*^9, 3.4048884100857472`*^9}, 
   3.404888482298147*^9, {3.404888523107747*^9, 3.404888593260947*^9}, {
   3.4048886239773474`*^9, 3.404888647377347*^9}, {3.4048888242189474`*^9, 
   3.4048888357941475`*^9}, {3.4048891031157475`*^9, 3.404889148121747*^9}, {
   3.404889229444547*^9, 3.404889260831747*^9}, {3.404889328176947*^9, 
   3.404889408579347*^9}, 3.4048894927725472`*^9, {3.404889523270547*^9, 
   3.404889539650547*^9}, {3.4048896202557473`*^9, 3.404889621129347*^9}, {
   3.4048906274507475`*^9, 3.404890630118347*^9}, 3.404890709865547*^9, {
   3.404890864399147*^9, 3.404890865771947*^9}, {3.404891178645547*^9, 
   3.404891216054347*^9}, {3.405760351858841*^9, 3.405760355015151*^9}, {
   3.4057604942990756`*^9, 3.4057605316435423`*^9}, {3.4057607697887397`*^9, 
   3.4057607703981266`*^9}, {3.405760946948391*^9, 3.405760949964074*^9}, {
   3.405760993183654*^9, 3.405760998246251*^9}, {3.405761486114993*^9, 
   3.405761486286871*^9}, {3.406446474989156*^9, 3.4064464915985312`*^9}, {
   3.406446540457906*^9, 3.4064465483485312`*^9}, {3.4066181958276224`*^9, 
   3.4066182032184362`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Test3BiHestonUnderlying2Vanilla", "[", 
   RowBox[{
   "S_", ",", "\[Alpha]1_", ",", "a_", ",", "K_", ",", "\[Tau]_", ",", 
    "\[CapitalSigma]_", ",", "M_", ",", "\[CapitalSigma]inf_", ",", 
    "\[Beta]_", ",", "\[Rho]_", ",", "\[Mu]_", ",", "\[Lambda]1_", ",", 
    "\[Lambda]2_", ",", "\[Omega]1_", ",", "period_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Q", ",", "as", ",", "res", ",", "res2", ",", 
      RowBox[{"Y", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Log", "[", 
          RowBox[{"S", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
         RowBox[{"Log", "[", 
          RowBox[{"S", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Q", "=", 
      RowBox[{
       RowBox[{"CholeskyDecomposition", "[", 
        RowBox[{"-", 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"M", ".", "\[CapitalSigma]inf"}], "+", 
            RowBox[{"\[CapitalSigma]inf", ".", " ", 
             RowBox[{"Transpose", "[", "M", "]"}]}]}], "2"], ")"}]}], "]"}], 
       "/", "\[Beta]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Valeur en 0 : \>\"", ",", 
       RowBox[{
        RowBox[{"SmileSymetrizedBiHestonUnderlying2VanillaIntegrandCC", "[", 
         RowBox[{"Y", ",", "\[Alpha]1", ",", "a", ",", 
          RowBox[{"{", "K", "}"}], ",", "\[Tau]", ",", "\[CapitalSigma]", ",",
           "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", "\[Beta]", ",", 
          "\[Lambda]1", ",", "\[Lambda]2", ",", "\[Omega]1", ",", "0"}], 
         "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"SmileSymetrizedBiHestonUnderlying2VanillaIntegrandCC", "[", 
         RowBox[{"Y", ",", "\[Alpha]1", ",", "a", ",", 
          RowBox[{"{", "K", "}"}], ",", "\[Tau]", ",", "\[CapitalSigma]", ",",
           "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", "\[Beta]", ",", 
          "\[Lambda]1", ",", "\[Lambda]2", ",", "\[Omega]1", ",", 
          "\[Omega]2"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Omega]2", ",", "0", " ", ",", 
         RowBox[{"2", "period"}]}], "}"}], ",", 
       RowBox[{"PlotPoints", "\[Rule]", "50"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", 
        RowBox[{"\"\<Integrand Underlying 1: K =\>\"", "<>", 
         RowBox[{"ToString", "[", "K", "]"}], "<>", "\"\< \[Omega]1=\>\"", "<>",
          
         RowBox[{"ToString", "[", "\[Omega]1", "]"}]}]}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4042074577632284`*^9, 3.4042074770760994`*^9}, {
   3.4042075328115444`*^9, 3.4042077538626633`*^9}, {3.404207970241818*^9, 
   3.404207993351637*^9}, {3.4042080286491895`*^9, 3.404208043665103*^9}, {
   3.4042173037335176`*^9, 3.4042173873444977`*^9}, {3.4042175109093704`*^9, 
   3.404217554472707*^9}, {3.4042999349691343`*^9, 3.4042999555923347`*^9}, {
   3.404381253215744*^9, 3.404381270172944*^9}, {3.4044634862113743`*^9, 
   3.4044635745846777`*^9}, {3.404463622474383*^9, 3.4044637577842846`*^9}, {
   3.4044637895649247`*^9, 3.4044638511887417`*^9}, {3.404463881485035*^9, 
   3.404463962092862*^9}, {3.4044646348143206`*^9, 3.4044646352830615`*^9}, {
   3.4044659090554795`*^9, 3.4044659091648526`*^9}, {3.404466252111393*^9, 
   3.4044662673767247`*^9}, {3.4044662976417685`*^9, 
   3.4044662980323863`*^9}, {3.4044673732461166`*^9, 
   3.4044673808397207`*^9}, {3.4046519546877003`*^9, 
   3.4046519750474663`*^9}, {3.4046528875181103`*^9, 3.404652993051387*^9}, 
   3.404811180721076*^9, {3.404811251817556*^9, 3.404811256317729*^9}, 
   3.404826602406996*^9, {3.4048266367520647`*^9, 3.4048266473149705`*^9}, {
   3.404838584300705*^9, 3.404838585847639*^9}, {3.404888355750947*^9, 
   3.4048883751261473`*^9}, {3.404888409087347*^9, 3.4048884100857472`*^9}, 
   3.404888482298147*^9, {3.404888523107747*^9, 3.404888593260947*^9}, {
   3.4048886239773474`*^9, 3.404888647377347*^9}, {3.4048888242189474`*^9, 
   3.4048888357941475`*^9}, {3.4048891031157475`*^9, 3.404889148121747*^9}, {
   3.404889229444547*^9, 3.404889260831747*^9}, {3.404889328176947*^9, 
   3.404889408579347*^9}, 3.4048894927725472`*^9, {3.404889523270547*^9, 
   3.404889539650547*^9}, {3.4048896202557473`*^9, 3.404889621129347*^9}, {
   3.4048906274507475`*^9, 3.404890630118347*^9}, 3.404890709865547*^9, {
   3.404890864399147*^9, 3.404890865771947*^9}, {3.404891178645547*^9, 
   3.404891216054347*^9}, {3.405760351858841*^9, 3.405760355015151*^9}, {
   3.4057604942990756`*^9, 3.4057605316435423`*^9}, {3.4057607697887397`*^9, 
   3.4057607703981266`*^9}, {3.405760946948391*^9, 3.405760949964074*^9}, {
   3.405760993183654*^9, 3.405760998246251*^9}, {3.405761486114993*^9, 
   3.405761486286871*^9}, {3.406446474989156*^9, 3.4064464915985312`*^9}, {
   3.406446540457906*^9, 3.4064465483485312`*^9}, {3.406617907492116*^9, 
   3.4066179158204546`*^9}, {3.406618218234446*^9, 3.4066182188438363`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TestBiHestonUnderlying2Vanilla2", "[", 
   RowBox[{
   "S_", ",", "\[Alpha]1_", ",", "a_", ",", "K_", ",", "\[Tau]_", ",", 
    "\[CapitalSigma]_", ",", "M_", ",", "\[CapitalSigma]inf_", ",", "Q_", ",",
     "\[Rho]_", ",", "\[Mu]_", ",", "\[Lambda]1_", ",", "\[Lambda]2_", ",", 
    "\[Omega]1_", ",", "period_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[Beta]m", ",", "as", ",", "res", ",", "res2", ",", 
      RowBox[{"Y", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Log", "[", 
          RowBox[{"S", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
         RowBox[{"Log", "[", 
          RowBox[{"S", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Beta]m", "=", 
      RowBox[{"-", 
       RowBox[{
        RowBox[{"(", 
         FractionBox[
          RowBox[{
           RowBox[{"M", ".", "\[CapitalSigma]inf"}], "+", 
           RowBox[{"\[CapitalSigma]inf", ".", 
            RowBox[{"Transpose", "[", "M", "]"}]}]}], "2"], ")"}], ".", 
        RowBox[{"Inverse", "[", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Transpose", "[", "Q", "]"}], ".", "Q"}], ")"}], 
         "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Valeur en 0 : \>\"", ",", 
       RowBox[{
        RowBox[{
        "SmileSymetrizedBiHestonUnderlying2VanillaIntegrand2CC", "[", 
         RowBox[{"Y", ",", "\[Alpha]1", ",", "a", ",", 
          RowBox[{"{", "K", "}"}], ",", "\[Tau]", ",", "\[CapitalSigma]", ",",
           "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", "\[Beta]m", ",", 
          "\[Lambda]1", ",", "\[Lambda]2", ",", "\[Omega]1", ",", "0"}], 
         "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
        "SmileSymetrizedBiHestonUnderlying2VanillaIntegrand2CC", "[", 
         RowBox[{"Y", ",", "\[Alpha]1", ",", "a", ",", 
          RowBox[{"{", "K", "}"}], ",", "\[Tau]", ",", "\[CapitalSigma]", ",",
           "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", "\[Beta]m", ",", 
          "\[Lambda]1", ",", "\[Lambda]2", ",", "\[Omega]1", ",", 
          "\[Omega]2"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Omega]2", ",", "0", " ", ",", 
         RowBox[{"2", "period"}]}], "}"}], ",", 
       RowBox[{"PlotPoints", "\[Rule]", "50"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "0.5"}], ",", "0.5"}], "}"}]}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", 
        RowBox[{"\"\<Integrand Underlying 1: K =\>\"", "<>", 
         RowBox[{"ToString", "[", "K", "]"}], "<>", "\"\< \[Omega]1=\>\"", "<>",
          
         RowBox[{"ToString", "[", "\[Omega]1", "]"}]}]}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4042074577632284`*^9, 3.4042074770760994`*^9}, {
   3.4042075328115444`*^9, 3.4042077538626633`*^9}, {3.404207970241818*^9, 
   3.404207993351637*^9}, {3.4042080286491895`*^9, 3.404208043665103*^9}, {
   3.4042173037335176`*^9, 3.4042173873444977`*^9}, {3.4042175109093704`*^9, 
   3.404217554472707*^9}, {3.4042999349691343`*^9, 3.4042999555923347`*^9}, {
   3.404381253215744*^9, 3.404381270172944*^9}, {3.4044634862113743`*^9, 
   3.4044635745846777`*^9}, {3.404463622474383*^9, 3.4044637577842846`*^9}, {
   3.4044637895649247`*^9, 3.4044638511887417`*^9}, {3.404463881485035*^9, 
   3.404463962092862*^9}, {3.4044646348143206`*^9, 3.4044646352830615`*^9}, {
   3.4044659090554795`*^9, 3.4044659091648526`*^9}, {3.404466252111393*^9, 
   3.4044662673767247`*^9}, {3.4044662976417685`*^9, 
   3.4044662980323863`*^9}, {3.4044673732461166`*^9, 
   3.4044673808397207`*^9}, {3.4046519546877003`*^9, 
   3.4046519750474663`*^9}, {3.4046528875181103`*^9, 3.404652993051387*^9}, 
   3.404811180721076*^9, {3.404811251817556*^9, 3.404811256317729*^9}, 
   3.404826602406996*^9, {3.4048266367520647`*^9, 3.4048266473149705`*^9}, {
   3.404838584300705*^9, 3.404838585847639*^9}, {3.404888355750947*^9, 
   3.4048883751261473`*^9}, {3.404888409087347*^9, 3.4048884100857472`*^9}, 
   3.404888482298147*^9, {3.404888523107747*^9, 3.404888593260947*^9}, {
   3.4048886239773474`*^9, 3.404888647377347*^9}, {3.4048888242189474`*^9, 
   3.4048888357941475`*^9}, {3.4048891031157475`*^9, 3.404889148121747*^9}, {
   3.404889229444547*^9, 3.404889260831747*^9}, {3.404889328176947*^9, 
   3.404889408579347*^9}, 3.4048894927725472`*^9, {3.404889523270547*^9, 
   3.404889539650547*^9}, {3.4048896202557473`*^9, 3.404889621129347*^9}, {
   3.4048906274507475`*^9, 3.404890630118347*^9}, 3.404890709865547*^9, {
   3.404890864399147*^9, 3.404890865771947*^9}, {3.404891178645547*^9, 
   3.404891216054347*^9}, {3.405760351858841*^9, 3.405760355015151*^9}, {
   3.4057604942990756`*^9, 3.4057605316435423`*^9}, {3.4057607697887397`*^9, 
   3.4057607703981266`*^9}, {3.405760946948391*^9, 3.405760949964074*^9}, {
   3.405760993183654*^9, 3.405760998246251*^9}, {3.405761486114993*^9, 
   3.405761486286871*^9}, {3.4059566440048122`*^9, 3.4059566628489237`*^9}, {
   3.4059567069278955`*^9, 3.4059567221000614`*^9}, {3.406446388364156*^9, 
   3.406446408239156*^9}, {3.406446553426656*^9, 3.4064465610360312`*^9}, {
   3.4065551695843525`*^9, 3.4065552035539722`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Test2BiHestonUnderlying2Vanilla", "[", 
   RowBox[{
   "S_", ",", "\[Alpha]1_", ",", "a_", ",", "K_", ",", "\[Tau]_", ",", 
    "\[CapitalSigma]_", ",", "M_", ",", "\[CapitalSigma]inf_", ",", 
    "\[Beta]_", ",", "\[Rho]_", ",", "\[Mu]_", ",", "\[Lambda]1_", ",", 
    "\[Lambda]2_", ",", 
    RowBox[{"{", 
     RowBox[{
     "LegendreCoef1_", ",", "LegendreCoef1n_", ",", "period1_", ",", 
      "period1n_", ",", "\[Epsilon]1_", ",", "imax_", ",", 
      "startmonitortime_", ",", "plafondexplosion_", ",", "initialTailFlag_", 
      ",", "InitialTailPosition_"}], "}"}], ",", "period_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Q", ",", "as", ",", "res", ",", "res2", ",", 
      RowBox[{"Y", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Log", "[", 
          RowBox[{"S", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
         RowBox[{"Log", "[", 
          RowBox[{"S", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}], ",", "tt"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Q", "=", 
      RowBox[{
       RowBox[{"CholeskyDecomposition", "[", 
        RowBox[{"-", 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"M", ".", "\[CapitalSigma]inf"}], "+", 
            RowBox[{"\[CapitalSigma]inf", ".", " ", 
             RowBox[{"Transpose", "[", "M", "]"}]}]}], "2"], ")"}]}], "]"}], 
       "/", "\[Beta]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Valeur en 0 : \>\"", ",", 
       RowBox[{
        RowBox[{"VectorAdaptativeIntegrateExplosionSafe", "[", 
         RowBox[{
          RowBox[{"Function", "[", 
           RowBox[{"\[Omega]1", ",", 
            RowBox[{
             RowBox[{
             "SmileSymetrizedBiHestonUnderlying2VanillaIntegrandCC", "[", 
              RowBox[{"Y", ",", "\[Alpha]1", ",", "a", ",", 
               RowBox[{"{", "K", "}"}], ",", "\[Tau]", ",", "\[CapitalSigma]",
                ",", "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", 
               "\[Beta]", ",", "\[Lambda]1", ",", "\[Lambda]2", ",", 
               "\[Omega]1", ",", "0"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", "LegendreCoef1", 
          ",", "LegendreCoef1n", ",", "period1", ",", "period1n", ",", 
          "\[Epsilon]1", ",", "imax", ",", "1", ",", "startmonitortime", ",", 
          "plafondexplosion", ",", "initialTailFlag", ",", 
          "InitialTailPosition"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tt", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Omega]2", ",", 
          RowBox[{
           RowBox[{"VectorAdaptativeIntegrateExplosionSafe", "[", 
            RowBox[{
             RowBox[{"Function", "[", 
              RowBox[{"\[Omega]1", ",", 
               RowBox[{
                RowBox[{
                "SmileSymetrizedBiHestonUnderlying2VanillaIntegrandCC", "[", 
                 RowBox[{"Y", ",", "\[Alpha]1", ",", "a", ",", 
                  RowBox[{"{", "K", "}"}], ",", "\[Tau]", ",", 
                  "\[CapitalSigma]", ",", "M", ",", "Q", ",", "\[Rho]", ",", 
                  "\[Mu]", ",", "\[Beta]", ",", "\[Lambda]1", ",", 
                  "\[Lambda]2", ",", "\[Omega]1", ",", "\[Omega]2"}], "]"}], 
                "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", "LegendreCoef1",
              ",", "LegendreCoef1n", ",", "period1", ",", "period1n", ",", 
             "\[Epsilon]1", ",", "imax", ",", "1", ",", "startmonitortime", 
             ",", "plafondexplosion", ",", "initialTailFlag", ",", 
             "InitialTailPosition"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Omega]2", ",", "0", ",", "period", ",", 
          RowBox[{"period", "/", "100"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ListPlot", "[", 
      RowBox[{"tt", ",", 
       RowBox[{"Joined", "\[Rule]", "True"}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", "\"\<U1:2nd Inv. Fourier:\>\""}], ",", 
       
       RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}]}], "]"}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.4042074577632284`*^9, 3.4042074770760994`*^9}, {
   3.4042075328115444`*^9, 3.4042077538626633`*^9}, {3.404207970241818*^9, 
   3.404207993351637*^9}, {3.4042080286491895`*^9, 3.404208043665103*^9}, {
   3.4042173037335176`*^9, 3.4042173873444977`*^9}, {3.4042175109093704`*^9, 
   3.404217554472707*^9}, {3.4042999349691343`*^9, 3.4042999555923347`*^9}, {
   3.404381253215744*^9, 3.404381270172944*^9}, {3.4044634862113743`*^9, 
   3.4044635745846777`*^9}, {3.404463622474383*^9, 3.4044637577842846`*^9}, {
   3.4044637895649247`*^9, 3.4044638511887417`*^9}, {3.404463881485035*^9, 
   3.404463962092862*^9}, {3.4044646348143206`*^9, 3.4044646352830615`*^9}, {
   3.4044659090554795`*^9, 3.4044659091648526`*^9}, {3.404466252111393*^9, 
   3.4044662673767247`*^9}, {3.4044662976417685`*^9, 
   3.4044662980323863`*^9}, {3.4044673732461166`*^9, 
   3.4044673808397207`*^9}, {3.4046519546877003`*^9, 
   3.4046519750474663`*^9}, {3.4046528875181103`*^9, 3.404652993051387*^9}, 
   3.404811180721076*^9, {3.404811251817556*^9, 3.404811256317729*^9}, 
   3.404826602406996*^9, {3.4048266367520647`*^9, 3.4048266473149705`*^9}, {
   3.404838584300705*^9, 3.404838585847639*^9}, {3.404888355750947*^9, 
   3.4048883751261473`*^9}, {3.404888409087347*^9, 3.4048884100857472`*^9}, 
   3.404888482298147*^9, {3.404888523107747*^9, 3.404888593260947*^9}, {
   3.4048886239773474`*^9, 3.404888647377347*^9}, {3.4048888242189474`*^9, 
   3.4048888357941475`*^9}, {3.4048891031157475`*^9, 3.404889148121747*^9}, {
   3.404889229444547*^9, 3.404889260831747*^9}, {3.404889328176947*^9, 
   3.404889408579347*^9}, 3.4048894927725472`*^9, {3.404889523270547*^9, 
   3.404889539650547*^9}, {3.4048896202557473`*^9, 3.404889621129347*^9}, {
   3.4048906274507475`*^9, 3.404890630118347*^9}, 3.404890709865547*^9, {
   3.404890864399147*^9, 3.404890865771947*^9}, {3.404891178645547*^9, 
   3.404891216054347*^9}, {3.405760351858841*^9, 3.405760355015151*^9}, {
   3.4057604942990756`*^9, 3.4057605316435423`*^9}, {3.4057607697887397`*^9, 
   3.4057607703981266`*^9}, {3.405760946948391*^9, 3.405760949964074*^9}, {
   3.405760993183654*^9, 3.405760998246251*^9}, {3.405761486114993*^9, 
   3.405761486286871*^9}, 3.4057618534345455`*^9, {3.405761894341581*^9, 
   3.4057619368423967`*^9}, {3.4057619887965193`*^9, 
   3.4057620280472727`*^9}, {3.4057621936361403`*^9, 3.405762195089507*^9}, {
   3.405762368881112*^9, 3.405762475670563*^9}, {3.405762968882745*^9, 
   3.4057629990866427`*^9}, {3.4064464253485312`*^9, 
   3.4064464383485312`*^9}, {3.4064465667235312`*^9, 3.4064465721922812`*^9}, 
   3.4064695061912036`*^9, {3.4064708849139977`*^9, 3.406470886882798*^9}, 
   3.406470941368568*^9, {3.4065413261088705`*^9, 3.40654132665576*^9}, {
   3.4065413732507024`*^9, 3.4065413783602085`*^9}, 3.4065574993627434`*^9, {
   3.406558310899143*^9, 3.4065583132117023`*^9}, {3.4066182388443484`*^9, 
   3.4066182697357645`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Test2BiHestonUnderlying2Vanilla2", "[", 
   RowBox[{
   "S_", ",", "\[Alpha]1_", ",", "a_", ",", "K_", ",", "\[Tau]_", ",", 
    "\[CapitalSigma]_", ",", "M_", ",", "\[CapitalSigma]inf_", ",", "Q_", ",",
     "\[Rho]_", ",", "\[Mu]_", ",", "\[Lambda]1_", ",", "\[Lambda]2_", ",", 
    RowBox[{"{", 
     RowBox[{
     "LegendreCoef1_", ",", "LegendreCoef1n_", ",", "period1_", ",", 
      "period1n_", ",", "\[Epsilon]1_", ",", "imax_", ",", 
      "startmonitortime_", ",", "plafondexplosion_", ",", "initialTailFlag_", 
      ",", "InitialTailPosition_"}], "}"}], ",", "period_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[Beta]m", ",", "as", ",", "res", ",", "res2", ",", 
      RowBox[{"Y", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Log", "[", 
          RowBox[{"S", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
         RowBox[{"Log", "[", 
          RowBox[{"S", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}], ",", "tt"}], 
     "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Beta]m", "=", 
      RowBox[{"-", 
       RowBox[{
        RowBox[{"(", 
         FractionBox[
          RowBox[{
           RowBox[{"M", ".", "\[CapitalSigma]inf"}], "+", 
           RowBox[{"\[CapitalSigma]inf", ".", 
            RowBox[{"Transpose", "[", "M", "]"}]}]}], "2"], ")"}], ".", 
        RowBox[{"Inverse", "[", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Transpose", "[", "Q", "]"}], ".", "Q"}], ")"}], 
         "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Valeur en 0 : \>\"", ",", 
       RowBox[{
        RowBox[{"VectorAdaptativeIntegrateExplosionSafe", "[", 
         RowBox[{
          RowBox[{"Function", "[", 
           RowBox[{"\[Omega]1", ",", 
            RowBox[{
             RowBox[{
             "SmileSymetrizedBiHestonUnderlying2VanillaIntegrand2CC", "[", 
              RowBox[{"Y", ",", "\[Alpha]1", ",", "a", ",", 
               RowBox[{"{", "K", "}"}], ",", "\[Tau]", ",", "\[CapitalSigma]",
                ",", "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", 
               "\[Beta]m", ",", "\[Lambda]1", ",", "\[Lambda]2", ",", 
               "\[Omega]1", ",", "0"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", "LegendreCoef1", 
          ",", "LegendreCoef1n", ",", "period1", ",", "period1n", ",", 
          "\[Epsilon]1", ",", "imax", ",", "1", ",", "startmonitortime", ",", 
          "plafondexplosion", ",", "initialTailFlag", ",", 
          "InitialTailPosition"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tt", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Omega]2", ",", 
          RowBox[{
           RowBox[{"VectorAdaptativeIntegrateExplosionSafe", "[", 
            RowBox[{
             RowBox[{"Function", "[", 
              RowBox[{"\[Omega]1", ",", 
               RowBox[{
                RowBox[{
                "SmileSymetrizedBiHestonUnderlying2VanillaIntegrand2CC", "[", 
                 
                 RowBox[{"Y", ",", "\[Alpha]1", ",", "a", ",", 
                  RowBox[{"{", "K", "}"}], ",", "\[Tau]", ",", 
                  "\[CapitalSigma]", ",", "M", ",", "Q", ",", "\[Rho]", ",", 
                  "\[Mu]", ",", "\[Beta]m", ",", "\[Lambda]1", ",", 
                  "\[Lambda]2", ",", "\[Omega]1", ",", "\[Omega]2"}], "]"}], 
                "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", "LegendreCoef1",
              ",", "LegendreCoef1n", ",", "period1", ",", "period1n", ",", 
             "\[Epsilon]1", ",", "imax", ",", "1", ",", "startmonitortime", 
             ",", "plafondexplosion", ",", "initialTailFlag", ",", 
             "InitialTailPosition"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Omega]2", ",", "0", ",", "period", ",", 
          RowBox[{"period", "/", "100"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ListPlot", "[", 
      RowBox[{"tt", ",", 
       RowBox[{"Joined", "\[Rule]", "True"}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", "\"\<U1:2nd Inv. Fourier:\>\""}], ",", 
       
       RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}]}], "]"}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.4042074577632284`*^9, 3.4042074770760994`*^9}, {
   3.4042075328115444`*^9, 3.4042077538626633`*^9}, {3.404207970241818*^9, 
   3.404207993351637*^9}, {3.4042080286491895`*^9, 3.404208043665103*^9}, {
   3.4042173037335176`*^9, 3.4042173873444977`*^9}, {3.4042175109093704`*^9, 
   3.404217554472707*^9}, {3.4042999349691343`*^9, 3.4042999555923347`*^9}, {
   3.404381253215744*^9, 3.404381270172944*^9}, {3.4044634862113743`*^9, 
   3.4044635745846777`*^9}, {3.404463622474383*^9, 3.4044637577842846`*^9}, {
   3.4044637895649247`*^9, 3.4044638511887417`*^9}, {3.404463881485035*^9, 
   3.404463962092862*^9}, {3.4044646348143206`*^9, 3.4044646352830615`*^9}, {
   3.4044659090554795`*^9, 3.4044659091648526`*^9}, {3.404466252111393*^9, 
   3.4044662673767247`*^9}, {3.4044662976417685`*^9, 
   3.4044662980323863`*^9}, {3.4044673732461166`*^9, 
   3.4044673808397207`*^9}, {3.4046519546877003`*^9, 
   3.4046519750474663`*^9}, {3.4046528875181103`*^9, 3.404652993051387*^9}, 
   3.404811180721076*^9, {3.404811251817556*^9, 3.404811256317729*^9}, 
   3.404826602406996*^9, {3.4048266367520647`*^9, 3.4048266473149705`*^9}, {
   3.404838584300705*^9, 3.404838585847639*^9}, {3.404888355750947*^9, 
   3.4048883751261473`*^9}, {3.404888409087347*^9, 3.4048884100857472`*^9}, 
   3.404888482298147*^9, {3.404888523107747*^9, 3.404888593260947*^9}, {
   3.4048886239773474`*^9, 3.404888647377347*^9}, {3.4048888242189474`*^9, 
   3.4048888357941475`*^9}, {3.4048891031157475`*^9, 3.404889148121747*^9}, {
   3.404889229444547*^9, 3.404889260831747*^9}, {3.404889328176947*^9, 
   3.404889408579347*^9}, 3.4048894927725472`*^9, {3.404889523270547*^9, 
   3.404889539650547*^9}, {3.4048896202557473`*^9, 3.404889621129347*^9}, {
   3.4048906274507475`*^9, 3.404890630118347*^9}, 3.404890709865547*^9, {
   3.404890864399147*^9, 3.404890865771947*^9}, {3.404891178645547*^9, 
   3.404891216054347*^9}, {3.405760351858841*^9, 3.405760355015151*^9}, {
   3.4057604942990756`*^9, 3.4057605316435423`*^9}, {3.4057607697887397`*^9, 
   3.4057607703981266`*^9}, {3.405760946948391*^9, 3.405760949964074*^9}, {
   3.405760993183654*^9, 3.405760998246251*^9}, {3.405761486114993*^9, 
   3.405761486286871*^9}, 3.4057618534345455`*^9, {3.405761894341581*^9, 
   3.4057619368423967`*^9}, {3.4057619887965193`*^9, 
   3.4057620280472727`*^9}, {3.4057621936361403`*^9, 3.405762195089507*^9}, {
   3.405762368881112*^9, 3.405762475670563*^9}, {3.405762968882745*^9, 
   3.4057629990866427`*^9}, {3.4059574493171487`*^9, 3.4059574908648214`*^9}, 
   3.4059581900969963`*^9, {3.4064464528485312`*^9, 3.4064464651610312`*^9}, {
   3.406446576364156*^9, 3.406446580957906*^9}, 3.4064695097537947`*^9, {
   3.406470904055113*^9, 3.406470933946503*^9}, {3.4065413325621605`*^9, 
   3.406541333062174*^9}, {3.406541382813447*^9, 3.406541386110407*^9}, 
   3.406557503581601*^9, {3.4065583218212976`*^9, 3.406558323665095*^9}, {
   3.4066182890800095`*^9, 3.4066183020334663`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Handling of (\[Beta] or Q input)", "Subsubtitle",
 CellChangeTimes->{{3.404641877166887*^9, 3.4046419260584507`*^9}, 
   3.404642337706979*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SmileBiHestonUnderlying2Vanilla", "[", 
   RowBox[{
   "S_", ",", " ", "\[Beta]1_", ",", " ", "b_", ",", " ", "KList_", ",", " ", 
    "\[Tau]_", ",", " ", "\[CapitalSigma]_", ",", " ", "M_", ",", " ", 
    "\[CapitalSigma]inf_", ",", " ", "Q_", ",", " ", "\[Rho]_", ",", " ", 
    "\[Mu]_", ",", " ", "\[Beta]_", ",", " ", "\[Lambda]1_", ",", " ", 
    "\[Lambda]2_", ",", " ", 
    RowBox[{"{", 
     RowBox[{
     "LegendreCoef1_", ",", " ", "LegendreCoef1n_", ",", " ", "period1_", ",",
       " ", "period1n_", ",", " ", "\[Epsilon]1_", ",", " ", "imax_", ",", 
      " ", "startmonitortime_", ",", " ", "plafondexplosion_", ",", 
      "initialTailFlag_", ",", "InitialTailPosition_", ",", 
      "InitialTailPosition2_"}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{
     "LegendreCoef2_", ",", " ", "period2_", ",", " ", "period2n_", ",", " ", 
      "\[Epsilon]2_", ",", "kmax_", ",", "StartControl_", ",", 
      "IncrementFactor_"}], "}"}], ",", " ", "printflag_"}], "]"}], " ", ":=",
   " ", 
  RowBox[{"SmileBiHestonUnderlying2VanillaAux", "[", 
   RowBox[{
   "S", ",", " ", "\[Beta]1", ",", " ", "b", ",", " ", "KList", ",", " ", 
    "\[Tau]", ",", " ", "\[CapitalSigma]", ",", " ", "M", ",", " ", 
    "\[CapitalSigma]inf", ",", " ", "Q", ",", " ", "\[Rho]", ",", " ", 
    "\[Mu]", ",", " ", "\[Beta]", ",", " ", "\[Lambda]1", ",", " ", 
    "\[Lambda]2", ",", " ", 
    RowBox[{"{", 
     RowBox[{
     "LegendreCoef1", ",", " ", "LegendreCoef1n", ",", " ", "period1", ",", 
      " ", "period1n", ",", " ", "\[Epsilon]1", ",", " ", "imax", ",", 
      "startmonitortime", ",", "plafondexplosion", ",", "initialTailFlag", 
      ",", "InitialTailPosition", ",", "InitialTailPosition2"}], "}"}], ",", 
    " ", 
    RowBox[{"{", 
     RowBox[{
     "LegendreCoef2", ",", " ", "period2", ",", " ", "period2n", ",", " ", 
      "\[Epsilon]2", ",", "kmax", ",", "StartControl", ",", 
      "IncrementFactor"}], "}"}], ",", " ", "printflag"}], "]"}], 
  " "}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.399897194377056*^9, 3.399897245940546*^9}, {
   3.3998976692611732`*^9, 3.3998976795269957`*^9}, {3.4002144512750473`*^9, 
   3.4002144569782815`*^9}, {3.400238263213356*^9, 3.400238300573448*^9}, {
   3.400408049201395*^9, 3.4004080510451803`*^9}, 3.400504474791651*^9, {
   3.4005667653701477`*^9, 3.400566798886416*^9}, {3.400819839626373*^9, 
   3.4008198425014277`*^9}, {3.4009134614843187`*^9, 
   3.4009134792034087`*^9}, {3.4009135487047434`*^9, 3.400913581252243*^9}, {
   3.4009136129872274`*^9, 3.4009136377220774`*^9}, {3.4009136698945704`*^9, 
   3.400913678910368*^9}, {3.400913713848539*^9, 3.400913720848673*^9}, {
   3.4009138946020093`*^9, 3.400913904914707*^9}, {3.40091789471006*^9, 
   3.400917899053893*^9}, {3.400921389214653*^9, 3.4009214402156324`*^9}, {
   3.400921492029127*^9, 3.4009215467489276`*^9}, {3.4009217594717617`*^9, 
   3.4009217705500994`*^9}, {3.401110611225083*^9, 3.4011106255847335`*^9}, {
   3.4011155613669987`*^9, 3.4011155856330895`*^9}, {3.401425790206461*^9, 
   3.401425813269404*^9}, {3.402046069834562*^9, 3.40204607210023*^9}, {
   3.4022357520580764`*^9, 3.4022357573706784`*^9}, {3.4022370965213895`*^9, 
   3.4022371025371304`*^9}, {3.402294637481146*^9, 3.4022946494188747`*^9}, {
   3.4022947595616145`*^9, 3.4022948086094313`*^9}, {3.4022949118926644`*^9, 
   3.4022949123770485`*^9}, 3.4022950944274187`*^9, {3.4023880298479567`*^9, 
   3.4023880317599564`*^9}, {3.403871467549989*^9, 3.4038715521922393`*^9}, {
   3.4038772034257407`*^9, 3.4038772338482*^9}, {3.4038778690791464`*^9, 
   3.4038778880951366`*^9}, {3.403877923330188*^9, 3.403877959690261*^9}, {
   3.403880525208268*^9, 3.403880528802087*^9}, {3.4039401668863335`*^9, 
   3.403940181277235*^9}, {3.403940658427021*^9, 3.403940660661439*^9}, 
   3.403940704459155*^9, {3.403947868049818*^9, 3.4039479096443667`*^9}, {
   3.4039621859965925`*^9, 3.4039621885122657`*^9}, {3.404149535953335*^9, 
   3.404149547107335*^9}, {3.404198055801464*^9, 3.4041980594734097`*^9}, {
   3.4043002987767344`*^9, 3.4043003215995345`*^9}, {3.404325523574544*^9, 
   3.4043255265385437`*^9}, 3.4043255927293434`*^9, {3.404455401905121*^9, 
   3.404455403947358*^9}, {3.404455464994901*^9, 3.4044554680552645`*^9}, 
   3.404456097176443*^9, {3.404456990174411*^9, 3.404456993518289*^9}, {
   3.404651399708295*^9, 3.40465140700531*^9}, 3.4048268523697195`*^9, 
   3.4048269961096134`*^9, {3.405009738003948*^9, 3.405009743073948*^9}, 
   3.4064691734014344`*^9, 3.406471079950241*^9, 3.4065575089098625`*^9, {
   3.4065583291964865`*^9, 3.406558331274665*^9}, {3.4066130975710487`*^9, 
   3.4066131051649933`*^9}, 3.406959922556342*^9, 3.40696058520969*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SmileBiHestonUnderlying2Vanilla2", "[", 
   RowBox[{
   "S_", ",", " ", "\[Beta]1_", ",", " ", "b_", ",", " ", "KList_", ",", " ", 
    "\[Tau]_", ",", " ", "\[CapitalSigma]_", ",", " ", "M_", ",", " ", 
    "\[CapitalSigma]inf_", ",", " ", "Q_", ",", " ", "\[Rho]_", ",", " ", 
    "\[Mu]_", ",", " ", "\[Beta]m_", ",", " ", "\[Lambda]1_", ",", " ", 
    "\[Lambda]2_", ",", " ", 
    RowBox[{"{", 
     RowBox[{
     "LegendreCoef1_", ",", " ", "LegendreCoef1n_", ",", " ", "period1_", ",",
       " ", "period1n_", ",", " ", "\[Epsilon]1_", ",", " ", "imax_", ",", 
      " ", "startmonitortime_", ",", " ", "plafondexplosion_", ",", 
      "initialTailFlag_", ",", "InitialTailPosition_", ",", 
      "InitialTailPosition2_"}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{
     "LegendreCoef2_", ",", " ", "period2_", ",", " ", "period2n_", ",", " ", 
      "\[Epsilon]2_", ",", "kmax_", ",", "StartControl_", ",", 
      "IncrementFactor_"}], "}"}], ",", " ", "printflag_"}], "]"}], " ", ":=",
   " ", 
  RowBox[{"SmileBiHestonUnderlying2VanillaAux2", "[", 
   RowBox[{
   "S", ",", " ", "\[Beta]1", ",", " ", "b", ",", " ", "KList", ",", " ", 
    "\[Tau]", ",", " ", "\[CapitalSigma]", ",", " ", "M", ",", " ", 
    "\[CapitalSigma]inf", ",", " ", "Q", ",", " ", "\[Rho]", ",", " ", 
    "\[Mu]", ",", " ", "\[Beta]m", ",", " ", "\[Lambda]1", ",", " ", 
    "\[Lambda]2", ",", " ", 
    RowBox[{"{", 
     RowBox[{
     "LegendreCoef1", ",", " ", "LegendreCoef1n", ",", " ", "period1", ",", 
      " ", "period1n", ",", " ", "\[Epsilon]1", ",", " ", "imax", ",", 
      "startmonitortime", ",", "plafondexplosion", ",", "initialTailFlag", 
      ",", "InitialTailPosition", ",", "InitialTailPosition2"}], "}"}], ",", 
    " ", 
    RowBox[{"{", 
     RowBox[{
     "LegendreCoef2", ",", " ", "period2", ",", " ", "period2n", ",", " ", 
      "\[Epsilon]2", ",", "kmax", ",", "StartControl", ",", 
      "IncrementFactor"}], "}"}], ",", " ", "printflag"}], "]"}], 
  " "}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.399897194377056*^9, 3.399897245940546*^9}, {
   3.3998976692611732`*^9, 3.3998976795269957`*^9}, {3.4002144512750473`*^9, 
   3.4002144569782815`*^9}, {3.400238263213356*^9, 3.400238300573448*^9}, {
   3.400408049201395*^9, 3.4004080510451803`*^9}, 3.400504474791651*^9, {
   3.4005667653701477`*^9, 3.400566798886416*^9}, {3.400819839626373*^9, 
   3.4008198425014277`*^9}, {3.4009134614843187`*^9, 
   3.4009134792034087`*^9}, {3.4009135487047434`*^9, 3.400913581252243*^9}, {
   3.4009136129872274`*^9, 3.4009136377220774`*^9}, {3.4009136698945704`*^9, 
   3.400913678910368*^9}, {3.400913713848539*^9, 3.400913720848673*^9}, {
   3.4009138946020093`*^9, 3.400913904914707*^9}, {3.40091789471006*^9, 
   3.400917899053893*^9}, {3.400921389214653*^9, 3.4009214402156324`*^9}, {
   3.400921492029127*^9, 3.4009215467489276`*^9}, {3.4009217594717617`*^9, 
   3.4009217705500994`*^9}, {3.401110611225083*^9, 3.4011106255847335`*^9}, {
   3.4011155613669987`*^9, 3.4011155856330895`*^9}, {3.401425790206461*^9, 
   3.401425813269404*^9}, {3.402046069834562*^9, 3.40204607210023*^9}, {
   3.4022357520580764`*^9, 3.4022357573706784`*^9}, {3.4022370965213895`*^9, 
   3.4022371025371304`*^9}, {3.402294637481146*^9, 3.4022946494188747`*^9}, {
   3.4022947595616145`*^9, 3.4022948086094313`*^9}, {3.4022949118926644`*^9, 
   3.4022949123770485`*^9}, 3.4022950944274187`*^9, {3.4023880298479567`*^9, 
   3.4023880317599564`*^9}, {3.403871467549989*^9, 3.4038715521922393`*^9}, {
   3.4038772034257407`*^9, 3.4038772338482*^9}, {3.4038778690791464`*^9, 
   3.4038778880951366`*^9}, {3.403877923330188*^9, 3.403877959690261*^9}, {
   3.403880525208268*^9, 3.403880528802087*^9}, {3.4039401668863335`*^9, 
   3.403940181277235*^9}, {3.403940658427021*^9, 3.403940660661439*^9}, 
   3.403940704459155*^9, {3.403947868049818*^9, 3.4039479096443667`*^9}, {
   3.4039621859965925`*^9, 3.4039621885122657`*^9}, {3.404149535953335*^9, 
   3.404149547107335*^9}, {3.404198055801464*^9, 3.4041980594734097`*^9}, {
   3.4043002987767344`*^9, 3.4043003215995345`*^9}, {3.404325523574544*^9, 
   3.4043255265385437`*^9}, 3.4043255927293434`*^9, {3.4043273738021436`*^9, 
   3.4043273906969433`*^9}, {3.4044553914289093`*^9, 3.4044553939076557`*^9}, 
   3.4044560995203576`*^9, {3.4044561637436285`*^9, 3.4044561674626403`*^9}, {
   3.4044569963777742`*^9, 3.404457001112331*^9}, {3.4046514017552094`*^9, 
   3.404651412646044*^9}, 3.4048268550260715`*^9, 3.4048269986409607`*^9, {
   3.405009748627548*^9, 3.405009753089148*^9}, 3.4064691761358795`*^9, 
   3.4064710742157187`*^9, 3.406557510597406*^9, {3.4065583370248117`*^9, 
   3.40655833889986*^9}, {3.406613109336975*^9, 3.4066131152590017`*^9}, 
   3.4069599176031227`*^9, 3.4069605883503757`*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["Integration Bi Dimensional", "Subsubtitle",
 CellChangeTimes->{{3.404641430673939*^9, 3.4046414450023394`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SmileBiHestonUnderlying2VanillaAux", "[", 
   RowBox[{
   "S_", ",", "\[Beta]1_", ",", "b_", ",", "KList_", ",", "\[Tau]_", ",", 
    "\[CapitalSigma]_", ",", "M_", ",", "\[CapitalSigma]inf_", ",", "Q_", ",",
     "\[Rho]_", ",", "\[Mu]_", ",", "\[Beta]_", ",", "\[Lambda]1_", ",", 
    "\[Lambda]2_", ",", 
    RowBox[{"{", 
     RowBox[{
     "LegendreCoef1_", ",", "LegendreCoef1n_", ",", "period1_", ",", 
      "period1n_", ",", "\[Epsilon]1_", ",", "imax_", ",", 
      "startmonitortime_", ",", "plafondexplosion_", ",", "initialTailFlag_", 
      ",", "InitialTailPosition_", ",", "InitialTailPosition2_"}], "}"}], ",",
     
    RowBox[{"{", 
     RowBox[{
     "LegendreCoef2_", ",", "period2_", ",", "period2n_", ",", "\[Epsilon]2_",
       ",", "kmax_", ",", "StartControl_", ",", "IncrementFactor_"}], "}"}], 
    ",", "printflag_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{
   FractionBox["2", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"2", "\[Pi]"}], ")"}], "2"]], 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "res", ",", "res2", ",", 
       RowBox[{"Y", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Log", "[", 
           RowBox[{"S", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
          RowBox[{"Log", "[", 
           RowBox[{"S", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "1"}], " ", "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "1"}], "]"}]}], "  ", ",", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\< S=\>\"", ",", 
           RowBox[{"S", " ", "//", " ", "MatrixForm"}], ",", 
           "\"\< \[CapitalSigma]=\>\"", ",", 
           RowBox[{"\[CapitalSigma]", " ", "//", "MatrixForm"}], ",", 
           "\"\<M=\>\"", ",", 
           RowBox[{"M", "//", "MatrixForm"}], ",", 
           "\"\< \[CapitalSigma]inf=\>\"", ",", 
           RowBox[{"\[CapitalSigma]inf", "//", "MatrixForm"}], " ", ",", 
           "\"\< Q=\>\"", ",", 
           RowBox[{"Q", "//", "MatrixForm"}], " ", ",", "\"\< \[Rho]=\>\"", 
           ",", 
           RowBox[{"\[Rho]", "//", "MatrixForm"}], ",", "\"\< \[Mu]=\>\"", 
           ",", 
           RowBox[{"\[Mu]", "//", "MatrixForm"}], ",", "\"\< \[Beta]=\>\"", 
           ",", "\[Beta]", ",", "\"\< T=\>\"", ",", "\[Tau]"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Inner Integration\>\"", ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\"\<LegendreNbMain\>\"", ",", 
                RowBox[{"Length", "[", "LegendreCoef1", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<LegendreNbIncrement\>\"", ",", 
                RowBox[{"Length", "[", "LegendreCoef1n", "]"}]}], "}"}], ",", 
              
              RowBox[{"{", 
               RowBox[{"\"\<IncrementNbMax\>\"", ",", "imax"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<InitialTailFlag\>\"", ",", "initialTailFlag"}], 
               "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<InitialTailLegendreNb\>\"", ",", 
                RowBox[{"Length", "[", "LegendreCoef2", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<PeriodMain\>\"", ",", "period1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<PeriodnIncrement\>\"", ",", "period1n"}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"\"\<StoppingLevel\>\"", ",", "\[Epsilon]1"}], "}"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"\"\<AbcisseMaxValue\>\"", ",", "kmax"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
               "\"\<InitialTailUpperLimit\>\"", ",", "InitialTailPosition"}], 
               "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
               "\"\<ExplosionMonitoringStartAbcisse\>\"", ",", 
                "StartControl"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
               "\"\<ExplosionMonitoringMaxLevel\>\"", ",", 
                "IncrementFactor"}], "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"\"\<lambda1\>\"", ",", "\[Lambda]1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<lambda2\>\"", ",", "\[Lambda]2"}], "}"}]}], "}"}],
             " ", "//", " ", "MatrixForm"}], ",", "\[IndentingNewLine]", 
           "\"\<Outer Integration\>\"", ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\"\<LegendreNbMain\>\"", ",", 
                RowBox[{"Length", "[", "LegendreCoef2", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<LegendreNbIncrement\>\"", ",", 
                RowBox[{"Length", "[", "LegendreCoef1n", "]"}]}], "}"}], ",", 
              
              RowBox[{"{", 
               RowBox[{"\"\<IncrementNbMax\>\"", ",", "imax"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<InitialTailFlag\>\"", ",", "initialTailFlag"}], 
               "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<InitialTailLegendreNb\>\"", ",", 
                RowBox[{"Length", "[", "LegendreCoef2", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<PeriodMain\>\"", ",", "period2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<PeriodnIncrement\>\"", ",", "period2n"}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"\"\<StoppingLevel\>\"", ",", "\[Epsilon]2"}], "}"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"\"\<AbcisseMaxValue\>\"", ",", "kmax"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
               "\"\<InitialTailUpperLimit\>\"", ",", "InitialTailPosition"}], 
               "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
               "\"\<GrowingControlStartAbcisse\>\"", ",", 
                "startmonitortime"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
               "\"\<GrowingControlMaxFactor\>\"", ",", "plafondexplosion"}], 
               "}"}]}], "}"}], " ", "//", " ", "MatrixForm"}]}], "]"}]}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "2"}], " ", "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "2"}], "]"}]}], "  ", ",", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<BiHestonLaplaceQuickTransform[M,Q,\[Rho], \
\[Mu],\[CapitalSigma],{-\[ImaginaryI] 1,-\[ImaginaryI] \
1},\[Beta],\[Tau]]=\>\"", ",", 
           RowBox[{"BiHestonLaplaceQuickTransform", "[", 
            RowBox[{
            "M", ",", "Q", ",", "\[Rho]", ",", " ", "\[Mu]", ",", 
             "\[CapitalSigma]", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "\[ImaginaryI]"}], " ", "1"}], ",", 
               RowBox[{
                RowBox[{"-", "\[ImaginaryI]"}], " ", "1"}]}], "}"}], ",", 
             "\[Beta]", ",", "\[Tau]"}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<integrand(0.1,0.1)=\>\"", ",", 
           RowBox[{
           "SmileSymetrizedBiHestonUnderlying2VanillaIntegrandCC", "[", 
            RowBox[{
            "Y", ",", "\[Beta]1", ",", "b", ",", "KList", ",", "\[Tau]", ",", 
             "\[CapitalSigma]", ",", "M", ",", "Q", ",", "\[Rho]", ",", 
             "\[Mu]", ",", "\[Beta]", ",", "\[Lambda]1", ",", "\[Lambda]2", 
             ",", "0.1", ",", "0.1"}], "]"}]}], "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "4"}], "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "4"}], "]"}]}], " ", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Plot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
              "SmileSymetrizedBiHestonUnderlying2VanillaIntegrandCC", "[", 
               RowBox[{"Y", ",", "\[Beta]1", ",", "b", ",", 
                RowBox[{"{", 
                 RowBox[{"KList", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", "\[Tau]", ",", 
                "\[CapitalSigma]", ",", "M", ",", "Q", ",", "\[Rho]", ",", 
                "\[Mu]", ",", "\[Beta]", ",", "\[Lambda]1", ",", "\[Lambda]2",
                 ",", "\[Omega]1", ",", "\[Omega]2"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Omega]2", ",", "0", " ", ",", 
               RowBox[{"2", "period1"}]}], "}"}], ",", 
             RowBox[{"PlotPoints", "\[Rule]", "50"}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
             RowBox[{"PlotLabel", "\[Rule]", 
              RowBox[{"\"\<U2:1st Inverse Fourier: K =\>\"", "<>", 
               RowBox[{"ToString", "[", 
                RowBox[{"KList", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", 
               "\"\< \[Omega]1=\>\"", "<>", 
               RowBox[{"ToString", "[", "\[Omega]1", "]"}]}]}]}], "]"}], ",", 
           
           RowBox[{"{", 
            RowBox[{"\[Omega]1", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.2", ",", "2"}], "}"}]}], "}"}]}], "]"}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "6"}], "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "6"}], "]"}]}], " ", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\[Omega]2", ",", 
               RowBox[{
                RowBox[{"VectorAdaptativeIntegrateExplosionSafe", "[", 
                 RowBox[{
                  RowBox[{"Function", "[", 
                   RowBox[{"\[Omega]1", ",", 
                    RowBox[{
                    RowBox[{
                    "SmileSymetrizedBiHestonUnderlying2VanillaIntegrandCC", 
                    "[", 
                    RowBox[{"Y", ",", "\[Beta]1", ",", "b", ",", 
                    RowBox[{"{", 
                    RowBox[{"KList", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", "\[Tau]", ",",
                     "\[CapitalSigma]", ",", "M", ",", "Q", ",", "\[Rho]", 
                    ",", "\[Mu]", ",", "\[Beta]", ",", "\[Lambda]1", ",", 
                    "\[Lambda]2", ",", "\[Omega]1", ",", "\[Omega]2"}], "]"}],
                     "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
                  "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", ",",
                   "period1n", ",", "\[Epsilon]1", ",", "imax", ",", "1", ",",
                   "startmonitortime", ",", "plafondexplosion", ",", 
                  "initialTailFlag", ",", "InitialTailPosition"}], "]"}], "[",
                 
                RowBox[{"[", 
                 RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Omega]2", ",", "0", ",", "period2", ",", 
               RowBox[{"period2", "/", "30"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"Joined", "\[Rule]", "True"}], ",", 
           RowBox[{
           "PlotLabel", "\[Rule]", "\"\<U2:2nd Inverse Fourier:\>\""}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "]"}]}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "7"}], "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "7"}], "]"}]}], " ", ",", 
        RowBox[{
         RowBox[{
         "Print", "[", 
          "\"\<code integ 2 : \
{i,exploded<1,Abs[increment[[1]]]>\[Epsilon],(i<imax)}\>\"", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
         "Print", "[", 
          "\"\<code integ 1 : \
{i,exploded<1,Abs[increment[[1]]]>\[Epsilon],(i<imax)}\>\"", "]"}]}]}], "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{"VectorAdaptativeIntegrateUnprotected", "[", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{"\[Omega]2", ",", 
           RowBox[{
            RowBox[{"a", "=", 
             RowBox[{"VectorAdaptativeIntegrateExplosionSafe", "[", 
              RowBox[{
               RowBox[{"Function", "[", 
                RowBox[{"\[Omega]1", ",", 
                 RowBox[{
                 "SmileSymetrizedBiHestonUnderlying2VanillaIntegrandCC", "[", 
                  
                  RowBox[{
                  "Y", ",", "\[Beta]1", ",", "b", ",", "KList", ",", "\[Tau]",
                    ",", "\[CapitalSigma]", ",", "M", ",", "Q", ",", "\[Rho]",
                    ",", "\[Mu]", ",", "\[Beta]", ",", "\[Lambda]1", ",", 
                   "\[Lambda]2", ",", "\[Omega]1", ",", "\[Omega]2"}], 
                  "]"}]}], "]"}], ",", "LegendreCoef1", ",", "LegendreCoef1n",
                ",", "period1", ",", "period1n", ",", "\[Epsilon]1", ",", 
               "imax", ",", 
               RowBox[{"Length", "[", "KList", "]"}], ",", "startmonitortime",
                ",", "plafondexplosion", ",", "initialTailFlag", ",", 
               "InitialTailPosition"}], "]"}]}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"printflag", "\[Equal]", "7"}], "||", " ", 
               RowBox[{"MemberQ", "[", 
                RowBox[{"printflag", ",", "7"}], "]"}]}], ",", 
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<\[Omega]2=\>\"", ",", "\[Omega]2", ",", 
                "\"\< Integ_2=\>\"", ",", "a"}], "]"}]}], "]"}], ";", 
            RowBox[{"a", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], ",", "LegendreCoef2", 
         ",", "LegendreCoef1n", ",", "period2", ",", "period2n", ",", 
         "\[Epsilon]2", ",", "imax", ",", 
         RowBox[{"Length", "[", "KList", "]"}], ",", "printflag", ",", 
         "initialTailFlag", ",", "InitialTailPosition2", ",", "kmax", ",", 
         "StartControl", ",", "IncrementFactor"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "7"}], "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "7"}], "]"}]}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Integ_1=\>\"", ",", "res"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"res", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.3997288601267104`*^9, 3.39972890803388*^9, {3.3997289692069297`*^9, 
   3.3997289944261637`*^9}, {3.399729087443575*^9, 3.3997291578199263`*^9}, {
   3.399729214633517*^9, 3.3997292559936857`*^9}, {3.399729338917153*^9, 
   3.399729443137904*^9}, {3.3997297921289797`*^9, 3.399729801332281*^9}, 
   3.3997984631978292`*^9, 3.3997986822957864`*^9, {3.399799475623518*^9, 
   3.3997994825611515`*^9}, {3.399813039024555*^9, 3.3998130523841867`*^9}, {
   3.3998138111956306`*^9, 3.399813818523896*^9}, {3.3998138975254135`*^9, 
   3.3998139300104117`*^9}, {3.399814002074295*^9, 3.3998140680286865`*^9}, {
   3.3998141794214506`*^9, 3.399814187827862*^9}, {3.3998161633189154`*^9, 
   3.399816166818983*^9}, {3.399816989678531*^9, 3.39981701069456*^9}, {
   3.3998175772210617`*^9, 3.3998175797054844`*^9}, {3.3998177980534267`*^9, 
   3.3998178039285393`*^9}, 3.3998191717048006`*^9, {3.399819229424659*^9, 
   3.399819249925052*^9}, {3.3998192996916327`*^9, 3.3998193255202537`*^9}, {
   3.3998194002404385`*^9, 3.399819401990472*^9}, {3.399819437022394*^9, 
   3.399819443678772*^9}, {3.3998195847752314`*^9, 3.3998195956035643`*^9}, {
   3.3998937261423693`*^9, 3.3998937440645885`*^9}, {3.399894673945778*^9, 
   3.3998946780865884`*^9}, 3.399895357951172*^9, {3.3998971752360635`*^9, 
   3.399897202986596*^9}, {3.399995099817901*^9, 3.3999951242558703`*^9}, {
   3.3999951653972855`*^9, 3.3999952424143887`*^9}, {3.399995434089944*^9, 
   3.3999954559809895`*^9}, 3.400214359554536*^9, {3.4002194753715076`*^9, 
   3.4002194862310915`*^9}, {3.400221264780864*^9, 3.400221267812172*^9}, {
   3.400221324438259*^9, 3.4002213249851446`*^9}, {3.4002307045682325`*^9, 
   3.4002307106777253`*^9}, {3.4002309417446613`*^9, 
   3.4002309457603636`*^9}, {3.4002355676772275`*^9, 
   3.4002356840075865`*^9}, {3.4002357813375797`*^9, 3.400235782228222*^9}, {
   3.400238239244146*^9, 3.40023824052542*^9}, {3.4004065560321016`*^9, 
   3.400406572266788*^9}, 3.40040661272069*^9, {3.400406710910075*^9, 
   3.400406802349331*^9}, {3.4004079962316275`*^9, 3.400408003981776*^9}, {
   3.4004080367167797`*^9, 3.400408037591797*^9}, {3.400408141500042*^9, 
   3.4004081422656813`*^9}, 3.400504474791651*^9, {3.4008198209228888`*^9, 
   3.4008198369544463`*^9}, {3.401177200473509*^9, 3.401177296365975*^9}, 
   3.4011776191065464`*^9, 3.4011776885297546`*^9, {3.4011777732345057`*^9, 
   3.4011777815627904`*^9}, {3.4015301347651124`*^9, 3.401530142671514*^9}, {
   3.4015342195318975`*^9, 3.4015342774861345`*^9}, {3.4015343731285963`*^9, 
   3.4015343749255056`*^9}, {3.402033437670154*^9, 3.402033457561161*^9}, {
   3.4020334928118377`*^9, 3.402033502483898*^9}, {3.402143403333747*^9, 
   3.402143421193465*^9}, {3.402143489991661*^9, 3.40214349125731*^9}, {
   3.402143653151044*^9, 3.4021436941674557`*^9}, {3.402205803123693*^9, 
   3.402205848499564*^9}, {3.402294611715026*^9, 3.4022946131681786`*^9}, 
   3.402294775718175*^9, {3.4022949263773174`*^9, 3.4022949270960813`*^9}, 
   3.4023779225819693`*^9, 3.402388039487956*^9, 3.4023881114109564`*^9, 
   3.403871476831417*^9, 3.403871589333577*^9, {3.403871732195695*^9, 
   3.4038719361371107`*^9}, 3.40387197021589*^9, {3.4038729130621176`*^9, 
   3.403872917359075*^9}, {3.4038732665532794`*^9, 3.4038732913350053`*^9}, {
   3.40387338716497*^9, 3.403873392790078*^9}, {3.4038739059561806`*^9, 
   3.403873929300379*^9}, {3.4038757265536356`*^9, 3.403875727100521*^9}, {
   3.4038760173873444`*^9, 3.403876028450057*^9}, {3.4038767128225718`*^9, 
   3.4038767355730085`*^9}, {3.403876883685227*^9, 3.403876894872942*^9}, 
   3.4038770811577682`*^9, {3.403877262489375*^9, 3.403877296927536*^9}, {
   3.4038779003609967`*^9, 3.4038779017516484`*^9}, {3.403877950330706*^9, 
   3.403877995722203*^9}, {3.4038805669746947`*^9, 3.4038805816156006`*^9}, {
   3.403940196949411*^9, 3.403940212309081*^9}, {3.4039402503098106`*^9, 
   3.403940330483225*^9}, {3.403940565097104*^9, 3.4039406320983906`*^9}, {
   3.4039477736886315`*^9, 3.4039478349866834`*^9}, 3.403947942238743*^9, {
   3.4039479736924715`*^9, 3.403948027771635*^9}, 3.403948162852353*^9, {
   3.4039491169487963`*^9, 3.4039491206988688`*^9}, {3.4039492631391034`*^9, 
   3.4039493470938406`*^9}, {3.4039496376931696`*^9, 3.403949723882324*^9}, {
   3.4039498424783516`*^9, 3.4039499998719983`*^9}, 3.403962196184288*^9, 
   3.403962253482263*^9, {3.403984021855946*^9, 3.4039840315435457`*^9}, {
   3.404149982971335*^9, 3.404150039490135*^9}, {3.4041553245635347`*^9, 
   3.4041553260611353`*^9}, {3.4041985742957945`*^9, 3.404198605796399*^9}, {
   3.4043005193139343`*^9, 3.4043005648035345`*^9}, 3.4043287870285435`*^9, 
   3.404328829550544*^9, {3.4043288705473433`*^9, 3.4043289008893433`*^9}, 
   3.4043891255567436`*^9, {3.4044552474277744`*^9, 3.4044552504521565`*^9}, {
   3.404457058223899*^9, 3.404457059552075*^9}, {3.4044575165330067`*^9, 
   3.4044575189704914`*^9}, {3.404457667922663*^9, 3.404457671672639*^9}, {
   3.4044577039693074`*^9, 3.404457751828376*^9}, {3.4044581531170692`*^9, 
   3.4044581548671255`*^9}, 3.4044669708163433`*^9, {3.4046514555062413`*^9, 
   3.404651487631858*^9}, {3.4046628248613453`*^9, 3.404662904078145*^9}, 
   3.404826857682423*^9, {3.404827092300807*^9, 3.404827106145089*^9}, {
   3.405009386052348*^9, 3.405009404304348*^9}, {3.405010668262348*^9, 
   3.405010684767148*^9}, {3.4051038997793727`*^9, 3.405103920090573*^9}, {
   3.4051458056404133`*^9, 3.4051458062341785`*^9}, {3.4057903720668364`*^9, 
   3.405790372551221*^9}, {3.4059348121637735`*^9, 3.4059348200389247`*^9}, {
   3.405935442332123*^9, 3.405935443644648*^9}, 3.405935847574278*^9, {
   3.405936273254326*^9, 3.405936274598102*^9}, {3.40593671590345*^9, 
   3.4059367422789564`*^9}, {3.4064709737287717`*^9, 3.406470977260112*^9}, {
   3.406471027105138*^9, 3.406471057293411*^9}, 3.406471531883685*^9, {
   3.406541837684467*^9, 3.406541873326004*^9}, {3.4065425167174745`*^9, 
   3.4065425171549854`*^9}, {3.406542583031672*^9, 3.406542601813403*^9}, 
   3.406542641814427*^9, {3.406554762167673*^9, 3.4065547627770634`*^9}, {
   3.406557527972851*^9, 3.406557532472966*^9}, {3.4065579383271055`*^9, 
   3.406557938748991*^9}, {3.4065583435718546`*^9, 3.406558345618782*^9}, {
   3.406561579217185*^9, 3.40656158663925*^9}, 3.4065617077048492`*^9, {
   3.406561906647442*^9, 3.406561925366671*^9}, 3.4066113640735474`*^9, 
   3.406612188344648*^9, 3.406959527720637*^9, 3.4069597873037453`*^9, 
   3.406968595957244*^9, 3.40697345314425*^9, 3.4084276246158857`*^9, {
   3.408429534855686*^9, 3.4084295354025717`*^9}, {3.4084297165622997`*^9, 
   3.408429717234188*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SmileBiHestonUnderlying2VanillaAux2", "[", 
   RowBox[{
   "S_", ",", "\[Beta]1_", ",", "b_", ",", "KList_", ",", "\[Tau]_", ",", 
    "\[CapitalSigma]_", ",", "M_", ",", "\[CapitalSigma]inf_", ",", "Q_", ",",
     "\[Rho]_", ",", "\[Mu]_", ",", "\[Beta]m_", ",", "\[Lambda]1_", ",", 
    "\[Lambda]2_", ",", 
    RowBox[{"{", 
     RowBox[{
     "LegendreCoef1_", ",", "LegendreCoef1n_", ",", "period1_", ",", 
      "period1n_", ",", "\[Epsilon]1_", ",", "imax_", ",", 
      "startmonitortime_", ",", "plafondexplosion_", ",", "initialTailFlag_", 
      ",", "InitialTailPosition_", ",", "InitialTailPosition2_"}], "}"}], ",",
     
    RowBox[{"{", 
     RowBox[{
     "LegendreCoef2_", ",", "period2_", ",", "period2n_", ",", "\[Epsilon]2_",
       ",", "kmax_", ",", "StartControl_", ",", "IncrementFactor_"}], "}"}], 
    ",", "printflag_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{
   FractionBox["2", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"2", "\[Pi]"}], ")"}], "2"]], 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "res", ",", "res2", ",", 
       RowBox[{"Y", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Log", "[", 
           RowBox[{"S", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
          RowBox[{"Log", "[", 
           RowBox[{"S", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "1"}], " ", "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "1"}], "]"}]}], "  ", ",", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\< S=\>\"", ",", 
           RowBox[{"S", " ", "//", " ", "MatrixForm"}], ",", 
           "\"\< \[CapitalSigma]=\>\"", ",", 
           RowBox[{"\[CapitalSigma]", " ", "//", "MatrixForm"}], ",", 
           "\"\<M=\>\"", ",", 
           RowBox[{"M", "//", "MatrixForm"}], ",", 
           "\"\< \[CapitalSigma]inf=\>\"", ",", 
           RowBox[{"\[CapitalSigma]inf", "//", "MatrixForm"}], " ", ",", 
           "\"\< Q=\>\"", ",", 
           RowBox[{"Q", "//", "MatrixForm"}], " ", ",", "\"\< \[Rho]=\>\"", 
           ",", 
           RowBox[{"\[Rho]", "//", "MatrixForm"}], ",", "\"\< \[Mu]=\>\"", 
           ",", 
           RowBox[{"\[Mu]", "//", "MatrixForm"}], ",", "\"\< \[Beta]m=\>\"", 
           ",", 
           RowBox[{"\[Beta]m", " ", "//", "MatrixForm"}], ",", "\"\< T=\>\"", 
           ",", "\[Tau]"}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Inner Integration\>\"", ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\"\<LegendreNbMain\>\"", ",", 
                RowBox[{"Length", "[", "LegendreCoef1", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<LegendreNbIncrement\>\"", ",", 
                RowBox[{"Length", "[", "LegendreCoef1n", "]"}]}], "}"}], ",", 
              
              RowBox[{"{", 
               RowBox[{"\"\<IncrementNbMax\>\"", ",", "imax"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<InitialTailFlag\>\"", ",", "initialTailFlag"}], 
               "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<InitialTailLegendreNb\>\"", ",", 
                RowBox[{"Length", "[", "LegendreCoef2", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<PeriodMain\>\"", ",", "period1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<PeriodnIncrement\>\"", ",", "period1n"}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"\"\<StoppingLevel\>\"", ",", "\[Epsilon]1"}], "}"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"\"\<AbcisseMaxValue\>\"", ",", "kmax"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
               "\"\<InitialTailUpperLimit\>\"", ",", "InitialTailPosition"}], 
               "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
               "\"\<ExplosionMonitoringStartAbcisse\>\"", ",", 
                "StartControl"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
               "\"\<ExplosionMonitoringMaxLevel\>\"", ",", 
                "IncrementFactor"}], "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"\"\<lambda1\>\"", ",", "\[Lambda]1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<lambda2\>\"", ",", "\[Lambda]2"}], "}"}]}], "}"}],
             " ", "//", " ", "MatrixForm"}], ",", "\[IndentingNewLine]", 
           "\"\<Outer Integration\>\"", ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\"\<LegendreNbMain\>\"", ",", 
                RowBox[{"Length", "[", "LegendreCoef2", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<LegendreNbIncrement\>\"", ",", 
                RowBox[{"Length", "[", "LegendreCoef1n", "]"}]}], "}"}], ",", 
              
              RowBox[{"{", 
               RowBox[{"\"\<IncrementNbMax\>\"", ",", "imax"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<InitialTailFlag\>\"", ",", "initialTailFlag"}], 
               "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<InitialTailLegendreNb\>\"", ",", 
                RowBox[{"Length", "[", "LegendreCoef1", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<PeriodMain\>\"", ",", "period2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<PeriodnIncrement\>\"", ",", "period2n"}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"\"\<StoppingLevel\>\"", ",", "\[Epsilon]2"}], "}"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"\"\<AbcisseMaxValue\>\"", ",", "kmax"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
               "\"\<InitialTailUpperLimit\>\"", ",", "InitialTailPosition"}], 
               "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
               "\"\<GrowingControlStartAbcisse\>\"", ",", 
                "startmonitortime"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
               "\"\<GrowingControlMaxFactor\>\"", ",", "plafondexplosion"}], 
               "}"}]}], "}"}], " ", "//", " ", "MatrixForm"}]}], "]"}]}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "2"}], " ", "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "2"}], "]"}]}], "  ", ",", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<BiHestonLaplaceQuickTransform2[M,Q,\[Rho], \[Mu],\
\[CapitalSigma],{-\[ImaginaryI] 1,-\[ImaginaryI] 1},\[Beta]m,\[Tau]]=\>\"", 
           ",", 
           RowBox[{"BiHestonLaplaceQuickTransform2", "[", 
            RowBox[{
            "M", ",", "Q", ",", "\[Rho]", ",", " ", "\[Mu]", ",", 
             "\[CapitalSigma]", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "\[ImaginaryI]"}], " ", "1"}], ",", 
               RowBox[{
                RowBox[{"-", "\[ImaginaryI]"}], " ", "1"}]}], "}"}], ",", 
             "\[Beta]m", ",", "\[Tau]"}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<integrand(0.1,0.1)=\>\"", ",", 
           RowBox[{
           "SmileSymetrizedBiHestonUnderlying2VanillaIntegrand2CC", "[", 
            RowBox[{
            "Y", ",", "\[Beta]1", ",", "b", ",", "KList", ",", "\[Tau]", ",", 
             "\[CapitalSigma]", ",", "M", ",", "Q", ",", "\[Rho]", ",", 
             "\[Mu]", ",", "\[Beta]m", ",", "\[Lambda]1", ",", "\[Lambda]2", 
             ",", "0.1", ",", "0.1"}], "]"}]}], "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "4"}], "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "4"}], "]"}]}], " ", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Plot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
              "SmileSymetrizedBiHestonUnderlying2VanillaIntegrand2CC", "[", 
               RowBox[{"Y", ",", "\[Beta]1", ",", "b", ",", 
                RowBox[{"{", 
                 RowBox[{"KList", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", "\[Tau]", ",", 
                "\[CapitalSigma]", ",", "M", ",", "Q", ",", "\[Rho]", ",", 
                "\[Mu]", ",", "\[Beta]m", ",", "\[Lambda]1", ",", 
                "\[Lambda]2", ",", "\[Omega]1", ",", "\[Omega]2"}], "]"}], 
              "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Omega]2", ",", "0", " ", ",", 
               RowBox[{"2", "period2"}]}], "}"}], ",", 
             RowBox[{"PlotPoints", "\[Rule]", "50"}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
             RowBox[{"PlotLabel", "\[Rule]", 
              RowBox[{"\"\<1st Inverse Fourier: K =\>\"", "<>", 
               RowBox[{"ToString", "[", 
                RowBox[{"KList", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", 
               "\"\< \[Omega]1=\>\"", "<>", 
               RowBox[{"ToString", "[", "\[Omega]1", "]"}]}]}]}], "]"}], ",", 
           
           RowBox[{"{", 
            RowBox[{"\[Omega]1", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.2", ",", "2"}], "}"}]}], "}"}]}], "]"}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "6"}], "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "6"}], "]"}]}], " ", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\[Omega]2", ",", 
               RowBox[{
                RowBox[{"VectorAdaptativeIntegrateExplosionSafe", "[", 
                 RowBox[{
                  RowBox[{"Function", "[", 
                   RowBox[{"\[Omega]1", ",", 
                    RowBox[{
                    RowBox[{
                    "SmileSymetrizedBiHestonUnderlying2VanillaIntegrand2CC", 
                    "[", 
                    RowBox[{"Y", ",", "\[Beta]1", ",", "b", ",", 
                    RowBox[{"{", 
                    RowBox[{"KList", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", "\[Tau]", ",",
                     "\[CapitalSigma]", ",", "M", ",", "Q", ",", "\[Rho]", 
                    ",", "\[Mu]", ",", "\[Beta]m", ",", "\[Lambda]1", ",", 
                    "\[Lambda]2", ",", "\[Omega]1", ",", "\[Omega]2"}], "]"}],
                     "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
                  "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", ",",
                   "period1n", ",", "\[Epsilon]1", ",", "imax", ",", "1", ",",
                   "startmonitortime", ",", "plafondexplosion", ",", 
                  "initialTailFlag", ",", "InitialTailPosition"}], "]"}], "[",
                 
                RowBox[{"[", 
                 RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Omega]2", ",", "0", ",", "period2", ",", 
               RowBox[{"period2", "/", "30"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"Joined", "\[Rule]", "True"}], ",", 
           RowBox[{"PlotLabel", "\[Rule]", "\"\<2nd Inverse Fourier:\>\""}], 
           ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "]"}]}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "7"}], "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "7"}], "]"}]}], " ", ",", 
        RowBox[{
         RowBox[{
         "Print", "[", 
          "\"\<code integ 2 : \
{i,exploded<1,Abs[increment[[1]]]>\[Epsilon],(i<imax)}\>\"", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
         "Print", "[", 
          "\"\<code integ 1 : \
{i,exploded<1,Abs[increment[[1]]]>\[Epsilon],(i<imax)}\>\"", "]"}]}]}], "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{"VectorAdaptativeIntegrateUnprotected", "[", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{"\[Omega]2", ",", 
           RowBox[{
            RowBox[{"a", "=", 
             RowBox[{"VectorAdaptativeIntegrateExplosionSafe", "[", 
              RowBox[{
               RowBox[{"Function", "[", 
                RowBox[{"\[Omega]1", ",", 
                 RowBox[{
                 "SmileSymetrizedBiHestonUnderlying2VanillaIntegrand2CC", "[",
                   
                  RowBox[{
                  "Y", ",", "\[Beta]1", ",", "b", ",", "KList", ",", "\[Tau]",
                    ",", "\[CapitalSigma]", ",", "M", ",", "Q", ",", "\[Rho]",
                    ",", "\[Mu]", ",", "\[Beta]m", ",", "\[Lambda]1", ",", 
                   "\[Lambda]2", ",", "\[Omega]1", ",", "\[Omega]2"}], 
                  "]"}]}], "]"}], ",", "LegendreCoef1", ",", "LegendreCoef1n",
                ",", "period1", ",", "period1n", ",", "\[Epsilon]1", ",", 
               "imax", ",", 
               RowBox[{"Length", "[", "KList", "]"}], ",", "startmonitortime",
                ",", "plafondexplosion", ",", "initialTailFlag", ",", 
               "InitialTailPosition"}], "]"}]}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"printflag", "\[Equal]", "7"}], "||", " ", 
               RowBox[{"MemberQ", "[", 
                RowBox[{"printflag", ",", "7"}], "]"}]}], ",", 
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<\[Omega]2=\>\"", ",", "\[Omega]2", ",", 
                "\"\< Integ_2=\>\"", ",", "a"}], "]"}]}], "]"}], ";", 
            RowBox[{"a", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], ",", "LegendreCoef2", 
         ",", "LegendreCoef1n", ",", "period2", ",", "period2n", ",", 
         "\[Epsilon]2", ",", "imax", ",", 
         RowBox[{"Length", "[", "KList", "]"}], ",", "printflag", ",", 
         "initialTailFlag", ",", "InitialTailPosition2", ",", "kmax", ",", 
         "StartControl", ",", "IncrementFactor"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "7"}], "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "7"}], "]"}]}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Integ_1=\>\"", ",", "res"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"res", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.3997288601267104`*^9, 3.39972890803388*^9, {3.3997289692069297`*^9, 
   3.3997289944261637`*^9}, {3.399729087443575*^9, 3.3997291578199263`*^9}, {
   3.399729214633517*^9, 3.3997292559936857`*^9}, {3.399729338917153*^9, 
   3.399729443137904*^9}, {3.3997297921289797`*^9, 3.399729801332281*^9}, 
   3.3997984631978292`*^9, 3.3997986822957864`*^9, {3.399799475623518*^9, 
   3.3997994825611515`*^9}, {3.399813039024555*^9, 3.3998130523841867`*^9}, {
   3.3998138111956306`*^9, 3.399813818523896*^9}, {3.3998138975254135`*^9, 
   3.3998139300104117`*^9}, {3.399814002074295*^9, 3.3998140680286865`*^9}, {
   3.3998141794214506`*^9, 3.399814187827862*^9}, {3.3998161633189154`*^9, 
   3.399816166818983*^9}, {3.399816989678531*^9, 3.39981701069456*^9}, {
   3.3998175772210617`*^9, 3.3998175797054844`*^9}, {3.3998177980534267`*^9, 
   3.3998178039285393`*^9}, 3.3998191717048006`*^9, {3.399819229424659*^9, 
   3.399819249925052*^9}, {3.3998192996916327`*^9, 3.3998193255202537`*^9}, {
   3.3998194002404385`*^9, 3.399819401990472*^9}, {3.399819437022394*^9, 
   3.399819443678772*^9}, {3.3998195847752314`*^9, 3.3998195956035643`*^9}, {
   3.3998937261423693`*^9, 3.3998937440645885`*^9}, {3.399894673945778*^9, 
   3.3998946780865884`*^9}, 3.399895357951172*^9, {3.3998971752360635`*^9, 
   3.399897202986596*^9}, {3.399995099817901*^9, 3.3999951242558703`*^9}, {
   3.3999951653972855`*^9, 3.3999952424143887`*^9}, {3.399995434089944*^9, 
   3.3999954559809895`*^9}, 3.400214359554536*^9, {3.4002194753715076`*^9, 
   3.4002194862310915`*^9}, {3.400221264780864*^9, 3.400221267812172*^9}, {
   3.400221324438259*^9, 3.4002213249851446`*^9}, {3.4002307045682325`*^9, 
   3.4002307106777253`*^9}, {3.4002309417446613`*^9, 
   3.4002309457603636`*^9}, {3.4002355676772275`*^9, 
   3.4002356840075865`*^9}, {3.4002357813375797`*^9, 3.400235782228222*^9}, {
   3.400238239244146*^9, 3.40023824052542*^9}, {3.4004065560321016`*^9, 
   3.400406572266788*^9}, 3.40040661272069*^9, {3.400406710910075*^9, 
   3.400406802349331*^9}, {3.4004079962316275`*^9, 3.400408003981776*^9}, {
   3.4004080367167797`*^9, 3.400408037591797*^9}, {3.400408141500042*^9, 
   3.4004081422656813`*^9}, 3.400504474791651*^9, {3.4008198209228888`*^9, 
   3.4008198369544463`*^9}, {3.401177200473509*^9, 3.401177296365975*^9}, 
   3.4011776191065464`*^9, 3.4011776885297546`*^9, {3.4011777732345057`*^9, 
   3.4011777815627904`*^9}, {3.4015301347651124`*^9, 3.401530142671514*^9}, {
   3.4015342195318975`*^9, 3.4015342774861345`*^9}, {3.4015343731285963`*^9, 
   3.4015343749255056`*^9}, {3.402033437670154*^9, 3.402033457561161*^9}, {
   3.4020334928118377`*^9, 3.402033502483898*^9}, {3.402143403333747*^9, 
   3.402143421193465*^9}, {3.402143489991661*^9, 3.40214349125731*^9}, {
   3.402143653151044*^9, 3.4021436941674557`*^9}, {3.402205803123693*^9, 
   3.402205848499564*^9}, {3.402294611715026*^9, 3.4022946131681786`*^9}, 
   3.402294775718175*^9, {3.4022949263773174`*^9, 3.4022949270960813`*^9}, 
   3.4023779225819693`*^9, 3.402388039487956*^9, 3.4023881114109564`*^9, 
   3.403871476831417*^9, 3.403871589333577*^9, {3.403871732195695*^9, 
   3.4038719361371107`*^9}, 3.40387197021589*^9, {3.4038729130621176`*^9, 
   3.403872917359075*^9}, {3.4038732665532794`*^9, 3.4038732913350053`*^9}, {
   3.40387338716497*^9, 3.403873392790078*^9}, {3.4038739059561806`*^9, 
   3.403873929300379*^9}, {3.4038757265536356`*^9, 3.403875727100521*^9}, {
   3.4038760173873444`*^9, 3.403876028450057*^9}, {3.4038767128225718`*^9, 
   3.4038767355730085`*^9}, {3.403876883685227*^9, 3.403876894872942*^9}, 
   3.4038770811577682`*^9, {3.403877262489375*^9, 3.403877296927536*^9}, {
   3.4038779003609967`*^9, 3.4038779017516484`*^9}, {3.403877950330706*^9, 
   3.403877995722203*^9}, {3.4038805669746947`*^9, 3.4038805816156006`*^9}, {
   3.403940196949411*^9, 3.403940212309081*^9}, {3.4039402503098106`*^9, 
   3.403940330483225*^9}, {3.403940565097104*^9, 3.4039406320983906`*^9}, {
   3.4039477736886315`*^9, 3.4039478349866834`*^9}, 3.403947942238743*^9, {
   3.4039479736924715`*^9, 3.403948027771635*^9}, 3.403948162852353*^9, {
   3.4039491169487963`*^9, 3.4039491206988688`*^9}, {3.4039492631391034`*^9, 
   3.4039493470938406`*^9}, {3.4039496376931696`*^9, 3.403949723882324*^9}, {
   3.4039498424783516`*^9, 3.4039499998719983`*^9}, 3.403962196184288*^9, 
   3.403962253482263*^9, {3.4041495661393347`*^9, 3.404149603407735*^9}, {
   3.4041552539579353`*^9, 3.404155264519135*^9}, {3.404197468258934*^9, 
   3.404197471821502*^9}, 3.4041980689267163`*^9, {3.404300362346734*^9, 
   3.4043004127347345`*^9}, 3.4043255380825434`*^9, {3.4043255819497433`*^9, 
   3.404325585849744*^9}, {3.4043271034385433`*^9, 3.4043271075257435`*^9}, {
   3.4043271542477436`*^9, 3.4043271966641436`*^9}, {3.4043274203057437`*^9, 
   3.4043274586505437`*^9}, {3.404329140177744*^9, 3.4043291626729436`*^9}, 
   3.4043891322959437`*^9, {3.404455255814979*^9, 3.40445525812224*^9}, {
   3.404457063614731*^9, 3.4044570649272814`*^9}, {3.4044575251110773`*^9, 
   3.404457527392312*^9}, {3.4044576775163517`*^9, 3.4044576936568737`*^9}, {
   3.4044578537980456`*^9, 3.404457858188755*^9}, 3.4044581376165733`*^9, 
   3.4044669620665116`*^9, {3.4046514953038807`*^9, 3.40465150986666*^9}, {
   3.404662922704545*^9, 3.404662967960145*^9}, 3.4048268609794245`*^9, {
   3.404827111567172*^9, 3.4048271183643084`*^9}, {3.405009417314748*^9, 
   3.4050094323687477`*^9}, {3.405010698151948*^9, 3.405010704735148*^9}, {
   3.4059348497269945`*^9, 3.4059348790869336`*^9}, {3.4059350146207857`*^9, 
   3.4059350545590525`*^9}, 3.4059356681177073`*^9, {3.4059362836451507`*^9, 
   3.405936284832673*^9}, {3.4059367564198527`*^9, 3.405936764826264*^9}, {
   3.4059392312017426`*^9, 3.4059392316080008`*^9}, 3.406469525722954*^9, {
   3.406470982697751*^9, 3.406471013245408*^9}, 3.4064715278523316`*^9, {
   3.4065419565000086`*^9, 3.4065420110795307`*^9}, {3.4065424567628145`*^9, 
   3.4065425074516125`*^9}, 3.4065433053001614`*^9, {3.4065539745537605`*^9, 
   3.406554001726331*^9}, {3.406554751151766*^9, 3.406554751854909*^9}, {
   3.4065575425669746`*^9, 3.4065575450357876`*^9}, {3.4065579280455923`*^9, 
   3.406557928545605*^9}, {3.4065583523845797`*^9, 3.406558354290879*^9}, {
   3.4065619445702877`*^9, 3.4065619641332884`*^9}, 3.4066113721987553`*^9, 
   3.4066121962042246`*^9, 3.40695961301915*^9, 3.4069597806317425`*^9, 
   3.4069686041917768`*^9, 3.4069734600037565`*^9, 3.4084276365536146`*^9, {
   3.4084295409183025`*^9, 3.408429546449659*^9}, {3.4084297240936947`*^9, 
   3.4084297251874657`*^9}, {3.4084462163947153`*^9, 3.408446221176058*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Integrands", "Subsubtitle",
 CellChangeTimes->{{3.4046313097306566`*^9, 3.404631312230688*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SmileSymetrizedBiHestonUnderlying2VanillaIntegrand", "[", 
    RowBox[{
    "Y_", ",", "\[Beta]1_", ",", "b_", ",", "KList_", ",", "\[Tau]_", ",", 
     "\[CapitalSigma]_", ",", "M_", ",", "Q_", ",", "\[Rho]_", ",", "\[Mu]_", 
     ",", "\[Beta]_", ",", "\[Lambda]1_", ",", "\[Lambda]2_", ",", 
     "\[Omega]1_", ",", "\[Omega]2_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x1", "=", 
        RowBox[{"Y", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", 
       RowBox[{"x2", "=", 
        RowBox[{"Y", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ",", 
       RowBox[{"k1", "=", 
        RowBox[{"(", 
         RowBox[{"\[Omega]1", "+", 
          RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1"}]}], ")"}]}], ",", 
       RowBox[{"Sk1", "=", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "\[Omega]1"}], "+", 
          RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1"}]}], ")"}]}], ",", 
       RowBox[{"k2", "=", " ", 
        RowBox[{"(", 
         RowBox[{"\[Omega]2", "+", 
          RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2"}]}], ")"}]}], ",", 
       RowBox[{"Sk1A", "=", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "\[Omega]1"}], "-", 
          RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1"}]}], ")"}]}], ",", 
       RowBox[{"k1A", "=", 
        RowBox[{"(", 
         RowBox[{"\[Omega]1", "-", 
          RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1"}]}], ")"}]}], ",", 
       RowBox[{"k2A", "=", 
        RowBox[{"(", 
         RowBox[{"\[Omega]2", "+", 
          RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2"}]}], ")"}]}], ",", 
       "\[Alpha]", ",", "\[Alpha]A", ",", "Sym\[Alpha]", ",", "Sym\[Alpha]A", 
       ",", "\[Alpha]2", ",", "\[Alpha]A2", ",", "Sym\[Alpha]2", ",", 
       "Sym\[Alpha]A2", ",", "propagatorDroit", ",", "SympropagatorDroit", 
       ",", "propagatorGauche", ",", "SympropagatorGauche", ",", 
       "propagatorDroit2", ",", "SympropagatorDroit2", ",", 
       "propagatorGauche2", ",", "SympropagatorGauche2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Re", "[", 
      RowBox[{
       RowBox[{"\[Alpha]", "=", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", "x1", " ", "k1"}], "-", 
          RowBox[{"\[ImaginaryI]", " ", "x2", " ", "k2"}]}]]}], ";", 
       RowBox[{"\[Alpha]A", "=", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", "x1", " ", "k1A"}], "-", 
          RowBox[{"\[ImaginaryI]", " ", "x2", " ", "k2A"}]}]]}], ";", 
       RowBox[{"Sym\[Alpha]", "=", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", "x1", " ", "Sk1"}], "-", 
          RowBox[{"\[ImaginaryI]", " ", "x2", " ", "k2"}]}]]}], ";", 
       RowBox[{"Sym\[Alpha]A", "=", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", "x1", " ", "Sk1A"}], "-", 
          RowBox[{"\[ImaginaryI]", " ", "x2", " ", "k2A"}]}]]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"propagatorDroit", "=", 
        RowBox[{"BiHestonLaplaceQuickTransform", "[", 
         RowBox[{
         "M", ",", "Q", ",", "\[Rho]", ",", " ", "\[Mu]", ",", 
          "\[CapitalSigma]", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], " ", "k1"}], ",", 
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], " ", "k2"}]}], "}"}], ",", 
          "\[Beta]", ",", "\[Tau]"}], "]"}]}], ";", 
       RowBox[{"SympropagatorDroit", "=", 
        RowBox[{"BiHestonLaplaceQuickTransform", "[", 
         RowBox[{
         "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", " ", 
          "\[CapitalSigma]", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], " ", "Sk1"}], ",", 
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], " ", "k2"}]}], "}"}], ",", 
          "\[Beta]", ",", "\[Tau]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"propagatorGauche", "=", 
        RowBox[{"BiHestonLaplaceQuickTransform", "[", 
         RowBox[{
         "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", " ", 
          "\[CapitalSigma]", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], " ", "k1A"}], ",", 
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], " ", "k2A"}]}], "}"}], ",", 
          "\[Beta]", ",", "\[Tau]"}], "]"}]}], ";", 
       RowBox[{"SympropagatorGauche", "=", 
        RowBox[{"BiHestonLaplaceQuickTransform", "[", 
         RowBox[{
         "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", " ", 
          "\[CapitalSigma]", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], " ", "Sk1A"}], ",", 
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], " ", "k2A"}]}], "}"}], ",", 
          "\[Beta]", ",", "\[Tau]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Alpha]", " ", "propagatorDroit", " ", 
           RowBox[{"SecondUnderlyingVanillaPayOffFourierDroite", "[", 
            RowBox[{"k1", ",", "k2", ",", 
             RowBox[{"KList", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "\[Beta]1", ",", "b"}], 
            "]"}]}], "+", "\[IndentingNewLine]", 
          RowBox[{"Sym\[Alpha]", " ", "SympropagatorDroit", " ", 
           RowBox[{"SecondUnderlyingVanillaPayOffFourierDroite", "[", 
            RowBox[{"Sk1", ",", "k2", ",", 
             RowBox[{"KList", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "\[Beta]1", ",", "b"}], 
            "]"}]}], "+", "\[IndentingNewLine]", 
          RowBox[{"\[Alpha]A", " ", "propagatorGauche", " ", 
           RowBox[{"SecondUnderlyingVanillaPayOffFourierGauche", "[", 
            RowBox[{"k1A", ",", "k2A", ",", 
             RowBox[{"KList", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "\[Beta]1", ",", "b"}], 
            "]"}]}], "+", "\[IndentingNewLine]", 
          RowBox[{"Sym\[Alpha]A", " ", "SympropagatorGauche", " ", 
           RowBox[{"SecondUnderlyingVanillaPayOffFourierGauche", "[", 
            RowBox[{"Sk1A", ",", "k2A", ",", 
             RowBox[{"KList", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "\[Beta]1", ",", "b"}], 
            "]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "KList", "]"}]}], "}"}]}], "]"}]}], "]"}]}],
     "]"}]}], "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.402140085770051*^9, 3.4021400863013115`*^9}, {
   3.4021401238489075`*^9, 3.4021402363666925`*^9}, {3.402140267929798*^9, 
   3.402140316290102*^9}, {3.4021403621347322`*^9, 3.4021403798069468`*^9}, {
   3.402140442948784*^9, 3.4021404698243*^9}, {3.40214052530974*^9, 
   3.4021405261847568`*^9}, {3.402140572076263*^9, 3.4021405730294065`*^9}, {
   3.40214283290092*^9, 3.402142834900958*^9}, 3.402142878995555*^9, {
   3.4021429531532288`*^9, 3.40214297455989*^9}, {3.4021430512488623`*^9, 
   3.4021430865307894`*^9}, {3.402143143625636*^9, 3.4021431463288126`*^9}, {
   3.402143222267771*^9, 3.402143365629898*^9}, {3.4021439797510643`*^9, 
   3.4021440141579747`*^9}, {3.4021444783543873`*^9, 
   3.4021445164332433`*^9}, {3.4021445469025784`*^9, 3.402144574918741*^9}, {
   3.4021446846239724`*^9, 3.4021446895459423`*^9}, {3.4021447226559525`*^9, 
   3.402144729593586*^9}, {3.402144860127342*^9, 3.402144926378614*^9}, {
   3.4021449572542067`*^9, 3.402145180727247*^9}, {3.402149153412896*^9, 
   3.4021491595067635`*^9}, {3.4021496964233217`*^9, 3.402149821410097*^9}, {
   3.40214987416111*^9, 3.402149884755063*^9}, {3.4021499394279876`*^9, 
   3.4021499498344374`*^9}, {3.402150065133526*^9, 3.402150121790864*^9}, {
   3.4021501655260787`*^9, 3.4021502014486437`*^9}, {3.402150388827241*^9, 
   3.4021504643911915`*^9}, {3.4021505016731577`*^9, 3.402150539877016*^9}, {
   3.402150576221464*^9, 3.4021506145190744`*^9}, 3.402150646160307*^9, {
   3.4021507013801165`*^9, 3.402150701614496*^9}, {3.402150792022482*^9, 
   3.4021508226011944`*^9}, {3.4022048852154446`*^9, 
   3.4022049314194565`*^9}, {3.402223441649846*^9, 3.4022234739004655`*^9}, {
   3.4022235664178667`*^9, 3.4022235977934694`*^9}, {3.402225770632062*^9, 
   3.4022257810853877`*^9}, {3.4022260066522183`*^9, 
   3.4022260340902452`*^9}, {3.402227989127781*^9, 3.4022280025967894`*^9}, 
   3.4022280710668545`*^9, {3.4022281624279833`*^9, 3.4022281629904943`*^9}, {
   3.4023193135668306`*^9, 3.4023194603141108`*^9}, {3.402319603150462*^9, 
   3.40231966787294*^9}, {3.4023197252970443`*^9, 3.4023197324378977`*^9}, {
   3.4023205583495092`*^9, 3.4023206749454975`*^9}, {3.4023207399779963`*^9, 
   3.4023207413373976`*^9}, {3.4023208249015017`*^9, 
   3.4023209920765867`*^9}, {3.4023211800958214`*^9, 3.40232123755005*^9}, {
   3.4023216909806304`*^9, 3.4023216975588818`*^9}, {3.402321742184738*^9, 
   3.4023217427316236`*^9}, {3.4023247260232773`*^9, 
   3.4023248331659594`*^9}, {3.4023253919266872`*^9, 
   3.4023255075695324`*^9}, {3.40237831846457*^9, 3.4023783246678143`*^9}, {
   3.403961973148756*^9, 3.4039620282435637`*^9}, {3.4039620755257215`*^9, 
   3.403962089885372*^9}, {3.403984040497946*^9, 3.403984073881946*^9}, 
   3.403985145789146*^9, {3.403985176552346*^9, 3.403985177519546*^9}, 
   3.403985265456746*^9, {3.403985618718746*^9, 3.403985619826346*^9}, 
   3.403985781426746*^9, 3.403985822563946*^9, 3.4041985891085787`*^9, {
   3.4041986270780573`*^9, 3.404198635046961*^9}, {3.4041986966418934`*^9, 
   3.4041987091733837`*^9}, {3.4043005771899347`*^9, 3.404300586456334*^9}, {
   3.404457069943099*^9, 3.404457212808214*^9}, {3.404651547086125*^9, 
   3.4046515778835907`*^9}, 3.404826864807697*^9, {3.4048271315523143`*^9, 
   3.404827136208743*^9}, {3.405009437703948*^9, 3.4050094657371483`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SmileSymetrizedBiHestonUnderlying2VanillaIntegrand2", "[", 
    RowBox[{
    "Y_", ",", "\[Beta]1_", ",", "b_", ",", "KList_", ",", "\[Tau]_", ",", 
     "\[CapitalSigma]_", ",", "M_", ",", "Q_", ",", "\[Rho]_", ",", "\[Mu]_", 
     ",", "\[Beta]m_", ",", "\[Lambda]1_", ",", "\[Lambda]2_", ",", 
     "\[Omega]1_", ",", "\[Omega]2_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x1", "=", 
        RowBox[{"Y", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", 
       RowBox[{"x2", "=", 
        RowBox[{"Y", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ",", 
       RowBox[{"k1", "=", 
        RowBox[{"(", 
         RowBox[{"\[Omega]1", "+", 
          RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1"}]}], ")"}]}], ",", 
       RowBox[{"Sk1", "=", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "\[Omega]1"}], "+", 
          RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1"}]}], ")"}]}], ",", 
       RowBox[{"k2", "=", " ", 
        RowBox[{"(", 
         RowBox[{"\[Omega]2", "+", 
          RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2"}]}], ")"}]}], ",", 
       RowBox[{"Sk1A", "=", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "\[Omega]1"}], "-", 
          RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1"}]}], ")"}]}], ",", 
       RowBox[{"k1A", "=", 
        RowBox[{"(", 
         RowBox[{"\[Omega]1", "-", 
          RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1"}]}], ")"}]}], ",", 
       RowBox[{"k2A", "=", 
        RowBox[{"(", 
         RowBox[{"\[Omega]2", "+", 
          RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2"}]}], ")"}]}], ",", 
       "\[Alpha]", ",", "\[Alpha]A", ",", "Sym\[Alpha]", ",", "Sym\[Alpha]A", 
       ",", "\[Alpha]2", ",", "\[Alpha]A2", ",", "Sym\[Alpha]2", ",", 
       "Sym\[Alpha]A2", ",", "propagatorDroit", ",", "SympropagatorDroit", 
       ",", "propagatorGauche", ",", "SympropagatorGauche", ",", 
       "propagatorDroit2", ",", "SympropagatorDroit2", ",", 
       "propagatorGauche2", ",", "SympropagatorGauche2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Re", "[", 
      RowBox[{
       RowBox[{"\[Alpha]", "=", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", "x1", " ", "k1"}], "-", 
          RowBox[{"\[ImaginaryI]", " ", "x2", " ", "k2"}]}]]}], ";", 
       RowBox[{"\[Alpha]A", "=", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", "x1", " ", "k1A"}], "-", 
          RowBox[{"\[ImaginaryI]", " ", "x2", " ", "k2A"}]}]]}], ";", 
       RowBox[{"Sym\[Alpha]", "=", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", "x1", " ", "Sk1"}], "-", 
          RowBox[{"\[ImaginaryI]", " ", "x2", " ", "k2"}]}]]}], ";", 
       RowBox[{"Sym\[Alpha]A", "=", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", "x1", " ", "Sk1A"}], "-", 
          RowBox[{"\[ImaginaryI]", " ", "x2", " ", "k2A"}]}]]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"propagatorDroit", "=", 
        RowBox[{"BiHestonLaplaceQuickTransform2", "[", 
         RowBox[{
         "M", ",", "Q", ",", "\[Rho]", ",", " ", "\[Mu]", ",", 
          "\[CapitalSigma]", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], " ", "k1"}], ",", 
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], " ", "k2"}]}], "}"}], ",", 
          "\[Beta]m", ",", "\[Tau]"}], "]"}]}], ";", 
       RowBox[{"SympropagatorDroit", "=", 
        RowBox[{"BiHestonLaplaceQuickTransform2", "[", 
         RowBox[{
         "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", " ", 
          "\[CapitalSigma]", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], " ", "Sk1"}], ",", 
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], " ", "k2"}]}], "}"}], ",", 
          "\[Beta]m", ",", "\[Tau]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"propagatorGauche", "=", 
        RowBox[{"BiHestonLaplaceQuickTransform2", "[", 
         RowBox[{
         "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", " ", 
          "\[CapitalSigma]", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], " ", "k1A"}], ",", 
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], " ", "k2A"}]}], "}"}], ",", 
          "\[Beta]m", ",", "\[Tau]"}], "]"}]}], ";", 
       RowBox[{"SympropagatorGauche", "=", 
        RowBox[{"BiHestonLaplaceQuickTransform2", "[", 
         RowBox[{
         "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", " ", 
          "\[CapitalSigma]", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], " ", "Sk1A"}], ",", 
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], " ", "k2A"}]}], "}"}], ",", 
          "\[Beta]m", ",", "\[Tau]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Alpha]", " ", "propagatorDroit", " ", 
           RowBox[{"SecondUnderlyingVanillaPayOffFourierDroite", "[", 
            RowBox[{"k1", ",", "k2", ",", 
             RowBox[{"KList", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "\[Beta]1", ",", "b"}], 
            "]"}]}], "+", "\[IndentingNewLine]", 
          RowBox[{"Sym\[Alpha]", " ", "SympropagatorDroit", " ", 
           RowBox[{"SecondUnderlyingVanillaPayOffFourierDroite", "[", 
            RowBox[{"Sk1", ",", "k2", ",", 
             RowBox[{"KList", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "\[Beta]1", ",", "b"}], 
            "]"}]}], "+", "\[IndentingNewLine]", 
          RowBox[{"\[Alpha]A", " ", "propagatorGauche", " ", 
           RowBox[{"SecondUnderlyingVanillaPayOffFourierGauche", "[", 
            RowBox[{"k1A", ",", "k2A", ",", 
             RowBox[{"KList", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "\[Beta]1", ",", "b"}], 
            "]"}]}], "+", "\[IndentingNewLine]", 
          RowBox[{"Sym\[Alpha]A", " ", "SympropagatorGauche", " ", 
           RowBox[{"SecondUnderlyingVanillaPayOffFourierGauche", "[", 
            RowBox[{"Sk1A", ",", "k2A", ",", 
             RowBox[{"KList", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "\[Beta]1", ",", "b"}], 
            "]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "KList", "]"}]}], "}"}]}], "]"}]}], "]"}]}],
     "]"}]}], "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.402140085770051*^9, 3.4021400863013115`*^9}, {
   3.4021401238489075`*^9, 3.4021402363666925`*^9}, {3.402140267929798*^9, 
   3.402140316290102*^9}, {3.4021403621347322`*^9, 3.4021403798069468`*^9}, {
   3.402140442948784*^9, 3.4021404698243*^9}, {3.40214052530974*^9, 
   3.4021405261847568`*^9}, {3.402140572076263*^9, 3.4021405730294065`*^9}, {
   3.40214283290092*^9, 3.402142834900958*^9}, 3.402142878995555*^9, {
   3.4021429531532288`*^9, 3.40214297455989*^9}, {3.4021430512488623`*^9, 
   3.4021430865307894`*^9}, {3.402143143625636*^9, 3.4021431463288126`*^9}, {
   3.402143222267771*^9, 3.402143365629898*^9}, {3.4021439797510643`*^9, 
   3.4021440141579747`*^9}, {3.4021444783543873`*^9, 
   3.4021445164332433`*^9}, {3.4021445469025784`*^9, 3.402144574918741*^9}, {
   3.4021446846239724`*^9, 3.4021446895459423`*^9}, {3.4021447226559525`*^9, 
   3.402144729593586*^9}, {3.402144860127342*^9, 3.402144926378614*^9}, {
   3.4021449572542067`*^9, 3.402145180727247*^9}, {3.402149153412896*^9, 
   3.4021491595067635`*^9}, {3.4021496964233217`*^9, 3.402149821410097*^9}, {
   3.40214987416111*^9, 3.402149884755063*^9}, {3.4021499394279876`*^9, 
   3.4021499498344374`*^9}, {3.402150065133526*^9, 3.402150121790864*^9}, {
   3.4021501655260787`*^9, 3.4021502014486437`*^9}, {3.402150388827241*^9, 
   3.4021504643911915`*^9}, {3.4021505016731577`*^9, 3.402150539877016*^9}, {
   3.402150576221464*^9, 3.4021506145190744`*^9}, 3.402150646160307*^9, {
   3.4021507013801165`*^9, 3.402150701614496*^9}, {3.402150792022482*^9, 
   3.4021508226011944`*^9}, {3.4022048852154446`*^9, 
   3.4022049314194565`*^9}, {3.402223441649846*^9, 3.4022234739004655`*^9}, {
   3.4022235664178667`*^9, 3.4022235977934694`*^9}, {3.402225770632062*^9, 
   3.4022257810853877`*^9}, {3.4022260066522183`*^9, 
   3.4022260340902452`*^9}, {3.402227989127781*^9, 3.4022280025967894`*^9}, 
   3.4022280710668545`*^9, {3.4022281624279833`*^9, 3.4022281629904943`*^9}, {
   3.4023193135668306`*^9, 3.4023194603141108`*^9}, {3.402319603150462*^9, 
   3.40231966787294*^9}, {3.4023197252970443`*^9, 3.4023197324378977`*^9}, {
   3.4023205583495092`*^9, 3.4023206749454975`*^9}, {3.4023207399779963`*^9, 
   3.4023207413373976`*^9}, {3.4023208249015017`*^9, 
   3.4023209920765867`*^9}, {3.4023211800958214`*^9, 3.40232123755005*^9}, {
   3.4023216909806304`*^9, 3.4023216975588818`*^9}, {3.402321742184738*^9, 
   3.4023217427316236`*^9}, {3.4023247260232773`*^9, 
   3.4023248331659594`*^9}, {3.4023253919266872`*^9, 
   3.4023255075695324`*^9}, {3.40237831846457*^9, 3.4023783246678143`*^9}, {
   3.403961973148756*^9, 3.4039620282435637`*^9}, {3.4039620755257215`*^9, 
   3.403962089885372*^9}, {3.403984040497946*^9, 3.403984073881946*^9}, 
   3.403985145789146*^9, {3.403985176552346*^9, 3.403985177519546*^9}, 
   3.403985265456746*^9, {3.403985618718746*^9, 3.403985619826346*^9}, 
   3.403985781426746*^9, 3.403985822563946*^9, 3.4041985891085787`*^9, {
   3.4041986270780573`*^9, 3.404198635046961*^9}, {3.4041986966418934`*^9, 
   3.4041987091733837`*^9}, {3.4043005771899347`*^9, 3.404300586456334*^9}, {
   3.4043297594041433`*^9, 3.4043297920705433`*^9}, {3.4044570751464233`*^9, 
   3.4044570764746*^9}, {3.404457134618842*^9, 3.4044571778247323`*^9}, {
   3.404457219198267*^9, 3.4044572213230762`*^9}, 3.4044572566011653`*^9, {
   3.404651605196615*^9, 3.404651621946937*^9}, 3.4048268675265512`*^9, {
   3.4048271510999403`*^9, 3.40482715553761*^9}, {3.405009478794348*^9, 
   3.405009503551548*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Fourier Transform of the payoff", "Subsubtitle",
 CellChangeTimes->{{3.4047174737434516`*^9, 3.404717491805258*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SecondUnderlyingVanillaPayOffFourierDroite", "[", 
   RowBox[{"k1_", ",", "k2_", ",", "K_", ",", "\[Beta]_", ",", "b_"}], "]"}], 
  ":=", 
  FractionBox[
   RowBox[{"b", " ", "K", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox["K", "\[Beta]"], ")"}], 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]]}], 
   RowBox[{
    RowBox[{"b", " ", "k1", " ", "k2"}], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     SuperscriptBox["k2", "2"], " ", "k1"}]}]]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.403954614991857*^9, 3.403954664367805*^9}, {
   3.404624481208702*^9, 3.404624482833744*^9}, 3.404624517584634*^9, {
   3.404628392777586*^9, 3.404628410574917*^9}, {3.4046284834674077`*^9, 
   3.4046285313592587`*^9}, 3.404631411872589*^9, {3.404636330466642*^9, 
   3.4046363336229525`*^9}, 3.405003693173147*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SecondUnderlyingVanillaPayOffFourierGauche", "[", 
   RowBox[{"k1_", ",", "k2_", ",", "K_", ",", "\[Beta]_", ",", "b_"}], "]"}], 
  ":=", 
  FractionBox[
   RowBox[{
    RowBox[{"-", "b"}], " ", "K", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox["K", "\[Beta]"], ")"}], 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]]}], 
   RowBox[{
    RowBox[{"b", " ", "k1", " ", "k2"}], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     SuperscriptBox["k2", "2"], " ", "k1"}]}]]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4039546461018295`*^9, 3.4039546738523617`*^9}, {
   3.4046244873494844`*^9, 3.40462448970892*^9}, 3.4046245348819513`*^9, {
   3.4046283964183044`*^9, 3.404628415418791*^9}, {3.4046284886706657`*^9, 
   3.4046285347812214`*^9}, 3.404631397966161*^9, {3.4046363364667573`*^9, 
   3.404636339529316*^9}, {3.4050036877599473`*^9, 3.405003705575147*^9}}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Option Max ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Max", "[", 
       RowBox[{
        RowBox[{"\[Alpha]", " ", 
         SuperscriptBox[
          SubscriptBox["S", "1"], "a"]}], ",", 
        RowBox[{"\[Beta]", " ", 
         SuperscriptBox[
          SubscriptBox["S", "2"], "b"]}]}], "]"}], "-", "K"}], ")"}], "+"], 
   TraditionalForm]]]
}], "Subtitle",
 CellChangeTimes->{{3.4026388686724606`*^9, 3.4026388811727004`*^9}, {
   3.404630792762659*^9, 3.404630809558997*^9}, {3.4048121803219595`*^9, 
   3.4048121923849225`*^9}, 3.4051644862592497`*^9, {3.4059397594150095`*^9, 
   3.405939761977558*^9}}],

Cell["Handling", "Text",
 CellChangeTimes->{{3.4059584675710735`*^9, 3.405958469274232*^9}}],

Cell[CellGroupData[{

Cell["High Level interface", "Subsubtitle",
 CellChangeTimes->{{3.404642425693043*^9, 3.404642434083829*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SmileBiHestonMaxOption", "[", 
   RowBox[{
   "S_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "a_", ",", "b_", ",", 
    "KList1_", ",", "\[Tau]_", ",", "\[CapitalSigma]_", ",", "M_", ",", 
    "\[CapitalSigma]inf_", ",", "\[Beta]_", ",", "\[Rho]_", ",", "\[Mu]_", 
    ",", "printflag_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "KList", ",", "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", 
      ",", "period1n", ",", "\[Epsilon]1", ",", "LegendreCoef2", ",", 
      "period2", ",", "period2n", ",", "\[Epsilon]2", ",", "imax", ",", 
      "\[Lambda]1", ",", "\[Lambda]2", ",", "Q", ",", "KListPositive", ",", 
      "KListNegative", ",", 
      RowBox[{"KPositivePrices", "=", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"KNegativePrices", "=", 
       RowBox[{"{", "}"}]}], ",", "prices", ",", "startmonitortime", ",", 
      "plafondexplosion", ",", "initialTailFlag", ",", "InitialTailPosition", 
      ",", "InitialTailPosition2", ",", "kmax", ",", "StartControl", ",", 
      "IncrementFactor"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "KList1", "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{"KList", "=", 
        RowBox[{"{", "KList1", "}"}]}], ",", 
       RowBox[{"KList", "=", "KList1"}]}], "]"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"Q", "=", 
      RowBox[{
       RowBox[{"CholeskyDecomposition", "[", 
        RowBox[{"-", 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"M", ".", "\[CapitalSigma]inf"}], "+", 
            RowBox[{"\[CapitalSigma]inf", ".", " ", 
             RowBox[{"Transpose", "[", "M", "]"}]}]}], "2"], ")"}]}], "]"}], 
       "/", "\[Beta]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", ",", 
          "period1n", ",", "\[Epsilon]1", ",", "startmonitortime", ",", 
          "plafondexplosion", ",", "initialTailFlag", ",", 
          "InitialTailPosition", ",", "InitialTailPosition2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "LegendreCoef2", ",", "period2", ",", "period2n", ",", "\[Epsilon]2",
           ",", "kmax", ",", "StartControl", ",", "IncrementFactor"}], "}"}], 
        ",", "imax", ",", "\[Lambda]1", ",", "\[Lambda]2"}], "}"}], "=", 
      RowBox[{"BiHestonVanillaOptimalParameters", "[", 
       RowBox[{
       "S", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", "b", ",", 
        RowBox[{"KList", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "\[Tau]", ",", 
        "\[CapitalSigma]", ",", "M", ",", "\[CapitalSigma]inf", ",", "Q", ",",
         "\[Rho]", ",", "\[Mu]", ",", "\"\<MaxOption\>\"", ",", "printflag"}],
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"prices", "=", 
      RowBox[{"SmileBiHestonMaxOptionAux", "[", 
       RowBox[{
       "S", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", "b", ",", 
        "KList1", ",", "\[Tau]", ",", "\[CapitalSigma]", ",", "M", ",", 
        "\[CapitalSigma]inf", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", 
        "\[Beta]", ",", "\[Lambda]1", ",", "\[Lambda]2", ",", 
        RowBox[{"{", 
         RowBox[{
         "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", ",", 
          "period1n", ",", "\[Epsilon]1", ",", "imax", ",", 
          "startmonitortime", ",", "plafondexplosion", ",", "initialTailFlag",
           ",", "InitialTailPosition", ",", "InitialTailPosition2"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{
         "LegendreCoef2", ",", "period2", ",", "period2n", ",", "\[Epsilon]2",
           ",", "kmax", ",", "StartControl", ",", "IncrementFactor"}], "}"}], 
        ",", "printflag"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{"\[Alpha]1", " ", 
             SuperscriptBox[
              RowBox[{"S", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "a"]}], ",", 
            RowBox[{"\[Beta]1", " ", 
             SuperscriptBox[
              RowBox[{"S", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "b"]}]}], "]"}], "-", 
          RowBox[{"KList1", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ",", "0", ",", 
         RowBox[{"prices", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "KList1", "]"}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4042074577632284`*^9, 3.4042074770760994`*^9}, {
   3.4042075328115444`*^9, 3.4042077538626633`*^9}, {3.404207970241818*^9, 
   3.404207993351637*^9}, {3.4042080286491895`*^9, 3.404208043665103*^9}, {
   3.4042173037335176`*^9, 3.4042173873444977`*^9}, {3.4042175109093704`*^9, 
   3.404217554472707*^9}, {3.4042999349691343`*^9, 3.4042999555923347`*^9}, {
   3.404381253215744*^9, 3.404381270172944*^9}, {3.4044634862113743`*^9, 
   3.4044635745846777`*^9}, {3.404463622474383*^9, 3.4044637577842846`*^9}, {
   3.4044637895649247`*^9, 3.4044638511887417`*^9}, {3.404463881485035*^9, 
   3.404463962092862*^9}, {3.4044646348143206`*^9, 3.4044646352830615`*^9}, {
   3.4044659090554795`*^9, 3.4044659091648526`*^9}, {3.404466252111393*^9, 
   3.4044662673767247`*^9}, {3.4044662976417685`*^9, 
   3.4044662980323863`*^9}, {3.4044673732461166`*^9, 
   3.4044673808397207`*^9}, {3.4046519546877003`*^9, 
   3.4046519750474663`*^9}, {3.4046528875181103`*^9, 3.404652993051387*^9}, 
   3.404811180721076*^9, {3.404811251817556*^9, 3.404811256317729*^9}, 
   3.404826602406996*^9, {3.4048266367520647`*^9, 3.4048266473149705`*^9}, {
   3.404838584300705*^9, 3.404838585847639*^9}, 3.405092320454278*^9, {
   3.405164497212655*^9, 3.405164499806472*^9}, {3.4051649727560787`*^9, 
   3.405165018538501*^9}, {3.4051841739727774`*^9, 3.405184192723977*^9}, {
   3.4056657204670115`*^9, 3.4056658337973127`*^9}, {3.4056658862045684`*^9, 
   3.405665887282714*^9}, {3.4056663091345634`*^9, 3.4056663125252533`*^9}, {
   3.4064719553476505`*^9, 3.406471967754218*^9}, 3.406472619411525*^9, {
   3.406557551270322*^9, 3.4065575580517454`*^9}, {3.4066131413846703`*^9, 
   3.406613153213098*^9}, 3.406959953588188*^9, 3.4069601139037666`*^9, {
   3.4069606373981924`*^9, 3.406960644367076*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TestBiHestonMaxOption", "[", 
   RowBox[{
   "S_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "a_", ",", "b_", ",", "K_",
     ",", "\[Tau]_", ",", "\[CapitalSigma]_", ",", "M_", ",", 
    "\[CapitalSigma]inf_", ",", "\[Beta]_", ",", "\[Rho]_", ",", "\[Mu]_", 
    ",", "\[Lambda]1_", ",", "\[Lambda]2_", ",", "scope_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "KList", ",", "period2", ",", "Q", ",", "as", ",", "res", ",", "res2", 
      ",", 
      RowBox[{"Y", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Log", "[", 
          RowBox[{"S", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
         RowBox[{"Log", "[", 
          RowBox[{"S", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}], ",", 
      RowBox[{"\[Omega]1", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Q", "=", 
      RowBox[{
       RowBox[{"CholeskyDecomposition", "[", 
        RowBox[{"-", 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"M", ".", "\[CapitalSigma]inf"}], "+", 
            RowBox[{"\[CapitalSigma]inf", ".", " ", 
             RowBox[{"Transpose", "[", "M", "]"}]}]}], "2"], ")"}]}], "]"}], 
       "/", "\[Beta]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"period2", "=", 
      FractionBox["scope", 
       SqrtBox[
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{"\[CapitalSigma]", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], "+", 
           RowBox[{"\[CapitalSigma]", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "2"}], "]"}], "]"}], "+", 
           RowBox[{"\[CapitalSigma]inf", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], "+", 
           RowBox[{"\[CapitalSigma]inf", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "4"], "\[Tau]"}]]]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"SmileSymetrizedBiHestonMaxOptionIntegrand", "[", 
         RowBox[{
         "Y", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", "b", ",", 
          RowBox[{"{", "K", "}"}], ",", "\[Tau]", ",", "\[CapitalSigma]", ",",
           "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", "\[Beta]", ",", 
          "\[Lambda]1", ",", "\[Lambda]2", ",", "\[Omega]1", ",", 
          "\[Omega]2"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Omega]2", ",", "0", " ", ",", 
         RowBox[{"2", "period2"}]}], "}"}], ",", 
       RowBox[{"PlotPoints", "\[Rule]", "50"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", 
        RowBox[{"\"\<Integrand spreadoption : K =\>\"", "<>", 
         RowBox[{"ToString", "[", "K", "]"}], "<>", "\"\< \[Omega]1=\>\"", "<>",
          
         RowBox[{"ToString", "[", "\[Omega]1", "]"}]}]}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4042074577632284`*^9, 3.4042074770760994`*^9}, {
   3.4042075328115444`*^9, 3.4042077538626633`*^9}, {3.404207970241818*^9, 
   3.404207993351637*^9}, {3.4042080286491895`*^9, 3.404208043665103*^9}, {
   3.4042173037335176`*^9, 3.4042173873444977`*^9}, {3.4042175109093704`*^9, 
   3.404217554472707*^9}, {3.4042999349691343`*^9, 3.4042999555923347`*^9}, {
   3.404381253215744*^9, 3.404381270172944*^9}, {3.4044634862113743`*^9, 
   3.4044635745846777`*^9}, {3.404463622474383*^9, 3.4044637577842846`*^9}, {
   3.4044637895649247`*^9, 3.4044638511887417`*^9}, {3.404463881485035*^9, 
   3.404463962092862*^9}, {3.4044646348143206`*^9, 3.4044646352830615`*^9}, {
   3.4044659090554795`*^9, 3.4044659091648526`*^9}, {3.404466252111393*^9, 
   3.4044662673767247`*^9}, {3.4044662976417685`*^9, 
   3.4044662980323863`*^9}, {3.4044673732461166`*^9, 
   3.4044673808397207`*^9}, {3.4046519546877003`*^9, 
   3.4046519750474663`*^9}, {3.4046528875181103`*^9, 3.404652993051387*^9}, 
   3.404811180721076*^9, {3.404811251817556*^9, 3.404811256317729*^9}, 
   3.404826602406996*^9, {3.4048266367520647`*^9, 3.4048266473149705`*^9}, {
   3.404838584300705*^9, 3.404838585847639*^9}, {3.404888355750947*^9, 
   3.4048883751261473`*^9}, {3.404888409087347*^9, 3.4048884100857472`*^9}, 
   3.404888482298147*^9, {3.404888523107747*^9, 3.404888593260947*^9}, {
   3.4048886239773474`*^9, 3.404888647377347*^9}, {3.4048888242189474`*^9, 
   3.4048888357941475`*^9}, {3.4048891031157475`*^9, 3.404889148121747*^9}, {
   3.404889229444547*^9, 3.404889260831747*^9}, {3.404889328176947*^9, 
   3.404889408579347*^9}, {3.4048896364485474`*^9, 3.4048896370257473`*^9}, {
   3.4048906491191473`*^9, 3.404890657433947*^9}, 3.4048906939379473`*^9, {
   3.4048908372083473`*^9, 3.404890839158347*^9}, {3.4048912343375473`*^9, 
   3.4048912741487474`*^9}, {3.4051645422294326`*^9, 3.4051645498858786`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SmileBiHestonMaxOption2", "[", 
   RowBox[{
   "S_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "a_", ",", "b_", ",", 
    "KList1_", ",", "\[Tau]_", ",", "\[CapitalSigma]_", ",", "M_", ",", 
    "\[CapitalSigma]inf_", ",", "Q_", ",", "\[Rho]_", ",", "\[Mu]_", ",", 
    "printflag_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "KList", ",", "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", 
      ",", "period1n", ",", "\[Epsilon]1", ",", "LegendreCoef2", ",", 
      "period2", ",", "period2n", ",", "\[Epsilon]2", ",", "imax", ",", 
      "\[Lambda]1", ",", "\[Lambda]2", ",", "KListPositive", ",", 
      "KListNegative", ",", 
      RowBox[{"KPositivePrices", "=", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"KNegativePrices", "=", 
       RowBox[{"{", "}"}]}], ",", "\[Beta]m", ",", "prices", ",", 
      "startmonitortime", ",", "plafondexplosion", ",", "initialTailFlag", 
      ",", "InitialTailPosition", ",", "InitialTailPosition2", ",", "kmax", 
      ",", "StartControl", ",", "IncrementFactor"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "KList1", "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{"KList", "=", 
        RowBox[{"{", "KList1", "}"}]}], ",", 
       RowBox[{"KList", "=", "KList1"}]}], "]"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"\[Beta]m", "=", 
      RowBox[{"-", 
       RowBox[{
        RowBox[{"(", 
         FractionBox[
          RowBox[{
           RowBox[{"M", ".", "\[CapitalSigma]inf"}], "+", 
           RowBox[{"\[CapitalSigma]inf", ".", 
            RowBox[{"Transpose", "[", "M", "]"}]}]}], "2"], ")"}], ".", 
        RowBox[{"Inverse", "[", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Transpose", "[", "Q", "]"}], ".", "Q"}], ")"}], 
         "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", ",", 
          "period1n", ",", "\[Epsilon]1", ",", "startmonitortime", ",", 
          "plafondexplosion", ",", "initialTailFlag", ",", 
          "InitialTailPosition", ",", "InitialTailPosition2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "LegendreCoef2", ",", "period2", ",", "period2n", ",", "\[Epsilon]2",
           ",", "kmax", ",", "StartControl", ",", "IncrementFactor"}], "}"}], 
        ",", "imax", ",", "\[Lambda]1", ",", "\[Lambda]2"}], "}"}], "=", 
      RowBox[{"BiHestonVanillaOptimalParameters", "[", 
       RowBox[{
       "S", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", "b", ",", 
        RowBox[{"KList", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "\[Tau]", ",", 
        "\[CapitalSigma]", ",", "M", ",", "\[CapitalSigma]inf", ",", "Q", ",",
         "\[Rho]", ",", "\[Mu]", ",", "\"\<MaxOption\>\"", ",", "printflag"}],
        "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"prices", "=", 
      RowBox[{"SmileBiHestonMaxOptionAux", "[", 
       RowBox[{
       "S", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", "b", ",", 
        "KList1", ",", "\[Tau]", ",", "\[CapitalSigma]", ",", "M", ",", 
        "\[CapitalSigma]inf", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", 
        "\[Beta]m", ",", "\[Lambda]1", ",", "\[Lambda]2", ",", 
        RowBox[{"{", 
         RowBox[{
         "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", ",", 
          "period1n", ",", "\[Epsilon]1", ",", "imax", ",", 
          "startmonitortime", ",", "plafondexplosion", ",", "initialTailFlag",
           ",", "InitialTailPosition", ",", "InitialTailPosition2"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{
         "LegendreCoef2", ",", "period2", ",", "period2n", ",", "\[Epsilon]2",
           ",", "kmax", ",", "StartControl", ",", "IncrementFactor"}], "}"}], 
        ",", "printflag"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{"\[Alpha]1", " ", 
             SuperscriptBox[
              RowBox[{"S", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "a"]}], ",", 
            RowBox[{"\[Beta]1", " ", 
             SuperscriptBox[
              RowBox[{"S", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "b"]}]}], "]"}], "-", 
          RowBox[{"KList1", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ",", "0", ",", 
         RowBox[{"prices", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "KList1", "]"}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4042074577632284`*^9, 3.4042074770760994`*^9}, {
   3.4042075328115444`*^9, 3.4042077538626633`*^9}, {3.404207970241818*^9, 
   3.404207993351637*^9}, {3.4042080286491895`*^9, 3.404208043665103*^9}, {
   3.4042173037335176`*^9, 3.4042173873444977`*^9}, {3.4042175109093704`*^9, 
   3.404217554472707*^9}, {3.4042999349691343`*^9, 3.4042999555923347`*^9}, {
   3.404381253215744*^9, 3.404381270172944*^9}, {3.4044634862113743`*^9, 
   3.4044635745846777`*^9}, {3.404463622474383*^9, 3.4044637577842846`*^9}, {
   3.4044637895649247`*^9, 3.4044638511887417`*^9}, {3.404463881485035*^9, 
   3.404463962092862*^9}, {3.4044640040764313`*^9, 3.4044640086857176`*^9}, 
   3.404464521300875*^9, {3.4044646057055044`*^9, 3.4044646242676477`*^9}, {
   3.404466242564701*^9, 3.404466243330312*^9}, {3.404466359484331*^9, 
   3.404466395764885*^9}, 3.404651957359627*^9, {3.404651989141487*^9, 
   3.4046519954384828`*^9}, {3.404653007770419*^9, 3.404653025192629*^9}, {
   3.404662589800545*^9, 3.404662590237345*^9}, {3.404718208726282*^9, 
   3.4047182136173773`*^9}, 3.4048111841899595`*^9, {3.4048112616773095`*^9, 
   3.4048112656774635`*^9}, 3.4048265968755336`*^9, {3.4048266642843723`*^9, 
   3.404826666581335*^9}, {3.404838607801607*^9, 3.4048386098641863`*^9}, 
   3.4050923021413093`*^9, {3.4051645547297525`*^9, 3.4051645690113683`*^9}, {
   3.4051650300231695`*^9, 3.405165068383527*^9}, 3.4051842118807774`*^9, {
   3.405665873641827*^9, 3.4056658961578846`*^9}, {3.405666290446705*^9, 
   3.405666295853059*^9}, {3.406471984754653*^9, 3.406471992051715*^9}, {
   3.4065575654269342`*^9, 3.406557568958275*^9}, {3.406613165166529*^9, 
   3.4066131785731225`*^9}, 3.4069599401191797`*^9, 3.406960098606598*^9, {
   3.4069606199603577`*^9, 3.4069606265698595`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SmileBiHestonMaxOption3", "[", 
   RowBox[{
   "S_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "a_", ",", "b_", ",", 
    "KList1_", ",", "\[Tau]_", ",", "\[CapitalSigma]_", ",", "M_", ",", "Q_", 
    ",", "\[Beta]_", ",", "\[Rho]_", ",", "\[Mu]_", ",", "printflag_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "KList", ",", "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", 
      ",", "period1n", ",", "\[Epsilon]1", ",", "LegendreCoef2", ",", 
      "period2", ",", "period2n", ",", "\[Epsilon]2", ",", "imax", ",", 
      "\[Lambda]1", ",", "\[Lambda]2", ",", "\[CapitalSigma]inf", ",", 
      "KListPositive", ",", "KListNegative", ",", 
      RowBox[{"KPositivePrices", "=", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"KNegativePrices", "=", 
       RowBox[{"{", "}"}]}], ",", "prices", ",", "startmonitortime", ",", 
      "plafondexplosion", ",", "initialTailFlag", ",", "InitialTailPosition", 
      ",", "InitialTailPosition2", ",", "kmax", ",", "StartControl", ",", 
      "IncrementFactor"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[CapitalSigma]inf", "=", 
      RowBox[{"\[CapitalSigma]inf", "=", 
       RowBox[{"SolveSymetricEquation", "[", 
        RowBox[{"M", ",", 
         RowBox[{
          RowBox[{"-", "2"}], 
          SuperscriptBox["\[Beta]", "2"], " ", 
          RowBox[{
           RowBox[{"Transpose", "[", "Q", "]"}], ".", "Q"}]}]}], "]"}]}]}], 
     " ", ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "KList1", "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{"KList", "=", 
        RowBox[{"{", "KList1", "}"}]}], ",", 
       RowBox[{"KList", "=", "KList1"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", ",", 
          "period1n", ",", "\[Epsilon]1", ",", "startmonitortime", ",", 
          "plafondexplosion", ",", "initialTailFlag", ",", 
          "InitialTailPosition", ",", "InitialTailPosition2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "LegendreCoef2", ",", "period2", ",", "period2n", ",", "\[Epsilon]2",
           ",", "kmax", ",", "StartControl", ",", "IncrementFactor"}], "}"}], 
        ",", "imax", ",", "\[Lambda]1", ",", "\[Lambda]2"}], "}"}], "=", 
      RowBox[{"BiHestonVanillaOptimalParameters", "[", 
       RowBox[{
       "S", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", "b", ",", 
        RowBox[{"KList", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "\[Tau]", ",", 
        "\[CapitalSigma]", ",", "M", ",", "\[CapitalSigma]inf", ",", "Q", ",",
         "\[Rho]", ",", "\[Mu]", ",", "\"\<MaxOption\>\"", ",", "printflag"}],
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"prices", "=", 
      RowBox[{"SmileBiHestonMaxOptionAux", "[", 
       RowBox[{
       "S", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", "b", ",", 
        "KList1", ",", "\[Tau]", ",", "\[CapitalSigma]", ",", "M", ",", 
        "\[CapitalSigma]inf", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", 
        "\[Beta]", ",", "\[Lambda]1", ",", "\[Lambda]2", ",", 
        RowBox[{"{", 
         RowBox[{
         "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", ",", 
          "period1n", ",", "\[Epsilon]1", ",", "imax", ",", 
          "startmonitortime", ",", "plafondexplosion", ",", "initialTailFlag",
           ",", "InitialTailPosition", ",", "InitialTailPosition2"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{
         "LegendreCoef2", ",", "period2", ",", "period2n", ",", "\[Epsilon]2",
           ",", "kmax", ",", "StartControl", ",", "IncrementFactor"}], "}"}], 
        ",", "printflag"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{"\[Alpha]1", " ", 
             SuperscriptBox[
              RowBox[{"S", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "a"]}], ",", 
            RowBox[{"\[Beta]1", " ", 
             SuperscriptBox[
              RowBox[{"S", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "b"]}]}], "]"}], "-", 
          RowBox[{"KList1", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ",", "0", ",", 
         RowBox[{"prices", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "KList1", "]"}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4042074577632284`*^9, 3.4042074770760994`*^9}, {
   3.4042075328115444`*^9, 3.4042077538626633`*^9}, {3.404207970241818*^9, 
   3.404207993351637*^9}, {3.4042080286491895`*^9, 3.404208043665103*^9}, {
   3.4042173037335176`*^9, 3.4042173873444977`*^9}, {3.4042175109093704`*^9, 
   3.404217554472707*^9}, {3.4042999349691343`*^9, 3.4042999555923347`*^9}, {
   3.404381253215744*^9, 3.404381270172944*^9}, {3.4044634862113743`*^9, 
   3.4044635745846777`*^9}, {3.404463622474383*^9, 3.4044637577842846`*^9}, {
   3.4044637895649247`*^9, 3.4044638511887417`*^9}, {3.404463881485035*^9, 
   3.404463962092862*^9}, {3.4044646348143206`*^9, 3.4044646352830615`*^9}, {
   3.4044659090554795`*^9, 3.4044659091648526`*^9}, {3.404466252111393*^9, 
   3.4044662673767247`*^9}, {3.4044662976417685`*^9, 
   3.4044662980323863`*^9}, {3.4044673732461166`*^9, 
   3.4044673808397207`*^9}, {3.4046519546877003`*^9, 
   3.4046519750474663`*^9}, {3.4046528875181103`*^9, 3.404652993051387*^9}, 
   3.404811180721076*^9, {3.404811251817556*^9, 3.404811256317729*^9}, 
   3.404826602406996*^9, {3.4048266367520647`*^9, 3.4048266473149705`*^9}, {
   3.404838584300705*^9, 3.404838585847639*^9}, 3.405092320454278*^9, {
   3.405164497212655*^9, 3.405164499806472*^9}, {3.4051649727560787`*^9, 
   3.405165018538501*^9}, {3.4051841739727774`*^9, 3.405184192723977*^9}, {
   3.4056657204670115`*^9, 3.4056658337973127`*^9}, {3.4056658862045684`*^9, 
   3.405665887282714*^9}, {3.4056663091345634`*^9, 3.4056663125252533`*^9}, {
   3.4064719553476505`*^9, 3.406471967754218*^9}, 3.406472619411525*^9, {
   3.406557551270322*^9, 3.4065575580517454`*^9}, {3.4066131413846703`*^9, 
   3.406613153213098*^9}, 3.406959953588188*^9, 3.4069601139037666`*^9, {
   3.4069606373981924`*^9, 3.406960644367076*^9}, {3.407057970063616*^9, 
   3.4070580196739435`*^9}, 3.4075833666634007`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TestNormalizedBiHestonMaxOption", "[", 
   RowBox[{
   "S_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "a_", ",", "b_", ",", "K_",
     ",", "\[Tau]_", ",", "\[CapitalSigma]_", ",", "M_", ",", 
    "\[CapitalSigma]inf_", ",", "\[Beta]_", ",", "\[Rho]_", ",", 
    "\[Lambda]1_", ",", "\[Lambda]2_", ",", "scope_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Q", ",", "period2", ",", 
      RowBox[{"\[Alpha]2", "=", 
       FractionBox["0.2", 
        SqrtBox[
         RowBox[{"\[CapitalSigma]", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]]]}], ",", 
      RowBox[{"\[Beta]2", "=", 
       FractionBox["0.2", 
        SqrtBox[
         RowBox[{"\[CapitalSigma]", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}]]]}], ",", "H", ",", "HInv", 
      ",", "Sa", ",", "am", ",", "bm", ",", "\[CapitalSigma]a", ",", "Ma", 
      ",", "\[CapitalSigma]infa", ",", "\[Mu]", ",", 
      RowBox[{"\[Omega]1", "=", "0"}], ",", 
      RowBox[{"Y", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Log", "[", 
          RowBox[{"S", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
         RowBox[{"Log", "[", 
          RowBox[{"S", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"H", "=", 
      RowBox[{"(", GridBox[{
         {"\[Alpha]2", "0"},
         {"0", "\[Beta]2"}
        }], ")"}]}], ";", 
     RowBox[{"HInv", "=", 
      RowBox[{"(", GridBox[{
         {
          SuperscriptBox["\[Alpha]2", 
           RowBox[{"-", "1"}]], "0"},
         {"0", 
          SuperscriptBox["\[Beta]2", 
           RowBox[{"-", "1"}]]}
        }], ")"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Sa", "=", 
      RowBox[{"H", ".", "S"}]}], ";", 
     RowBox[{"am", "=", 
      RowBox[{"a", "/", " ", "\[Alpha]2"}]}], ";", 
     RowBox[{"bm", "=", 
      RowBox[{"b", " ", "/", "\[Beta]2"}]}], ";", 
     RowBox[{"\[CapitalSigma]a", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"H", ".", "\[CapitalSigma]"}], ")"}], ".", "H"}]}], ";", 
     RowBox[{"Ma", "=", 
      RowBox[{"H", ".", "M", ".", "HInv"}]}], ";", 
     RowBox[{"\[CapitalSigma]infa", "=", 
      RowBox[{"H", ".", "\[CapitalSigma]inf", ".", "H"}]}], ";", 
     RowBox[{"\[Mu]", "=", 
      RowBox[{"{", 
       RowBox[{
        FractionBox[
         RowBox[{"\[Alpha]2", 
          RowBox[{"(", 
           RowBox[{"\[Alpha]2", "-", "1"}], ")"}]}], "2"], ",", 
        FractionBox[
         RowBox[{"\[Beta]2", 
          RowBox[{"(", 
           RowBox[{"\[Beta]2", "-", "1"}], ")"}]}], "2"]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Q", "=", 
      RowBox[{
       RowBox[{"CholeskyDecomposition", "[", 
        RowBox[{"-", 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"M", ".", "\[CapitalSigma]inf"}], "+", 
            RowBox[{"\[CapitalSigma]inf", ".", " ", 
             RowBox[{"Transpose", "[", "M", "]"}]}]}], "2"], ")"}]}], "]"}], 
       "/", "\[Beta]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"period2", "=", 
      FractionBox["scope", 
       SqrtBox[
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{"\[CapitalSigma]", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], "+", 
           RowBox[{"\[CapitalSigma]", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "2"}], "]"}], "]"}], "+", 
           RowBox[{"\[CapitalSigma]inf", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], "+", 
           RowBox[{"\[CapitalSigma]inf", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "4"], "\[Tau]"}]]]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"SmileSymetrizedBiHestonMaxOptionIntegrand", "[", 
         RowBox[{
         "Y", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", "b", ",", 
          RowBox[{"{", "K", "}"}], ",", "\[Tau]", ",", "\[CapitalSigma]", ",",
           "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", "\[Beta]", ",", 
          "\[Lambda]1", ",", "\[Lambda]2", ",", "\[Omega]1", ",", 
          "\[Omega]2"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Omega]2", ",", "0", " ", ",", 
         RowBox[{"2", "period2"}]}], "}"}], ",", 
       RowBox[{"PlotPoints", "\[Rule]", "50"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", 
        RowBox[{"\"\<Integrand spreadoption : K =\>\"", "<>", 
         RowBox[{"ToString", "[", "K", "]"}], "<>", "\"\< \[Omega]1=\>\"", "<>",
          
         RowBox[{"ToString", "[", "\[Omega]1", "]"}]}]}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4042074577632284`*^9, 3.4042074770760994`*^9}, {
   3.4042075328115444`*^9, 3.4042077538626633`*^9}, {3.404207970241818*^9, 
   3.404207993351637*^9}, {3.4042080286491895`*^9, 3.404208043665103*^9}, {
   3.4042173037335176`*^9, 3.4042173873444977`*^9}, {3.4042175109093704`*^9, 
   3.404217554472707*^9}, {3.4042999349691343`*^9, 3.4042999555923347`*^9}, {
   3.404381253215744*^9, 3.404381270172944*^9}, {3.4044634862113743`*^9, 
   3.4044635745846777`*^9}, {3.404463622474383*^9, 3.4044637577842846`*^9}, {
   3.4044637895649247`*^9, 3.4044638511887417`*^9}, {3.404463881485035*^9, 
   3.404463962092862*^9}, {3.4044646348143206`*^9, 3.4044646352830615`*^9}, {
   3.4044659090554795`*^9, 3.4044659091648526`*^9}, {3.404466252111393*^9, 
   3.4044662673767247`*^9}, {3.4044662976417685`*^9, 
   3.4044662980323863`*^9}, {3.4044673732461166`*^9, 
   3.4044673808397207`*^9}, {3.4046519546877003`*^9, 
   3.4046519750474663`*^9}, {3.4046528875181103`*^9, 3.404652993051387*^9}, 
   3.404811180721076*^9, {3.404811251817556*^9, 3.404811256317729*^9}, 
   3.404826602406996*^9, {3.4048266367520647`*^9, 3.4048266473149705`*^9}, {
   3.404838584300705*^9, 3.404838585847639*^9}, {3.404888355750947*^9, 
   3.4048883751261473`*^9}, {3.404888409087347*^9, 3.4048884100857472`*^9}, 
   3.404888482298147*^9, {3.404888523107747*^9, 3.404888593260947*^9}, {
   3.4048886239773474`*^9, 3.404888647377347*^9}, {3.4048888242189474`*^9, 
   3.4048888357941475`*^9}, {3.4048891031157475`*^9, 3.404889148121747*^9}, {
   3.404889229444547*^9, 3.404889260831747*^9}, {3.404889328176947*^9, 
   3.404889408579347*^9}, {3.4048896364485474`*^9, 3.4048896370257473`*^9}, {
   3.4048906491191473`*^9, 3.404890657433947*^9}, 3.4048906939379473`*^9, {
   3.4048908372083473`*^9, 3.404890839158347*^9}, {3.4048912343375473`*^9, 
   3.4048912741487474`*^9}, {3.4050692133627515`*^9, 3.40506921642533*^9}, {
   3.4050692513793497`*^9, 3.4050693694136214`*^9}, 3.405070054212402*^9, 
   3.4050704530976133`*^9, {3.405070559975349*^9, 3.405070577288292*^9}, {
   3.4050706654467993`*^9, 3.4050706669937134`*^9}, {3.40507077740279*^9, 
   3.4050707859655094`*^9}, {3.405071812273032*^9, 3.4050720116531363`*^9}, {
   3.40507212607794*^9, 3.4050721266873307`*^9}, {3.405164582417961*^9, 
   3.4051645891525087`*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "utilise", " ", "une", " ", "matrice", " ", "complete", "  ", "comme", " ", 
   "vol", " ", "de", " ", "vol"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.4043007956367345`*^9, 3.4043008208619347`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "assume", " ", "the", " ", "list", " ", "of", " ", "strike", " ", "with", 
    " ", "negative", " ", "strikes", " ", "before", " ", "the", " ", 
    "positve", " ", "ones"}], " ", "*)"}], " "}]], "Input",
 CellChangeTimes->{{3.404464641454818*^9, 3.4044646798134565`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Integration Bi Dimensional", "Subsubtitle",
 CellChangeTimes->{{3.404641430673939*^9, 3.4046414450023394`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SmileBiHestonMaxOptionAux", "[", 
   RowBox[{
   "S_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "a_", ",", "b_", ",", 
    "KList_", ",", "\[Tau]_", ",", "\[CapitalSigma]_", ",", "M_", ",", 
    "\[CapitalSigma]inf_", ",", "Q_", ",", "\[Rho]_", ",", "\[Mu]_", ",", 
    "\[Beta]_", ",", "\[Lambda]1_", ",", "\[Lambda]2_", ",", 
    RowBox[{"{", 
     RowBox[{
     "LegendreCoef1_", ",", "LegendreCoef1n_", ",", "period1_", ",", 
      "period1n_", ",", "\[Epsilon]1_", ",", "imax_", ",", 
      "startmonitortime_", ",", "plafondexplosion_", ",", "initialTailFlag_", 
      ",", "InitialTailPosition_", ",", "InitialTailPosition2_"}], "}"}], ",",
     
    RowBox[{"{", 
     RowBox[{
     "LegendreCoef2_", ",", "period2_", ",", "period2n_", ",", "\[Epsilon]2_",
       ",", "kmax_", ",", "StartControl_", ",", "IncrementFactor_"}], "}"}], 
    ",", "printflag_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{
   FractionBox["2", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"2", "\[Pi]"}], ")"}], "2"]], 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"as", ",", "res", ",", "res2", ",", 
       RowBox[{"Y", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Log", "[", 
           RowBox[{"S", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
          RowBox[{"Log", "[", 
           RowBox[{"S", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "1"}], " ", "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "1"}], "]"}]}], "  ", ",", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\< S=\>\"", ",", 
           RowBox[{"S", " ", "//", " ", "MatrixForm"}], ",", 
           "\"\< \[CapitalSigma]=\>\"", ",", 
           RowBox[{"\[CapitalSigma]", " ", "//", "MatrixForm"}], ",", 
           "\"\<M=\>\"", ",", 
           RowBox[{"M", "//", "MatrixForm"}], ",", 
           "\"\< \[CapitalSigma]inf=\>\"", ",", 
           RowBox[{"\[CapitalSigma]inf", "//", "MatrixForm"}], " ", ",", 
           "\"\< Q=\>\"", ",", 
           RowBox[{"Q", "//", "MatrixForm"}], " ", ",", "\"\< \[Rho]=\>\"", 
           ",", 
           RowBox[{"\[Rho]", "//", "MatrixForm"}], ",", "\"\< \[Mu]=\>\"", 
           ",", 
           RowBox[{"\[Mu]", "//", "MatrixForm"}], ",", "\"\< \[Beta]=\>\"", 
           ",", "\[Beta]", ",", "\"\< T=\>\"", ",", "\[Tau]"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Inner Integration\>\"", ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\"\<LegendreNbMain\>\"", ",", 
                RowBox[{"Length", "[", "LegendreCoef1", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<LegendreNbIncrement\>\"", ",", 
                RowBox[{"Length", "[", "LegendreCoef1n", "]"}]}], "}"}], ",", 
              
              RowBox[{"{", 
               RowBox[{"\"\<IncrementNbMax\>\"", ",", "imax"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<InitialTailFlag\>\"", ",", "initialTailFlag"}], 
               "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<InitialTailLegendreNb\>\"", ",", 
                RowBox[{"Length", "[", "LegendreCoef2", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<PeriodMain\>\"", ",", "period1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<PeriodnIncrement\>\"", ",", "period1n"}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"\"\<StoppingLevel\>\"", ",", "\[Epsilon]1"}], "}"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"\"\<AbcisseMaxValue\>\"", ",", "kmax"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
               "\"\<InitialTailUpperLimit\>\"", ",", "InitialTailPosition"}], 
               "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
               "\"\<ExplosionMonitoringStartAbcisse\>\"", ",", 
                "StartControl"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
               "\"\<ExplosionMonitoringMaxLevel\>\"", ",", 
                "IncrementFactor"}], "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"\"\<lambda1\>\"", ",", "\[Lambda]1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<lambda2\>\"", ",", "\[Lambda]2"}], "}"}]}], "}"}],
             " ", "//", " ", "MatrixForm"}], ",", "\[IndentingNewLine]", 
           "\"\<Outer Integration\>\"", ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\"\<LegendreNbMain\>\"", ",", 
                RowBox[{"Length", "[", "LegendreCoef2", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<LegendreNbIncrement\>\"", ",", 
                RowBox[{"Length", "[", "LegendreCoef1n", "]"}]}], "}"}], ",", 
              
              RowBox[{"{", 
               RowBox[{"\"\<IncrementNbMax\>\"", ",", "imax"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<InitialTailFlag\>\"", ",", "initialTailFlag"}], 
               "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<InitialTailLegendreNb\>\"", ",", 
                RowBox[{"Length", "[", "LegendreCoef1", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<PeriodMain\>\"", ",", "period2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<PeriodnIncrement\>\"", ",", "period2n"}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"\"\<StoppingLevel\>\"", ",", "\[Epsilon]2"}], "}"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"\"\<AbcisseMaxValue\>\"", ",", "kmax"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
               "\"\<InitialTailUpperLimit\>\"", ",", "InitialTailPosition"}], 
               "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
               "\"\<GrowingControlStartAbcisse\>\"", ",", 
                "startmonitortime"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
               "\"\<GrowingControlMaxFactor\>\"", ",", "plafondexplosion"}], 
               "}"}]}], "}"}], " ", "//", " ", "MatrixForm"}]}], "]"}]}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "2"}], " ", "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "2"}], "]"}]}], "  ", ",", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<BiHestonLaplaceQuickTransform[M,Q,\[Rho], \
\[Mu],\[CapitalSigma],{-\[ImaginaryI] 1,-\[ImaginaryI] \
1},\[Beta],\[Tau]]=\>\"", ",", 
           RowBox[{"BiHestonLaplaceQuickTransform", "[", 
            RowBox[{
            "M", ",", "Q", ",", "\[Rho]", ",", " ", "\[Mu]", ",", 
             "\[CapitalSigma]", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "\[ImaginaryI]"}], " ", "1"}], ",", 
               RowBox[{
                RowBox[{"-", "\[ImaginaryI]"}], " ", "1"}]}], "}"}], ",", 
             "\[Beta]", ",", "\[Tau]"}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<integrand(0.1,0.1)=\>\"", ",", 
           RowBox[{"SmileSymetrizedBiHestonMaxOptionIntegrandCC", "[", 
            RowBox[{
            "Y", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", "b", ",", 
             "KList", ",", "\[Tau]", ",", "\[CapitalSigma]", ",", "M", ",", 
             "Q", ",", "\[Rho]", ",", "\[Mu]", ",", "\[Beta]", ",", 
             "\[Lambda]1", ",", "\[Lambda]2", ",", "0.1", ",", "0.1"}], 
            "]"}]}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "4"}], "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "4"}], "]"}]}], " ", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Plot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"SmileSymetrizedBiHestonMaxOptionIntegrand", "[", 
               RowBox[{
               "Y", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", "b", 
                ",", 
                RowBox[{"{", 
                 RowBox[{"KList", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", "\[Tau]", ",", 
                "\[CapitalSigma]", ",", "M", ",", "Q", ",", "\[Rho]", ",", 
                "\[Mu]", ",", "\[Beta]", ",", "\[Lambda]1", ",", "\[Lambda]2",
                 ",", "\[Omega]1", ",", "\[Omega]2"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Omega]2", ",", "0", " ", ",", 
               RowBox[{"2", "period2"}]}], "}"}], ",", 
             RowBox[{"PlotPoints", "\[Rule]", "50"}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
             RowBox[{"PlotLabel", "\[Rule]", 
              RowBox[{"\"\<1st Inverse Fourier: K =\>\"", "<>", 
               RowBox[{"ToString", "[", 
                RowBox[{"KList", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", 
               "\"\< \[Omega]1=\>\"", "<>", 
               RowBox[{"ToString", "[", "\[Omega]1", "]"}]}]}]}], "]"}], ",", 
           
           RowBox[{"{", 
            RowBox[{"\[Omega]1", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.2", ",", "2"}], "}"}]}], "}"}]}], "]"}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "6"}], "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "6"}], "]"}]}], " ", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\[Omega]2", ",", 
               RowBox[{
                RowBox[{"VectorAdaptativeIntegrateExplosionSafe", "[", 
                 RowBox[{
                  RowBox[{"Function", "[", 
                   RowBox[{"\[Omega]1", ",", 
                    RowBox[{
                    RowBox[{
                    "SmileSymetrizedBiHestonMaxOptionIntegrand", "[", 
                    RowBox[{
                    "Y", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", 
                    "b", ",", 
                    RowBox[{"{", 
                    RowBox[{"KList", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", "\[Tau]", ",",
                     "\[CapitalSigma]", ",", "M", ",", "Q", ",", "\[Rho]", 
                    ",", "\[Mu]", ",", "\[Beta]", ",", "\[Lambda]1", ",", 
                    "\[Lambda]2", ",", "\[Omega]1", ",", "\[Omega]2"}], "]"}],
                     "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
                  "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", ",",
                   "period1n", ",", "\[Epsilon]1", ",", "imax", ",", "1", ",",
                   "startmonitortime", ",", "plafondexplosion", ",", 
                  "initialTailFlag", ",", "InitialTailPosition"}], "]"}], "[",
                 
                RowBox[{"[", 
                 RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Omega]2", ",", "0", ",", "period2", ",", 
               RowBox[{"period2", "/", "60"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"Joined", "\[Rule]", "True"}], ",", 
           RowBox[{"PlotLabel", "\[Rule]", "\"\<2nd Inverse Fourier:\>\""}], 
           ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "]"}]}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "7"}], "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "7"}], "]"}]}], " ", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<integrand(0.1,0.1)=\>\"", ",", 
          RowBox[{"SmileSymetrizedBiHestonMaxOptionIntegrand", "[", 
           RowBox[{
           "Y", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", "b", ",", 
            "KList", ",", "\[Tau]", ",", "\[CapitalSigma]", ",", "M", ",", 
            "Q", ",", "\[Rho]", ",", "\[Mu]", ",", "\[Beta]", ",", 
            "\[Lambda]1", ",", "\[Lambda]2", ",", "0.1", ",", "0.1"}], 
           "]"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{"VectorAdaptativeIntegrateUnprotected", "[", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{"\[Omega]2", ",", 
           RowBox[{
            RowBox[{"as", "=", 
             RowBox[{"VectorAdaptativeIntegrateExplosionSafe", "[", 
              RowBox[{
               RowBox[{"Function", "[", 
                RowBox[{"\[Omega]1", ",", 
                 RowBox[{"SmileSymetrizedBiHestonMaxOptionIntegrand", "[", 
                  RowBox[{
                  "Y", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", "b", 
                   ",", "KList", ",", "\[Tau]", ",", "\[CapitalSigma]", ",", 
                   "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", "\[Beta]",
                    ",", "\[Lambda]1", ",", "\[Lambda]2", ",", "\[Omega]1", 
                   ",", "\[Omega]2"}], "]"}]}], "]"}], ",", "LegendreCoef1", 
               ",", "LegendreCoef1n", ",", "period1", ",", "period1n", ",", 
               "\[Epsilon]1", ",", "imax", ",", 
               RowBox[{"Length", "[", "KList", "]"}], ",", "startmonitortime",
                ",", "plafondexplosion", ",", "initialTailFlag", ",", 
               "InitialTailPosition"}], "]"}]}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"printflag", "\[Equal]", "7"}], "||", " ", 
               RowBox[{"MemberQ", "[", 
                RowBox[{"printflag", ",", "7"}], "]"}]}], ",", 
              RowBox[{"Print", "[", 
               RowBox[{"\"\<Integ_2=\>\"", ",", "as"}], "]"}]}], "]"}], ";", 
            RowBox[{"as", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], ",", "LegendreCoef2", 
         ",", "period2", ",", "period2n", ",", "\[Epsilon]2", ",", "imax", 
         ",", 
         RowBox[{"Length", "[", "KList", "]"}], ",", "printflag", ",", 
         "initialTailFlag", ",", "InitialTailPosition2", ",", "kmax", ",", 
         "StartControl", ",", "IncrementFactor"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "7"}], "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "7"}], "]"}]}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Integ_1=\>\"", ",", "res"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"res", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.3997288601267104`*^9, 3.39972890803388*^9, {3.3997289692069297`*^9, 
   3.3997289944261637`*^9}, {3.399729087443575*^9, 3.3997291578199263`*^9}, {
   3.399729214633517*^9, 3.3997292559936857`*^9}, {3.399729338917153*^9, 
   3.399729443137904*^9}, {3.3997297921289797`*^9, 3.399729801332281*^9}, 
   3.3997984631978292`*^9, 3.3997986822957864`*^9, {3.399799475623518*^9, 
   3.3997994825611515`*^9}, {3.399813039024555*^9, 3.3998130523841867`*^9}, {
   3.3998138111956306`*^9, 3.399813818523896*^9}, {3.3998138975254135`*^9, 
   3.3998139300104117`*^9}, {3.399814002074295*^9, 3.3998140680286865`*^9}, {
   3.3998141794214506`*^9, 3.399814187827862*^9}, {3.3998161633189154`*^9, 
   3.399816166818983*^9}, {3.399816989678531*^9, 3.39981701069456*^9}, {
   3.3998175772210617`*^9, 3.3998175797054844`*^9}, {3.3998177980534267`*^9, 
   3.3998178039285393`*^9}, 3.3998191717048006`*^9, {3.399819229424659*^9, 
   3.399819249925052*^9}, {3.3998192996916327`*^9, 3.3998193255202537`*^9}, {
   3.3998194002404385`*^9, 3.399819401990472*^9}, {3.399819437022394*^9, 
   3.399819443678772*^9}, {3.3998195847752314`*^9, 3.3998195956035643`*^9}, {
   3.3998937261423693`*^9, 3.3998937440645885`*^9}, {3.399894673945778*^9, 
   3.3998946780865884`*^9}, 3.399895357951172*^9, {3.3998971752360635`*^9, 
   3.399897202986596*^9}, {3.399995099817901*^9, 3.3999951242558703`*^9}, {
   3.3999951653972855`*^9, 3.3999952424143887`*^9}, {3.399995434089944*^9, 
   3.3999954559809895`*^9}, 3.400214359554536*^9, {3.4002194753715076`*^9, 
   3.4002194862310915`*^9}, {3.400221264780864*^9, 3.400221267812172*^9}, {
   3.400221324438259*^9, 3.4002213249851446`*^9}, {3.4002307045682325`*^9, 
   3.4002307106777253`*^9}, {3.4002309417446613`*^9, 
   3.4002309457603636`*^9}, {3.4002355676772275`*^9, 
   3.4002356840075865`*^9}, {3.4002357813375797`*^9, 3.400235782228222*^9}, {
   3.400238239244146*^9, 3.40023824052542*^9}, {3.4004065560321016`*^9, 
   3.400406572266788*^9}, 3.40040661272069*^9, {3.400406710910075*^9, 
   3.400406802349331*^9}, {3.4004079962316275`*^9, 3.400408003981776*^9}, {
   3.4004080367167797`*^9, 3.400408037591797*^9}, {3.400408141500042*^9, 
   3.4004081422656813`*^9}, 3.400504474791651*^9, {3.4008198209228888`*^9, 
   3.4008198369544463`*^9}, {3.401177200473509*^9, 3.401177296365975*^9}, 
   3.4011776191065464`*^9, 3.4011776885297546`*^9, {3.4011777732345057`*^9, 
   3.4011777815627904`*^9}, {3.4015301347651124`*^9, 3.401530142671514*^9}, {
   3.4015342195318975`*^9, 3.4015342774861345`*^9}, {3.4015343731285963`*^9, 
   3.4015343749255056`*^9}, {3.402033437670154*^9, 3.402033457561161*^9}, {
   3.4020334928118377`*^9, 3.402033502483898*^9}, {3.402143403333747*^9, 
   3.402143421193465*^9}, {3.402143489991661*^9, 3.40214349125731*^9}, {
   3.402143653151044*^9, 3.4021436941674557`*^9}, {3.402205803123693*^9, 
   3.402205848499564*^9}, {3.402294611715026*^9, 3.4022946131681786`*^9}, 
   3.402294775718175*^9, {3.4022949263773174`*^9, 3.4022949270960813`*^9}, 
   3.4023779225819693`*^9, 3.402388039487956*^9, 3.4023881114109564`*^9, 
   3.403871476831417*^9, 3.403871589333577*^9, {3.403871732195695*^9, 
   3.4038719361371107`*^9}, 3.40387197021589*^9, {3.4038729130621176`*^9, 
   3.403872917359075*^9}, {3.4038732665532794`*^9, 3.4038732913350053`*^9}, {
   3.40387338716497*^9, 3.403873392790078*^9}, {3.4038739059561806`*^9, 
   3.403873929300379*^9}, {3.4038757265536356`*^9, 3.403875727100521*^9}, {
   3.4038760173873444`*^9, 3.403876028450057*^9}, {3.4038767128225718`*^9, 
   3.4038767355730085`*^9}, {3.403876883685227*^9, 3.403876894872942*^9}, 
   3.4038770811577682`*^9, {3.403877262489375*^9, 3.403877296927536*^9}, {
   3.4038779003609967`*^9, 3.4038779017516484`*^9}, {3.403877950330706*^9, 
   3.403877995722203*^9}, {3.4038805669746947`*^9, 3.4038805816156006`*^9}, {
   3.403940196949411*^9, 3.403940212309081*^9}, {3.4039402503098106`*^9, 
   3.403940330483225*^9}, {3.403940565097104*^9, 3.4039406320983906`*^9}, {
   3.4039477736886315`*^9, 3.4039478349866834`*^9}, 3.403947942238743*^9, {
   3.4039479736924715`*^9, 3.403948027771635*^9}, 3.403948162852353*^9, {
   3.4039491169487963`*^9, 3.4039491206988688`*^9}, {3.4039492631391034`*^9, 
   3.4039493470938406`*^9}, {3.4039496376931696`*^9, 3.403949723882324*^9}, {
   3.4039498424783516`*^9, 3.4039499998719983`*^9}, {3.404147952397335*^9, 
   3.404147980680135*^9}, {3.404148073983735*^9, 3.404148107492535*^9}, {
   3.404148258531735*^9, 3.4041482678605347`*^9}, {3.404148945009735*^9, 
   3.404148946164135*^9}, {3.4041489846337347`*^9, 3.404149017549735*^9}, {
   3.404149060200135*^9, 3.404149083178935*^9}, {3.404151307641535*^9, 
   3.404151309185935*^9}, {3.404151474499135*^9, 3.404151483219535*^9}, 
   3.404151568223935*^9, 3.4041938717523823`*^9, {3.404193912175033*^9, 
   3.404193917190755*^9}, {3.4042041069801445`*^9, 3.4042041521685123`*^9}, {
   3.4042042123415427`*^9, 3.4042042386076717`*^9}, {3.404204276624027*^9, 
   3.4042044284238167`*^9}, {3.40420452156623*^9, 3.4042045494573903`*^9}, {
   3.404204582895532*^9, 3.4042046181149583`*^9}, {3.404204788415103*^9, 
   3.4042048062748213`*^9}, {3.404204841759877*^9, 3.4042048723542147`*^9}, {
   3.404204936324193*^9, 3.4042052265172644`*^9}, {3.4042052790182724`*^9, 
   3.4042052894403477`*^9}, {3.404205340738208*^9, 3.4042053679418545`*^9}, {
   3.404205400817486*^9, 3.404205419677223*^9}, {3.4042054802252607`*^9, 
   3.404205497178711*^9}, 3.40420552863244*^9, {3.4042072185555105`*^9, 
   3.404207235243331*^9}, {3.4043000701119347`*^9, 3.4043000786295347`*^9}, {
   3.4043001168183346`*^9, 3.4043001401871347`*^9}, {3.4043234063901434`*^9, 
   3.404323420461344*^9}, {3.4043237408853436`*^9, 3.4043237568753433`*^9}, {
   3.4043239580841436`*^9, 3.4043239680837436`*^9}, {3.404389056089944*^9, 
   3.404389064997544*^9}, {3.4044553143383374`*^9, 3.4044553173471303`*^9}, {
   3.404464727328169*^9, 3.4044647793115463`*^9}, {3.4044648634193068`*^9, 
   3.404464895731186*^9}, 3.404464939995961*^9, {3.404466809225696*^9, 
   3.404466820006739*^9}, 3.4044669271765566`*^9, {3.404470193535716*^9, 
   3.404470194207578*^9}, {3.404652102174907*^9, 3.4046521218471603`*^9}, {
   3.404662523952945*^9, 3.4046625707061453`*^9}, {3.4046627912433453`*^9, 
   3.404662802490945*^9}, {3.4046642321459455`*^9, 3.404664234080345*^9}, {
   3.4046642723003454`*^9, 3.404664298679945*^9}, {3.4047349612907963`*^9, 
   3.4047350190586395`*^9}, 3.4048112009093513`*^9, {3.4048112843813066`*^9, 
   3.404811295334852*^9}, {3.4048122778100777`*^9, 3.4048123057486506`*^9}, 
   3.404826576562254*^9, {3.4048266892697067`*^9, 3.404826703692135*^9}, {
   3.404831024244785*^9, 3.404831026635502*^9}, {3.4049792115931997`*^9, 
   3.4049792117922*^9}, {3.405087246152504*^9, 3.4050872465900154`*^9}, {
   3.4051646230596266`*^9, 3.405164664404435*^9}, {3.405182662158377*^9, 
   3.4051826625327773`*^9}, {3.405934879149435*^9, 3.405934879180685*^9}, {
   3.405935465832574*^9, 3.4059354670044713`*^9}, 3.405935858058854*^9, {
   3.4059363028642693`*^9, 3.405936304051792*^9}, {3.4059367923424177`*^9, 
   3.405936836280761*^9}, 3.406469540754588*^9, {3.406471107341567*^9, 
   3.4064711150917654`*^9}, {3.4064711526396017`*^9, 3.406471154999037*^9}, 
   3.406471520086508*^9, {3.406557575786575*^9, 3.4065575804273186`*^9}, {
   3.4065579171078124`*^9, 3.4065579175765743`*^9}, {3.406558380979062*^9, 
   3.4065584079485025`*^9}, {3.4065619899777*^9, 3.4065620072593927`*^9}, {
   3.4066119073999557`*^9, 3.406611923931629*^9}, 3.4066122082357826`*^9, 
   3.40695962345685*^9, 3.406959771287813*^9, 3.4069686125044365`*^9, 
   3.4069734679726596`*^9, 3.4084276774919004`*^9, {3.408429584122257*^9, 
   3.4084295846691427`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SmileBiHestonMaxOptionAux2", "[", 
   RowBox[{
   "S_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "a_", ",", "b_", ",", 
    "KList_", ",", "\[Tau]_", ",", "\[CapitalSigma]_", ",", "M_", ",", 
    "\[CapitalSigma]inf_", ",", "Q_", ",", "\[Rho]_", ",", "\[Mu]_", ",", 
    "\[Beta]m_", ",", "\[Lambda]1_", ",", "\[Lambda]2_", ",", 
    RowBox[{"{", 
     RowBox[{
     "LegendreCoef1_", ",", "LegendreCoef1n_", ",", "period1_", ",", 
      "period1n_", ",", "\[Epsilon]1_", ",", "imax_", ",", 
      "startmonitortime_", ",", "plafondexplosion_", ",", "initialTailFlag_", 
      ",", "InitialTailPosition_", ",", "InitialTailPosition2_"}], "}"}], ",",
     
    RowBox[{"{", 
     RowBox[{
     "LegendreCoef2_", ",", "period2_", ",", "period2n_", ",", "\[Epsilon]2_",
       ",", "kmax_", ",", "StartControl_", ",", "IncrementFactor_"}], "}"}], 
    ",", "printflag_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{
   FractionBox["2", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"2", "\[Pi]"}], ")"}], "2"]], 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"as", ",", "res", ",", "res2", ",", 
       RowBox[{"Y", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Log", "[", 
           RowBox[{"S", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
          RowBox[{"Log", "[", 
           RowBox[{"S", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "1"}], " ", "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "1"}], "]"}]}], "  ", ",", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\< S=\>\"", ",", 
           RowBox[{"S", " ", "//", " ", "MatrixForm"}], ",", 
           "\"\< \[CapitalSigma]=\>\"", ",", 
           RowBox[{"\[CapitalSigma]", " ", "//", "MatrixForm"}], ",", 
           "\"\<M=\>\"", ",", 
           RowBox[{"M", "//", "MatrixForm"}], ",", 
           "\"\< \[CapitalSigma]inf=\>\"", ",", 
           RowBox[{"\[CapitalSigma]inf", "//", "MatrixForm"}], " ", ",", 
           "\"\< Q=\>\"", ",", 
           RowBox[{"Q", "//", "MatrixForm"}], " ", ",", "\"\< \[Rho]=\>\"", 
           ",", 
           RowBox[{"\[Rho]", "//", "MatrixForm"}], ",", "\"\< \[Mu]=\>\"", 
           ",", 
           RowBox[{"\[Mu]", "//", "MatrixForm"}], ",", "\"\< \[Beta]m=\>\"", 
           ",", 
           RowBox[{"\[Beta]m", " ", "//", "MatrixForm"}], ",", "\"\< T=\>\"", 
           ",", "\[Tau]"}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Inner Integration\>\"", ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\"\<LegendreNbMain\>\"", ",", 
                RowBox[{"Length", "[", "LegendreCoef1", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<LegendreNbIncrement\>\"", ",", 
                RowBox[{"Length", "[", "LegendreCoef1n", "]"}]}], "}"}], ",", 
              
              RowBox[{"{", 
               RowBox[{"\"\<IncrementNbMax\>\"", ",", "imax"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<InitialTailFlag\>\"", ",", "initialTailFlag"}], 
               "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<InitialTailLegendreNb\>\"", ",", 
                RowBox[{"Length", "[", "LegendreCoef2", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<PeriodMain\>\"", ",", "period1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<PeriodnIncrement\>\"", ",", "period1n"}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"\"\<StoppingLevel\>\"", ",", "\[Epsilon]1"}], "}"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"\"\<AbcisseMaxValue\>\"", ",", "kmax"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
               "\"\<InitialTailUpperLimit\>\"", ",", "InitialTailPosition"}], 
               "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
               "\"\<ExplosionMonitoringStartAbcisse\>\"", ",", 
                "StartControl"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
               "\"\<ExplosionMonitoringMaxLevel\>\"", ",", 
                "IncrementFactor"}], "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"\"\<lambda1\>\"", ",", "\[Lambda]1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<lambda2\>\"", ",", "\[Lambda]2"}], "}"}]}], "}"}],
             " ", "//", " ", "MatrixForm"}], ",", "\[IndentingNewLine]", 
           "\"\<Outer Integration\>\"", ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\"\<LegendreNbMain\>\"", ",", 
                RowBox[{"Length", "[", "LegendreCoef2", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<LegendreNbIncrement\>\"", ",", 
                RowBox[{"Length", "[", "LegendreCoef1n", "]"}]}], "}"}], ",", 
              
              RowBox[{"{", 
               RowBox[{"\"\<IncrementNbMax\>\"", ",", "imax"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<InitialTailFlag\>\"", ",", "initialTailFlag"}], 
               "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<InitialTailLegendreNb\>\"", ",", 
                RowBox[{"Length", "[", "LegendreCoef1", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<PeriodMain\>\"", ",", "period2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<PeriodnIncrement\>\"", ",", "period2n"}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"\"\<StoppingLevel\>\"", ",", "\[Epsilon]2"}], "}"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"\"\<AbcisseMaxValue\>\"", ",", "kmax"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
               "\"\<InitialTailUpperLimit\>\"", ",", "InitialTailPosition"}], 
               "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
               "\"\<GrowingControlStartAbcisse\>\"", ",", 
                "startmonitortime"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
               "\"\<GrowingControlMaxFactor\>\"", ",", "plafondexplosion"}], 
               "}"}]}], "}"}], " ", "//", " ", "MatrixForm"}]}], "]"}]}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "2"}], " ", "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "2"}], "]"}]}], "  ", ",", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<BiHestonLaplaceQuickTransform2[M,Q,\[Rho], \[Mu],\
\[CapitalSigma],{-\[ImaginaryI] 1,-\[ImaginaryI] 1},\[Beta]m,\[Tau]]=\>\"", 
           ",", 
           RowBox[{"BiHestonLaplaceQuickTransform2", "[", 
            RowBox[{
            "M", ",", "Q", ",", "\[Rho]", ",", " ", "\[Mu]", ",", 
             "\[CapitalSigma]", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "\[ImaginaryI]"}], " ", "1"}], ",", 
               RowBox[{
                RowBox[{"-", "\[ImaginaryI]"}], " ", "1"}]}], "}"}], ",", 
             "\[Beta]m", ",", "\[Tau]"}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<integrand(0.1,0.1)=\>\"", ",", 
           RowBox[{"SmileSymetrizedBiHestonMaxOptionIntegrand2CC", "[", 
            RowBox[{
            "Y", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", "b", ",", 
             "KList", ",", "\[Tau]", ",", "\[CapitalSigma]", ",", "M", ",", 
             "Q", ",", "\[Rho]", ",", "\[Mu]", ",", "\[Beta]m", ",", 
             "\[Lambda]1", ",", "\[Lambda]2", ",", "0.1", ",", "0.1"}], 
            "]"}]}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "4"}], "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "4"}], "]"}]}], " ", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Plot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"SmileSymetrizedBiHestonMaxOptionIntegrand2", "[", 
               RowBox[{
               "Y", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", "b", 
                ",", 
                RowBox[{"{", 
                 RowBox[{"KList", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", "\[Tau]", ",", 
                "\[CapitalSigma]", ",", "M", ",", "Q", ",", "\[Rho]", ",", 
                "\[Mu]", ",", "\[Beta]m", ",", "\[Lambda]1", ",", 
                "\[Lambda]2", ",", "\[Omega]1", ",", "\[Omega]2"}], "]"}], 
              "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Omega]2", ",", "0", " ", ",", 
               RowBox[{"2", "period1"}]}], "}"}], ",", 
             RowBox[{"PlotPoints", "\[Rule]", "50"}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
             RowBox[{"PlotLabel", "\[Rule]", 
              RowBox[{"\"\<1st Inverse Fourier: K =\>\"", "<>", 
               RowBox[{"ToString", "[", 
                RowBox[{"KList", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", 
               "\"\< \[Omega]1=\>\"", "<>", 
               RowBox[{"ToString", "[", "\[Omega]1", "]"}]}]}]}], "]"}], ",", 
           
           RowBox[{"{", 
            RowBox[{"\[Omega]1", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.2", ",", "2"}], "}"}]}], "}"}]}], "]"}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "6"}], "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "6"}], "]"}]}], " ", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\[Omega]2", ",", 
               RowBox[{
                RowBox[{"VectorAdaptativeIntegrateExplosionSafe", "[", 
                 RowBox[{
                  RowBox[{"Function", "[", 
                   RowBox[{"\[Omega]1", ",", 
                    RowBox[{
                    RowBox[{
                    "SmileSymetrizedBiHestonMaxOptionIntegrand2", "[", 
                    RowBox[{
                    "Y", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", 
                    "b", ",", 
                    RowBox[{"{", 
                    RowBox[{"KList", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", "\[Tau]", ",",
                     "\[CapitalSigma]", ",", "M", ",", "Q", ",", "\[Rho]", 
                    ",", "\[Mu]", ",", "\[Beta]m", ",", "\[Lambda]1", ",", 
                    "\[Lambda]2", ",", "\[Omega]1", ",", "\[Omega]2"}], "]"}],
                     "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
                  "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", ",",
                   "period1n", ",", "\[Epsilon]1", ",", "imax", ",", "1", ",",
                   "startmonitortime", ",", "plafondexplosion", ",", 
                  "initialTailFlag", ",", "InitialTailPosition"}], "]"}], "[",
                 
                RowBox[{"[", 
                 RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Omega]2", ",", "0", ",", "period2", ",", 
               RowBox[{"period2", "/", "30"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"Joined", "\[Rule]", "True"}], ",", 
           RowBox[{"PlotLabel", "\[Rule]", "\"\<2nd Inverse Fourier:\>\""}], 
           ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "]"}]}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{"VectorAdaptativeIntegrateUnprotected", "[", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{"\[Omega]2", ",", 
           RowBox[{
            RowBox[{"as", "=", 
             RowBox[{"VectorAdaptativeIntegrateExplosionSafe", "[", 
              RowBox[{
               RowBox[{"Function", "[", 
                RowBox[{"\[Omega]1", ",", 
                 RowBox[{"SmileSymetrizedBiHestonMaxOptionIntegrand2", "[", 
                  RowBox[{
                  "Y", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", "b", 
                   ",", "KList", ",", "\[Tau]", ",", "\[CapitalSigma]", ",", 
                   "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", 
                   "\[Beta]m", ",", "\[Lambda]1", ",", "\[Lambda]2", ",", 
                   "\[Omega]1", ",", "\[Omega]2"}], "]"}]}], "]"}], ",", 
               "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", ",", 
               "period1n", ",", "\[Epsilon]1", ",", "imax", ",", 
               RowBox[{"Length", "[", "KList", "]"}], ",", "startmonitortime",
                ",", "plafondexplosion", ",", "initialTailFlag", ",", 
               "InitialTailPosition"}], "]"}]}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"printflag", "\[Equal]", "2"}], ",", 
              RowBox[{"Print", "[", 
               RowBox[{"\"\<Integ_2=\>\"", ",", "as"}], "]"}]}], "]"}], ";", 
            RowBox[{"as", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], ",", "LegendreCoef2", 
         ",", "period2", ",", "period2n", ",", "\[Epsilon]2", ",", "imax", 
         ",", 
         RowBox[{"Length", "[", "KList", "]"}], ",", "printflag", ",", 
         "initialTailFlag", ",", "InitialTailPosition2", ",", "kmax", ",", 
         "StartControl", ",", "IncrementFactor"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"printflag", "\[Equal]", "2"}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Integ_1=\>\"", ",", "res"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"res", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.3997288601267104`*^9, 3.39972890803388*^9, {3.3997289692069297`*^9, 
   3.3997289944261637`*^9}, {3.399729087443575*^9, 3.3997291578199263`*^9}, {
   3.399729214633517*^9, 3.3997292559936857`*^9}, {3.399729338917153*^9, 
   3.399729443137904*^9}, {3.3997297921289797`*^9, 3.399729801332281*^9}, 
   3.3997984631978292`*^9, 3.3997986822957864`*^9, {3.399799475623518*^9, 
   3.3997994825611515`*^9}, {3.399813039024555*^9, 3.3998130523841867`*^9}, {
   3.3998138111956306`*^9, 3.399813818523896*^9}, {3.3998138975254135`*^9, 
   3.3998139300104117`*^9}, {3.399814002074295*^9, 3.3998140680286865`*^9}, {
   3.3998141794214506`*^9, 3.399814187827862*^9}, {3.3998161633189154`*^9, 
   3.399816166818983*^9}, {3.399816989678531*^9, 3.39981701069456*^9}, {
   3.3998175772210617`*^9, 3.3998175797054844`*^9}, {3.3998177980534267`*^9, 
   3.3998178039285393`*^9}, 3.3998191717048006`*^9, {3.399819229424659*^9, 
   3.399819249925052*^9}, {3.3998192996916327`*^9, 3.3998193255202537`*^9}, {
   3.3998194002404385`*^9, 3.399819401990472*^9}, {3.399819437022394*^9, 
   3.399819443678772*^9}, {3.3998195847752314`*^9, 3.3998195956035643`*^9}, {
   3.3998937261423693`*^9, 3.3998937440645885`*^9}, {3.399894673945778*^9, 
   3.3998946780865884`*^9}, 3.399895357951172*^9, {3.3998971752360635`*^9, 
   3.399897202986596*^9}, {3.399995099817901*^9, 3.3999951242558703`*^9}, {
   3.3999951653972855`*^9, 3.3999952424143887`*^9}, {3.399995434089944*^9, 
   3.3999954559809895`*^9}, 3.400214359554536*^9, {3.4002194753715076`*^9, 
   3.4002194862310915`*^9}, {3.400221264780864*^9, 3.400221267812172*^9}, {
   3.400221324438259*^9, 3.4002213249851446`*^9}, {3.4002307045682325`*^9, 
   3.4002307106777253`*^9}, {3.4002309417446613`*^9, 
   3.4002309457603636`*^9}, {3.4002355676772275`*^9, 
   3.4002356840075865`*^9}, {3.4002357813375797`*^9, 3.400235782228222*^9}, {
   3.400238239244146*^9, 3.40023824052542*^9}, {3.4004065560321016`*^9, 
   3.400406572266788*^9}, 3.40040661272069*^9, {3.400406710910075*^9, 
   3.400406802349331*^9}, {3.4004079962316275`*^9, 3.400408003981776*^9}, {
   3.4004080367167797`*^9, 3.400408037591797*^9}, {3.400408141500042*^9, 
   3.4004081422656813`*^9}, 3.400504474791651*^9, {3.4008198209228888`*^9, 
   3.4008198369544463`*^9}, {3.401177200473509*^9, 3.401177296365975*^9}, 
   3.4011776191065464`*^9, 3.4011776885297546`*^9, {3.4011777732345057`*^9, 
   3.4011777815627904`*^9}, {3.4015301347651124`*^9, 3.401530142671514*^9}, {
   3.4015342195318975`*^9, 3.4015342774861345`*^9}, {3.4015343731285963`*^9, 
   3.4015343749255056`*^9}, {3.402033437670154*^9, 3.402033457561161*^9}, {
   3.4020334928118377`*^9, 3.402033502483898*^9}, {3.402143403333747*^9, 
   3.402143421193465*^9}, {3.402143489991661*^9, 3.40214349125731*^9}, {
   3.402143653151044*^9, 3.4021436941674557`*^9}, {3.402205803123693*^9, 
   3.402205848499564*^9}, {3.402294611715026*^9, 3.4022946131681786`*^9}, 
   3.402294775718175*^9, {3.4022949263773174`*^9, 3.4022949270960813`*^9}, 
   3.4023779225819693`*^9, 3.402388039487956*^9, 3.4023881114109564`*^9, 
   3.403871476831417*^9, 3.403871589333577*^9, {3.403871732195695*^9, 
   3.4038719361371107`*^9}, 3.40387197021589*^9, {3.4038729130621176`*^9, 
   3.403872917359075*^9}, {3.4038732665532794`*^9, 3.4038732913350053`*^9}, {
   3.40387338716497*^9, 3.403873392790078*^9}, {3.4038739059561806`*^9, 
   3.403873929300379*^9}, {3.4038757265536356`*^9, 3.403875727100521*^9}, {
   3.4038760173873444`*^9, 3.403876028450057*^9}, {3.4038767128225718`*^9, 
   3.4038767355730085`*^9}, {3.403876883685227*^9, 3.403876894872942*^9}, 
   3.4038770811577682`*^9, {3.403877262489375*^9, 3.403877296927536*^9}, {
   3.4038779003609967`*^9, 3.4038779017516484`*^9}, {3.403877950330706*^9, 
   3.403877995722203*^9}, {3.4038805669746947`*^9, 3.4038805816156006`*^9}, {
   3.403940196949411*^9, 3.403940212309081*^9}, {3.4039402503098106`*^9, 
   3.403940330483225*^9}, {3.403940565097104*^9, 3.4039406320983906`*^9}, {
   3.4039477736886315`*^9, 3.4039478349866834`*^9}, 3.403947942238743*^9, {
   3.4039479736924715`*^9, 3.403948027771635*^9}, 3.403948162852353*^9, {
   3.4039491169487963`*^9, 3.4039491206988688`*^9}, {3.4039492631391034`*^9, 
   3.4039493470938406`*^9}, {3.4039496376931696`*^9, 3.403949723882324*^9}, {
   3.4039498424783516`*^9, 3.4039499998719983`*^9}, {3.404147952397335*^9, 
   3.404147980680135*^9}, {3.404148073983735*^9, 3.404148107492535*^9}, {
   3.404148258531735*^9, 3.4041482678605347`*^9}, {3.404148945009735*^9, 
   3.404148946164135*^9}, {3.4041489846337347`*^9, 3.404149017549735*^9}, {
   3.404149060200135*^9, 3.404149083178935*^9}, {3.404151307641535*^9, 
   3.404151309185935*^9}, {3.404151474499135*^9, 3.404151483219535*^9}, 
   3.404151568223935*^9, 3.4041938717523823`*^9, {3.404193912175033*^9, 
   3.404193917190755*^9}, {3.4042041069801445`*^9, 3.4042041521685123`*^9}, {
   3.4042042123415427`*^9, 3.4042042386076717`*^9}, {3.404204276624027*^9, 
   3.4042044284238167`*^9}, {3.40420452156623*^9, 3.4042045494573903`*^9}, {
   3.404204582895532*^9, 3.4042046181149583`*^9}, {3.404204788415103*^9, 
   3.4042048062748213`*^9}, {3.404204841759877*^9, 3.4042048723542147`*^9}, {
   3.404204936324193*^9, 3.4042052265172644`*^9}, {3.4042052790182724`*^9, 
   3.4042052894403477`*^9}, {3.404205340738208*^9, 3.4042053679418545`*^9}, {
   3.404205400817486*^9, 3.404205419677223*^9}, {3.4042054802252607`*^9, 
   3.404205497178711*^9}, 3.40420552863244*^9, {3.4042072185555105`*^9, 
   3.404207235243331*^9}, {3.4042169113197336`*^9, 3.404216925101248*^9}, {
   3.4043001505299344`*^9, 3.4043002016355343`*^9}, {3.4043234402889433`*^9, 
   3.4043234487441435`*^9}, {3.4043237751273437`*^9, 
   3.4043237822877436`*^9}, {3.404324132304144*^9, 3.4043241429121437`*^9}, {
   3.404324465254944*^9, 3.4043244826177435`*^9}, 3.404324753246544*^9, 
   3.404389086572344*^9, {3.4044647321249523`*^9, 3.404464746624674*^9}, {
   3.404464795092493*^9, 3.4044648116703*^9}, {3.404464856278818*^9, 
   3.404464859169388*^9}, {3.4044649040279016`*^9, 3.4044649336835823`*^9}, 
   3.4044669516448364`*^9, {3.4044672458266883`*^9, 3.4044672763573523`*^9}, {
   3.4046521047218313`*^9, 3.404652136113059*^9}, {3.404662443222945*^9, 
   3.404662495467345*^9}, 3.404811209190919*^9, {3.4048113022257414`*^9, 
   3.404811310991703*^9}, {3.4048123202804585`*^9, 3.4048123315308905`*^9}, {
   3.404826540560871*^9, 3.404826542826583*^9}, {3.404826714333169*^9, 
   3.404826722989751*^9}, 3.4048312176740875`*^9, {3.405145840438179*^9, 
   3.405145840906941*^9}, {3.405164673201535*^9, 3.4051646944989557`*^9}, {
   3.405934879196311*^9, 3.405934879211936*^9}, 3.4059351073256907`*^9, 
   3.405935682930492*^9, {3.405936317145794*^9, 3.4059363184426937`*^9}, {
   3.4059368707970486`*^9, 3.4059368791722097`*^9}, 3.4064695493329325`*^9, {
   3.4064711223107*^9, 3.4064711439206285`*^9}, 3.406471514805123*^9, {
   3.4065575886931553`*^9, 3.4065575908182096`*^9}, {3.4065579109514046`*^9, 
   3.406557911498294*^9}, {3.406558426761484*^9, 3.4065584289177895`*^9}, {
   3.4065620211972494`*^9, 3.406562035525741*^9}, 3.4066119391195183`*^9, 
   3.40661197083908*^9, 3.406612215360965*^9, 3.4069596283944445`*^9, 
   3.4069597643501797`*^9, 3.406968617582659*^9, 3.40697347345714*^9, 
   3.408427688757742*^9, {3.4084295913411455`*^9, 3.40842959182553*^9}, {
   3.408429696030656*^9, 3.4084296975150595`*^9}, {3.4084462430202265`*^9, 
   3.4084462479421964`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Integrands", "Subsubtitle",
 CellChangeTimes->{{3.404631476967207*^9, 3.4046314788891187`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SmileSymetrizedBiHestonMaxOptionIntegrand", "[", 
   RowBox[{
   "Y_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "a_", ",", "b_", ",", 
    "KList_", ",", "\[Tau]_", ",", "\[CapitalSigma]_", ",", "M_", ",", "Q_", 
    ",", "\[Rho]_", ",", "\[Mu]_", ",", "\[Beta]_", ",", "\[Lambda]1_", ",", 
    "\[Lambda]2_", ",", "\[Omega]1_", ",", "\[Omega]2_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x1", "=", 
       RowBox[{"Y", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", 
      RowBox[{"x2", "=", 
       RowBox[{"Y", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ",", "\[Lambda]1G", ",", 
      "\[Lambda]2G", ",", "\[Lambda]1D", ",", "\[Lambda]2D", ",", "\[Alpha]D",
       ",", "\[Alpha]G", ",", "Sym\[Alpha]D", ",", "Sym\[Alpha]G", ",", 
      "propagatorDroit", ",", "SympropagatorDroit", ",", "propagatorGauche", 
      ",", "SympropagatorGauche", ",", "propagatorDroit2", ",", 
      "SympropagatorDroit2", ",", "propagatorGauche2", ",", 
      "SympropagatorGauche2"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Lambda]1G", "=", 
      RowBox[{"(", 
       RowBox[{"\[Lambda]1", " ", "+", 
        RowBox[{"\[Lambda]2", " ", 
         RowBox[{"a", "/", "b"}]}], "+", "a"}], ")"}]}], ";", 
     RowBox[{"\[Lambda]2G", "=", 
      RowBox[{"(", 
       RowBox[{"-", "\[Lambda]2"}], ")"}]}], ";", 
     RowBox[{"\[Lambda]1D", "=", 
      RowBox[{"(", 
       RowBox[{"-", "\[Lambda]1"}], ")"}]}], ";", 
     RowBox[{"\[Lambda]2D", "=", 
      RowBox[{"(", 
       RowBox[{"\[Lambda]2", " ", "+", 
        RowBox[{"\[Lambda]1", " ", 
         RowBox[{"b", "/", "a"}]}], "+", "a"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Alpha]D", "=", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "x1", " ", 
         RowBox[{"(", 
          RowBox[{"\[Omega]1", "+", 
           RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1D"}]}], ")"}]}], "-", 
        RowBox[{"\[ImaginaryI]", " ", "x2", " ", 
         RowBox[{"(", 
          RowBox[{"\[Omega]2", "+", 
           RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2D"}]}], ")"}]}]}]]}], ";",
      
     RowBox[{"\[Alpha]G", "=", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "x1", " ", 
         RowBox[{"(", 
          RowBox[{"\[Omega]1", "+", 
           RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1G"}]}], ")"}]}], "-", 
        RowBox[{"\[ImaginaryI]", " ", "x2", " ", 
         RowBox[{"(", 
          RowBox[{"\[Omega]2", "+", 
           RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2G"}]}], ")"}]}]}]]}], ";",
      
     RowBox[{"Sym\[Alpha]D", "=", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"\[ImaginaryI]", " ", "x1", " ", 
         RowBox[{"(", 
          RowBox[{"\[Omega]1", "+", 
           RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1D"}]}], ")"}]}], "-", 
        RowBox[{"\[ImaginaryI]", " ", "x2", " ", 
         RowBox[{"(", 
          RowBox[{"\[Omega]2", "+", 
           RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2D"}]}], ")"}]}]}]]}], ";",
      
     RowBox[{"Sym\[Alpha]G", "=", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"\[ImaginaryI]", " ", "x1", " ", 
         RowBox[{"(", 
          RowBox[{"\[Omega]1", "+", 
           RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1G"}]}], ")"}]}], "-", 
        RowBox[{"\[ImaginaryI]", " ", "x2", " ", 
         RowBox[{"(", 
          RowBox[{"\[Omega]2", "+", 
           RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2G"}]}], ")"}]}]}]]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"propagatorDroit", "=", 
      RowBox[{"BiHestonLaplaceQuickTransform", "[", 
       RowBox[{
       "M", ",", "Q", ",", "\[Rho]", ",", " ", "\[Mu]", ",", 
        "\[CapitalSigma]", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], 
           RowBox[{"(", 
            RowBox[{"\[Omega]1", "+", 
             RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1D"}]}], ")"}]}], ",", 
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", 
           RowBox[{"(", 
            RowBox[{"\[Omega]2", "+", 
             RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2D"}]}], ")"}]}]}], 
         "}"}], ",", "\[Beta]", ",", "\[Tau]"}], "]"}]}], ";", 
     RowBox[{"SympropagatorDroit", "=", 
      RowBox[{"BiHestonLaplaceQuickTransform", "[", 
       RowBox[{
       "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", " ", 
        "\[CapitalSigma]", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"(", 
            RowBox[{"\[Omega]1", "+", 
             RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1D"}]}], ")"}]}], ",", 
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], 
           RowBox[{"(", 
            RowBox[{"\[Omega]2", "+", 
             RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2D"}]}], ")"}]}]}], 
         "}"}], ",", "\[Beta]", ",", "\[Tau]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"propagatorGauche", "=", 
      RowBox[{"BiHestonLaplaceQuickTransform", "[", 
       RowBox[{
       "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", " ", 
        "\[CapitalSigma]", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], 
           RowBox[{"(", 
            RowBox[{"\[Omega]1", "+", 
             RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1G"}]}], ")"}]}], ",", 
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", 
           RowBox[{"(", 
            RowBox[{"\[Omega]2", "+", 
             RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2G"}]}], ")"}]}]}], 
         "}"}], ",", "\[Beta]", ",", "\[Tau]"}], "]"}]}], ";", 
     RowBox[{"SympropagatorGauche", "=", 
      RowBox[{"BiHestonLaplaceQuickTransform", "[", 
       RowBox[{
       "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", " ", 
        "\[CapitalSigma]", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[ImaginaryI]", 
           RowBox[{"(", 
            RowBox[{"\[Omega]1", "+", 
             RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1G"}]}], ")"}]}], ",", 
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", 
           RowBox[{"(", 
            RowBox[{"\[Omega]2", "+", 
             RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2G"}]}], ")"}]}]}], 
         "}"}], ",", "\[Beta]", ",", "\[Tau]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Re", "[", 
        RowBox[{
         RowBox[{"\[Alpha]D", " ", "propagatorDroit", " ", 
          RowBox[{"MaxOptionPayOffFourierDroite", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"\[Omega]1", "+", 
              RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1D"}]}], ")"}], ",", 
            RowBox[{"(", 
             RowBox[{"\[Omega]2", "+", 
              RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2D"}]}], ")"}], ",", 
            RowBox[{"KList", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "\[Alpha]1", ",", 
            "\[Beta]1", ",", "a", ",", "b"}], "]"}]}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"Sym\[Alpha]D", " ", "SympropagatorDroit", " ", 
          RowBox[{"MaxOptionPayOffFourierDroite", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{"\[Omega]1", "+", 
               RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1D"}]}], ")"}]}], ",", 
            
            RowBox[{"(", 
             RowBox[{"\[Omega]2", "+", 
              RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2D"}]}], ")"}], ",", 
            RowBox[{"KList", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "\[Alpha]1", ",", 
            "\[Beta]1", ",", "a", ",", "b"}], "]"}]}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"\[Alpha]G", " ", "propagatorGauche", " ", 
          RowBox[{"MaxOptionPayOffFourierGauche", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"\[Omega]1", "+", 
              RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1G"}]}], ")"}], ",", 
            RowBox[{"(", 
             RowBox[{"\[Omega]2", "+", 
              RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2G"}]}], ")"}], ",", 
            RowBox[{"KList", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "\[Alpha]1", ",", 
            "\[Beta]1", ",", "a", ",", "b"}], "]"}]}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"Sym\[Alpha]G", " ", "SympropagatorGauche", " ", 
          RowBox[{"MaxOptionPayOffFourierGauche", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{"\[Omega]1", "+", 
               RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1G"}]}], ")"}]}], ",", 
            
            RowBox[{"(", 
             RowBox[{"\[Omega]2", "+", 
              RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2G"}]}], ")"}], ",", 
            RowBox[{"KList", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "\[Alpha]1", ",", 
            "\[Beta]1", ",", "a", ",", "b"}], "]"}]}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "KList", "]"}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.402140085770051*^9, 3.4021400863013115`*^9}, {
   3.4021401238489075`*^9, 3.4021402363666925`*^9}, {3.402140267929798*^9, 
   3.402140316290102*^9}, {3.4021403621347322`*^9, 3.4021403798069468`*^9}, {
   3.402140442948784*^9, 3.4021404698243*^9}, {3.40214052530974*^9, 
   3.4021405261847568`*^9}, {3.402140572076263*^9, 3.4021405730294065`*^9}, {
   3.40214283290092*^9, 3.402142834900958*^9}, 3.402142878995555*^9, {
   3.4021429531532288`*^9, 3.40214297455989*^9}, {3.4021430512488623`*^9, 
   3.4021430865307894`*^9}, {3.402143143625636*^9, 3.4021431463288126`*^9}, {
   3.402143222267771*^9, 3.402143365629898*^9}, {3.4021439797510643`*^9, 
   3.4021440141579747`*^9}, {3.4021444783543873`*^9, 
   3.4021445164332433`*^9}, {3.4021445469025784`*^9, 3.402144574918741*^9}, {
   3.4021446846239724`*^9, 3.4021446895459423`*^9}, {3.4021447226559525`*^9, 
   3.402144729593586*^9}, {3.402144860127342*^9, 3.402144926378614*^9}, {
   3.4021449572542067`*^9, 3.402145180727247*^9}, {3.402149153412896*^9, 
   3.4021491595067635`*^9}, {3.4021496964233217`*^9, 3.402149821410097*^9}, {
   3.40214987416111*^9, 3.402149884755063*^9}, {3.4021499394279876`*^9, 
   3.4021499498344374`*^9}, {3.402150065133526*^9, 3.402150121790864*^9}, {
   3.4021501655260787`*^9, 3.4021502014486437`*^9}, {3.402150388827241*^9, 
   3.4021504643911915`*^9}, {3.4021505016731577`*^9, 3.402150539877016*^9}, {
   3.402150576221464*^9, 3.4021506145190744`*^9}, 3.402150646160307*^9, {
   3.4021507013801165`*^9, 3.402150701614496*^9}, {3.402150792022482*^9, 
   3.4021508226011944`*^9}, {3.4022048852154446`*^9, 
   3.4022049314194565`*^9}, {3.402223441649846*^9, 3.4022234739004655`*^9}, {
   3.4022235664178667`*^9, 3.4022235977934694`*^9}, {3.402225770632062*^9, 
   3.4022257810853877`*^9}, {3.4022260066522183`*^9, 
   3.4022260340902452`*^9}, {3.402227989127781*^9, 3.4022280025967894`*^9}, 
   3.4022280710668545`*^9, {3.4022281624279833`*^9, 3.4022281629904943`*^9}, {
   3.4023193135668306`*^9, 3.4023194603141108`*^9}, {3.402319603150462*^9, 
   3.40231966787294*^9}, {3.4023197252970443`*^9, 3.4023197324378977`*^9}, {
   3.4023205583495092`*^9, 3.4023206749454975`*^9}, {3.4023207399779963`*^9, 
   3.4023207413373976`*^9}, {3.4023208249015017`*^9, 
   3.4023209920765867`*^9}, {3.4023211800958214`*^9, 3.40232123755005*^9}, {
   3.4023216909806304`*^9, 3.4023216975588818`*^9}, {3.402321742184738*^9, 
   3.4023217427316236`*^9}, {3.4023247260232773`*^9, 
   3.4023248331659594`*^9}, {3.4023253919266872`*^9, 
   3.4023255075695324`*^9}, {3.40237831846457*^9, 3.4023783246678143`*^9}, {
   3.4041932487247953`*^9, 3.4041932623344316`*^9}, {3.40419333647648*^9, 
   3.4041933710083933`*^9}, {3.4041937125305753`*^9, 3.404193749953169*^9}, {
   3.4043002135695343`*^9, 3.4043002231947346`*^9}, {3.4044649846669784`*^9, 
   3.4044650123383217`*^9}, {3.4044650477751417`*^9, 
   3.4044651238049316`*^9}, {3.404465582921117*^9, 3.4044656190610476`*^9}, {
   3.4044656599352627`*^9, 3.4044656716225386`*^9}, {3.4044670806423597`*^9, 
   3.404467083939172*^9}, {3.4044685611608086`*^9, 3.4044685642701235`*^9}, {
   3.4044686800022764`*^9, 3.4044687901564116`*^9}, {3.4044707796025887`*^9, 
   3.4044707807275667`*^9}, 3.404652171754368*^9, {3.4046522684124737`*^9, 
   3.404652301397482*^9}, 3.4048112137223434`*^9, {3.4048113224921446`*^9, 
   3.4048113889321957`*^9}, 3.404826533466849*^9, {3.404826732521367*^9, 
   3.404826749568897*^9}, 3.4051647325780554`*^9, {3.405165151291899*^9, 
   3.4051652061058025`*^9}, {3.4051653156086054`*^9, 3.405165325483858*^9}, {
   3.405165713493791*^9, 3.405165736338126*^9}, {3.4051706650736732`*^9, 
   3.4051707229657803`*^9}, {3.405170756826022*^9, 3.405170757685419*^9}, {
   3.4051708129680843`*^9, 3.40517084365637*^9}, {3.4051709842849703`*^9, 
   3.4051709871912947`*^9}, {3.4051711665083847`*^9, 
   3.4051711773680377`*^9}, {3.405186211332777*^9, 3.4051863222019773`*^9}, {
   3.405186712950777*^9, 3.4051870170727773`*^9}, {3.4051870853695774`*^9, 
   3.405187263162777*^9}, {3.405187307544777*^9, 3.405187352800377*^9}, {
   3.4051873882279773`*^9, 3.4051874194123774`*^9}, {3.405187886413977*^9, 
   3.405187894947177*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SmileSymetrizedBiHestonMaxOptionIntegrand2", "[", 
   RowBox[{
   "Y_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "a_", ",", "b_", ",", 
    "KList_", ",", "\[Tau]_", ",", "\[CapitalSigma]_", ",", "M_", ",", "Q_", 
    ",", "\[Rho]_", ",", "\[Mu]_", ",", "\[Beta]m_", ",", "\[Lambda]1_", ",", 
    "\[Lambda]2_", ",", "\[Omega]1_", ",", "\[Omega]2_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x1", "=", 
       RowBox[{"Y", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", 
      RowBox[{"x2", "=", 
       RowBox[{"Y", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ",", "\[Lambda]1G", ",", 
      "\[Lambda]2G", ",", "\[Lambda]1D", ",", "\[Lambda]2D", ",", "\[Alpha]D",
       ",", "\[Alpha]G", ",", "Sym\[Alpha]D", ",", "Sym\[Alpha]G", ",", 
      "propagatorDroit", ",", "SympropagatorDroit", ",", "propagatorGauche", 
      ",", "SympropagatorGauche", ",", "propagatorDroit2", ",", 
      "SympropagatorDroit2", ",", "propagatorGauche2", ",", 
      "SympropagatorGauche2"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Lambda]1G", "=", 
      RowBox[{"(", 
       RowBox[{"\[Lambda]1", " ", "+", 
        RowBox[{"\[Lambda]2", " ", 
         RowBox[{"a", "/", "b"}]}], "+", "a"}], ")"}]}], ";", 
     RowBox[{"\[Lambda]2G", "=", 
      RowBox[{"(", 
       RowBox[{"-", "\[Lambda]2"}], ")"}]}], ";", 
     RowBox[{"\[Lambda]1D", "=", 
      RowBox[{"(", 
       RowBox[{"-", "\[Lambda]1"}], ")"}]}], ";", 
     RowBox[{"\[Lambda]2D", "=", 
      RowBox[{"(", 
       RowBox[{"\[Lambda]2", " ", "+", 
        RowBox[{"\[Lambda]1", " ", 
         RowBox[{"b", "/", "a"}]}], "+", "a"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Alpha]D", "=", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "x1", " ", 
         RowBox[{"(", 
          RowBox[{"\[Omega]1", "+", 
           RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1D"}]}], ")"}]}], "-", 
        RowBox[{"\[ImaginaryI]", " ", "x2", " ", 
         RowBox[{"(", 
          RowBox[{"\[Omega]2", "+", 
           RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2D"}]}], ")"}]}]}]]}], ";",
      
     RowBox[{"\[Alpha]G", "=", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "x1", " ", 
         RowBox[{"(", 
          RowBox[{"\[Omega]1", "+", 
           RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1G"}]}], ")"}]}], "-", 
        RowBox[{"\[ImaginaryI]", " ", "x2", " ", 
         RowBox[{"(", 
          RowBox[{"\[Omega]2", "+", 
           RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2G"}]}], ")"}]}]}]]}], ";",
      
     RowBox[{"Sym\[Alpha]D", "=", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"\[ImaginaryI]", " ", "x1", " ", 
         RowBox[{"(", 
          RowBox[{"\[Omega]1", "+", 
           RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1D"}]}], ")"}]}], "-", 
        RowBox[{"\[ImaginaryI]", " ", "x2", " ", 
         RowBox[{"(", 
          RowBox[{"\[Omega]2", "+", 
           RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2D"}]}], ")"}]}]}]]}], ";",
      
     RowBox[{"Sym\[Alpha]G", "=", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"\[ImaginaryI]", " ", "x1", " ", 
         RowBox[{"(", 
          RowBox[{"\[Omega]1", "+", 
           RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1G"}]}], ")"}]}], "-", 
        RowBox[{"\[ImaginaryI]", " ", "x2", " ", 
         RowBox[{"(", 
          RowBox[{"\[Omega]2", "+", 
           RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2G"}]}], ")"}]}]}]]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"propagatorDroit", "=", 
      RowBox[{"BiHestonLaplaceQuickTransform2", "[", 
       RowBox[{
       "M", ",", "Q", ",", "\[Rho]", ",", " ", "\[Mu]", ",", 
        "\[CapitalSigma]", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], 
           RowBox[{"(", 
            RowBox[{"\[Omega]1", "+", 
             RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1D"}]}], ")"}]}], ",", 
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", 
           RowBox[{"(", 
            RowBox[{"\[Omega]2", "+", 
             RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2D"}]}], ")"}]}]}], 
         "}"}], ",", "\[Beta]m", ",", "\[Tau]"}], "]"}]}], ";", 
     RowBox[{"SympropagatorDroit", "=", 
      RowBox[{"BiHestonLaplaceQuickTransform2", "[", 
       RowBox[{
       "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", " ", 
        "\[CapitalSigma]", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"(", 
            RowBox[{"\[Omega]1", "+", 
             RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1D"}]}], ")"}]}], ",", 
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], 
           RowBox[{"(", 
            RowBox[{"\[Omega]2", "+", 
             RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2D"}]}], ")"}]}]}], 
         "}"}], ",", "\[Beta]m", ",", "\[Tau]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"propagatorGauche", "=", 
      RowBox[{"BiHestonLaplaceQuickTransform2", "[", 
       RowBox[{
       "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", " ", 
        "\[CapitalSigma]", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], 
           RowBox[{"(", 
            RowBox[{"\[Omega]1", "+", 
             RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1G"}]}], ")"}]}], ",", 
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", 
           RowBox[{"(", 
            RowBox[{"\[Omega]2", "+", 
             RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2G"}]}], ")"}]}]}], 
         "}"}], ",", "\[Beta]m", ",", "\[Tau]"}], "]"}]}], ";", 
     RowBox[{"SympropagatorGauche", "=", 
      RowBox[{"BiHestonLaplaceQuickTransform2", "[", 
       RowBox[{
       "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", " ", 
        "\[CapitalSigma]", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[ImaginaryI]", 
           RowBox[{"(", 
            RowBox[{"\[Omega]1", "+", 
             RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1G"}]}], ")"}]}], ",", 
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", 
           RowBox[{"(", 
            RowBox[{"\[Omega]2", "+", 
             RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2G"}]}], ")"}]}]}], 
         "}"}], ",", "\[Beta]m", ",", "\[Tau]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Re", "[", 
        RowBox[{
         RowBox[{"\[Alpha]D", " ", "propagatorDroit", " ", 
          RowBox[{"MaxOptionPayOffFourierDroite", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"\[Omega]1", "+", 
              RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1D"}]}], ")"}], ",", 
            RowBox[{"(", 
             RowBox[{"\[Omega]2", "+", 
              RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2D"}]}], ")"}], ",", 
            RowBox[{"KList", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "\[Alpha]1", ",", 
            "\[Beta]1", ",", "a", ",", "b"}], "]"}]}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"Sym\[Alpha]D", " ", "SympropagatorDroit", " ", 
          RowBox[{"MaxOptionPayOffFourierDroite", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{"\[Omega]1", "+", 
               RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1D"}]}], ")"}]}], ",", 
            
            RowBox[{"(", 
             RowBox[{"\[Omega]2", "+", 
              RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2D"}]}], ")"}], ",", 
            RowBox[{"KList", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "\[Alpha]1", ",", 
            "\[Beta]1", ",", "a", ",", "b"}], "]"}]}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"\[Alpha]G", " ", "propagatorGauche", " ", 
          RowBox[{"MaxOptionPayOffFourierGauche", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"\[Omega]1", "+", 
              RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1G"}]}], ")"}], ",", 
            RowBox[{"(", 
             RowBox[{"\[Omega]2", "+", 
              RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2G"}]}], ")"}], ",", 
            RowBox[{"KList", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "\[Alpha]1", ",", 
            "\[Beta]1", ",", "a", ",", "b"}], "]"}]}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"Sym\[Alpha]G", " ", "SympropagatorGauche", " ", 
          RowBox[{"MaxOptionPayOffFourierGauche", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{"\[Omega]1", "+", 
               RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1G"}]}], ")"}]}], ",", 
            
            RowBox[{"(", 
             RowBox[{"\[Omega]2", "+", 
              RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2G"}]}], ")"}], ",", 
            RowBox[{"KList", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "\[Alpha]1", ",", 
            "\[Beta]1", ",", "a", ",", "b"}], "]"}]}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "KList", "]"}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.402140085770051*^9, 3.4021400863013115`*^9}, {
   3.4021401238489075`*^9, 3.4021402363666925`*^9}, {3.402140267929798*^9, 
   3.402140316290102*^9}, {3.4021403621347322`*^9, 3.4021403798069468`*^9}, {
   3.402140442948784*^9, 3.4021404698243*^9}, {3.40214052530974*^9, 
   3.4021405261847568`*^9}, {3.402140572076263*^9, 3.4021405730294065`*^9}, {
   3.40214283290092*^9, 3.402142834900958*^9}, 3.402142878995555*^9, {
   3.4021429531532288`*^9, 3.40214297455989*^9}, {3.4021430512488623`*^9, 
   3.4021430865307894`*^9}, {3.402143143625636*^9, 3.4021431463288126`*^9}, {
   3.402143222267771*^9, 3.402143365629898*^9}, {3.4021439797510643`*^9, 
   3.4021440141579747`*^9}, {3.4021444783543873`*^9, 
   3.4021445164332433`*^9}, {3.4021445469025784`*^9, 3.402144574918741*^9}, {
   3.4021446846239724`*^9, 3.4021446895459423`*^9}, {3.4021447226559525`*^9, 
   3.402144729593586*^9}, {3.402144860127342*^9, 3.402144926378614*^9}, {
   3.4021449572542067`*^9, 3.402145180727247*^9}, {3.402149153412896*^9, 
   3.4021491595067635`*^9}, {3.4021496964233217`*^9, 3.402149821410097*^9}, {
   3.40214987416111*^9, 3.402149884755063*^9}, {3.4021499394279876`*^9, 
   3.4021499498344374`*^9}, {3.402150065133526*^9, 3.402150121790864*^9}, {
   3.4021501655260787`*^9, 3.4021502014486437`*^9}, {3.402150388827241*^9, 
   3.4021504643911915`*^9}, {3.4021505016731577`*^9, 3.402150539877016*^9}, {
   3.402150576221464*^9, 3.4021506145190744`*^9}, 3.402150646160307*^9, {
   3.4021507013801165`*^9, 3.402150701614496*^9}, {3.402150792022482*^9, 
   3.4021508226011944`*^9}, {3.4022048852154446`*^9, 
   3.4022049314194565`*^9}, {3.402223441649846*^9, 3.4022234739004655`*^9}, {
   3.4022235664178667`*^9, 3.4022235977934694`*^9}, {3.402225770632062*^9, 
   3.4022257810853877`*^9}, {3.4022260066522183`*^9, 
   3.4022260340902452`*^9}, {3.402227989127781*^9, 3.4022280025967894`*^9}, 
   3.4022280710668545`*^9, {3.4022281624279833`*^9, 3.4022281629904943`*^9}, {
   3.4023193135668306`*^9, 3.4023194603141108`*^9}, {3.402319603150462*^9, 
   3.40231966787294*^9}, {3.4023197252970443`*^9, 3.4023197324378977`*^9}, {
   3.4023205583495092`*^9, 3.4023206749454975`*^9}, {3.4023207399779963`*^9, 
   3.4023207413373976`*^9}, {3.4023208249015017`*^9, 
   3.4023209920765867`*^9}, {3.4023211800958214`*^9, 3.40232123755005*^9}, {
   3.4023216909806304`*^9, 3.4023216975588818`*^9}, {3.402321742184738*^9, 
   3.4023217427316236`*^9}, {3.4023247260232773`*^9, 
   3.4023248331659594`*^9}, {3.4023253919266872`*^9, 
   3.4023255075695324`*^9}, {3.40237831846457*^9, 3.4023783246678143`*^9}, {
   3.4041932487247953`*^9, 3.4041932623344316`*^9}, {3.40419333647648*^9, 
   3.4041933710083933`*^9}, {3.4041937125305753`*^9, 3.404193749953169*^9}, {
   3.4043002135695343`*^9, 3.4043002231947346`*^9}, {3.4044649846669784`*^9, 
   3.4044650123383217`*^9}, {3.4044650477751417`*^9, 
   3.4044651238049316`*^9}, {3.404465582921117*^9, 3.4044656190610476`*^9}, {
   3.4044656599352627`*^9, 3.4044656716225386`*^9}, {3.4044670806423597`*^9, 
   3.404467083939172*^9}, {3.4044685611608086`*^9, 3.4044685642701235`*^9}, {
   3.4044686800022764`*^9, 3.4044687901564116`*^9}, {3.4044707796025887`*^9, 
   3.4044707807275667`*^9}, 3.404652171754368*^9, {3.4046522684124737`*^9, 
   3.404652301397482*^9}, 3.4048112137223434`*^9, {3.4048113224921446`*^9, 
   3.4048113889321957`*^9}, 3.404826533466849*^9, {3.404826732521367*^9, 
   3.404826749568897*^9}, 3.4051647325780554`*^9, {3.405165151291899*^9, 
   3.4051652061058025`*^9}, {3.4051653156086054`*^9, 3.405165325483858*^9}, {
   3.405165713493791*^9, 3.405165736338126*^9}, {3.4051706650736732`*^9, 
   3.4051707229657803`*^9}, {3.405170756826022*^9, 3.405170757685419*^9}, {
   3.4051708129680843`*^9, 3.40517084365637*^9}, {3.4051709842849703`*^9, 
   3.4051709871912947`*^9}, {3.4051711665083847`*^9, 
   3.4051711773680377`*^9}, {3.405186211332777*^9, 3.4051863222019773`*^9}, {
   3.405186712950777*^9, 3.4051870170727773`*^9}, {3.4051870853695774`*^9, 
   3.405187263162777*^9}, {3.405187307544777*^9, 3.405187352800377*^9}, {
   3.4051873882279773`*^9, 3.4051874194123774`*^9}, {3.405187649668377*^9, 
   3.405187689105177*^9}, {3.405187871968377*^9, 3.4051878824047775`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Fourier Transform of the payoff", "Subsubtitle",
 CellChangeTimes->{{3.4047174737434516`*^9, 3.404717491805258*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MaxOptionPayOffFourierDroite", "[", 
    RowBox[{
    "k1_", ",", "k2_", ",", "K_", ",", "\[Alpha]_", ",", "\[Beta]_", ",", 
     "a_", ",", "b_"}], "]"}], ":=", 
   FractionBox[
    RowBox[{"a", " ", 
     SuperscriptBox["K", 
      RowBox[{"\[ImaginaryI]", " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox["k1", "a"], "+", 
         FractionBox["k2", "b"]}], ")"}]}]], " ", 
     SuperscriptBox["\[Alpha]", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}]], " ", 
     SuperscriptBox["\[Beta]", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"a", "+", 
         RowBox[{"\[ImaginaryI]", " ", "k2"}]}], "b"]}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[ImaginaryI]", " ", 
        SuperscriptBox["K", 
         RowBox[{"a", "/", "b"}]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"b", " ", "k1"}], "+", 
          RowBox[{"a", " ", "k2"}]}], ")"}], " ", 
        SuperscriptBox["\[Beta]", "2"]}], "-", 
       RowBox[{"K", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["a", "2"], "+", 
          RowBox[{"\[ImaginaryI]", " ", "b", " ", "k1"}], "+", 
          RowBox[{"\[ImaginaryI]", " ", "a", " ", "k2"}]}], ")"}], " ", 
        SuperscriptBox["\[Beta]", 
         RowBox[{"a", "/", "b"}]]}]}], ")"}]}], 
    RowBox[{"k1", " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["a", "2"], "+", 
       RowBox[{"\[ImaginaryI]", " ", "b", " ", "k1"}], "+", 
       RowBox[{"\[ImaginaryI]", " ", "a", " ", "k2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"b", " ", "k1"}], "+", 
       RowBox[{"a", " ", "k2"}]}], ")"}]}]]}], " "}], "\[IndentingNewLine]", 
 RowBox[{"  ", 
  RowBox[{
   RowBox[{
    RowBox[{"si", " ", 
     RowBox[{"Re", "[", "a", "]"}]}], "<", 
    RowBox[{
     RowBox[{"Im", "[", 
      FractionBox[
       RowBox[{"b", " ", "k1"}], "a"], "]"}], "+", 
     RowBox[{"Im", "[", "k2", "]"}]}]}], "&&", 
   RowBox[{
    RowBox[{"Im", "[", 
     RowBox[{
      FractionBox[
       RowBox[{"b", " ", "k1"}], "a"], "+", "k2"}], "]"}], ">", "0"}], " ", "&&",
    
   RowBox[{
    RowBox[{"Im", "[", "k1", "]"}], "<", "0"}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4048102845616646`*^9, 3.404810294702679*^9}, {
   3.4048103293758855`*^9, 3.404810338454359*^9}, {3.404810451536826*^9, 
   3.404810619137012*^9}, {3.40481068953034*^9, 3.404810710187383*^9}, 
   3.4051647566724224`*^9, 3.4051649030980453`*^9, {3.4051679186127405`*^9, 
   3.4051679208471727`*^9}, 3.405170554305213*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"si", " ", 
    RowBox[{"Re", "[", "a", "]"}]}], "<", 
   RowBox[{
    RowBox[{"Im", "[", 
     FractionBox[
      RowBox[{"b", " ", "k1"}], "a"], "]"}], "+", 
    RowBox[{"Im", "[", "k2", "]"}]}]}], "&&", 
  RowBox[{
   RowBox[{"Im", "[", 
    RowBox[{
     FractionBox[
      RowBox[{"b", " ", "k1"}], "a"], "+", "k2"}], "]"}], ">", "0"}], "&&", 
  RowBox[{
   RowBox[{"Im", "[", "k1", "]"}], "<", "0"}]}]], "Output",
 CellChangeTimes->{3.4056664225742416`*^9, 3.4057555246255345`*^9, 
  3.4057832461643963`*^9, 3.405830756795333*^9, 3.4058678017140007`*^9, 
  3.4059348956966276`*^9, 3.405937077301014*^9, 3.406472475376588*^9, 
  3.406473078345148*^9, 3.4065622367652674`*^9, 3.40661620488603*^9, 
  3.4068884240676613`*^9, 3.4069608946062555`*^9, 3.407480840615988*^9, 
  3.407583175832401*^9, 3.4076703996949997`*^9, 3.4078495177448*^9, 
  3.408195946306387*^9, 3.4082021050810003`*^9, 3.408202369329*^9, 
  3.4083820535572286`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MaxOptionPayOffFourierGauche", "[", 
    RowBox[{
    "k1_", ",", "k2_", ",", "K_", ",", "\[Alpha]_", ",", "\[Beta]_", ",", 
     "a_", ",", "b_"}], "]"}], ":=", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"b", " ", 
      SuperscriptBox["K", 
       RowBox[{"1", "+", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"], "+", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", " ", 
         RowBox[{"(", 
          RowBox[{"b", "-", 
           RowBox[{"\[ImaginaryI]", " ", "k2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "\[Alpha]"}], ")"}]}]}], ")"}]}], "-", 
        
        RowBox[{"\[ImaginaryI]", " ", "b", " ", "k1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Alpha]"}], ")"}]}]}], ")"}], " ", 
      SuperscriptBox["\[Alpha]", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}]], " ", 
      SuperscriptBox["\[Beta]", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}]]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[ImaginaryI]", " ", "b", " ", "k1"}], "+", 
        RowBox[{"a", " ", 
         RowBox[{"(", 
          RowBox[{"b", "+", 
           RowBox[{"\[ImaginaryI]", " ", "k2"}]}], ")"}]}]}], ")"}], " ", 
      "k2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"b", " ", "k1"}], "+", 
        RowBox[{"a", " ", "k2"}]}], ")"}]}]]}]}], 
  "  "}], "\[IndentingNewLine]", 
 RowBox[{" ", 
  RowBox[{
   RowBox[{
    RowBox[{"si", " ", 
     RowBox[{"Re", "[", "a", "]"}]}], "<", 
    RowBox[{
     RowBox[{"Im", "[", "k1", "]"}], "+", 
     RowBox[{"Im", "[", 
      FractionBox[
       RowBox[{"a", " ", "k2"}], "b"], "]"}]}]}], "&&", 
   RowBox[{
    RowBox[{"Im", "[", 
     RowBox[{"k1", "+", 
      FractionBox[
       RowBox[{"a", " ", "k2"}], "b"]}], "]"}], ">", "0"}], " ", "&&", " ", 
   RowBox[{
    RowBox[{"Im", "[", "k2", "]"}], "<", "0"}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.404809293461108*^9, 3.4048092956643176`*^9}, 
   3.4048093674014473`*^9, {3.4048094552954473`*^9, 3.404809463092622*^9}, {
   3.4048095314233704`*^9, 3.4048095442363625`*^9}, {3.404809605191828*^9, 
   3.4048096283333416`*^9}, {3.404809817199969*^9, 3.4048098448885317`*^9}, {
   3.4048099035782857`*^9, 3.4048099656900454`*^9}, {3.4048100079572935`*^9, 
   3.4048100840852165`*^9}, 3.405164762141312*^9, 3.4051648317993455`*^9, 
   3.4051652997488246`*^9, {3.4051678858306513`*^9, 3.4051678890807347`*^9}, 
   3.4051705136947985`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"si", " ", 
    RowBox[{"Re", "[", "a", "]"}]}], "<", 
   RowBox[{
    RowBox[{"Im", "[", "k1", "]"}], "+", 
    RowBox[{"Im", "[", 
     FractionBox[
      RowBox[{"a", " ", "k2"}], "b"], "]"}]}]}], "&&", 
  RowBox[{
   RowBox[{"Im", "[", 
    RowBox[{"k1", "+", 
     FractionBox[
      RowBox[{"a", " ", "k2"}], "b"]}], "]"}], ">", "0"}], "&&", 
  RowBox[{
   RowBox[{"Im", "[", "k2", "]"}], "<", "0"}]}]], "Output",
 CellChangeTimes->{3.4056664226679935`*^9, 3.405755524703661*^9, 
  3.4057832462268977`*^9, 3.4058307568578343`*^9, 3.4058678018077526`*^9, 
  3.4059348957903795`*^9, 3.405937077410391*^9, 3.4064724754859657`*^9, 
  3.406473078454526*^9, 3.4065622368433948`*^9, 3.406616204979783*^9, 
  3.4068884241457872`*^9, 3.4069608947156324`*^9, 3.4074808406459875`*^9, 
  3.4075831758634005`*^9, 3.407670399723*^9, 3.4078495177688*^9, 
  3.4081959463283873`*^9, 3.408202105138*^9, 3.408202369363*^9, 
  3.4083820536509805`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"b", " ", 
     SuperscriptBox["K", 
      RowBox[{"1", "+", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"], "+", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a", " ", 
        RowBox[{"(", 
         RowBox[{"b", "-", 
          RowBox[{"\[ImaginaryI]", " ", "k2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "\[Alpha]"}], ")"}]}]}], ")"}]}], "-", 
       RowBox[{"\[ImaginaryI]", " ", "b", " ", "k1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Alpha]"}], ")"}]}]}], ")"}], " ", 
     SuperscriptBox["\[Alpha]", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}]], " ", 
     SuperscriptBox["\[Beta]", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}]]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[ImaginaryI]", " ", "b", " ", "k1"}], "+", 
       RowBox[{"a", " ", 
        RowBox[{"(", 
         RowBox[{"b", "+", 
          RowBox[{"\[ImaginaryI]", " ", "k2"}]}], ")"}]}]}], ")"}], " ", "k2",
      " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"b", " ", "k1"}], "+", 
       RowBox[{"a", " ", "k2"}]}], ")"}]}]]}], " ", "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[Alpha]", "\[Rule]", "1"}], ",", 
    RowBox[{"\[Beta]", "\[Rule]", "1"}], ",", 
    RowBox[{"a", "\[Rule]", "1"}], ",", 
    RowBox[{"b", "\[Rule]", "1"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.40516580837122*^9, 3.4051658284342337`*^9}, 
   3.4051679772704926`*^9, 3.405170518288666*^9}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   SuperscriptBox["K", 
    RowBox[{"1", "+", 
     RowBox[{"\[ImaginaryI]", " ", "k1"}], "+", 
     RowBox[{"\[ImaginaryI]", " ", "k2"}]}]], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"\[ImaginaryI]", " ", "k1"}], "+", 
      RowBox[{"\[ImaginaryI]", " ", "k2"}]}], ")"}], " ", "k2", " ", 
    RowBox[{"(", 
     RowBox[{"k1", "+", "k2"}], ")"}]}]]}]], "Output",
 CellChangeTimes->{3.4051658301374025`*^9, 3.4051679803174458`*^9, 
  3.40517052119499*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.405334824658795*^9, 3.4053348257487946`*^9}}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Digitale paying Float 1 ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       SubscriptBox["S", "1"], "c"], 
      SubscriptBox["1", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Alpha]", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"a", " ", "x1"}]]}], "-", 
         RowBox[{"\[Beta]", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"b", " ", "x2"}]]}], "-", "K"}], ">", "0"}]]}], ")"}], 
    "+"], TraditionalForm]]]
}], "Subtitle",
 CellChangeTimes->{{3.4026388686724606`*^9, 3.4026388811727004`*^9}, {
   3.404630792762659*^9, 3.404630809558997*^9}, {3.4048121803219595`*^9, 
   3.4048121923849225`*^9}, 3.4051644862592497`*^9, 3.4053348989257946`*^9, {
   3.405939767368287*^9, 3.4059397788528824`*^9}}],

Cell["Handling", "Text",
 CellChangeTimes->{{3.4059584675710735`*^9, 3.405958469274232*^9}}],

Cell[CellGroupData[{

Cell["High Level interface", "Subsubtitle",
 CellChangeTimes->{{3.404642425693043*^9, 3.404642434083829*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SmileBiHestonPaysFloat1Digital", "[", 
   RowBox[{
   "S_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "a_", ",", "b_", ",", "c_",
     ",", "KList1_", ",", "\[Tau]_", ",", "\[CapitalSigma]_", ",", "M_", ",", 
    "\[CapitalSigma]inf_", ",", "\[Beta]_", ",", "\[Rho]_", ",", "\[Mu]_", 
    ",", "printflag_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "KList", ",", "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", 
      ",", "period1n", ",", "\[Epsilon]1", ",", "LegendreCoef2", ",", 
      "period2", ",", "period2n", ",", "\[Epsilon]2", ",", "imax", ",", 
      "\[Lambda]1", ",", "\[Lambda]2", ",", "Q", ",", "KListPositive", ",", 
      "KListNegative", ",", 
      RowBox[{"KPositivePrices", "=", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"KNegativePrices", "=", 
       RowBox[{"{", "}"}]}], ",", "prices", ",", "startmonitortime", ",", 
      "plafondexplosion", ",", "initialTailFlag", ",", "InitialTailPosition", 
      ",", "InitialTailPosition2", ",", "kmax", ",", "StartControl", ",", 
      "IncrementFactor"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "KList1", "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{"KList", "=", 
        RowBox[{"{", "KList1", "}"}]}], ",", 
       RowBox[{"KList", "=", "KList1"}]}], "]"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"Q", "=", 
      RowBox[{
       RowBox[{"CholeskyDecomposition", "[", 
        RowBox[{"-", 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"M", ".", "\[CapitalSigma]inf"}], "+", 
            RowBox[{"\[CapitalSigma]inf", ".", " ", 
             RowBox[{"Transpose", "[", "M", "]"}]}]}], "2"], ")"}]}], "]"}], 
       "/", "\[Beta]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", ",", 
          "period1n", ",", "\[Epsilon]1", ",", "startmonitortime", ",", 
          "plafondexplosion", ",", "initialTailFlag", ",", 
          "InitialTailPosition", ",", "InitialTailPosition2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "LegendreCoef2", ",", "period2", ",", "period2n", ",", "\[Epsilon]2",
           ",", "kmax", ",", "StartControl", ",", "IncrementFactor"}], "}"}], 
        ",", "imax", ",", "\[Lambda]1", ",", "\[Lambda]2"}], "}"}], "=", 
      RowBox[{"BiHestonVanillaOptimalParameters", "[", 
       RowBox[{
       "S", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", "b", ",", "c", 
        ",", 
        RowBox[{"KList", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "\[Tau]", ",", 
        "\[CapitalSigma]", ",", "M", ",", "\[CapitalSigma]inf", ",", "Q", ",",
         "\[Rho]", ",", "\[Mu]", ",", "\"\<MaxOption\>\"", ",", "printflag"}],
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"prices", "=", 
      RowBox[{"SmileBiHestonPaysFloat1Digital", "[", 
       RowBox[{
       "S", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", "b", ",", "c", 
        ",", "KList1", ",", "\[Tau]", ",", "\[CapitalSigma]", ",", "M", ",", 
        "\[CapitalSigma]inf", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", 
        "\[Beta]", ",", "\[Lambda]1", ",", "\[Lambda]2", ",", 
        RowBox[{"{", 
         RowBox[{
         "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", ",", 
          "period1n", ",", "\[Epsilon]1", ",", "imax", ",", 
          "startmonitortime", ",", "plafondexplosion", ",", "initialTailFlag",
           ",", "InitialTailPosition", ",", "InitialTailPosition2"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{
         "LegendreCoef2", ",", "period2", ",", "period2n", ",", "\[Epsilon]2",
           ",", "kmax", ",", "StartControl", ",", "IncrementFactor"}], "}"}], 
        ",", "printflag"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Min", "[", 
        RowBox[{
         RowBox[{"S", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"Max", "[", 
          RowBox[{"0", ",", 
           RowBox[{"prices", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "KList1", "]"}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4042074577632284`*^9, 3.4042074770760994`*^9}, {
   3.4042075328115444`*^9, 3.4042077538626633`*^9}, {3.404207970241818*^9, 
   3.404207993351637*^9}, {3.4042080286491895`*^9, 3.404208043665103*^9}, {
   3.4042173037335176`*^9, 3.4042173873444977`*^9}, {3.4042175109093704`*^9, 
   3.404217554472707*^9}, {3.4042999349691343`*^9, 3.4042999555923347`*^9}, {
   3.404381253215744*^9, 3.404381270172944*^9}, {3.4044634862113743`*^9, 
   3.4044635745846777`*^9}, {3.404463622474383*^9, 3.4044637577842846`*^9}, {
   3.4044637895649247`*^9, 3.4044638511887417`*^9}, {3.404463881485035*^9, 
   3.404463962092862*^9}, {3.4044646348143206`*^9, 3.4044646352830615`*^9}, {
   3.4044659090554795`*^9, 3.4044659091648526`*^9}, {3.404466252111393*^9, 
   3.4044662673767247`*^9}, {3.4044662976417685`*^9, 
   3.4044662980323863`*^9}, {3.4044673732461166`*^9, 
   3.4044673808397207`*^9}, {3.4046519546877003`*^9, 
   3.4046519750474663`*^9}, {3.4046528875181103`*^9, 3.404652993051387*^9}, 
   3.404811180721076*^9, {3.404811251817556*^9, 3.404811256317729*^9}, 
   3.404826602406996*^9, {3.4048266367520647`*^9, 3.4048266473149705`*^9}, {
   3.404838584300705*^9, 3.404838585847639*^9}, 3.405092320454278*^9, {
   3.405164497212655*^9, 3.405164499806472*^9}, {3.4051649727560787`*^9, 
   3.405165018538501*^9}, {3.4051841739727774`*^9, 3.405184192723977*^9}, {
   3.405334927245795*^9, 3.4053349669257946`*^9}, 3.4053352651807947`*^9, {
   3.405335552143795*^9, 3.4053355628907948`*^9}, {3.4053468889442806`*^9, 
   3.405346892584999*^9}, {3.4056659541902485`*^9, 3.405665996456685*^9}, {
   3.4056660325198774`*^9, 3.405666060614167*^9}, {3.4064720093802834`*^9, 
   3.4064720180055046`*^9}, {3.4065576085061626`*^9, 
   3.4065576132406583`*^9}, {3.4066132021674767`*^9, 3.40661323473081*^9}, 
   3.4069599865106955`*^9, {3.40696008755951*^9, 3.4069600906689453`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SmileBiHestonPaysFloat1Digital2", "[", 
   RowBox[{
   "S_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "a_", ",", "b_", ",", "c_",
     ",", "KList1_", ",", "\[Tau]_", ",", "\[CapitalSigma]_", ",", "M_", ",", 
    "\[CapitalSigma]inf_", ",", "Q_", ",", "\[Rho]_", ",", "\[Mu]_", ",", 
    "printflag_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "KList", ",", "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", 
      ",", "period1n", ",", "\[Epsilon]1", ",", "LegendreCoef2", ",", 
      "period2", ",", "period2n", ",", "\[Epsilon]2", ",", "imax", ",", 
      "\[Lambda]1", ",", "\[Lambda]2", ",", "KListPositive", ",", 
      "KListNegative", ",", 
      RowBox[{"KPositivePrices", "=", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"KNegativePrices", "=", 
       RowBox[{"{", "}"}]}], ",", "\[Beta]m", ",", "prices", ",", 
      "startmonitortime", ",", "plafondexplosion", ",", "initialTailFlag", 
      ",", "InitialTailPosition", ",", "InitialTailPosition2", ",", "kmax", 
      ",", "StartControl", ",", "IncrementFactor"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "KList1", "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{"KList", "=", 
        RowBox[{"{", "KList1", "}"}]}], ",", 
       RowBox[{"KList", "=", "KList1"}]}], "]"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"\[Beta]m", "=", 
      RowBox[{"-", 
       RowBox[{
        RowBox[{"(", 
         FractionBox[
          RowBox[{
           RowBox[{"M", ".", "\[CapitalSigma]inf"}], "+", 
           RowBox[{"\[CapitalSigma]inf", ".", 
            RowBox[{"Transpose", "[", "M", "]"}]}]}], "2"], ")"}], ".", 
        RowBox[{"Inverse", "[", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Transpose", "[", "Q", "]"}], ".", "Q"}], ")"}], 
         "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", ",", 
          "period1n", ",", "\[Epsilon]1", ",", "startmonitortime", ",", 
          "plafondexplosion", ",", "initialTailFlag", ",", 
          "InitialTailPosition", ",", "InitialTailPosition2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "LegendreCoef2", ",", "period2", ",", "period2n", ",", "\[Epsilon]2",
           ",", "kmax", ",", "StartControl", ",", "IncrementFactor"}], "}"}], 
        ",", "imax", ",", "\[Lambda]1", ",", "\[Lambda]2"}], "}"}], "=", 
      RowBox[{"BiHestonVanillaOptimalParameters", "[", 
       RowBox[{
       "S", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", "b", ",", "c", 
        ",", 
        RowBox[{"KList", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "\[Tau]", ",", 
        "\[CapitalSigma]", ",", "M", ",", "\[CapitalSigma]inf", ",", "Q", ",",
         "\[Rho]", ",", "\[Mu]", ",", "\"\<MaxOption\>\"", ",", "printflag"}],
        "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"prices", "=", 
      RowBox[{"SmileBiHestonPaysFloat1DigitalAux", "[", 
       RowBox[{
       "S", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", "b", ",", "c", 
        ",", "KList1", ",", "\[Tau]", ",", "\[CapitalSigma]", ",", "M", ",", 
        "\[CapitalSigma]inf", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", 
        "\[Beta]m", ",", "\[Lambda]1", ",", "\[Lambda]2", ",", 
        RowBox[{"{", 
         RowBox[{
         "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", ",", 
          "period1n", ",", "\[Epsilon]1", ",", "imax", ",", 
          "startmonitortime", ",", "plafondexplosion", ",", "initialTailFlag",
           ",", "InitialTailPosition", ",", "InitialTailPosition2"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{
         "LegendreCoef2", ",", "period2", ",", "period2n", ",", "\[Epsilon]2",
           ",", "kmax", ",", "StartControl", ",", "IncrementFactor"}], "}"}], 
        ",", "printflag"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Min", "[", 
        RowBox[{
         RowBox[{"S", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"Max", "[", 
          RowBox[{"0", ",", 
           RowBox[{"prices", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "KList1", "]"}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4042074577632284`*^9, 3.4042074770760994`*^9}, {
   3.4042075328115444`*^9, 3.4042077538626633`*^9}, {3.404207970241818*^9, 
   3.404207993351637*^9}, {3.4042080286491895`*^9, 3.404208043665103*^9}, {
   3.4042173037335176`*^9, 3.4042173873444977`*^9}, {3.4042175109093704`*^9, 
   3.404217554472707*^9}, {3.4042999349691343`*^9, 3.4042999555923347`*^9}, {
   3.404381253215744*^9, 3.404381270172944*^9}, {3.4044634862113743`*^9, 
   3.4044635745846777`*^9}, {3.404463622474383*^9, 3.4044637577842846`*^9}, {
   3.4044637895649247`*^9, 3.4044638511887417`*^9}, {3.404463881485035*^9, 
   3.404463962092862*^9}, {3.4044640040764313`*^9, 3.4044640086857176`*^9}, 
   3.404464521300875*^9, {3.4044646057055044`*^9, 3.4044646242676477`*^9}, {
   3.404466242564701*^9, 3.404466243330312*^9}, {3.404466359484331*^9, 
   3.404466395764885*^9}, 3.404651957359627*^9, {3.404651989141487*^9, 
   3.4046519954384828`*^9}, {3.404653007770419*^9, 3.404653025192629*^9}, {
   3.404662589800545*^9, 3.404662590237345*^9}, {3.404718208726282*^9, 
   3.4047182136173773`*^9}, 3.4048111841899595`*^9, {3.4048112616773095`*^9, 
   3.4048112656774635`*^9}, 3.4048265968755336`*^9, {3.4048266642843723`*^9, 
   3.404826666581335*^9}, {3.404838607801607*^9, 3.4048386098641863`*^9}, 
   3.4050923021413093`*^9, {3.4051645547297525`*^9, 3.4051645690113683`*^9}, {
   3.4051650300231695`*^9, 3.405165068383527*^9}, 3.4051842118807774`*^9, {
   3.405335034395795*^9, 3.405335042957795*^9}, 3.4053352589067945`*^9, {
   3.405335535829795*^9, 3.4053355405097947`*^9}, {3.405346901694607*^9, 
   3.405346926101482*^9}, {3.40566610113057*^9, 3.4056661135995593`*^9}, {
   3.4064720281307635`*^9, 3.4064720332090187`*^9}, {3.406557617240761*^9, 
   3.4065576215064955`*^9}, {3.406613240824716*^9, 3.4066132522781343`*^9}, 
   3.406959970197882*^9, {3.4069600737623706`*^9, 3.406960080293746*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SmileBiHestonPaysFloat1Digital3", "[", 
   RowBox[{
   "S_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "a_", ",", "b_", ",", "c_",
     ",", "KList1_", ",", "\[Tau]_", ",", "\[CapitalSigma]_", ",", "M_", ",", 
    "Q_", ",", "\[Beta]_", ",", "\[Rho]_", ",", "\[Mu]_", ",", "printflag_"}],
    "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "KList", ",", "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", 
      ",", "period1n", ",", "\[Epsilon]1", ",", "LegendreCoef2", ",", 
      "period2", ",", "period2n", ",", "\[Epsilon]2", ",", "imax", ",", 
      "\[Lambda]1", ",", "\[Lambda]2", ",", "\[CapitalSigma]inf", ",", 
      "KListPositive", ",", "KListNegative", ",", 
      RowBox[{"KPositivePrices", "=", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"KNegativePrices", "=", 
       RowBox[{"{", "}"}]}], ",", "prices", ",", "startmonitortime", ",", 
      "plafondexplosion", ",", "initialTailFlag", ",", "InitialTailPosition", 
      ",", "InitialTailPosition2", ",", "kmax", ",", "StartControl", ",", 
      "IncrementFactor"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[CapitalSigma]inf", "=", 
      RowBox[{"\[CapitalSigma]inf", "=", 
       RowBox[{"SolveSymetricEquation", "[", 
        RowBox[{"M", ",", 
         RowBox[{
          RowBox[{"-", "2"}], 
          SuperscriptBox["\[Beta]", "2"], " ", 
          RowBox[{
           RowBox[{"Transpose", "[", "Q", "]"}], ".", "Q"}]}]}], "]"}]}]}], 
     " ", ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "KList1", "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{"KList", "=", 
        RowBox[{"{", "KList1", "}"}]}], ",", 
       RowBox[{"KList", "=", "KList1"}]}], "]"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", ",", 
          "period1n", ",", "\[Epsilon]1", ",", "startmonitortime", ",", 
          "plafondexplosion", ",", "initialTailFlag", ",", 
          "InitialTailPosition", ",", "InitialTailPosition2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "LegendreCoef2", ",", "period2", ",", "period2n", ",", "\[Epsilon]2",
           ",", "kmax", ",", "StartControl", ",", "IncrementFactor"}], "}"}], 
        ",", "imax", ",", "\[Lambda]1", ",", "\[Lambda]2"}], "}"}], "=", 
      RowBox[{"BiHestonVanillaOptimalParameters", "[", 
       RowBox[{
       "S", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", "b", ",", "c", 
        ",", 
        RowBox[{"KList", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "\[Tau]", ",", 
        "\[CapitalSigma]", ",", "M", ",", "\[CapitalSigma]inf", ",", "Q", ",",
         "\[Rho]", ",", "\[Mu]", ",", "\"\<MaxOption\>\"", ",", "printflag"}],
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"prices", "=", 
      RowBox[{"SmileBiHestonPaysFloat1Digital", "[", 
       RowBox[{
       "S", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", "b", ",", "c", 
        ",", "KList1", ",", "\[Tau]", ",", "\[CapitalSigma]", ",", "M", ",", 
        "\[CapitalSigma]inf", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", 
        "\[Beta]", ",", "\[Lambda]1", ",", "\[Lambda]2", ",", 
        RowBox[{"{", 
         RowBox[{
         "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", ",", 
          "period1n", ",", "\[Epsilon]1", ",", "imax", ",", 
          "startmonitortime", ",", "plafondexplosion", ",", "initialTailFlag",
           ",", "InitialTailPosition", ",", "InitialTailPosition2"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{
         "LegendreCoef2", ",", "period2", ",", "period2n", ",", "\[Epsilon]2",
           ",", "kmax", ",", "StartControl", ",", "IncrementFactor"}], "}"}], 
        ",", "printflag"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Min", "[", 
        RowBox[{
         RowBox[{"S", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"Max", "[", 
          RowBox[{"0", ",", 
           RowBox[{"prices", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "KList1", "]"}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4042074577632284`*^9, 3.4042074770760994`*^9}, {
   3.4042075328115444`*^9, 3.4042077538626633`*^9}, {3.404207970241818*^9, 
   3.404207993351637*^9}, {3.4042080286491895`*^9, 3.404208043665103*^9}, {
   3.4042173037335176`*^9, 3.4042173873444977`*^9}, {3.4042175109093704`*^9, 
   3.404217554472707*^9}, {3.4042999349691343`*^9, 3.4042999555923347`*^9}, {
   3.404381253215744*^9, 3.404381270172944*^9}, {3.4044634862113743`*^9, 
   3.4044635745846777`*^9}, {3.404463622474383*^9, 3.4044637577842846`*^9}, {
   3.4044637895649247`*^9, 3.4044638511887417`*^9}, {3.404463881485035*^9, 
   3.404463962092862*^9}, {3.4044646348143206`*^9, 3.4044646352830615`*^9}, {
   3.4044659090554795`*^9, 3.4044659091648526`*^9}, {3.404466252111393*^9, 
   3.4044662673767247`*^9}, {3.4044662976417685`*^9, 
   3.4044662980323863`*^9}, {3.4044673732461166`*^9, 
   3.4044673808397207`*^9}, {3.4046519546877003`*^9, 
   3.4046519750474663`*^9}, {3.4046528875181103`*^9, 3.404652993051387*^9}, 
   3.404811180721076*^9, {3.404811251817556*^9, 3.404811256317729*^9}, 
   3.404826602406996*^9, {3.4048266367520647`*^9, 3.4048266473149705`*^9}, {
   3.404838584300705*^9, 3.404838585847639*^9}, 3.405092320454278*^9, {
   3.405164497212655*^9, 3.405164499806472*^9}, {3.4051649727560787`*^9, 
   3.405165018538501*^9}, {3.4051841739727774`*^9, 3.405184192723977*^9}, {
   3.405334927245795*^9, 3.4053349669257946`*^9}, 3.4053352651807947`*^9, {
   3.405335552143795*^9, 3.4053355628907948`*^9}, {3.4053468889442806`*^9, 
   3.405346892584999*^9}, {3.4056659541902485`*^9, 3.405665996456685*^9}, {
   3.4056660325198774`*^9, 3.405666060614167*^9}, {3.4064720093802834`*^9, 
   3.4064720180055046`*^9}, {3.4065576085061626`*^9, 
   3.4065576132406583`*^9}, {3.4066132021674767`*^9, 3.40661323473081*^9}, 
   3.4069599865106955`*^9, {3.40696008755951*^9, 3.4069600906689453`*^9}, {
   3.4070580530495844`*^9, 3.407058083690798*^9}, 3.407583382275401*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TestBiHestonPaysFloat1Digital", "[", 
   RowBox[{
   "S_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "a_", ",", "b_", ",", "c_",
     ",", "K_", ",", "\[Tau]_", ",", "\[CapitalSigma]_", ",", "M_", ",", 
    "\[CapitalSigma]inf_", ",", "\[Beta]_", ",", "\[Rho]_", ",", "\[Mu]_", 
    ",", "\[Lambda]1_", ",", "\[Lambda]2_", ",", "scope_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "KList", ",", "period2", ",", "Q", ",", "as", ",", "res", ",", "res2", 
      ",", 
      RowBox[{"Y", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Log", "[", 
          RowBox[{"S", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
         RowBox[{"Log", "[", 
          RowBox[{"S", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}], ",", 
      RowBox[{"\[Omega]1", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Q", "=", 
      RowBox[{
       RowBox[{"CholeskyDecomposition", "[", 
        RowBox[{"-", 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"M", ".", "\[CapitalSigma]inf"}], "+", 
            RowBox[{"\[CapitalSigma]inf", ".", " ", 
             RowBox[{"Transpose", "[", "M", "]"}]}]}], "2"], ")"}]}], "]"}], 
       "/", "\[Beta]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"period2", "=", 
      FractionBox["scope", 
       SqrtBox[
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{"\[CapitalSigma]", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], "+", 
           RowBox[{"\[CapitalSigma]", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "2"}], "]"}], "]"}], "+", 
           RowBox[{"\[CapitalSigma]inf", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], "+", 
           RowBox[{"\[CapitalSigma]inf", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "4"], "\[Tau]"}]]]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"SmileSymetrizedBiHestonPaysFloat1DigitalIntegrand", "[", 
         RowBox[{
         "Y", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", "b", ",", "c",
           ",", 
          RowBox[{"{", "K", "}"}], ",", "\[Tau]", ",", "\[CapitalSigma]", ",",
           "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", "\[Beta]", ",", 
          "\[Lambda]1", ",", "\[Lambda]2", ",", "\[Omega]1", ",", 
          "\[Omega]2"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Omega]2", ",", "0", " ", ",", 
         RowBox[{"2", "period2"}]}], "}"}], ",", 
       RowBox[{"PlotPoints", "\[Rule]", "50"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", 
        RowBox[{"\"\<Integrand spreadoption : K =\>\"", "<>", 
         RowBox[{"ToString", "[", "K", "]"}], "<>", "\"\< \[Omega]1=\>\"", "<>",
          
         RowBox[{"ToString", "[", "\[Omega]1", "]"}]}]}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4042074577632284`*^9, 3.4042074770760994`*^9}, {
   3.4042075328115444`*^9, 3.4042077538626633`*^9}, {3.404207970241818*^9, 
   3.404207993351637*^9}, {3.4042080286491895`*^9, 3.404208043665103*^9}, {
   3.4042173037335176`*^9, 3.4042173873444977`*^9}, {3.4042175109093704`*^9, 
   3.404217554472707*^9}, {3.4042999349691343`*^9, 3.4042999555923347`*^9}, {
   3.404381253215744*^9, 3.404381270172944*^9}, {3.4044634862113743`*^9, 
   3.4044635745846777`*^9}, {3.404463622474383*^9, 3.4044637577842846`*^9}, {
   3.4044637895649247`*^9, 3.4044638511887417`*^9}, {3.404463881485035*^9, 
   3.404463962092862*^9}, {3.4044646348143206`*^9, 3.4044646352830615`*^9}, {
   3.4044659090554795`*^9, 3.4044659091648526`*^9}, {3.404466252111393*^9, 
   3.4044662673767247`*^9}, {3.4044662976417685`*^9, 
   3.4044662980323863`*^9}, {3.4044673732461166`*^9, 
   3.4044673808397207`*^9}, {3.4046519546877003`*^9, 
   3.4046519750474663`*^9}, {3.4046528875181103`*^9, 3.404652993051387*^9}, 
   3.404811180721076*^9, {3.404811251817556*^9, 3.404811256317729*^9}, 
   3.404826602406996*^9, {3.4048266367520647`*^9, 3.4048266473149705`*^9}, {
   3.404838584300705*^9, 3.404838585847639*^9}, {3.404888355750947*^9, 
   3.4048883751261473`*^9}, {3.404888409087347*^9, 3.4048884100857472`*^9}, 
   3.404888482298147*^9, {3.404888523107747*^9, 3.404888593260947*^9}, {
   3.4048886239773474`*^9, 3.404888647377347*^9}, {3.4048888242189474`*^9, 
   3.4048888357941475`*^9}, {3.4048891031157475`*^9, 3.404889148121747*^9}, {
   3.404889229444547*^9, 3.404889260831747*^9}, {3.404889328176947*^9, 
   3.404889408579347*^9}, {3.4048896364485474`*^9, 3.4048896370257473`*^9}, {
   3.4048906491191473`*^9, 3.404890657433947*^9}, 3.4048906939379473`*^9, {
   3.4048908372083473`*^9, 3.404890839158347*^9}, {3.4048912343375473`*^9, 
   3.4048912741487474`*^9}, {3.4051645422294326`*^9, 3.4051645498858786`*^9}, 
   3.4053349711497946`*^9, 3.405335260905795*^9, {3.405335546967795*^9, 
   3.4053355475527945`*^9}, {3.405346894850682*^9, 3.405346917351258*^9}, {
   3.4053471798423524`*^9, 3.405347181451769*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Integration Bi Dimensional", "Subsubtitle",
 CellChangeTimes->{{3.404641430673939*^9, 3.4046414450023394`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SmileBiHestonPaysFloat1DigitalAux", "[", 
   RowBox[{
   "S_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "a_", ",", "b_", ",", "c_",
     ",", "KList_", ",", "\[Tau]_", ",", "\[CapitalSigma]_", ",", "M_", ",", 
    "\[CapitalSigma]inf_", ",", "Q_", ",", "\[Rho]_", ",", "\[Mu]_", ",", 
    "\[Beta]_", ",", "\[Lambda]1_", ",", "\[Lambda]2_", ",", 
    RowBox[{"{", 
     RowBox[{
     "LegendreCoef1_", ",", "LegendreCoef1n_", ",", "period1_", ",", 
      "period1n_", ",", "\[Epsilon]1_", ",", "imax_", ",", 
      "startmonitortime_", ",", "plafondexplosion_", ",", "initialTailFlag_", 
      ",", "InitialTailPosition_", ",", "InitialTailPosition2_"}], "}"}], ",",
     
    RowBox[{"{", 
     RowBox[{
     "LegendreCoef2_", ",", "period2_", ",", "period2n_", ",", "\[Epsilon]2_",
       ",", "kmax_", ",", "StartControl_", ",", "IncrementFactor_"}], "}"}], 
    ",", "printflag_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{
   FractionBox["2", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"2", "\[Pi]"}], ")"}], "2"]], 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"as", ",", "res", ",", "res2", ",", 
       RowBox[{"Y", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Log", "[", 
           RowBox[{"S", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
          RowBox[{"Log", "[", 
           RowBox[{"S", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "1"}], " ", "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "1"}], "]"}]}], "  ", ",", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\< S=\>\"", ",", 
           RowBox[{"S", " ", "//", " ", "MatrixForm"}], ",", 
           "\"\< \[CapitalSigma]=\>\"", ",", 
           RowBox[{"\[CapitalSigma]", " ", "//", "MatrixForm"}], ",", 
           "\"\<M=\>\"", ",", 
           RowBox[{"M", "//", "MatrixForm"}], ",", 
           "\"\< \[CapitalSigma]inf=\>\"", ",", 
           RowBox[{"\[CapitalSigma]inf", "//", "MatrixForm"}], " ", ",", 
           "\"\< Q=\>\"", ",", 
           RowBox[{"Q", "//", "MatrixForm"}], " ", ",", "\"\< \[Rho]=\>\"", 
           ",", 
           RowBox[{"\[Rho]", "//", "MatrixForm"}], ",", "\"\< \[Mu]=\>\"", 
           ",", 
           RowBox[{"\[Mu]", "//", "MatrixForm"}], ",", "\"\< \[Beta]=\>\"", 
           ",", "\[Beta]", ",", "\"\< T=\>\"", ",", "\[Tau]"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Inner Integration\>\"", ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\"\<LegendreNbMain\>\"", ",", 
                RowBox[{"Length", "[", "LegendreCoef1", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<LegendreNbIncrement\>\"", ",", 
                RowBox[{"Length", "[", "LegendreCoef1n", "]"}]}], "}"}], ",", 
              
              RowBox[{"{", 
               RowBox[{"\"\<IncrementNbMax\>\"", ",", "imax"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<InitialTailFlag\>\"", ",", "initialTailFlag"}], 
               "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<InitialTailLegendreNb\>\"", ",", 
                RowBox[{"Length", "[", "LegendreCoef2", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<PeriodMain\>\"", ",", "period1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<PeriodnIncrement\>\"", ",", "period1n"}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"\"\<StoppingLevel\>\"", ",", "\[Epsilon]1"}], "}"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"\"\<AbcisseMaxValue\>\"", ",", "kmax"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
               "\"\<InitialTailUpperLimit\>\"", ",", "InitialTailPosition"}], 
               "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
               "\"\<ExplosionMonitoringStartAbcisse\>\"", ",", 
                "StartControl"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
               "\"\<ExplosionMonitoringMaxLevel\>\"", ",", 
                "IncrementFactor"}], "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"\"\<lambda1\>\"", ",", "\[Lambda]1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<lambda2\>\"", ",", "\[Lambda]2"}], "}"}]}], "}"}],
             " ", "//", " ", "MatrixForm"}], ",", "\[IndentingNewLine]", 
           "\"\<Outer Integration\>\"", ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\"\<LegendreNbMain\>\"", ",", 
                RowBox[{"Length", "[", "LegendreCoef2", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<LegendreNbIncrement\>\"", ",", 
                RowBox[{"Length", "[", "LegendreCoef1n", "]"}]}], "}"}], ",", 
              
              RowBox[{"{", 
               RowBox[{"\"\<IncrementNbMax\>\"", ",", "imax"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<InitialTailFlag\>\"", ",", "initialTailFlag"}], 
               "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<InitialTailLegendreNb\>\"", ",", 
                RowBox[{"Length", "[", "LegendreCoef1", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<PeriodMain\>\"", ",", "period2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<PeriodnIncrement\>\"", ",", "period2n"}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"\"\<StoppingLevel\>\"", ",", "\[Epsilon]2"}], "}"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"\"\<AbcisseMaxValue\>\"", ",", "kmax"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
               "\"\<InitialTailUpperLimit\>\"", ",", "InitialTailPosition"}], 
               "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
               "\"\<GrowingControlStartAbcisse\>\"", ",", 
                "startmonitortime"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
               "\"\<GrowingControlMaxFactor\>\"", ",", "plafondexplosion"}], 
               "}"}]}], "}"}], " ", "//", " ", "MatrixForm"}]}], "]"}]}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "2"}], " ", "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "2"}], "]"}]}], "  ", ",", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<BiHestonLaplaceQuickTransform[M,Q,\[Rho], \
\[Mu],\[CapitalSigma],{-\[ImaginaryI] 1,-\[ImaginaryI] \
1},\[Beta],\[Tau]]=\>\"", ",", 
           RowBox[{"BiHestonLaplaceQuickTransform", "[", 
            RowBox[{
            "M", ",", "Q", ",", "\[Rho]", ",", " ", "\[Mu]", ",", 
             "\[CapitalSigma]", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "\[ImaginaryI]"}], " ", "1"}], ",", 
               RowBox[{
                RowBox[{"-", "\[ImaginaryI]"}], " ", "1"}]}], "}"}], ",", 
             "\[Beta]", ",", "\[Tau]"}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<integrand(0.1,0.1)=\>\"", ",", 
           RowBox[{
           "SmileSymetrizedBiHestonPaysFloat1DigitalIntegrandCC", "[", 
            RowBox[{
            "Y", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", "b", ",", 
             "c", ",", "KList", ",", "\[Tau]", ",", "\[CapitalSigma]", ",", 
             "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", "\[Beta]", ",", 
             "\[Lambda]1", ",", "\[Lambda]2", ",", "0.1", ",", "0.1"}], 
            "]"}]}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "4"}], "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "4"}], "]"}]}], " ", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Plot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
              "SmileSymetrizedBiHestonPaysFloat1DigitalIntegrand", "[", 
               RowBox[{
               "Y", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", "b", 
                ",", "c", ",", 
                RowBox[{"{", 
                 RowBox[{"KList", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", "\[Tau]", ",", 
                "\[CapitalSigma]", ",", "M", ",", "Q", ",", "\[Rho]", ",", 
                "\[Mu]", ",", "\[Beta]", ",", "\[Lambda]1", ",", "\[Lambda]2",
                 ",", "\[Omega]1", ",", "\[Omega]2"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Omega]2", ",", "0", " ", ",", 
               RowBox[{"2", "period2"}]}], "}"}], ",", 
             RowBox[{"PlotPoints", "\[Rule]", "50"}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
             RowBox[{"PlotLabel", "\[Rule]", 
              RowBox[{"\"\<1st Inverse Fourier: K =\>\"", "<>", 
               RowBox[{"ToString", "[", 
                RowBox[{"KList", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", 
               "\"\< \[Omega]1=\>\"", "<>", 
               RowBox[{"ToString", "[", "\[Omega]1", "]"}]}]}]}], "]"}], ",", 
           
           RowBox[{"{", 
            RowBox[{"\[Omega]1", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.2", ",", "2"}], "}"}]}], "}"}]}], "]"}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "6"}], "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "6"}], "]"}]}], " ", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\[Omega]2", ",", 
               RowBox[{
                RowBox[{"VectorAdaptativeIntegrateExplosionSafe", "[", 
                 RowBox[{
                  RowBox[{"Function", "[", 
                   RowBox[{"\[Omega]1", ",", 
                    RowBox[{
                    RowBox[{
                    "SmileSymetrizedBiHestonPaysFloat1DigitalIntegrand", "[", 
                    
                    RowBox[{
                    "Y", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", 
                    "b", ",", "c", ",", 
                    RowBox[{"{", 
                    RowBox[{"KList", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", "\[Tau]", ",",
                     "\[CapitalSigma]", ",", "M", ",", "Q", ",", "\[Rho]", 
                    ",", "\[Mu]", ",", "\[Beta]", ",", "\[Lambda]1", ",", 
                    "\[Lambda]2", ",", "\[Omega]1", ",", "\[Omega]2"}], "]"}],
                     "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
                  "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", ",",
                   "period1n", ",", "\[Epsilon]1", ",", "imax", ",", "1", ",",
                   "startmonitortime", ",", "plafondexplosion", ",", 
                  "initialTailFlag", ",", "InitialTailPosition"}], "]"}], "[",
                 
                RowBox[{"[", 
                 RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Omega]2", ",", "0", ",", "period2", ",", 
               RowBox[{"period2", "/", "60"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"Joined", "\[Rule]", "True"}], ",", 
           RowBox[{"PlotLabel", "\[Rule]", "\"\<2nd Inverse Fourier:\>\""}], 
           ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "]"}]}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "7"}], "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "7"}], "]"}]}], " ", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<integrand(0.1,0.1)=\>\"", ",", 
          RowBox[{"SmileSymetrizedBiHestonPaysFloat1DigitalIntegrand", "[", 
           RowBox[{
           "Y", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", "b", ",", 
            "c", ",", "KList", ",", "\[Tau]", ",", "\[CapitalSigma]", ",", 
            "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", "\[Beta]", ",", 
            "\[Lambda]1", ",", "\[Lambda]2", ",", "0.1", ",", "0.1"}], 
           "]"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{"VectorAdaptativeIntegrateUnprotected", "[", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{"\[Omega]2", ",", 
           RowBox[{
            RowBox[{"as", "=", 
             RowBox[{"VectorAdaptativeIntegrateExplosionSafe", "[", 
              RowBox[{
               RowBox[{"Function", "[", 
                RowBox[{"\[Omega]1", ",", 
                 RowBox[{
                 "SmileSymetrizedBiHestonPaysFloat1DigitalIntegrand", "[", 
                  RowBox[{
                  "Y", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", "b", 
                   ",", "c", ",", "KList", ",", "\[Tau]", ",", 
                   "\[CapitalSigma]", ",", "M", ",", "Q", ",", "\[Rho]", ",", 
                   "\[Mu]", ",", "\[Beta]", ",", "\[Lambda]1", ",", 
                   "\[Lambda]2", ",", "\[Omega]1", ",", "\[Omega]2"}], 
                  "]"}]}], "]"}], ",", "LegendreCoef1", ",", "LegendreCoef1n",
                ",", "period1", ",", "period1n", ",", "\[Epsilon]1", ",", 
               "imax", ",", 
               RowBox[{"Length", "[", "KList", "]"}], ",", "startmonitortime",
                ",", "plafondexplosion", ",", "initialTailFlag", ",", 
               "InitialTailPosition"}], "]"}]}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"printflag", "\[Equal]", "7"}], "||", " ", 
               RowBox[{"MemberQ", "[", 
                RowBox[{"printflag", ",", "7"}], "]"}]}], ",", 
              RowBox[{"Print", "[", 
               RowBox[{"\"\<Integ_2=\>\"", ",", "as"}], "]"}]}], "]"}], ";", 
            RowBox[{"as", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], ",", "LegendreCoef2", 
         ",", "period2", ",", "period2n", ",", "\[Epsilon]2", ",", "imax", 
         ",", 
         RowBox[{"Length", "[", "KList", "]"}], ",", "printflag", ",", 
         "initialTailFlag", ",", "InitialTailPosition2", ",", "kmax", ",", 
         "StartControl", ",", "IncrementFactor"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "7"}], "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "7"}], "]"}]}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Integ_1=\>\"", ",", "res"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"res", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.3997288601267104`*^9, 3.39972890803388*^9, {3.3997289692069297`*^9, 
   3.3997289944261637`*^9}, {3.399729087443575*^9, 3.3997291578199263`*^9}, {
   3.399729214633517*^9, 3.3997292559936857`*^9}, {3.399729338917153*^9, 
   3.399729443137904*^9}, {3.3997297921289797`*^9, 3.399729801332281*^9}, 
   3.3997984631978292`*^9, 3.3997986822957864`*^9, {3.399799475623518*^9, 
   3.3997994825611515`*^9}, {3.399813039024555*^9, 3.3998130523841867`*^9}, {
   3.3998138111956306`*^9, 3.399813818523896*^9}, {3.3998138975254135`*^9, 
   3.3998139300104117`*^9}, {3.399814002074295*^9, 3.3998140680286865`*^9}, {
   3.3998141794214506`*^9, 3.399814187827862*^9}, {3.3998161633189154`*^9, 
   3.399816166818983*^9}, {3.399816989678531*^9, 3.39981701069456*^9}, {
   3.3998175772210617`*^9, 3.3998175797054844`*^9}, {3.3998177980534267`*^9, 
   3.3998178039285393`*^9}, 3.3998191717048006`*^9, {3.399819229424659*^9, 
   3.399819249925052*^9}, {3.3998192996916327`*^9, 3.3998193255202537`*^9}, {
   3.3998194002404385`*^9, 3.399819401990472*^9}, {3.399819437022394*^9, 
   3.399819443678772*^9}, {3.3998195847752314`*^9, 3.3998195956035643`*^9}, {
   3.3998937261423693`*^9, 3.3998937440645885`*^9}, {3.399894673945778*^9, 
   3.3998946780865884`*^9}, 3.399895357951172*^9, {3.3998971752360635`*^9, 
   3.399897202986596*^9}, {3.399995099817901*^9, 3.3999951242558703`*^9}, {
   3.3999951653972855`*^9, 3.3999952424143887`*^9}, {3.399995434089944*^9, 
   3.3999954559809895`*^9}, 3.400214359554536*^9, {3.4002194753715076`*^9, 
   3.4002194862310915`*^9}, {3.400221264780864*^9, 3.400221267812172*^9}, {
   3.400221324438259*^9, 3.4002213249851446`*^9}, {3.4002307045682325`*^9, 
   3.4002307106777253`*^9}, {3.4002309417446613`*^9, 
   3.4002309457603636`*^9}, {3.4002355676772275`*^9, 
   3.4002356840075865`*^9}, {3.4002357813375797`*^9, 3.400235782228222*^9}, {
   3.400238239244146*^9, 3.40023824052542*^9}, {3.4004065560321016`*^9, 
   3.400406572266788*^9}, 3.40040661272069*^9, {3.400406710910075*^9, 
   3.400406802349331*^9}, {3.4004079962316275`*^9, 3.400408003981776*^9}, {
   3.4004080367167797`*^9, 3.400408037591797*^9}, {3.400408141500042*^9, 
   3.4004081422656813`*^9}, 3.400504474791651*^9, {3.4008198209228888`*^9, 
   3.4008198369544463`*^9}, {3.401177200473509*^9, 3.401177296365975*^9}, 
   3.4011776191065464`*^9, 3.4011776885297546`*^9, {3.4011777732345057`*^9, 
   3.4011777815627904`*^9}, {3.4015301347651124`*^9, 3.401530142671514*^9}, {
   3.4015342195318975`*^9, 3.4015342774861345`*^9}, {3.4015343731285963`*^9, 
   3.4015343749255056`*^9}, {3.402033437670154*^9, 3.402033457561161*^9}, {
   3.4020334928118377`*^9, 3.402033502483898*^9}, {3.402143403333747*^9, 
   3.402143421193465*^9}, {3.402143489991661*^9, 3.40214349125731*^9}, {
   3.402143653151044*^9, 3.4021436941674557`*^9}, {3.402205803123693*^9, 
   3.402205848499564*^9}, {3.402294611715026*^9, 3.4022946131681786`*^9}, 
   3.402294775718175*^9, {3.4022949263773174`*^9, 3.4022949270960813`*^9}, 
   3.4023779225819693`*^9, 3.402388039487956*^9, 3.4023881114109564`*^9, 
   3.403871476831417*^9, 3.403871589333577*^9, {3.403871732195695*^9, 
   3.4038719361371107`*^9}, 3.40387197021589*^9, {3.4038729130621176`*^9, 
   3.403872917359075*^9}, {3.4038732665532794`*^9, 3.4038732913350053`*^9}, {
   3.40387338716497*^9, 3.403873392790078*^9}, {3.4038739059561806`*^9, 
   3.403873929300379*^9}, {3.4038757265536356`*^9, 3.403875727100521*^9}, {
   3.4038760173873444`*^9, 3.403876028450057*^9}, {3.4038767128225718`*^9, 
   3.4038767355730085`*^9}, {3.403876883685227*^9, 3.403876894872942*^9}, 
   3.4038770811577682`*^9, {3.403877262489375*^9, 3.403877296927536*^9}, {
   3.4038779003609967`*^9, 3.4038779017516484`*^9}, {3.403877950330706*^9, 
   3.403877995722203*^9}, {3.4038805669746947`*^9, 3.4038805816156006`*^9}, {
   3.403940196949411*^9, 3.403940212309081*^9}, {3.4039402503098106`*^9, 
   3.403940330483225*^9}, {3.403940565097104*^9, 3.4039406320983906`*^9}, {
   3.4039477736886315`*^9, 3.4039478349866834`*^9}, 3.403947942238743*^9, {
   3.4039479736924715`*^9, 3.403948027771635*^9}, 3.403948162852353*^9, {
   3.4039491169487963`*^9, 3.4039491206988688`*^9}, {3.4039492631391034`*^9, 
   3.4039493470938406`*^9}, {3.4039496376931696`*^9, 3.403949723882324*^9}, {
   3.4039498424783516`*^9, 3.4039499998719983`*^9}, {3.404147952397335*^9, 
   3.404147980680135*^9}, {3.404148073983735*^9, 3.404148107492535*^9}, {
   3.404148258531735*^9, 3.4041482678605347`*^9}, {3.404148945009735*^9, 
   3.404148946164135*^9}, {3.4041489846337347`*^9, 3.404149017549735*^9}, {
   3.404149060200135*^9, 3.404149083178935*^9}, {3.404151307641535*^9, 
   3.404151309185935*^9}, {3.404151474499135*^9, 3.404151483219535*^9}, 
   3.404151568223935*^9, 3.4041938717523823`*^9, {3.404193912175033*^9, 
   3.404193917190755*^9}, {3.4042041069801445`*^9, 3.4042041521685123`*^9}, {
   3.4042042123415427`*^9, 3.4042042386076717`*^9}, {3.404204276624027*^9, 
   3.4042044284238167`*^9}, {3.40420452156623*^9, 3.4042045494573903`*^9}, {
   3.404204582895532*^9, 3.4042046181149583`*^9}, {3.404204788415103*^9, 
   3.4042048062748213`*^9}, {3.404204841759877*^9, 3.4042048723542147`*^9}, {
   3.404204936324193*^9, 3.4042052265172644`*^9}, {3.4042052790182724`*^9, 
   3.4042052894403477`*^9}, {3.404205340738208*^9, 3.4042053679418545`*^9}, {
   3.404205400817486*^9, 3.404205419677223*^9}, {3.4042054802252607`*^9, 
   3.404205497178711*^9}, 3.40420552863244*^9, {3.4042072185555105`*^9, 
   3.404207235243331*^9}, {3.4043000701119347`*^9, 3.4043000786295347`*^9}, {
   3.4043001168183346`*^9, 3.4043001401871347`*^9}, {3.4043234063901434`*^9, 
   3.404323420461344*^9}, {3.4043237408853436`*^9, 3.4043237568753433`*^9}, {
   3.4043239580841436`*^9, 3.4043239680837436`*^9}, {3.404389056089944*^9, 
   3.404389064997544*^9}, {3.4044553143383374`*^9, 3.4044553173471303`*^9}, {
   3.404464727328169*^9, 3.4044647793115463`*^9}, {3.4044648634193068`*^9, 
   3.404464895731186*^9}, 3.404464939995961*^9, {3.404466809225696*^9, 
   3.404466820006739*^9}, 3.4044669271765566`*^9, {3.404470193535716*^9, 
   3.404470194207578*^9}, {3.404652102174907*^9, 3.4046521218471603`*^9}, {
   3.404662523952945*^9, 3.4046625707061453`*^9}, {3.4046627912433453`*^9, 
   3.404662802490945*^9}, {3.4046642321459455`*^9, 3.404664234080345*^9}, {
   3.4046642723003454`*^9, 3.404664298679945*^9}, {3.4047349612907963`*^9, 
   3.4047350190586395`*^9}, 3.4048112009093513`*^9, {3.4048112843813066`*^9, 
   3.404811295334852*^9}, {3.4048122778100777`*^9, 3.4048123057486506`*^9}, 
   3.404826576562254*^9, {3.4048266892697067`*^9, 3.404826703692135*^9}, {
   3.404831024244785*^9, 3.404831026635502*^9}, {3.4049792115931997`*^9, 
   3.4049792117922*^9}, {3.405087246152504*^9, 3.4050872465900154`*^9}, {
   3.4051646230596266`*^9, 3.405164664404435*^9}, {3.405182662158377*^9, 
   3.4051826625327773`*^9}, {3.4053350771357946`*^9, 3.405335101457795*^9}, {
   3.405335223282795*^9, 3.405335224442795*^9}, {3.405335403379795*^9, 
   3.4053354154567947`*^9}, {3.405347079902294*^9, 3.4053470975433702`*^9}, {
   3.405934879243187*^9, 3.405934879274437*^9}, {3.4059354803953533`*^9, 
   3.4059354814734993`*^9}, 3.405935868027796*^9, {3.405936329036647*^9, 
   3.4059363302710457`*^9}, {3.4059368890317736`*^9, 3.405936915422906*^9}, 
   3.406469563536422*^9, {3.4064712185944147`*^9, 3.4064712210944786`*^9}, {
   3.4064712971745515`*^9, 3.4064713032684574`*^9}, 3.4064715060392733`*^9, {
   3.4065576350537167`*^9, 3.406557643788316*^9}, {3.4065578927478137`*^9, 
   3.4065578932009506`*^9}, {3.406558443293157*^9, 3.4065584451525803`*^9}, {
   3.4065620511355157`*^9, 3.4065620662921534`*^9}, {3.4066119537136416`*^9, 
   3.4066119559480743`*^9}, 3.406612224079938*^9, 3.4069596398321643`*^9, 
   3.406959752428076*^9, 3.4069686242390366`*^9, 3.4069734804416485`*^9, 
   3.4084277200552177`*^9, {3.408429607107074*^9, 3.4084296076383333`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SmileBiHestonPaysFloat1DigitalAux2", "[", 
   RowBox[{
   "S_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "a_", ",", "b_", ",", "c_",
     ",", "KList_", ",", "\[Tau]_", ",", "\[CapitalSigma]_", ",", "M_", ",", 
    "\[CapitalSigma]inf_", ",", "Q_", ",", "\[Rho]_", ",", "\[Mu]_", ",", 
    "\[Beta]m_", ",", "\[Lambda]1_", ",", "\[Lambda]2_", ",", 
    RowBox[{"{", 
     RowBox[{
     "LegendreCoef1_", ",", "LegendreCoef1n_", ",", "period1_", ",", 
      "period1n_", ",", "\[Epsilon]1_", ",", "imax_", ",", 
      "startmonitortime_", ",", "plafondexplosion_", ",", "initialTailFlag_", 
      ",", "InitialTailPosition_", ",", "InitialTailPosition2_"}], "}"}], ",",
     
    RowBox[{"{", 
     RowBox[{
     "LegendreCoef2_", ",", "period2_", ",", "period2n_", ",", "\[Epsilon]2_",
       ",", "kmax_", ",", "StartControl_", ",", "IncrementFactor_"}], "}"}], 
    ",", "printflag_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{
   FractionBox["2", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"2", "\[Pi]"}], ")"}], "2"]], 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"as", ",", "res", ",", "res2", ",", 
       RowBox[{"Y", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Log", "[", 
           RowBox[{"S", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
          RowBox[{"Log", "[", 
           RowBox[{"S", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "1"}], " ", "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "1"}], "]"}]}], "  ", ",", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\< S=\>\"", ",", 
           RowBox[{"S", " ", "//", " ", "MatrixForm"}], ",", 
           "\"\< \[CapitalSigma]=\>\"", ",", 
           RowBox[{"\[CapitalSigma]", " ", "//", "MatrixForm"}], ",", 
           "\"\<M=\>\"", ",", 
           RowBox[{"M", "//", "MatrixForm"}], ",", 
           "\"\< \[CapitalSigma]inf=\>\"", ",", 
           RowBox[{"\[CapitalSigma]inf", "//", "MatrixForm"}], " ", ",", 
           "\"\< Q=\>\"", ",", 
           RowBox[{"Q", "//", "MatrixForm"}], " ", ",", "\"\< \[Rho]=\>\"", 
           ",", 
           RowBox[{"\[Rho]", "//", "MatrixForm"}], ",", "\"\< \[Mu]=\>\"", 
           ",", 
           RowBox[{"\[Mu]", "//", "MatrixForm"}], ",", "\"\< \[Beta]m=\>\"", 
           ",", 
           RowBox[{"\[Beta]m", "//", " ", "MatrixForm"}], ",", "\"\< T=\>\"", 
           ",", "\[Tau]"}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Inner Integration\>\"", ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\"\<LegendreNbMain\>\"", ",", 
                RowBox[{"Length", "[", "LegendreCoef1", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<LegendreNbIncrement\>\"", ",", 
                RowBox[{"Length", "[", "LegendreCoef1n", "]"}]}], "}"}], ",", 
              
              RowBox[{"{", 
               RowBox[{"\"\<IncrementNbMax\>\"", ",", "imax"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<InitialTailFlag\>\"", ",", "initialTailFlag"}], 
               "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<InitialTailLegendreNb\>\"", ",", 
                RowBox[{"Length", "[", "LegendreCoef2", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<PeriodMain\>\"", ",", "period1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<PeriodnIncrement\>\"", ",", "period1n"}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"\"\<StoppingLevel\>\"", ",", "\[Epsilon]1"}], "}"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"\"\<AbcisseMaxValue\>\"", ",", "kmax"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
               "\"\<InitialTailUpperLimit\>\"", ",", "InitialTailPosition"}], 
               "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
               "\"\<ExplosionMonitoringStartAbcisse\>\"", ",", 
                "StartControl"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
               "\"\<ExplosionMonitoringMaxLevel\>\"", ",", 
                "IncrementFactor"}], "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"\"\<lambda1\>\"", ",", "\[Lambda]1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<lambda2\>\"", ",", "\[Lambda]2"}], "}"}]}], "}"}],
             " ", "//", " ", "MatrixForm"}], ",", "\[IndentingNewLine]", 
           "\"\<Outer Integration\>\"", ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\"\<LegendreNbMain\>\"", ",", 
                RowBox[{"Length", "[", "LegendreCoef2", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<LegendreNbIncrement\>\"", ",", 
                RowBox[{"Length", "[", "LegendreCoef1n", "]"}]}], "}"}], ",", 
              
              RowBox[{"{", 
               RowBox[{"\"\<IncrementNbMax\>\"", ",", "imax"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<InitialTailFlag\>\"", ",", "initialTailFlag"}], 
               "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<InitialTailLegendreNb\>\"", ",", 
                RowBox[{"Length", "[", "LegendreCoef1", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<PeriodMain\>\"", ",", "period2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<PeriodnIncrement\>\"", ",", "period2n"}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"\"\<StoppingLevel\>\"", ",", "\[Epsilon]2"}], "}"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"\"\<AbcisseMaxValue\>\"", ",", "kmax"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
               "\"\<InitialTailUpperLimit\>\"", ",", "InitialTailPosition"}], 
               "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
               "\"\<GrowingControlStartAbcisse\>\"", ",", 
                "startmonitortime"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
               "\"\<GrowingControlMaxFactor\>\"", ",", "plafondexplosion"}], 
               "}"}]}], "}"}], " ", "//", " ", "MatrixForm"}]}], "]"}]}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "2"}], " ", "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "2"}], "]"}]}], "  ", ",", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<BiHestonLaplaceQuickTransform2[M,Q,\[Rho], \[Mu],\
\[CapitalSigma],{-\[ImaginaryI] 1,-\[ImaginaryI] 1},\[Beta]m,\[Tau]]=\>\"", 
           ",", 
           RowBox[{"BiHestonLaplaceQuickTransform2", "[", 
            RowBox[{
            "M", ",", "Q", ",", "\[Rho]", ",", " ", "\[Mu]", ",", 
             "\[CapitalSigma]", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "\[ImaginaryI]"}], " ", "1"}], ",", 
               RowBox[{
                RowBox[{"-", "\[ImaginaryI]"}], " ", "1"}]}], "}"}], ",", 
             "\[Beta]m", ",", "\[Tau]"}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<integrand(0.1,0.1)=\>\"", ",", 
           RowBox[{
           "SmileSymetrizedBiHestonPaysFloat1DigitalIntegrand2CC", "[", 
            RowBox[{
            "Y", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", "b", ",", 
             "c", ",", "KList", ",", "\[Tau]", ",", "\[CapitalSigma]", ",", 
             "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", "\[Beta]m", ",",
              "\[Lambda]1", ",", "\[Lambda]2", ",", "0.1", ",", "0.1"}], 
            "]"}]}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "4"}], "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "4"}], "]"}]}], " ", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Plot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
              "SmileSymetrizedBiHestonPaysFloat1DigitalIntegrand2", "[", 
               RowBox[{
               "Y", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", "b", 
                ",", "c", ",", 
                RowBox[{"{", 
                 RowBox[{"KList", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", "\[Tau]", ",", 
                "\[CapitalSigma]", ",", "M", ",", "Q", ",", "\[Rho]", ",", 
                "\[Mu]", ",", "\[Beta]m", ",", "\[Lambda]1", ",", 
                "\[Lambda]2", ",", "\[Omega]1", ",", "\[Omega]2"}], "]"}], 
              "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Omega]2", ",", "0", " ", ",", 
               RowBox[{"2", "period1"}]}], "}"}], ",", 
             RowBox[{"PlotPoints", "\[Rule]", "50"}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
             RowBox[{"PlotLabel", "\[Rule]", 
              RowBox[{"\"\<1st Inverse Fourier: K =\>\"", "<>", 
               RowBox[{"ToString", "[", 
                RowBox[{"KList", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", 
               "\"\< \[Omega]1=\>\"", "<>", 
               RowBox[{"ToString", "[", "\[Omega]1", "]"}]}]}]}], "]"}], ",", 
           
           RowBox[{"{", 
            RowBox[{"\[Omega]1", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.2", ",", "2"}], "}"}]}], "}"}]}], "]"}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "6"}], "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "6"}], "]"}]}], " ", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\[Omega]2", ",", 
               RowBox[{
                RowBox[{"VectorAdaptativeIntegrateExplosionSafe", "[", 
                 RowBox[{
                  RowBox[{"Function", "[", 
                   RowBox[{"\[Omega]1", ",", 
                    RowBox[{
                    RowBox[{
                    "SmileSymetrizedBiHestonPaysFloat1DigitalIntegrand2", "[",
                     
                    RowBox[{
                    "Y", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", 
                    "b", ",", "c", ",", 
                    RowBox[{"{", 
                    RowBox[{"KList", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", "\[Tau]", ",",
                     "\[CapitalSigma]", ",", "M", ",", "Q", ",", "\[Rho]", 
                    ",", "\[Mu]", ",", "\[Beta]m", ",", "\[Lambda]1", ",", 
                    "\[Lambda]2", ",", "\[Omega]1", ",", "\[Omega]2"}], "]"}],
                     "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
                  "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", ",",
                   "period1n", ",", "\[Epsilon]1", ",", "imax", ",", "1", ",",
                   "startmonitortime", ",", "plafondexplosion", ",", 
                  "initialTailFlag", ",", "InitialTailPosition"}], "]"}], "[",
                 
                RowBox[{"[", 
                 RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Omega]2", ",", "0", ",", "period2", ",", 
               RowBox[{"period2", "/", "30"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"Joined", "\[Rule]", "True"}], ",", 
           RowBox[{"PlotLabel", "\[Rule]", "\"\<2nd Inverse Fourier:\>\""}], 
           ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "]"}]}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{"VectorAdaptativeIntegrateUnprotected", "[", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{"\[Omega]2", ",", 
           RowBox[{
            RowBox[{"as", "=", 
             RowBox[{"VectorAdaptativeIntegrateExplosionSafe", "[", 
              RowBox[{
               RowBox[{"Function", "[", 
                RowBox[{"\[Omega]1", ",", 
                 RowBox[{
                 "SmileSymetrizedBiHestonPaysFloat1DigitalIntegrand2", "[", 
                  RowBox[{
                  "Y", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", "b", 
                   ",", "c", ",", "KList", ",", "\[Tau]", ",", 
                   "\[CapitalSigma]", ",", "M", ",", "Q", ",", "\[Rho]", ",", 
                   "\[Mu]", ",", "\[Beta]m", ",", "\[Lambda]1", ",", 
                   "\[Lambda]2", ",", "\[Omega]1", ",", "\[Omega]2"}], 
                  "]"}]}], "]"}], ",", "LegendreCoef1", ",", "LegendreCoef1n",
                ",", "period1", ",", "period1n", ",", "\[Epsilon]1", ",", 
               "imax", ",", 
               RowBox[{"Length", "[", "KList", "]"}], ",", "startmonitortime",
                ",", "plafondexplosion", ",", "initialTailFlag", ",", 
               "InitialTailPosition"}], "]"}]}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"printflag", "\[Equal]", "2"}], ",", 
              RowBox[{"Print", "[", 
               RowBox[{"\"\<Integ_2=\>\"", ",", "as"}], "]"}]}], "]"}], ";", 
            RowBox[{"as", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], ",", "LegendreCoef2", 
         ",", "period2", ",", "period2n", ",", "\[Epsilon]2", ",", "imax", 
         ",", 
         RowBox[{"Length", "[", "KList", "]"}], ",", "printflag", ",", 
         "initialTailFlag", ",", "InitialTailPosition2", ",", "kmax", ",", 
         "StartControl", ",", "IncrementFactor"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"printflag", "\[Equal]", "2"}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Integ_1=\>\"", ",", "res"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"res", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.3997288601267104`*^9, 3.39972890803388*^9, {3.3997289692069297`*^9, 
   3.3997289944261637`*^9}, {3.399729087443575*^9, 3.3997291578199263`*^9}, {
   3.399729214633517*^9, 3.3997292559936857`*^9}, {3.399729338917153*^9, 
   3.399729443137904*^9}, {3.3997297921289797`*^9, 3.399729801332281*^9}, 
   3.3997984631978292`*^9, 3.3997986822957864`*^9, {3.399799475623518*^9, 
   3.3997994825611515`*^9}, {3.399813039024555*^9, 3.3998130523841867`*^9}, {
   3.3998138111956306`*^9, 3.399813818523896*^9}, {3.3998138975254135`*^9, 
   3.3998139300104117`*^9}, {3.399814002074295*^9, 3.3998140680286865`*^9}, {
   3.3998141794214506`*^9, 3.399814187827862*^9}, {3.3998161633189154`*^9, 
   3.399816166818983*^9}, {3.399816989678531*^9, 3.39981701069456*^9}, {
   3.3998175772210617`*^9, 3.3998175797054844`*^9}, {3.3998177980534267`*^9, 
   3.3998178039285393`*^9}, 3.3998191717048006`*^9, {3.399819229424659*^9, 
   3.399819249925052*^9}, {3.3998192996916327`*^9, 3.3998193255202537`*^9}, {
   3.3998194002404385`*^9, 3.399819401990472*^9}, {3.399819437022394*^9, 
   3.399819443678772*^9}, {3.3998195847752314`*^9, 3.3998195956035643`*^9}, {
   3.3998937261423693`*^9, 3.3998937440645885`*^9}, {3.399894673945778*^9, 
   3.3998946780865884`*^9}, 3.399895357951172*^9, {3.3998971752360635`*^9, 
   3.399897202986596*^9}, {3.399995099817901*^9, 3.3999951242558703`*^9}, {
   3.3999951653972855`*^9, 3.3999952424143887`*^9}, {3.399995434089944*^9, 
   3.3999954559809895`*^9}, 3.400214359554536*^9, {3.4002194753715076`*^9, 
   3.4002194862310915`*^9}, {3.400221264780864*^9, 3.400221267812172*^9}, {
   3.400221324438259*^9, 3.4002213249851446`*^9}, {3.4002307045682325`*^9, 
   3.4002307106777253`*^9}, {3.4002309417446613`*^9, 
   3.4002309457603636`*^9}, {3.4002355676772275`*^9, 
   3.4002356840075865`*^9}, {3.4002357813375797`*^9, 3.400235782228222*^9}, {
   3.400238239244146*^9, 3.40023824052542*^9}, {3.4004065560321016`*^9, 
   3.400406572266788*^9}, 3.40040661272069*^9, {3.400406710910075*^9, 
   3.400406802349331*^9}, {3.4004079962316275`*^9, 3.400408003981776*^9}, {
   3.4004080367167797`*^9, 3.400408037591797*^9}, {3.400408141500042*^9, 
   3.4004081422656813`*^9}, 3.400504474791651*^9, {3.4008198209228888`*^9, 
   3.4008198369544463`*^9}, {3.401177200473509*^9, 3.401177296365975*^9}, 
   3.4011776191065464`*^9, 3.4011776885297546`*^9, {3.4011777732345057`*^9, 
   3.4011777815627904`*^9}, {3.4015301347651124`*^9, 3.401530142671514*^9}, {
   3.4015342195318975`*^9, 3.4015342774861345`*^9}, {3.4015343731285963`*^9, 
   3.4015343749255056`*^9}, {3.402033437670154*^9, 3.402033457561161*^9}, {
   3.4020334928118377`*^9, 3.402033502483898*^9}, {3.402143403333747*^9, 
   3.402143421193465*^9}, {3.402143489991661*^9, 3.40214349125731*^9}, {
   3.402143653151044*^9, 3.4021436941674557`*^9}, {3.402205803123693*^9, 
   3.402205848499564*^9}, {3.402294611715026*^9, 3.4022946131681786`*^9}, 
   3.402294775718175*^9, {3.4022949263773174`*^9, 3.4022949270960813`*^9}, 
   3.4023779225819693`*^9, 3.402388039487956*^9, 3.4023881114109564`*^9, 
   3.403871476831417*^9, 3.403871589333577*^9, {3.403871732195695*^9, 
   3.4038719361371107`*^9}, 3.40387197021589*^9, {3.4038729130621176`*^9, 
   3.403872917359075*^9}, {3.4038732665532794`*^9, 3.4038732913350053`*^9}, {
   3.40387338716497*^9, 3.403873392790078*^9}, {3.4038739059561806`*^9, 
   3.403873929300379*^9}, {3.4038757265536356`*^9, 3.403875727100521*^9}, {
   3.4038760173873444`*^9, 3.403876028450057*^9}, {3.4038767128225718`*^9, 
   3.4038767355730085`*^9}, {3.403876883685227*^9, 3.403876894872942*^9}, 
   3.4038770811577682`*^9, {3.403877262489375*^9, 3.403877296927536*^9}, {
   3.4038779003609967`*^9, 3.4038779017516484`*^9}, {3.403877950330706*^9, 
   3.403877995722203*^9}, {3.4038805669746947`*^9, 3.4038805816156006`*^9}, {
   3.403940196949411*^9, 3.403940212309081*^9}, {3.4039402503098106`*^9, 
   3.403940330483225*^9}, {3.403940565097104*^9, 3.4039406320983906`*^9}, {
   3.4039477736886315`*^9, 3.4039478349866834`*^9}, 3.403947942238743*^9, {
   3.4039479736924715`*^9, 3.403948027771635*^9}, 3.403948162852353*^9, {
   3.4039491169487963`*^9, 3.4039491206988688`*^9}, {3.4039492631391034`*^9, 
   3.4039493470938406`*^9}, {3.4039496376931696`*^9, 3.403949723882324*^9}, {
   3.4039498424783516`*^9, 3.4039499998719983`*^9}, {3.404147952397335*^9, 
   3.404147980680135*^9}, {3.404148073983735*^9, 3.404148107492535*^9}, {
   3.404148258531735*^9, 3.4041482678605347`*^9}, {3.404148945009735*^9, 
   3.404148946164135*^9}, {3.4041489846337347`*^9, 3.404149017549735*^9}, {
   3.404149060200135*^9, 3.404149083178935*^9}, {3.404151307641535*^9, 
   3.404151309185935*^9}, {3.404151474499135*^9, 3.404151483219535*^9}, 
   3.404151568223935*^9, 3.4041938717523823`*^9, {3.404193912175033*^9, 
   3.404193917190755*^9}, {3.4042041069801445`*^9, 3.4042041521685123`*^9}, {
   3.4042042123415427`*^9, 3.4042042386076717`*^9}, {3.404204276624027*^9, 
   3.4042044284238167`*^9}, {3.40420452156623*^9, 3.4042045494573903`*^9}, {
   3.404204582895532*^9, 3.4042046181149583`*^9}, {3.404204788415103*^9, 
   3.4042048062748213`*^9}, {3.404204841759877*^9, 3.4042048723542147`*^9}, {
   3.404204936324193*^9, 3.4042052265172644`*^9}, {3.4042052790182724`*^9, 
   3.4042052894403477`*^9}, {3.404205340738208*^9, 3.4042053679418545`*^9}, {
   3.404205400817486*^9, 3.404205419677223*^9}, {3.4042054802252607`*^9, 
   3.404205497178711*^9}, 3.40420552863244*^9, {3.4042072185555105`*^9, 
   3.404207235243331*^9}, {3.4042169113197336`*^9, 3.404216925101248*^9}, {
   3.4043001505299344`*^9, 3.4043002016355343`*^9}, {3.4043234402889433`*^9, 
   3.4043234487441435`*^9}, {3.4043237751273437`*^9, 
   3.4043237822877436`*^9}, {3.404324132304144*^9, 3.4043241429121437`*^9}, {
   3.404324465254944*^9, 3.4043244826177435`*^9}, 3.404324753246544*^9, 
   3.404389086572344*^9, {3.4044647321249523`*^9, 3.404464746624674*^9}, {
   3.404464795092493*^9, 3.4044648116703*^9}, {3.404464856278818*^9, 
   3.404464859169388*^9}, {3.4044649040279016`*^9, 3.4044649336835823`*^9}, 
   3.4044669516448364`*^9, {3.4044672458266883`*^9, 3.4044672763573523`*^9}, {
   3.4046521047218313`*^9, 3.404652136113059*^9}, {3.404662443222945*^9, 
   3.404662495467345*^9}, 3.404811209190919*^9, {3.4048113022257414`*^9, 
   3.404811310991703*^9}, {3.4048123202804585`*^9, 3.4048123315308905`*^9}, {
   3.404826540560871*^9, 3.404826542826583*^9}, {3.404826714333169*^9, 
   3.404826722989751*^9}, 3.4048312176740875`*^9, {3.405145840438179*^9, 
   3.405145840906941*^9}, {3.405164673201535*^9, 3.4051646944989557`*^9}, {
   3.4053351081867948`*^9, 3.405335126874795*^9}, 3.405335273508795*^9, {
   3.4053353738057947`*^9, 3.4053353941967945`*^9}, {3.4053471004340696`*^9, 
   3.405347110918713*^9}, {3.4059348792900624`*^9, 3.405934879305688*^9}, 
   3.4059351230447426`*^9, 3.405935734181476*^9, {3.4059363897409377`*^9, 
   3.4059363910378375`*^9}, {3.4059369368295665`*^9, 3.405936945079725*^9}, 
   3.4064695759273634`*^9, {3.406471227188385*^9, 3.4064712315166206`*^9}, {
   3.406471262861173*^9, 3.406471279002211*^9}, 3.4064715010391455`*^9, {
   3.406557648522812*^9, 3.406557655038604*^9}, {3.4065578846069803`*^9, 
   3.4065578851694946`*^9}, {3.4065584516058702`*^9, 
   3.4065584537309246`*^9}, {3.406562080183134*^9, 3.4065620936522293`*^9}, {
   3.4066119815112286`*^9, 3.406611982401876*^9}, 3.4066122396740875`*^9, 
   3.40695964506664*^9, 3.406959746849844*^9, 3.4069686286609964`*^9, 
   3.4069734854573703`*^9, 3.4084277290397654`*^9, {3.4084296126853056`*^9, 
   3.408429639904578*^9}, {3.408446268036332*^9, 3.4084462715832753`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Integrands", "Subsubtitle",
 CellChangeTimes->{{3.404631476967207*^9, 3.4046314788891187`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SmileSymetrizedBiHestonPaysFloat1DigitalIntegrand", "[", 
   RowBox[{
   "Y_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "a_", ",", "b_", ",", "c_",
     ",", "KList_", ",", "\[Tau]_", ",", "\[CapitalSigma]_", ",", "M_", ",", 
    "Q_", ",", "\[Rho]_", ",", "\[Mu]_", ",", "\[Beta]_", ",", "\[Lambda]1_", 
    ",", "\[Lambda]2_", ",", "\[Omega]1_", ",", "\[Omega]2_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x1", "=", 
       RowBox[{"Y", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", 
      RowBox[{"x2", "=", 
       RowBox[{"Y", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ",", "\[Lambda]1G", ",", 
      "\[Lambda]2G", ",", "\[Lambda]1D", ",", "\[Lambda]2D", ",", "\[Alpha]D",
       ",", "\[Alpha]G", ",", "Sym\[Alpha]D", ",", "Sym\[Alpha]G", ",", 
      "propagatorDroit", ",", "SympropagatorDroit", ",", "propagatorGauche", 
      ",", "SympropagatorGauche", ",", "propagatorDroit2", ",", 
      "SympropagatorDroit2", ",", "propagatorGauche2", ",", 
      "SympropagatorGauche2"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Lambda]1G", "=", 
      RowBox[{"(", 
       RowBox[{"\[Lambda]1", " ", "+", 
        RowBox[{"\[Lambda]2", " ", 
         RowBox[{"a", "/", "b"}]}], "+", "a"}], ")"}]}], ";", 
     RowBox[{"\[Lambda]2G", "=", 
      RowBox[{"(", 
       RowBox[{"-", "\[Lambda]2"}], ")"}]}], ";", 
     RowBox[{"\[Lambda]1D", "=", 
      RowBox[{"(", 
       RowBox[{"-", "\[Lambda]1"}], ")"}]}], ";", 
     RowBox[{"\[Lambda]2D", "=", 
      RowBox[{"(", 
       RowBox[{"\[Lambda]2", " ", "+", 
        RowBox[{"\[Lambda]1", " ", 
         RowBox[{"b", "/", "a"}]}], "+", "a"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Alpha]D", "=", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "x1", " ", 
         RowBox[{"(", 
          RowBox[{"\[Omega]1", "+", 
           RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1D"}]}], ")"}]}], "-", 
        RowBox[{"\[ImaginaryI]", " ", "x2", " ", 
         RowBox[{"(", 
          RowBox[{"\[Omega]2", "+", 
           RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2D"}]}], ")"}]}]}]]}], ";",
      
     RowBox[{"\[Alpha]G", "=", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "x1", " ", 
         RowBox[{"(", 
          RowBox[{"\[Omega]1", "+", 
           RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1G"}]}], ")"}]}], "-", 
        RowBox[{"\[ImaginaryI]", " ", "x2", " ", 
         RowBox[{"(", 
          RowBox[{"\[Omega]2", "+", 
           RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2G"}]}], ")"}]}]}]]}], ";",
      
     RowBox[{"Sym\[Alpha]D", "=", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"\[ImaginaryI]", " ", "x1", " ", 
         RowBox[{"(", 
          RowBox[{"\[Omega]1", "+", 
           RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1D"}]}], ")"}]}], "-", 
        RowBox[{"\[ImaginaryI]", " ", "x2", " ", 
         RowBox[{"(", 
          RowBox[{"\[Omega]2", "+", 
           RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2D"}]}], ")"}]}]}]]}], ";",
      
     RowBox[{"Sym\[Alpha]G", "=", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"\[ImaginaryI]", " ", "x1", " ", 
         RowBox[{"(", 
          RowBox[{"\[Omega]1", "+", 
           RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1G"}]}], ")"}]}], "-", 
        RowBox[{"\[ImaginaryI]", " ", "x2", " ", 
         RowBox[{"(", 
          RowBox[{"\[Omega]2", "+", 
           RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2G"}]}], ")"}]}]}]]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"propagatorDroit", "=", 
      RowBox[{"BiHestonLaplaceQuickTransform", "[", 
       RowBox[{
       "M", ",", "Q", ",", "\[Rho]", ",", " ", "\[Mu]", ",", 
        "\[CapitalSigma]", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], 
           RowBox[{"(", 
            RowBox[{"\[Omega]1", "+", 
             RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1D"}]}], ")"}]}], ",", 
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", 
           RowBox[{"(", 
            RowBox[{"\[Omega]2", "+", 
             RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2D"}]}], ")"}]}]}], 
         "}"}], ",", "\[Beta]", ",", "\[Tau]"}], "]"}]}], ";", 
     RowBox[{"SympropagatorDroit", "=", 
      RowBox[{"BiHestonLaplaceQuickTransform", "[", 
       RowBox[{
       "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", " ", 
        "\[CapitalSigma]", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"(", 
            RowBox[{"\[Omega]1", "+", 
             RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1D"}]}], ")"}]}], ",", 
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], 
           RowBox[{"(", 
            RowBox[{"\[Omega]2", "+", 
             RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2D"}]}], ")"}]}]}], 
         "}"}], ",", "\[Beta]", ",", "\[Tau]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"propagatorGauche", "=", 
      RowBox[{"BiHestonLaplaceQuickTransform", "[", 
       RowBox[{
       "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", " ", 
        "\[CapitalSigma]", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], 
           RowBox[{"(", 
            RowBox[{"\[Omega]1", "+", 
             RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1G"}]}], ")"}]}], ",", 
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", 
           RowBox[{"(", 
            RowBox[{"\[Omega]2", "+", 
             RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2G"}]}], ")"}]}]}], 
         "}"}], ",", "\[Beta]", ",", "\[Tau]"}], "]"}]}], ";", 
     RowBox[{"SympropagatorGauche", "=", 
      RowBox[{"BiHestonLaplaceQuickTransform", "[", 
       RowBox[{
       "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", " ", 
        "\[CapitalSigma]", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[ImaginaryI]", 
           RowBox[{"(", 
            RowBox[{"\[Omega]1", "+", 
             RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1G"}]}], ")"}]}], ",", 
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", 
           RowBox[{"(", 
            RowBox[{"\[Omega]2", "+", 
             RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2G"}]}], ")"}]}]}], 
         "}"}], ",", "\[Beta]", ",", "\[Tau]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Re", "[", 
        RowBox[{
         RowBox[{"\[Alpha]D", " ", "propagatorDroit", " ", 
          RowBox[{"PaysFloat1DigitalPayOffFourierDroite", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"\[Omega]1", "+", 
              RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1D"}]}], ")"}], ",", 
            RowBox[{"(", 
             RowBox[{"\[Omega]2", "+", 
              RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2D"}]}], ")"}], ",", 
            RowBox[{"KList", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "\[Alpha]1", ",", 
            "\[Beta]1", ",", "a", ",", "b", ",", "c"}], "]"}]}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"Sym\[Alpha]D", " ", "SympropagatorDroit", " ", 
          RowBox[{"PaysFloat1DigitalPayOffFourierDroite", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{"\[Omega]1", "+", 
               RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1D"}]}], ")"}]}], ",", 
            
            RowBox[{"(", 
             RowBox[{"\[Omega]2", "+", 
              RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2D"}]}], ")"}], ",", 
            RowBox[{"KList", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "\[Alpha]1", ",", 
            "\[Beta]1", ",", "a", ",", "b", ",", "c"}], "]"}]}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"\[Alpha]G", " ", "propagatorGauche", " ", 
          RowBox[{"PaysFloat1DigitalPayOffFourierGauche", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"\[Omega]1", "+", 
              RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1G"}]}], ")"}], ",", 
            RowBox[{"(", 
             RowBox[{"\[Omega]2", "+", 
              RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2G"}]}], ")"}], ",", 
            RowBox[{"KList", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "\[Alpha]1", ",", 
            "\[Beta]1", ",", "a", ",", "b", ",", "c"}], "]"}]}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"Sym\[Alpha]G", " ", "SympropagatorGauche", " ", 
          RowBox[{"PaysFloat1DigitalPayOffFourierGauche", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{"\[Omega]1", "+", 
               RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1G"}]}], ")"}]}], ",", 
            
            RowBox[{"(", 
             RowBox[{"\[Omega]2", "+", 
              RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2G"}]}], ")"}], ",", 
            RowBox[{"KList", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "\[Alpha]1", ",", 
            "\[Beta]1", ",", "a", ",", "b", ",", "c"}], "]"}]}]}], "]"}], ",",
        
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "KList", "]"}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.402140085770051*^9, 3.4021400863013115`*^9}, {
   3.4021401238489075`*^9, 3.4021402363666925`*^9}, {3.402140267929798*^9, 
   3.402140316290102*^9}, {3.4021403621347322`*^9, 3.4021403798069468`*^9}, {
   3.402140442948784*^9, 3.4021404698243*^9}, {3.40214052530974*^9, 
   3.4021405261847568`*^9}, {3.402140572076263*^9, 3.4021405730294065`*^9}, {
   3.40214283290092*^9, 3.402142834900958*^9}, 3.402142878995555*^9, {
   3.4021429531532288`*^9, 3.40214297455989*^9}, {3.4021430512488623`*^9, 
   3.4021430865307894`*^9}, {3.402143143625636*^9, 3.4021431463288126`*^9}, {
   3.402143222267771*^9, 3.402143365629898*^9}, {3.4021439797510643`*^9, 
   3.4021440141579747`*^9}, {3.4021444783543873`*^9, 
   3.4021445164332433`*^9}, {3.4021445469025784`*^9, 3.402144574918741*^9}, {
   3.4021446846239724`*^9, 3.4021446895459423`*^9}, {3.4021447226559525`*^9, 
   3.402144729593586*^9}, {3.402144860127342*^9, 3.402144926378614*^9}, {
   3.4021449572542067`*^9, 3.402145180727247*^9}, {3.402149153412896*^9, 
   3.4021491595067635`*^9}, {3.4021496964233217`*^9, 3.402149821410097*^9}, {
   3.40214987416111*^9, 3.402149884755063*^9}, {3.4021499394279876`*^9, 
   3.4021499498344374`*^9}, {3.402150065133526*^9, 3.402150121790864*^9}, {
   3.4021501655260787`*^9, 3.4021502014486437`*^9}, {3.402150388827241*^9, 
   3.4021504643911915`*^9}, {3.4021505016731577`*^9, 3.402150539877016*^9}, {
   3.402150576221464*^9, 3.4021506145190744`*^9}, 3.402150646160307*^9, {
   3.4021507013801165`*^9, 3.402150701614496*^9}, {3.402150792022482*^9, 
   3.4021508226011944`*^9}, {3.4022048852154446`*^9, 
   3.4022049314194565`*^9}, {3.402223441649846*^9, 3.4022234739004655`*^9}, {
   3.4022235664178667`*^9, 3.4022235977934694`*^9}, {3.402225770632062*^9, 
   3.4022257810853877`*^9}, {3.4022260066522183`*^9, 
   3.4022260340902452`*^9}, {3.402227989127781*^9, 3.4022280025967894`*^9}, 
   3.4022280710668545`*^9, {3.4022281624279833`*^9, 3.4022281629904943`*^9}, {
   3.4023193135668306`*^9, 3.4023194603141108`*^9}, {3.402319603150462*^9, 
   3.40231966787294*^9}, {3.4023197252970443`*^9, 3.4023197324378977`*^9}, {
   3.4023205583495092`*^9, 3.4023206749454975`*^9}, {3.4023207399779963`*^9, 
   3.4023207413373976`*^9}, {3.4023208249015017`*^9, 
   3.4023209920765867`*^9}, {3.4023211800958214`*^9, 3.40232123755005*^9}, {
   3.4023216909806304`*^9, 3.4023216975588818`*^9}, {3.402321742184738*^9, 
   3.4023217427316236`*^9}, {3.4023247260232773`*^9, 
   3.4023248331659594`*^9}, {3.4023253919266872`*^9, 
   3.4023255075695324`*^9}, {3.40237831846457*^9, 3.4023783246678143`*^9}, {
   3.4041932487247953`*^9, 3.4041932623344316`*^9}, {3.40419333647648*^9, 
   3.4041933710083933`*^9}, {3.4041937125305753`*^9, 3.404193749953169*^9}, {
   3.4043002135695343`*^9, 3.4043002231947346`*^9}, {3.4044649846669784`*^9, 
   3.4044650123383217`*^9}, {3.4044650477751417`*^9, 
   3.4044651238049316`*^9}, {3.404465582921117*^9, 3.4044656190610476`*^9}, {
   3.4044656599352627`*^9, 3.4044656716225386`*^9}, {3.4044670806423597`*^9, 
   3.404467083939172*^9}, {3.4044685611608086`*^9, 3.4044685642701235`*^9}, {
   3.4044686800022764`*^9, 3.4044687901564116`*^9}, {3.4044707796025887`*^9, 
   3.4044707807275667`*^9}, 3.404652171754368*^9, {3.4046522684124737`*^9, 
   3.404652301397482*^9}, 3.4048112137223434`*^9, {3.4048113224921446`*^9, 
   3.4048113889321957`*^9}, 3.404826533466849*^9, {3.404826732521367*^9, 
   3.404826749568897*^9}, 3.4051647325780554`*^9, {3.405165151291899*^9, 
   3.4051652061058025`*^9}, {3.4051653156086054`*^9, 3.405165325483858*^9}, {
   3.405165713493791*^9, 3.405165736338126*^9}, {3.4051706650736732`*^9, 
   3.4051707229657803`*^9}, {3.405170756826022*^9, 3.405170757685419*^9}, {
   3.4051708129680843`*^9, 3.40517084365637*^9}, {3.4051709842849703`*^9, 
   3.4051709871912947`*^9}, {3.4051711665083847`*^9, 
   3.4051711773680377`*^9}, {3.405186211332777*^9, 3.4051863222019773`*^9}, {
   3.405186712950777*^9, 3.4051870170727773`*^9}, {3.4051870853695774`*^9, 
   3.405187263162777*^9}, {3.405187307544777*^9, 3.405187352800377*^9}, {
   3.4051873882279773`*^9, 3.4051874194123774`*^9}, {3.405187886413977*^9, 
   3.405187894947177*^9}, {3.405335139297795*^9, 3.405335159223795*^9}, 
   3.405335277721795*^9, {3.405335357027795*^9, 3.405335364556795*^9}, {
   3.4053365635697947`*^9, 3.4053365635947948`*^9}, 3.4053471142937994`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SmileSymetrizedBiHestonPaysFloat1DigitalIntegrand2", "[", 
   RowBox[{
   "Y_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "a_", ",", "b_", ",", "c_",
     ",", "KList_", ",", "\[Tau]_", ",", "\[CapitalSigma]_", ",", "M_", ",", 
    "Q_", ",", "\[Rho]_", ",", "\[Mu]_", ",", "\[Beta]m_", ",", "\[Lambda]1_",
     ",", "\[Lambda]2_", ",", "\[Omega]1_", ",", "\[Omega]2_"}], "]"}], ":=", 
  
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x1", "=", 
       RowBox[{"Y", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", 
      RowBox[{"x2", "=", 
       RowBox[{"Y", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ",", "\[Lambda]1G", ",", 
      "\[Lambda]2G", ",", "\[Lambda]1D", ",", "\[Lambda]2D", ",", "\[Alpha]D",
       ",", "\[Alpha]G", ",", "Sym\[Alpha]D", ",", "Sym\[Alpha]G", ",", 
      "propagatorDroit", ",", "SympropagatorDroit", ",", "propagatorGauche", 
      ",", "SympropagatorGauche", ",", "propagatorDroit2", ",", 
      "SympropagatorDroit2", ",", "propagatorGauche2", ",", 
      "SympropagatorGauche2"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Lambda]1G", "=", 
      RowBox[{"(", 
       RowBox[{"\[Lambda]1", " ", "+", 
        RowBox[{"\[Lambda]2", " ", 
         RowBox[{"a", "/", "b"}]}], "+", "a"}], ")"}]}], ";", 
     RowBox[{"\[Lambda]2G", "=", 
      RowBox[{"(", 
       RowBox[{"-", "\[Lambda]2"}], ")"}]}], ";", 
     RowBox[{"\[Lambda]1D", "=", 
      RowBox[{"(", 
       RowBox[{"-", "\[Lambda]1"}], ")"}]}], ";", 
     RowBox[{"\[Lambda]2D", "=", 
      RowBox[{"(", 
       RowBox[{"\[Lambda]2", " ", "+", 
        RowBox[{"\[Lambda]1", " ", 
         RowBox[{"b", "/", "a"}]}], "+", "a"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Alpha]D", "=", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "x1", " ", 
         RowBox[{"(", 
          RowBox[{"\[Omega]1", "+", 
           RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1D"}]}], ")"}]}], "-", 
        RowBox[{"\[ImaginaryI]", " ", "x2", " ", 
         RowBox[{"(", 
          RowBox[{"\[Omega]2", "+", 
           RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2D"}]}], ")"}]}]}]]}], ";",
      
     RowBox[{"\[Alpha]G", "=", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "x1", " ", 
         RowBox[{"(", 
          RowBox[{"\[Omega]1", "+", 
           RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1G"}]}], ")"}]}], "-", 
        RowBox[{"\[ImaginaryI]", " ", "x2", " ", 
         RowBox[{"(", 
          RowBox[{"\[Omega]2", "+", 
           RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2G"}]}], ")"}]}]}]]}], ";",
      
     RowBox[{"Sym\[Alpha]D", "=", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"\[ImaginaryI]", " ", "x1", " ", 
         RowBox[{"(", 
          RowBox[{"\[Omega]1", "+", 
           RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1D"}]}], ")"}]}], "-", 
        RowBox[{"\[ImaginaryI]", " ", "x2", " ", 
         RowBox[{"(", 
          RowBox[{"\[Omega]2", "+", 
           RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2D"}]}], ")"}]}]}]]}], ";",
      
     RowBox[{"Sym\[Alpha]G", "=", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"\[ImaginaryI]", " ", "x1", " ", 
         RowBox[{"(", 
          RowBox[{"\[Omega]1", "+", 
           RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1G"}]}], ")"}]}], "-", 
        RowBox[{"\[ImaginaryI]", " ", "x2", " ", 
         RowBox[{"(", 
          RowBox[{"\[Omega]2", "+", 
           RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2G"}]}], ")"}]}]}]]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"propagatorDroit", "=", 
      RowBox[{"BiHestonLaplaceQuickTransform2", "[", 
       RowBox[{
       "M", ",", "Q", ",", "\[Rho]", ",", " ", "\[Mu]", ",", 
        "\[CapitalSigma]", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], 
           RowBox[{"(", 
            RowBox[{"\[Omega]1", "+", 
             RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1D"}]}], ")"}]}], ",", 
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", 
           RowBox[{"(", 
            RowBox[{"\[Omega]2", "+", 
             RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2D"}]}], ")"}]}]}], 
         "}"}], ",", "\[Beta]m", ",", "\[Tau]"}], "]"}]}], ";", 
     RowBox[{"SympropagatorDroit", "=", 
      RowBox[{"BiHestonLaplaceQuickTransform2", "[", 
       RowBox[{
       "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", " ", 
        "\[CapitalSigma]", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"(", 
            RowBox[{"\[Omega]1", "+", 
             RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1D"}]}], ")"}]}], ",", 
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], 
           RowBox[{"(", 
            RowBox[{"\[Omega]2", "+", 
             RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2D"}]}], ")"}]}]}], 
         "}"}], ",", "\[Beta]m", ",", "\[Tau]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"propagatorGauche", "=", 
      RowBox[{"BiHestonLaplaceQuickTransform2", "[", 
       RowBox[{
       "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", " ", 
        "\[CapitalSigma]", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], 
           RowBox[{"(", 
            RowBox[{"\[Omega]1", "+", 
             RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1G"}]}], ")"}]}], ",", 
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", 
           RowBox[{"(", 
            RowBox[{"\[Omega]2", "+", 
             RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2G"}]}], ")"}]}]}], 
         "}"}], ",", "\[Beta]m", ",", "\[Tau]"}], "]"}]}], ";", 
     RowBox[{"SympropagatorGauche", "=", 
      RowBox[{"BiHestonLaplaceQuickTransform2", "[", 
       RowBox[{
       "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", " ", 
        "\[CapitalSigma]", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[ImaginaryI]", 
           RowBox[{"(", 
            RowBox[{"\[Omega]1", "+", 
             RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1G"}]}], ")"}]}], ",", 
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", 
           RowBox[{"(", 
            RowBox[{"\[Omega]2", "+", 
             RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2G"}]}], ")"}]}]}], 
         "}"}], ",", "\[Beta]m", ",", "\[Tau]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Re", "[", 
        RowBox[{
         RowBox[{"\[Alpha]D", " ", "propagatorDroit", " ", 
          RowBox[{"PaysFloat1DigitalPayOffFourierDroite", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"\[Omega]1", "+", 
              RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1D"}]}], ")"}], ",", 
            RowBox[{"(", 
             RowBox[{"\[Omega]2", "+", 
              RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2D"}]}], ")"}], ",", 
            RowBox[{"KList", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "\[Alpha]1", ",", 
            "\[Beta]1", ",", "a", ",", "b", ",", "c"}], "]"}]}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"Sym\[Alpha]D", " ", "SympropagatorDroit", " ", 
          RowBox[{"PaysFloat1DigitalPayOffFourierDroite", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{"\[Omega]1", "+", 
               RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1D"}]}], ")"}]}], ",", 
            
            RowBox[{"(", 
             RowBox[{"\[Omega]2", "+", 
              RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2D"}]}], ")"}], ",", 
            RowBox[{"KList", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "\[Alpha]1", ",", 
            "\[Beta]1", ",", "a", ",", "b", ",", "c"}], "]"}]}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"\[Alpha]G", " ", "propagatorGauche", " ", 
          RowBox[{"PaysFloat1DigitalPayOffFourierGauche", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"\[Omega]1", "+", 
              RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1G"}]}], ")"}], ",", 
            RowBox[{"(", 
             RowBox[{"\[Omega]2", "+", 
              RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2G"}]}], ")"}], ",", 
            RowBox[{"KList", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "\[Alpha]1", ",", 
            "\[Beta]1", ",", "a", ",", "b", ",", "c"}], "]"}]}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"Sym\[Alpha]G", " ", "SympropagatorGauche", " ", 
          RowBox[{"PaysFloat1DigitalPayOffFourierGauche", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{"\[Omega]1", "+", 
               RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1G"}]}], ")"}]}], ",", 
            
            RowBox[{"(", 
             RowBox[{"\[Omega]2", "+", 
              RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2G"}]}], ")"}], ",", 
            RowBox[{"KList", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "\[Alpha]1", ",", 
            "\[Beta]1", ",", "a", ",", "b", ",", "c"}], "]"}]}]}], "]"}], ",",
        
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "KList", "]"}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.402140085770051*^9, 3.4021400863013115`*^9}, {
   3.4021401238489075`*^9, 3.4021402363666925`*^9}, {3.402140267929798*^9, 
   3.402140316290102*^9}, {3.4021403621347322`*^9, 3.4021403798069468`*^9}, {
   3.402140442948784*^9, 3.4021404698243*^9}, {3.40214052530974*^9, 
   3.4021405261847568`*^9}, {3.402140572076263*^9, 3.4021405730294065`*^9}, {
   3.40214283290092*^9, 3.402142834900958*^9}, 3.402142878995555*^9, {
   3.4021429531532288`*^9, 3.40214297455989*^9}, {3.4021430512488623`*^9, 
   3.4021430865307894`*^9}, {3.402143143625636*^9, 3.4021431463288126`*^9}, {
   3.402143222267771*^9, 3.402143365629898*^9}, {3.4021439797510643`*^9, 
   3.4021440141579747`*^9}, {3.4021444783543873`*^9, 
   3.4021445164332433`*^9}, {3.4021445469025784`*^9, 3.402144574918741*^9}, {
   3.4021446846239724`*^9, 3.4021446895459423`*^9}, {3.4021447226559525`*^9, 
   3.402144729593586*^9}, {3.402144860127342*^9, 3.402144926378614*^9}, {
   3.4021449572542067`*^9, 3.402145180727247*^9}, {3.402149153412896*^9, 
   3.4021491595067635`*^9}, {3.4021496964233217`*^9, 3.402149821410097*^9}, {
   3.40214987416111*^9, 3.402149884755063*^9}, {3.4021499394279876`*^9, 
   3.4021499498344374`*^9}, {3.402150065133526*^9, 3.402150121790864*^9}, {
   3.4021501655260787`*^9, 3.4021502014486437`*^9}, {3.402150388827241*^9, 
   3.4021504643911915`*^9}, {3.4021505016731577`*^9, 3.402150539877016*^9}, {
   3.402150576221464*^9, 3.4021506145190744`*^9}, 3.402150646160307*^9, {
   3.4021507013801165`*^9, 3.402150701614496*^9}, {3.402150792022482*^9, 
   3.4021508226011944`*^9}, {3.4022048852154446`*^9, 
   3.4022049314194565`*^9}, {3.402223441649846*^9, 3.4022234739004655`*^9}, {
   3.4022235664178667`*^9, 3.4022235977934694`*^9}, {3.402225770632062*^9, 
   3.4022257810853877`*^9}, {3.4022260066522183`*^9, 
   3.4022260340902452`*^9}, {3.402227989127781*^9, 3.4022280025967894`*^9}, 
   3.4022280710668545`*^9, {3.4022281624279833`*^9, 3.4022281629904943`*^9}, {
   3.4023193135668306`*^9, 3.4023194603141108`*^9}, {3.402319603150462*^9, 
   3.40231966787294*^9}, {3.4023197252970443`*^9, 3.4023197324378977`*^9}, {
   3.4023205583495092`*^9, 3.4023206749454975`*^9}, {3.4023207399779963`*^9, 
   3.4023207413373976`*^9}, {3.4023208249015017`*^9, 
   3.4023209920765867`*^9}, {3.4023211800958214`*^9, 3.40232123755005*^9}, {
   3.4023216909806304`*^9, 3.4023216975588818`*^9}, {3.402321742184738*^9, 
   3.4023217427316236`*^9}, {3.4023247260232773`*^9, 
   3.4023248331659594`*^9}, {3.4023253919266872`*^9, 
   3.4023255075695324`*^9}, {3.40237831846457*^9, 3.4023783246678143`*^9}, {
   3.4041932487247953`*^9, 3.4041932623344316`*^9}, {3.40419333647648*^9, 
   3.4041933710083933`*^9}, {3.4041937125305753`*^9, 3.404193749953169*^9}, {
   3.4043002135695343`*^9, 3.4043002231947346`*^9}, {3.4044649846669784`*^9, 
   3.4044650123383217`*^9}, {3.4044650477751417`*^9, 
   3.4044651238049316`*^9}, {3.404465582921117*^9, 3.4044656190610476`*^9}, {
   3.4044656599352627`*^9, 3.4044656716225386`*^9}, {3.4044670806423597`*^9, 
   3.404467083939172*^9}, {3.4044685611608086`*^9, 3.4044685642701235`*^9}, {
   3.4044686800022764`*^9, 3.4044687901564116`*^9}, {3.4044707796025887`*^9, 
   3.4044707807275667`*^9}, 3.404652171754368*^9, {3.4046522684124737`*^9, 
   3.404652301397482*^9}, 3.4048112137223434`*^9, {3.4048113224921446`*^9, 
   3.4048113889321957`*^9}, 3.404826533466849*^9, {3.404826732521367*^9, 
   3.404826749568897*^9}, 3.4051647325780554`*^9, {3.405165151291899*^9, 
   3.4051652061058025`*^9}, {3.4051653156086054`*^9, 3.405165325483858*^9}, {
   3.405165713493791*^9, 3.405165736338126*^9}, {3.4051706650736732`*^9, 
   3.4051707229657803`*^9}, {3.405170756826022*^9, 3.405170757685419*^9}, {
   3.4051708129680843`*^9, 3.40517084365637*^9}, {3.4051709842849703`*^9, 
   3.4051709871912947`*^9}, {3.4051711665083847`*^9, 
   3.4051711773680377`*^9}, {3.405186211332777*^9, 3.4051863222019773`*^9}, {
   3.405186712950777*^9, 3.4051870170727773`*^9}, {3.4051870853695774`*^9, 
   3.405187263162777*^9}, {3.405187307544777*^9, 3.405187352800377*^9}, {
   3.4051873882279773`*^9, 3.4051874194123774`*^9}, {3.405187649668377*^9, 
   3.405187689105177*^9}, {3.405187871968377*^9, 3.4051878824047775`*^9}, {
   3.4053351648457947`*^9, 3.405335187198795*^9}, 3.405335281506795*^9, {
   3.4053353347367945`*^9, 3.4053353487667947`*^9}, {3.405336563610795*^9, 
   3.405336563664795*^9}, 3.405836206634343*^9, 3.405836244181939*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["Fourier Transform of the payoff", "Subsubtitle",
 CellChangeTimes->{{3.4047174737434516`*^9, 3.404717491805258*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PaysFloat1DigitalPayOffFourierDroite", "[", 
   RowBox[{
   "k1_", ",", "k2_", ",", "K_", ",", "\[Alpha]_", ",", "\[Beta]_", ",", "a_",
     ",", "b_", ",", "c_"}], "]"}], ":=", 
  RowBox[{"-", 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", 
     SuperscriptBox["K", 
      FractionBox[
       RowBox[{"c", "+", 
        RowBox[{"\[ImaginaryI]", " ", "k1"}]}], "a"]], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox["1", "\[Alpha]"], ")"}], 
      FractionBox[
       RowBox[{"c", "+", 
        RowBox[{"\[ImaginaryI]", " ", "k1"}]}], "a"]], " ", 
     RowBox[{"Hypergeometric2F1", "[", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"c", "+", 
          RowBox[{"\[ImaginaryI]", " ", "k1"}]}], "a"]}], ",", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"], ",", 
       RowBox[{"1", "+", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ",", 
       RowBox[{"-", 
        FractionBox["\[Beta]", "K"]}]}], "]"}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"c", "+", 
       RowBox[{"\[ImaginaryI]", " ", "k1"}]}], ")"}], " ", 
     "k2"}]]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4048102845616646`*^9, 3.404810294702679*^9}, {
   3.4048103293758855`*^9, 3.404810338454359*^9}, {3.404810451536826*^9, 
   3.404810619137012*^9}, {3.40481068953034*^9, 3.404810710187383*^9}, 
   3.4051647566724224`*^9, 3.4051649030980453`*^9, {3.4051679186127405`*^9, 
   3.4051679208471727`*^9}, 3.405170554305213*^9, 3.4053351958737946`*^9, {
   3.4053352880787945`*^9, 3.4053352927417946`*^9}, 3.4053355759587946`*^9, {
   3.4053356357667947`*^9, 3.4053356444657946`*^9}, 3.405335693690795*^9, {
   3.405335859763795*^9, 3.405335860336795*^9}, 3.405336563549795*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"si", " ", 
   RowBox[{"Re", "[", "c", "]"}]}], "<", 
  RowBox[{
   RowBox[{"Im", "[", "k1", "]"}], "   ", "et", " ", 
   RowBox[{"Im", "[", "k2", "]"}]}], ">", "0"}]], "Input",
 CellChangeTimes->{{3.4053358516447945`*^9, 3.4053358526967945`*^9}, {
  3.405336037966795*^9, 3.4053360487597947`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PaysFloat1DigitalPayOffFourierGauche", "[", 
   RowBox[{
   "k1_", ",", "k2_", ",", "K_", ",", "\[Alpha]_", ",", "\[Beta]_", ",", "a_",
     ",", "b_", ",", "c_"}], "]"}], ":=", "  ", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    SuperscriptBox["K", 
     FractionBox[
      RowBox[{"c", "+", 
       RowBox[{"\[ImaginaryI]", " ", "k1"}]}], "a"]], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox["1", "\[Alpha]"], ")"}], 
     FractionBox[
      RowBox[{"c", "+", 
       RowBox[{"\[ImaginaryI]", " ", "k1"}]}], "a"]], " ", 
    RowBox[{"Hypergeometric2F1", "[", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"c", "+", 
         RowBox[{"\[ImaginaryI]", " ", "k1"}]}], "a"]}], ",", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"], ",", 
      RowBox[{"1", "+", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ",", 
      RowBox[{"-", 
       FractionBox["\[Beta]", "K"]}]}], "]"}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"c", "+", 
      RowBox[{"\[ImaginaryI]", " ", "k1"}]}], ")"}], " ", "k2"}]]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.404809293461108*^9, 3.4048092956643176`*^9}, 
   3.4048093674014473`*^9, {3.4048094552954473`*^9, 3.404809463092622*^9}, {
   3.4048095314233704`*^9, 3.4048095442363625`*^9}, {3.404809605191828*^9, 
   3.4048096283333416`*^9}, {3.404809817199969*^9, 3.4048098448885317`*^9}, {
   3.4048099035782857`*^9, 3.4048099656900454`*^9}, {3.4048100079572935`*^9, 
   3.4048100840852165`*^9}, 3.405164762141312*^9, 3.4051648317993455`*^9, 
   3.4051652997488246`*^9, {3.4051678858306513`*^9, 3.4051678890807347`*^9}, 
   3.4051705136947985`*^9, 3.4053352020757947`*^9, {3.4053352966947947`*^9, 
   3.4053352999607944`*^9}, 3.405335578221795*^9, 3.4053356412227945`*^9, {
   3.405335863308795*^9, 3.405335863967795*^9}, 3.4053365635557947`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"si", " ", 
   RowBox[{"Re", "[", "c", "]"}]}], "<", 
  RowBox[{
   RowBox[{"Im", "[", "k1", "]"}], "  ", "et", " ", 
   RowBox[{"Im", "[", "k2", "]"}]}], "<", "0"}]], "Input",
 CellChangeTimes->{{3.4053358480027947`*^9, 3.405335849103795*^9}, {
  3.405336055830795*^9, 3.405336059879795*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{"/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Alpha]", "\[Rule]", "1"}], ",", 
     RowBox[{"\[Beta]", "\[Rule]", "1"}], ",", 
     RowBox[{"a", "\[Rule]", "1"}], ",", 
     RowBox[{"b", "\[Rule]", "1"}]}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.40516580837122*^9, 3.4051658284342337`*^9}, 
   3.4051679772704926`*^9, 3.405170518288666*^9, 3.405335583356795*^9}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   SuperscriptBox["K", 
    RowBox[{"1", "+", 
     RowBox[{"\[ImaginaryI]", " ", "k1"}], "+", 
     RowBox[{"\[ImaginaryI]", " ", "k2"}]}]], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"\[ImaginaryI]", " ", "k1"}], "+", 
      RowBox[{"\[ImaginaryI]", " ", "k2"}]}], ")"}], " ", "k2", " ", 
    RowBox[{"(", 
     RowBox[{"k1", "+", "k2"}], ")"}]}]]}]], "Output",
 CellChangeTimes->{3.4051658301374025`*^9, 3.4051679803174458`*^9, 
  3.40517052119499*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.405334824658795*^9, 3.4053348257487946`*^9}}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Digitale paying Float 2 ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       SubscriptBox["S", "2"], "c"], 
      SubscriptBox["1", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Alpha]", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"a", " ", "x1"}]]}], "-", 
         RowBox[{"\[Beta]", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"b", " ", "x2"}]]}], "-", "K"}], ">", "0"}]]}], ")"}], 
    "+"], TraditionalForm]]]
}], "Subtitle",
 CellChangeTimes->{{3.4026388686724606`*^9, 3.4026388811727004`*^9}, {
   3.404630792762659*^9, 3.404630809558997*^9}, {3.4048121803219595`*^9, 
   3.4048121923849225`*^9}, 3.4051644862592497`*^9, 3.4053348989257946`*^9, {
   3.4053468048015013`*^9, 3.4053468052702637`*^9}, {3.40593978680616*^9, 
   3.4059397924000177`*^9}}],

Cell["Handling", "Text",
 CellChangeTimes->{{3.4059584675710735`*^9, 3.405958469274232*^9}}],

Cell[CellGroupData[{

Cell["High Level interface", "Subsubtitle",
 CellChangeTimes->{{3.404642425693043*^9, 3.404642434083829*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SmileBiHestonPaysFloat2Digital", "[", 
   RowBox[{
   "S_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "a_", ",", "b_", ",", "c_",
     ",", "KList1_", ",", "\[Tau]_", ",", "\[CapitalSigma]_", ",", "M_", ",", 
    "\[CapitalSigma]inf_", ",", "\[Beta]_", ",", "\[Rho]_", ",", "\[Mu]_", 
    ",", "printflag_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "KList", ",", "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", 
      ",", "period1n", ",", "\[Epsilon]1", ",", "LegendreCoef2", ",", 
      "period2", ",", "period2n", ",", "\[Epsilon]2", ",", "imax", ",", 
      "\[Lambda]1", ",", "\[Lambda]2", ",", "Q", ",", "KListPositive", ",", 
      "KListNegative", ",", 
      RowBox[{"KPositivePrices", "=", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"KNegativePrices", "=", 
       RowBox[{"{", "}"}]}], ",", "prices", ",", "startmonitortime", ",", 
      "plafondexplosion", ",", "initialTailFlag", ",", "InitialTailPosition", 
      ",", "InitialTailPosition2", ",", "kmax", ",", "StartControl", ",", 
      "IncrementFactor"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "KList1", "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{"KList", "=", 
        RowBox[{"{", "KList1", "}"}]}], ",", 
       RowBox[{"KList", "=", "KList1"}]}], "]"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"Q", "=", 
      RowBox[{
       RowBox[{"CholeskyDecomposition", "[", 
        RowBox[{"-", 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"M", ".", "\[CapitalSigma]inf"}], "+", 
            RowBox[{"\[CapitalSigma]inf", ".", " ", 
             RowBox[{"Transpose", "[", "M", "]"}]}]}], "2"], ")"}]}], "]"}], 
       "/", "\[Beta]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", ",", 
          "period1n", ",", "\[Epsilon]1", ",", "startmonitortime", ",", 
          "plafondexplosion", ",", "initialTailFlag", ",", 
          "InitialTailPosition", ",", "InitialTailPosition2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "LegendreCoef2", ",", "period2", ",", "period2n", ",", "\[Epsilon]2",
           ",", "kmax", ",", "StartControl", ",", "IncrementFactor"}], "}"}], 
        ",", "imax", ",", "\[Lambda]1", ",", "\[Lambda]2"}], "}"}], "=", 
      RowBox[{"BiHestonVanillaOptimalParameters", "[", 
       RowBox[{
       "S", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", "b", ",", "c", 
        ",", 
        RowBox[{"KList", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "\[Tau]", ",", 
        "\[CapitalSigma]", ",", "M", ",", "\[CapitalSigma]inf", ",", "Q", ",",
         "\[Rho]", ",", "\[Mu]", ",", "\"\<MaxOption\>\"", ",", "printflag"}],
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"prices", "=", 
      RowBox[{"SmileBiHestonPaysFloat2Digital", "[", 
       RowBox[{
       "S", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", "b", ",", "c", 
        ",", "KList1", ",", "\[Tau]", ",", "\[CapitalSigma]", ",", "M", ",", 
        "\[CapitalSigma]inf", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", 
        "\[Beta]", ",", "\[Lambda]1", ",", "\[Lambda]2", ",", 
        RowBox[{"{", 
         RowBox[{
         "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", ",", 
          "period1n", ",", "\[Epsilon]1", ",", "imax", ",", 
          "startmonitortime", ",", "plafondexplosion", ",", "initialTailFlag",
           ",", "InitialTailPosition", ",", "InitialTailPosition2"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{
         "LegendreCoef2", ",", "period2", ",", "period2n", ",", "\[Epsilon]2",
           ",", "kmax", ",", "StartControl", ",", "IncrementFactor"}], "}"}], 
        ",", "printflag"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Min", "[", 
        RowBox[{
         RowBox[{"S", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{"Max", "[", 
          RowBox[{"0", ",", 
           RowBox[{"prices", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "KList1", "]"}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4042074577632284`*^9, 3.4042074770760994`*^9}, {
   3.4042075328115444`*^9, 3.4042077538626633`*^9}, {3.404207970241818*^9, 
   3.404207993351637*^9}, {3.4042080286491895`*^9, 3.404208043665103*^9}, {
   3.4042173037335176`*^9, 3.4042173873444977`*^9}, {3.4042175109093704`*^9, 
   3.404217554472707*^9}, {3.4042999349691343`*^9, 3.4042999555923347`*^9}, {
   3.404381253215744*^9, 3.404381270172944*^9}, {3.4044634862113743`*^9, 
   3.4044635745846777`*^9}, {3.404463622474383*^9, 3.4044637577842846`*^9}, {
   3.4044637895649247`*^9, 3.4044638511887417`*^9}, {3.404463881485035*^9, 
   3.404463962092862*^9}, {3.4044646348143206`*^9, 3.4044646352830615`*^9}, {
   3.4044659090554795`*^9, 3.4044659091648526`*^9}, {3.404466252111393*^9, 
   3.4044662673767247`*^9}, {3.4044662976417685`*^9, 
   3.4044662980323863`*^9}, {3.4044673732461166`*^9, 
   3.4044673808397207`*^9}, {3.4046519546877003`*^9, 
   3.4046519750474663`*^9}, {3.4046528875181103`*^9, 3.404652993051387*^9}, 
   3.404811180721076*^9, {3.404811251817556*^9, 3.404811256317729*^9}, 
   3.404826602406996*^9, {3.4048266367520647`*^9, 3.4048266473149705`*^9}, {
   3.404838584300705*^9, 3.404838585847639*^9}, 3.405092320454278*^9, {
   3.405164497212655*^9, 3.405164499806472*^9}, {3.4051649727560787`*^9, 
   3.405165018538501*^9}, {3.4051841739727774`*^9, 3.405184192723977*^9}, {
   3.405334927245795*^9, 3.4053349669257946`*^9}, 3.4053352651807947`*^9, {
   3.405335552143795*^9, 3.4053355628907948`*^9}, {3.405347138888179*^9, 
   3.40534714282578*^9}, {3.405666136490624*^9, 3.4056661623973713`*^9}, {
   3.4064720432249002`*^9, 3.406472053225156*^9}, {3.40655765960122*^9, 
   3.4065576634294434`*^9}, {3.406613290325983*^9, 3.4066133002949886`*^9}, {
   3.4069600517463226`*^9, 3.406960061871517*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TestBiHestonPaysFloat2Digital", "[", 
   RowBox[{
   "S_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "a_", ",", "b_", ",", "c_",
     ",", "K_", ",", "\[Tau]_", ",", "\[CapitalSigma]_", ",", "M_", ",", 
    "\[CapitalSigma]inf_", ",", "\[Beta]_", ",", "\[Rho]_", ",", "\[Mu]_", 
    ",", "\[Lambda]1_", ",", "\[Lambda]2_", ",", "scope_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "KList", ",", "period2", ",", "Q", ",", "as", ",", "res", ",", "res2", 
      ",", 
      RowBox[{"Y", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Log", "[", 
          RowBox[{"S", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
         RowBox[{"Log", "[", 
          RowBox[{"S", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}], ",", 
      RowBox[{"\[Omega]1", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Q", "=", 
      RowBox[{
       RowBox[{"CholeskyDecomposition", "[", 
        RowBox[{"-", 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"M", ".", "\[CapitalSigma]inf"}], "+", 
            RowBox[{"\[CapitalSigma]inf", ".", " ", 
             RowBox[{"Transpose", "[", "M", "]"}]}]}], "2"], ")"}]}], "]"}], 
       "/", "\[Beta]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"period2", "=", 
      FractionBox["scope", 
       SqrtBox[
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{"\[CapitalSigma]", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], "+", 
           RowBox[{"\[CapitalSigma]", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "2"}], "]"}], "]"}], "+", 
           RowBox[{"\[CapitalSigma]inf", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], "+", 
           RowBox[{"\[CapitalSigma]inf", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "4"], "\[Tau]"}]]]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"SmileSymetrizedBiHestonPaysFloat2DigitalIntegrand", "[", 
         RowBox[{
         "Y", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", "b", ",", "c",
           ",", 
          RowBox[{"{", "K", "}"}], ",", "\[Tau]", ",", "\[CapitalSigma]", ",",
           "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", "\[Beta]", ",", 
          "\[Lambda]1", ",", "\[Lambda]2", ",", "\[Omega]1", ",", 
          "\[Omega]2"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Omega]2", ",", "0", " ", ",", 
         RowBox[{"2", "period2"}]}], "}"}], ",", 
       RowBox[{"PlotPoints", "\[Rule]", "50"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", 
        RowBox[{"\"\<Integrand spreadoption : K =\>\"", "<>", 
         RowBox[{"ToString", "[", "K", "]"}], "<>", "\"\< \[Omega]1=\>\"", "<>",
          
         RowBox[{"ToString", "[", "\[Omega]1", "]"}]}]}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4042074577632284`*^9, 3.4042074770760994`*^9}, {
   3.4042075328115444`*^9, 3.4042077538626633`*^9}, {3.404207970241818*^9, 
   3.404207993351637*^9}, {3.4042080286491895`*^9, 3.404208043665103*^9}, {
   3.4042173037335176`*^9, 3.4042173873444977`*^9}, {3.4042175109093704`*^9, 
   3.404217554472707*^9}, {3.4042999349691343`*^9, 3.4042999555923347`*^9}, {
   3.404381253215744*^9, 3.404381270172944*^9}, {3.4044634862113743`*^9, 
   3.4044635745846777`*^9}, {3.404463622474383*^9, 3.4044637577842846`*^9}, {
   3.4044637895649247`*^9, 3.4044638511887417`*^9}, {3.404463881485035*^9, 
   3.404463962092862*^9}, {3.4044646348143206`*^9, 3.4044646352830615`*^9}, {
   3.4044659090554795`*^9, 3.4044659091648526`*^9}, {3.404466252111393*^9, 
   3.4044662673767247`*^9}, {3.4044662976417685`*^9, 
   3.4044662980323863`*^9}, {3.4044673732461166`*^9, 
   3.4044673808397207`*^9}, {3.4046519546877003`*^9, 
   3.4046519750474663`*^9}, {3.4046528875181103`*^9, 3.404652993051387*^9}, 
   3.404811180721076*^9, {3.404811251817556*^9, 3.404811256317729*^9}, 
   3.404826602406996*^9, {3.4048266367520647`*^9, 3.4048266473149705`*^9}, {
   3.404838584300705*^9, 3.404838585847639*^9}, {3.404888355750947*^9, 
   3.4048883751261473`*^9}, {3.404888409087347*^9, 3.4048884100857472`*^9}, 
   3.404888482298147*^9, {3.404888523107747*^9, 3.404888593260947*^9}, {
   3.4048886239773474`*^9, 3.404888647377347*^9}, {3.4048888242189474`*^9, 
   3.4048888357941475`*^9}, {3.4048891031157475`*^9, 3.404889148121747*^9}, {
   3.404889229444547*^9, 3.404889260831747*^9}, {3.404889328176947*^9, 
   3.404889408579347*^9}, {3.4048896364485474`*^9, 3.4048896370257473`*^9}, {
   3.4048906491191473`*^9, 3.404890657433947*^9}, 3.4048906939379473`*^9, {
   3.4048908372083473`*^9, 3.404890839158347*^9}, {3.4048912343375473`*^9, 
   3.4048912741487474`*^9}, {3.4051645422294326`*^9, 3.4051645498858786`*^9}, 
   3.4053349711497946`*^9, 3.405335260905795*^9, {3.405335546967795*^9, 
   3.4053355475527945`*^9}, {3.4053471456696024`*^9, 3.4053471640138226`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SmileBiHestonPaysFloat2Digital2", "[", 
   RowBox[{
   "S_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "a_", ",", "b_", ",", "c_",
     ",", "KList1_", ",", "\[Tau]_", ",", "\[CapitalSigma]_", ",", "M_", ",", 
    "\[CapitalSigma]inf_", ",", "Q_", ",", "\[Rho]_", ",", "\[Mu]_", ",", 
    "printflag_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "KList", ",", "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", 
      ",", "period1n", ",", "\[Epsilon]1", ",", "LegendreCoef2", ",", 
      "period2", ",", "period2n", ",", "\[Epsilon]2", ",", "imax", ",", 
      "\[Lambda]1", ",", "\[Lambda]2", ",", "KListPositive", ",", 
      "KListNegative", ",", 
      RowBox[{"KPositivePrices", "=", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"KNegativePrices", "=", 
       RowBox[{"{", "}"}]}], ",", "\[Beta]m", ",", "prices", ",", 
      "startmonitortime", ",", "plafondexplosion", ",", "initialTailFlag", 
      ",", "InitialTailPosition", ",", "InitialTailPosition2", ",", "kmax", 
      ",", "StartControl", ",", "IncrementFactor"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "KList1", "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{"KList", "=", 
        RowBox[{"{", "KList1", "}"}]}], ",", 
       RowBox[{"KList", "=", "KList1"}]}], "]"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"\[Beta]m", "=", 
      RowBox[{"-", 
       RowBox[{
        RowBox[{"(", 
         FractionBox[
          RowBox[{
           RowBox[{"M", ".", "\[CapitalSigma]inf"}], "+", 
           RowBox[{"\[CapitalSigma]inf", ".", 
            RowBox[{"Transpose", "[", "M", "]"}]}]}], "2"], ")"}], ".", 
        RowBox[{"Inverse", "[", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Transpose", "[", "Q", "]"}], ".", "Q"}], ")"}], 
         "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", ",", 
          "period1n", ",", "\[Epsilon]1", ",", "startmonitortime", ",", 
          "plafondexplosion", ",", "initialTailFlag", ",", 
          "InitialTailPosition", ",", "InitialTailPosition2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "LegendreCoef2", ",", "period2", ",", "period2n", ",", "\[Epsilon]2",
           ",", "kmax", ",", "StartControl", ",", "IncrementFactor"}], "}"}], 
        ",", "imax", ",", "\[Lambda]1", ",", "\[Lambda]2"}], "}"}], "=", 
      RowBox[{"BiHestonVanillaOptimalParameters", "[", 
       RowBox[{
       "S", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", "b", ",", "c", 
        ",", 
        RowBox[{"KList", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "\[Tau]", ",", 
        "\[CapitalSigma]", ",", "M", ",", "\[CapitalSigma]inf", ",", "Q", ",",
         "\[Rho]", ",", "\[Mu]", ",", "\"\<MaxOption\>\"", ",", "printflag"}],
        "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"prices", "=", 
      RowBox[{"SmileBiHestonPaysFloat2DigitalAux", "[", 
       RowBox[{
       "S", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", "b", ",", "c", 
        ",", "KList1", ",", "\[Tau]", ",", "\[CapitalSigma]", ",", "M", ",", 
        "\[CapitalSigma]inf", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", 
        "\[Beta]m", ",", "\[Lambda]1", ",", "\[Lambda]2", ",", 
        RowBox[{"{", 
         RowBox[{
         "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", ",", 
          "period1n", ",", "\[Epsilon]1", ",", "imax", ",", 
          "startmonitortime", ",", "plafondexplosion", ",", "initialTailFlag",
           ",", "InitialTailPosition", ",", "InitialTailPosition2"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{
         "LegendreCoef2", ",", "period2", ",", "period2n", ",", "\[Epsilon]2",
           ",", "kmax", ",", "StartControl", ",", "IncrementFactor"}], "}"}], 
        ",", "printflag"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Min", "[", 
        RowBox[{
         RowBox[{"S", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{"Max", "[", 
          RowBox[{"0", ",", 
           RowBox[{"prices", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "KList1", "]"}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4042074577632284`*^9, 3.4042074770760994`*^9}, {
   3.4042075328115444`*^9, 3.4042077538626633`*^9}, {3.404207970241818*^9, 
   3.404207993351637*^9}, {3.4042080286491895`*^9, 3.404208043665103*^9}, {
   3.4042173037335176`*^9, 3.4042173873444977`*^9}, {3.4042175109093704`*^9, 
   3.404217554472707*^9}, {3.4042999349691343`*^9, 3.4042999555923347`*^9}, {
   3.404381253215744*^9, 3.404381270172944*^9}, {3.4044634862113743`*^9, 
   3.4044635745846777`*^9}, {3.404463622474383*^9, 3.4044637577842846`*^9}, {
   3.4044637895649247`*^9, 3.4044638511887417`*^9}, {3.404463881485035*^9, 
   3.404463962092862*^9}, {3.4044640040764313`*^9, 3.4044640086857176`*^9}, 
   3.404464521300875*^9, {3.4044646057055044`*^9, 3.4044646242676477`*^9}, {
   3.404466242564701*^9, 3.404466243330312*^9}, {3.404466359484331*^9, 
   3.404466395764885*^9}, 3.404651957359627*^9, {3.404651989141487*^9, 
   3.4046519954384828`*^9}, {3.404653007770419*^9, 3.404653025192629*^9}, {
   3.404662589800545*^9, 3.404662590237345*^9}, {3.404718208726282*^9, 
   3.4047182136173773`*^9}, 3.4048111841899595`*^9, {3.4048112616773095`*^9, 
   3.4048112656774635`*^9}, 3.4048265968755336`*^9, {3.4048266642843723`*^9, 
   3.404826666581335*^9}, {3.404838607801607*^9, 3.4048386098641863`*^9}, 
   3.4050923021413093`*^9, {3.4051645547297525`*^9, 3.4051645690113683`*^9}, {
   3.4051650300231695`*^9, 3.405165068383527*^9}, 3.4051842118807774`*^9, {
   3.405335034395795*^9, 3.405335042957795*^9}, 3.4053352589067945`*^9, {
   3.405335535829795*^9, 3.4053355405097947`*^9}, {3.405347222249688*^9, 
   3.405347227062311*^9}, {3.405666171350668*^9, 3.405666231476823*^9}, {
   3.406472064600447*^9, 3.406472070272467*^9}, {3.4065576739765882`*^9, 
   3.406557678757961*^9}, {3.406558619250787*^9, 3.4065586200945587`*^9}, {
   3.4066133153422484`*^9, 3.406613324217476*^9}, {3.4069600198082094`*^9, 
   3.4069600403398542`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SmileBiHestonPaysFloat2Digital3", "[", 
   RowBox[{
   "S_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "a_", ",", "b_", ",", "c_",
     ",", "KList1_", ",", "\[Tau]_", ",", "\[CapitalSigma]_", ",", "M_", ",", 
    "Q_", ",", "\[Beta]_", ",", "\[Rho]_", ",", "\[Mu]_", ",", "printflag_"}],
    "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "KList", ",", "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", 
      ",", "period1n", ",", "\[Epsilon]1", ",", "LegendreCoef2", ",", 
      "period2", ",", "period2n", ",", "\[Epsilon]2", ",", "imax", ",", 
      "\[Lambda]1", ",", "\[Lambda]2", ",", "\[CapitalSigma]inf", ",", 
      "KListPositive", ",", "KListNegative", ",", 
      RowBox[{"KPositivePrices", "=", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"KNegativePrices", "=", 
       RowBox[{"{", "}"}]}], ",", "prices", ",", "startmonitortime", ",", 
      "plafondexplosion", ",", "initialTailFlag", ",", "InitialTailPosition", 
      ",", "InitialTailPosition2", ",", "kmax", ",", "StartControl", ",", 
      "IncrementFactor"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "KList1", "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{"KList", "=", 
        RowBox[{"{", "KList1", "}"}]}], ",", 
       RowBox[{"KList", "=", "KList1"}]}], "]"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"\[CapitalSigma]inf", "=", 
      RowBox[{"\[CapitalSigma]inf", "=", 
       RowBox[{"SolveSymetricEquation", "[", 
        RowBox[{"M", ",", 
         RowBox[{
          RowBox[{"-", "2"}], 
          SuperscriptBox["\[Beta]", "2"], " ", 
          RowBox[{
           RowBox[{"Transpose", "[", "Q", "]"}], ".", "Q"}]}]}], "]"}]}]}], 
     " ", ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", ",", 
          "period1n", ",", "\[Epsilon]1", ",", "startmonitortime", ",", 
          "plafondexplosion", ",", "initialTailFlag", ",", 
          "InitialTailPosition", ",", "InitialTailPosition2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "LegendreCoef2", ",", "period2", ",", "period2n", ",", "\[Epsilon]2",
           ",", "kmax", ",", "StartControl", ",", "IncrementFactor"}], "}"}], 
        ",", "imax", ",", "\[Lambda]1", ",", "\[Lambda]2"}], "}"}], "=", 
      RowBox[{"BiHestonVanillaOptimalParameters", "[", 
       RowBox[{
       "S", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", "b", ",", "c", 
        ",", 
        RowBox[{"KList", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "\[Tau]", ",", 
        "\[CapitalSigma]", ",", "M", ",", "\[CapitalSigma]inf", ",", "Q", ",",
         "\[Rho]", ",", "\[Mu]", ",", "\"\<MaxOption\>\"", ",", "printflag"}],
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"prices", "=", 
      RowBox[{"SmileBiHestonPaysFloat2Digital", "[", 
       RowBox[{
       "S", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", "b", ",", "c", 
        ",", "KList1", ",", "\[Tau]", ",", "\[CapitalSigma]", ",", "M", ",", 
        "\[CapitalSigma]inf", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", 
        "\[Beta]", ",", "\[Lambda]1", ",", "\[Lambda]2", ",", 
        RowBox[{"{", 
         RowBox[{
         "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", ",", 
          "period1n", ",", "\[Epsilon]1", ",", "imax", ",", 
          "startmonitortime", ",", "plafondexplosion", ",", "initialTailFlag",
           ",", "InitialTailPosition", ",", "InitialTailPosition2"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{
         "LegendreCoef2", ",", "period2", ",", "period2n", ",", "\[Epsilon]2",
           ",", "kmax", ",", "StartControl", ",", "IncrementFactor"}], "}"}], 
        ",", "printflag"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Min", "[", 
        RowBox[{
         RowBox[{"S", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{"Max", "[", 
          RowBox[{"0", ",", 
           RowBox[{"prices", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "KList1", "]"}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4042074577632284`*^9, 3.4042074770760994`*^9}, {
   3.4042075328115444`*^9, 3.4042077538626633`*^9}, {3.404207970241818*^9, 
   3.404207993351637*^9}, {3.4042080286491895`*^9, 3.404208043665103*^9}, {
   3.4042173037335176`*^9, 3.4042173873444977`*^9}, {3.4042175109093704`*^9, 
   3.404217554472707*^9}, {3.4042999349691343`*^9, 3.4042999555923347`*^9}, {
   3.404381253215744*^9, 3.404381270172944*^9}, {3.4044634862113743`*^9, 
   3.4044635745846777`*^9}, {3.404463622474383*^9, 3.4044637577842846`*^9}, {
   3.4044637895649247`*^9, 3.4044638511887417`*^9}, {3.404463881485035*^9, 
   3.404463962092862*^9}, {3.4044646348143206`*^9, 3.4044646352830615`*^9}, {
   3.4044659090554795`*^9, 3.4044659091648526`*^9}, {3.404466252111393*^9, 
   3.4044662673767247`*^9}, {3.4044662976417685`*^9, 
   3.4044662980323863`*^9}, {3.4044673732461166`*^9, 
   3.4044673808397207`*^9}, {3.4046519546877003`*^9, 
   3.4046519750474663`*^9}, {3.4046528875181103`*^9, 3.404652993051387*^9}, 
   3.404811180721076*^9, {3.404811251817556*^9, 3.404811256317729*^9}, 
   3.404826602406996*^9, {3.4048266367520647`*^9, 3.4048266473149705`*^9}, {
   3.404838584300705*^9, 3.404838585847639*^9}, 3.405092320454278*^9, {
   3.405164497212655*^9, 3.405164499806472*^9}, {3.4051649727560787`*^9, 
   3.405165018538501*^9}, {3.4051841739727774`*^9, 3.405184192723977*^9}, {
   3.405334927245795*^9, 3.4053349669257946`*^9}, 3.4053352651807947`*^9, {
   3.405335552143795*^9, 3.4053355628907948`*^9}, {3.405347138888179*^9, 
   3.40534714282578*^9}, {3.405666136490624*^9, 3.4056661623973713`*^9}, {
   3.4064720432249002`*^9, 3.406472053225156*^9}, {3.40655765960122*^9, 
   3.4065576634294434`*^9}, {3.406613290325983*^9, 3.4066133002949886`*^9}, {
   3.4069600517463226`*^9, 3.406960061871517*^9}, {3.4070581172851925`*^9, 
   3.4070581579422235`*^9}, 3.4075834036554008`*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["Integration Bi Dimensional", "Subsubtitle",
 CellChangeTimes->{{3.404641430673939*^9, 3.4046414450023394`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SmileBiHestonPaysFloat2DigitalAux", "[", 
   RowBox[{
   "S_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "a_", ",", "b_", ",", "c_",
     ",", "KList_", ",", "\[Tau]_", ",", "\[CapitalSigma]_", ",", "M_", ",", 
    "\[CapitalSigma]inf_", ",", "Q_", ",", "\[Rho]_", ",", "\[Mu]_", ",", 
    "\[Beta]_", ",", "\[Lambda]1_", ",", "\[Lambda]2_", ",", 
    RowBox[{"{", 
     RowBox[{
     "LegendreCoef1_", ",", "LegendreCoef1n_", ",", "period1_", ",", 
      "period1n_", ",", "\[Epsilon]1_", ",", "imax_", ",", 
      "startmonitortime_", ",", "plafondexplosion_", ",", "initialTailFlag_", 
      ",", "InitialTailPosition_", ",", "InitialTailPosition2_"}], "}"}], ",",
     
    RowBox[{"{", 
     RowBox[{
     "LegendreCoef2_", ",", "period2_", ",", "period2n_", ",", "\[Epsilon]2_",
       ",", "kmax_", ",", "StartControl_", ",", "IncrementFactor_"}], "}"}], 
    ",", "printflag_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{
   FractionBox["2", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"2", "\[Pi]"}], ")"}], "2"]], 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"as", ",", "res", ",", "res2", ",", 
       RowBox[{"Y", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Log", "[", 
           RowBox[{"S", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
          RowBox[{"Log", "[", 
           RowBox[{"S", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "1"}], " ", "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "1"}], "]"}]}], "  ", ",", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\< S=\>\"", ",", 
           RowBox[{"S", " ", "//", " ", "MatrixForm"}], ",", 
           "\"\< \[CapitalSigma]=\>\"", ",", 
           RowBox[{"\[CapitalSigma]", " ", "//", "MatrixForm"}], ",", 
           "\"\<M=\>\"", ",", 
           RowBox[{"M", "//", "MatrixForm"}], ",", 
           "\"\< \[CapitalSigma]inf=\>\"", ",", 
           RowBox[{"\[CapitalSigma]inf", "//", "MatrixForm"}], " ", ",", 
           "\"\< Q=\>\"", ",", 
           RowBox[{"Q", "//", "MatrixForm"}], " ", ",", "\"\< \[Rho]=\>\"", 
           ",", 
           RowBox[{"\[Rho]", "//", "MatrixForm"}], ",", "\"\< \[Mu]=\>\"", 
           ",", 
           RowBox[{"\[Mu]", "//", "MatrixForm"}], ",", "\"\< \[Beta]=\>\"", 
           ",", "\[Beta]", ",", "\"\< T=\>\"", ",", "\[Tau]"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Inner Integration\>\"", ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\"\<LegendreNbMain\>\"", ",", 
                RowBox[{"Length", "[", "LegendreCoef1", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<LegendreNbIncrement\>\"", ",", 
                RowBox[{"Length", "[", "LegendreCoef1n", "]"}]}], "}"}], ",", 
              
              RowBox[{"{", 
               RowBox[{"\"\<IncrementNbMax\>\"", ",", "imax"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<InitialTailFlag\>\"", ",", "initialTailFlag"}], 
               "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<InitialTailLegendreNb\>\"", ",", 
                RowBox[{"Length", "[", "LegendreCoef2", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<PeriodMain\>\"", ",", "period1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<PeriodnIncrement\>\"", ",", "period1n"}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"\"\<StoppingLevel\>\"", ",", "\[Epsilon]1"}], "}"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"\"\<AbcisseMaxValue\>\"", ",", "kmax"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
               "\"\<InitialTailUpperLimit\>\"", ",", "InitialTailPosition"}], 
               "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
               "\"\<ExplosionMonitoringStartAbcisse\>\"", ",", 
                "StartControl"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
               "\"\<ExplosionMonitoringMaxLevel\>\"", ",", 
                "IncrementFactor"}], "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"\"\<lambda1\>\"", ",", "\[Lambda]1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<lambda2\>\"", ",", "\[Lambda]2"}], "}"}]}], "}"}],
             " ", "//", " ", "MatrixForm"}], ",", "\[IndentingNewLine]", 
           "\"\<Outer Integration\>\"", ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\"\<LegendreNbMain\>\"", ",", 
                RowBox[{"Length", "[", "LegendreCoef2", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<LegendreNbIncrement\>\"", ",", 
                RowBox[{"Length", "[", "LegendreCoef1n", "]"}]}], "}"}], ",", 
              
              RowBox[{"{", 
               RowBox[{"\"\<IncrementNbMax\>\"", ",", "imax"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<InitialTailFlag\>\"", ",", "initialTailFlag"}], 
               "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<InitialTailLegendreNb\>\"", ",", 
                RowBox[{"Length", "[", "LegendreCoef1", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<PeriodMain\>\"", ",", "period2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<PeriodnIncrement\>\"", ",", "period2n"}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"\"\<StoppingLevel\>\"", ",", "\[Epsilon]2"}], "}"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"\"\<AbcisseMaxValue\>\"", ",", "kmax"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
               "\"\<InitialTailUpperLimit\>\"", ",", "InitialTailPosition"}], 
               "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
               "\"\<GrowingControlStartAbcisse\>\"", ",", 
                "startmonitortime"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
               "\"\<GrowingControlMaxFactor\>\"", ",", "plafondexplosion"}], 
               "}"}]}], "}"}], " ", "//", " ", "MatrixForm"}]}], "]"}]}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "2"}], " ", "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "2"}], "]"}]}], "  ", ",", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<BiHestonLaplaceQuickTransform[M,Q,\[Rho], \
\[Mu],\[CapitalSigma],{-\[ImaginaryI] 1,-\[ImaginaryI] \
1},\[Beta],\[Tau]]=\>\"", ",", 
           RowBox[{"BiHestonLaplaceQuickTransform", "[", 
            RowBox[{
            "M", ",", "Q", ",", "\[Rho]", ",", " ", "\[Mu]", ",", 
             "\[CapitalSigma]", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "\[ImaginaryI]"}], " ", "1"}], ",", 
               RowBox[{
                RowBox[{"-", "\[ImaginaryI]"}], " ", "1"}]}], "}"}], ",", 
             "\[Beta]", ",", "\[Tau]"}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<integrand(0.1,0.1)=\>\"", ",", 
           RowBox[{
           "SmileSymetrizedBiHestonPaysFloat2DigitalIntegrandCC", "[", 
            RowBox[{
            "Y", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", "b", ",", 
             "c", ",", "KList", ",", "\[Tau]", ",", "\[CapitalSigma]", ",", 
             "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", "\[Beta]", ",", 
             "\[Lambda]1", ",", "\[Lambda]2", ",", "0.1", ",", "0.1"}], 
            "]"}]}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "4"}], "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "4"}], "]"}]}], " ", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Plot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
              "SmileSymetrizedBiHestonPaysFloat2DigitalIntegrand", "[", 
               RowBox[{
               "Y", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", "b", 
                ",", "c", ",", 
                RowBox[{"{", 
                 RowBox[{"KList", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", "\[Tau]", ",", 
                "\[CapitalSigma]", ",", "M", ",", "Q", ",", "\[Rho]", ",", 
                "\[Mu]", ",", "\[Beta]", ",", "\[Lambda]1", ",", "\[Lambda]2",
                 ",", "\[Omega]1", ",", "\[Omega]2"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Omega]2", ",", "0", " ", ",", 
               RowBox[{"2", "period2"}]}], "}"}], ",", 
             RowBox[{"PlotPoints", "\[Rule]", "50"}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
             RowBox[{"PlotLabel", "\[Rule]", 
              RowBox[{"\"\<1st Inverse Fourier: K =\>\"", "<>", 
               RowBox[{"ToString", "[", 
                RowBox[{"KList", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", 
               "\"\< \[Omega]1=\>\"", "<>", 
               RowBox[{"ToString", "[", "\[Omega]1", "]"}]}]}]}], "]"}], ",", 
           
           RowBox[{"{", 
            RowBox[{"\[Omega]1", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.2", ",", "2"}], "}"}]}], "}"}]}], "]"}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "6"}], "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "6"}], "]"}]}], " ", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\[Omega]2", ",", 
               RowBox[{
                RowBox[{"VectorAdaptativeIntegrateExplosionSafe", "[", 
                 RowBox[{
                  RowBox[{"Function", "[", 
                   RowBox[{"\[Omega]1", ",", 
                    RowBox[{
                    RowBox[{
                    "SmileSymetrizedBiHestonPaysFloat2DigitalIntegrand", "[", 
                    
                    RowBox[{
                    "Y", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", 
                    "b", ",", "c", ",", 
                    RowBox[{"{", 
                    RowBox[{"KList", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", "\[Tau]", ",",
                     "\[CapitalSigma]", ",", "M", ",", "Q", ",", "\[Rho]", 
                    ",", "\[Mu]", ",", "\[Beta]", ",", "\[Lambda]1", ",", 
                    "\[Lambda]2", ",", "\[Omega]1", ",", "\[Omega]2"}], "]"}],
                     "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
                  "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", ",",
                   "period1n", ",", "\[Epsilon]1", ",", "imax", ",", "1", ",",
                   "startmonitortime", ",", "plafondexplosion", ",", 
                  "initialTailFlag", ",", "InitialTailPosition"}], "]"}], "[",
                 
                RowBox[{"[", 
                 RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Omega]2", ",", "0", ",", "period2", ",", 
               RowBox[{"period2", "/", "60"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"Joined", "\[Rule]", "True"}], ",", 
           RowBox[{"PlotLabel", "\[Rule]", "\"\<2nd Inverse Fourier:\>\""}], 
           ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "]"}]}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "7"}], "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "7"}], "]"}]}], " ", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<integrand(0.1,0.1)=\>\"", ",", 
          RowBox[{"SmileSymetrizedBiHestonPaysFloat2DigitalIntegrand", "[", 
           RowBox[{
           "Y", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", "b", ",", 
            "c", ",", "KList", ",", "\[Tau]", ",", "\[CapitalSigma]", ",", 
            "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", "\[Beta]", ",", 
            "\[Lambda]1", ",", "\[Lambda]2", ",", "0.1", ",", "0.1"}], 
           "]"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{"VectorAdaptativeIntegrateUnprotected", "[", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{"\[Omega]2", ",", 
           RowBox[{
            RowBox[{"as", "=", 
             RowBox[{"VectorAdaptativeIntegrateExplosionSafe", "[", 
              RowBox[{
               RowBox[{"Function", "[", 
                RowBox[{"\[Omega]1", ",", 
                 RowBox[{
                 "SmileSymetrizedBiHestonPaysFloat2DigitalIntegrand", "[", 
                  RowBox[{
                  "Y", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", "b", 
                   ",", "c", ",", "KList", ",", "\[Tau]", ",", 
                   "\[CapitalSigma]", ",", "M", ",", "Q", ",", "\[Rho]", ",", 
                   "\[Mu]", ",", "\[Beta]", ",", "\[Lambda]1", ",", 
                   "\[Lambda]2", ",", "\[Omega]1", ",", "\[Omega]2"}], 
                  "]"}]}], "]"}], ",", "LegendreCoef1", ",", "LegendreCoef1n",
                ",", "period1", ",", "period1n", ",", "\[Epsilon]1", ",", 
               "imax", ",", 
               RowBox[{"Length", "[", "KList", "]"}], ",", "startmonitortime",
                ",", "plafondexplosion", ",", "initialTailFlag", ",", 
               "InitialTailPosition"}], "]"}]}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"printflag", "\[Equal]", "7"}], "||", " ", 
               RowBox[{"MemberQ", "[", 
                RowBox[{"printflag", ",", "7"}], "]"}]}], ",", 
              RowBox[{"Print", "[", 
               RowBox[{"\"\<Integ_2=\>\"", ",", "as"}], "]"}]}], "]"}], ";", 
            RowBox[{"as", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], ",", "LegendreCoef2", 
         ",", "period2", ",", "period2n", ",", "\[Epsilon]2", ",", "imax", 
         ",", 
         RowBox[{"Length", "[", "KList", "]"}], ",", "printflag", ",", 
         "initialTailFlag", ",", "InitialTailPosition2", ",", "kmax", ",", 
         "StartControl", ",", "IncrementFactor"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "7"}], "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "7"}], "]"}]}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Integ_1=\>\"", ",", "res"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"res", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.3997288601267104`*^9, 3.39972890803388*^9, {3.3997289692069297`*^9, 
   3.3997289944261637`*^9}, {3.399729087443575*^9, 3.3997291578199263`*^9}, {
   3.399729214633517*^9, 3.3997292559936857`*^9}, {3.399729338917153*^9, 
   3.399729443137904*^9}, {3.3997297921289797`*^9, 3.399729801332281*^9}, 
   3.3997984631978292`*^9, 3.3997986822957864`*^9, {3.399799475623518*^9, 
   3.3997994825611515`*^9}, {3.399813039024555*^9, 3.3998130523841867`*^9}, {
   3.3998138111956306`*^9, 3.399813818523896*^9}, {3.3998138975254135`*^9, 
   3.3998139300104117`*^9}, {3.399814002074295*^9, 3.3998140680286865`*^9}, {
   3.3998141794214506`*^9, 3.399814187827862*^9}, {3.3998161633189154`*^9, 
   3.399816166818983*^9}, {3.399816989678531*^9, 3.39981701069456*^9}, {
   3.3998175772210617`*^9, 3.3998175797054844`*^9}, {3.3998177980534267`*^9, 
   3.3998178039285393`*^9}, 3.3998191717048006`*^9, {3.399819229424659*^9, 
   3.399819249925052*^9}, {3.3998192996916327`*^9, 3.3998193255202537`*^9}, {
   3.3998194002404385`*^9, 3.399819401990472*^9}, {3.399819437022394*^9, 
   3.399819443678772*^9}, {3.3998195847752314`*^9, 3.3998195956035643`*^9}, {
   3.3998937261423693`*^9, 3.3998937440645885`*^9}, {3.399894673945778*^9, 
   3.3998946780865884`*^9}, 3.399895357951172*^9, {3.3998971752360635`*^9, 
   3.399897202986596*^9}, {3.399995099817901*^9, 3.3999951242558703`*^9}, {
   3.3999951653972855`*^9, 3.3999952424143887`*^9}, {3.399995434089944*^9, 
   3.3999954559809895`*^9}, 3.400214359554536*^9, {3.4002194753715076`*^9, 
   3.4002194862310915`*^9}, {3.400221264780864*^9, 3.400221267812172*^9}, {
   3.400221324438259*^9, 3.4002213249851446`*^9}, {3.4002307045682325`*^9, 
   3.4002307106777253`*^9}, {3.4002309417446613`*^9, 
   3.4002309457603636`*^9}, {3.4002355676772275`*^9, 
   3.4002356840075865`*^9}, {3.4002357813375797`*^9, 3.400235782228222*^9}, {
   3.400238239244146*^9, 3.40023824052542*^9}, {3.4004065560321016`*^9, 
   3.400406572266788*^9}, 3.40040661272069*^9, {3.400406710910075*^9, 
   3.400406802349331*^9}, {3.4004079962316275`*^9, 3.400408003981776*^9}, {
   3.4004080367167797`*^9, 3.400408037591797*^9}, {3.400408141500042*^9, 
   3.4004081422656813`*^9}, 3.400504474791651*^9, {3.4008198209228888`*^9, 
   3.4008198369544463`*^9}, {3.401177200473509*^9, 3.401177296365975*^9}, 
   3.4011776191065464`*^9, 3.4011776885297546`*^9, {3.4011777732345057`*^9, 
   3.4011777815627904`*^9}, {3.4015301347651124`*^9, 3.401530142671514*^9}, {
   3.4015342195318975`*^9, 3.4015342774861345`*^9}, {3.4015343731285963`*^9, 
   3.4015343749255056`*^9}, {3.402033437670154*^9, 3.402033457561161*^9}, {
   3.4020334928118377`*^9, 3.402033502483898*^9}, {3.402143403333747*^9, 
   3.402143421193465*^9}, {3.402143489991661*^9, 3.40214349125731*^9}, {
   3.402143653151044*^9, 3.4021436941674557`*^9}, {3.402205803123693*^9, 
   3.402205848499564*^9}, {3.402294611715026*^9, 3.4022946131681786`*^9}, 
   3.402294775718175*^9, {3.4022949263773174`*^9, 3.4022949270960813`*^9}, 
   3.4023779225819693`*^9, 3.402388039487956*^9, 3.4023881114109564`*^9, 
   3.403871476831417*^9, 3.403871589333577*^9, {3.403871732195695*^9, 
   3.4038719361371107`*^9}, 3.40387197021589*^9, {3.4038729130621176`*^9, 
   3.403872917359075*^9}, {3.4038732665532794`*^9, 3.4038732913350053`*^9}, {
   3.40387338716497*^9, 3.403873392790078*^9}, {3.4038739059561806`*^9, 
   3.403873929300379*^9}, {3.4038757265536356`*^9, 3.403875727100521*^9}, {
   3.4038760173873444`*^9, 3.403876028450057*^9}, {3.4038767128225718`*^9, 
   3.4038767355730085`*^9}, {3.403876883685227*^9, 3.403876894872942*^9}, 
   3.4038770811577682`*^9, {3.403877262489375*^9, 3.403877296927536*^9}, {
   3.4038779003609967`*^9, 3.4038779017516484`*^9}, {3.403877950330706*^9, 
   3.403877995722203*^9}, {3.4038805669746947`*^9, 3.4038805816156006`*^9}, {
   3.403940196949411*^9, 3.403940212309081*^9}, {3.4039402503098106`*^9, 
   3.403940330483225*^9}, {3.403940565097104*^9, 3.4039406320983906`*^9}, {
   3.4039477736886315`*^9, 3.4039478349866834`*^9}, 3.403947942238743*^9, {
   3.4039479736924715`*^9, 3.403948027771635*^9}, 3.403948162852353*^9, {
   3.4039491169487963`*^9, 3.4039491206988688`*^9}, {3.4039492631391034`*^9, 
   3.4039493470938406`*^9}, {3.4039496376931696`*^9, 3.403949723882324*^9}, {
   3.4039498424783516`*^9, 3.4039499998719983`*^9}, {3.404147952397335*^9, 
   3.404147980680135*^9}, {3.404148073983735*^9, 3.404148107492535*^9}, {
   3.404148258531735*^9, 3.4041482678605347`*^9}, {3.404148945009735*^9, 
   3.404148946164135*^9}, {3.4041489846337347`*^9, 3.404149017549735*^9}, {
   3.404149060200135*^9, 3.404149083178935*^9}, {3.404151307641535*^9, 
   3.404151309185935*^9}, {3.404151474499135*^9, 3.404151483219535*^9}, 
   3.404151568223935*^9, 3.4041938717523823`*^9, {3.404193912175033*^9, 
   3.404193917190755*^9}, {3.4042041069801445`*^9, 3.4042041521685123`*^9}, {
   3.4042042123415427`*^9, 3.4042042386076717`*^9}, {3.404204276624027*^9, 
   3.4042044284238167`*^9}, {3.40420452156623*^9, 3.4042045494573903`*^9}, {
   3.404204582895532*^9, 3.4042046181149583`*^9}, {3.404204788415103*^9, 
   3.4042048062748213`*^9}, {3.404204841759877*^9, 3.4042048723542147`*^9}, {
   3.404204936324193*^9, 3.4042052265172644`*^9}, {3.4042052790182724`*^9, 
   3.4042052894403477`*^9}, {3.404205340738208*^9, 3.4042053679418545`*^9}, {
   3.404205400817486*^9, 3.404205419677223*^9}, {3.4042054802252607`*^9, 
   3.404205497178711*^9}, 3.40420552863244*^9, {3.4042072185555105`*^9, 
   3.404207235243331*^9}, {3.4043000701119347`*^9, 3.4043000786295347`*^9}, {
   3.4043001168183346`*^9, 3.4043001401871347`*^9}, {3.4043234063901434`*^9, 
   3.404323420461344*^9}, {3.4043237408853436`*^9, 3.4043237568753433`*^9}, {
   3.4043239580841436`*^9, 3.4043239680837436`*^9}, {3.404389056089944*^9, 
   3.404389064997544*^9}, {3.4044553143383374`*^9, 3.4044553173471303`*^9}, {
   3.404464727328169*^9, 3.4044647793115463`*^9}, {3.4044648634193068`*^9, 
   3.404464895731186*^9}, 3.404464939995961*^9, {3.404466809225696*^9, 
   3.404466820006739*^9}, 3.4044669271765566`*^9, {3.404470193535716*^9, 
   3.404470194207578*^9}, {3.404652102174907*^9, 3.4046521218471603`*^9}, {
   3.404662523952945*^9, 3.4046625707061453`*^9}, {3.4046627912433453`*^9, 
   3.404662802490945*^9}, {3.4046642321459455`*^9, 3.404664234080345*^9}, {
   3.4046642723003454`*^9, 3.404664298679945*^9}, {3.4047349612907963`*^9, 
   3.4047350190586395`*^9}, 3.4048112009093513`*^9, {3.4048112843813066`*^9, 
   3.404811295334852*^9}, {3.4048122778100777`*^9, 3.4048123057486506`*^9}, 
   3.404826576562254*^9, {3.4048266892697067`*^9, 3.404826703692135*^9}, {
   3.404831024244785*^9, 3.404831026635502*^9}, {3.4049792115931997`*^9, 
   3.4049792117922*^9}, {3.405087246152504*^9, 3.4050872465900154`*^9}, {
   3.4051646230596266`*^9, 3.405164664404435*^9}, {3.405182662158377*^9, 
   3.4051826625327773`*^9}, {3.4053350771357946`*^9, 3.405335101457795*^9}, {
   3.405335223282795*^9, 3.405335224442795*^9}, {3.405335403379795*^9, 
   3.4053354154567947`*^9}, {3.405347241515806*^9, 3.4053472540942535`*^9}, {
   3.4058684913209915`*^9, 3.4058685125870247`*^9}, {3.4059348793369384`*^9, 
   3.405934879368189*^9}, {3.4059355008801217`*^9, 3.4059355022082725`*^9}, 
   3.405935875481064*^9, {3.405936350083926*^9, 3.4059363513495755`*^9}, {
   3.405936959517502*^9, 3.4059369662051306`*^9}, 3.4064695866932645`*^9, {
   3.406471330972292*^9, 3.4064713411913033`*^9}, {3.406471375832815*^9, 
   3.4064713779578695`*^9}, 3.4064714921326675`*^9, {3.406557685945645*^9, 
   3.4065576887113404`*^9}, {3.4065578605438643`*^9, 
   3.4065578609970007`*^9}, {3.4065584749033413`*^9, 
   3.4065584770908976`*^9}, {3.4065621070119457`*^9, 
   3.4065621218248253`*^9}, {3.4066119892145505`*^9, 3.406611990136449*^9}, 
   3.4066122473149076`*^9, 3.4069596610356965`*^9, 3.406959740584099*^9, 
   3.406968638020551*^9, 3.4069734911918554`*^9, 3.408427759430974*^9, {
   3.4084296565455227`*^9, 3.408429657123659*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SmileBiHestonPaysFloat2DigitalAux2", "[", 
   RowBox[{
   "S_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "a_", ",", "b_", ",", "c_",
     ",", "KList_", ",", "\[Tau]_", ",", "\[CapitalSigma]_", ",", "M_", ",", 
    "\[CapitalSigma]inf_", ",", "Q_", ",", "\[Rho]_", ",", "\[Mu]_", ",", 
    "\[Beta]m_", ",", "\[Lambda]1_", ",", "\[Lambda]2_", ",", 
    RowBox[{"{", 
     RowBox[{
     "LegendreCoef1_", ",", "LegendreCoef1n_", ",", "period1_", ",", 
      "period1n_", ",", "\[Epsilon]1_", ",", "imax_", ",", 
      "startmonitortime_", ",", "plafondexplosion_", ",", "initialTailFlag_", 
      ",", "InitialTailPosition_", ",", "InitialTailPosition2_"}], "}"}], ",",
     
    RowBox[{"{", 
     RowBox[{
     "LegendreCoef2_", ",", "period2_", ",", "period2n_", ",", "\[Epsilon]2_",
       ",", "kmax_", ",", "StartControl_", ",", "IncrementFactor_"}], "}"}], 
    ",", "printflag_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{
   FractionBox["2", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"2", "\[Pi]"}], ")"}], "2"]], 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"as", ",", "res", ",", "res2", ",", 
       RowBox[{"Y", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Log", "[", 
           RowBox[{"S", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
          RowBox[{"Log", "[", 
           RowBox[{"S", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "1"}], " ", "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "1"}], "]"}]}], "  ", ",", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\< S=\>\"", ",", 
           RowBox[{"S", " ", "//", " ", "MatrixForm"}], ",", 
           "\"\< \[CapitalSigma]=\>\"", ",", 
           RowBox[{"\[CapitalSigma]", " ", "//", "MatrixForm"}], ",", 
           "\"\<M=\>\"", ",", 
           RowBox[{"M", "//", "MatrixForm"}], ",", 
           "\"\< \[CapitalSigma]inf=\>\"", ",", 
           RowBox[{"\[CapitalSigma]inf", "//", "MatrixForm"}], " ", ",", 
           "\"\< Q=\>\"", ",", 
           RowBox[{"Q", "//", "MatrixForm"}], " ", ",", "\"\< \[Rho]=\>\"", 
           ",", 
           RowBox[{"\[Rho]", "//", "MatrixForm"}], ",", "\"\< \[Mu]=\>\"", 
           ",", 
           RowBox[{"\[Mu]", "//", "MatrixForm"}], ",", "\"\< \[Beta]m=\>\"", 
           ",", 
           RowBox[{"\[Beta]m", " ", "//", " ", "MatrixForm"}], ",", 
           "\"\< T=\>\"", ",", "\[Tau]"}], "]"}], ";", "\[IndentingNewLine]", 
         
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Inner Integration\>\"", ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\"\<LegendreNbMain\>\"", ",", 
                RowBox[{"Length", "[", "LegendreCoef1", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<LegendreNbIncrement\>\"", ",", 
                RowBox[{"Length", "[", "LegendreCoef1n", "]"}]}], "}"}], ",", 
              
              RowBox[{"{", 
               RowBox[{"\"\<IncrementNbMax\>\"", ",", "imax"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<InitialTailFlag\>\"", ",", "initialTailFlag"}], 
               "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<InitialTailLegendreNb\>\"", ",", 
                RowBox[{"Length", "[", "LegendreCoef2", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<PeriodMain\>\"", ",", "period1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<PeriodnIncrement\>\"", ",", "period1n"}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"\"\<StoppingLevel\>\"", ",", "\[Epsilon]1"}], "}"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"\"\<AbcisseMaxValue\>\"", ",", "kmax"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
               "\"\<InitialTailUpperLimit\>\"", ",", "InitialTailPosition"}], 
               "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
               "\"\<ExplosionMonitoringStartAbcisse\>\"", ",", 
                "StartControl"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
               "\"\<ExplosionMonitoringMaxLevel\>\"", ",", 
                "IncrementFactor"}], "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"\"\<lambda1\>\"", ",", "\[Lambda]1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<lambda2\>\"", ",", "\[Lambda]2"}], "}"}]}], "}"}],
             " ", "//", " ", "MatrixForm"}], ",", "\[IndentingNewLine]", 
           "\"\<Outer Integration\>\"", ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\"\<LegendreNbMain\>\"", ",", 
                RowBox[{"Length", "[", "LegendreCoef2", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<LegendreNbIncrement\>\"", ",", 
                RowBox[{"Length", "[", "LegendreCoef1n", "]"}]}], "}"}], ",", 
              
              RowBox[{"{", 
               RowBox[{"\"\<IncrementNbMax\>\"", ",", "imax"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<InitialTailFlag\>\"", ",", "initialTailFlag"}], 
               "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<InitialTailLegendreNb\>\"", ",", 
                RowBox[{"Length", "[", "LegendreCoef1", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<PeriodMain\>\"", ",", "period2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<PeriodnIncrement\>\"", ",", "period2n"}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"\"\<StoppingLevel\>\"", ",", "\[Epsilon]2"}], "}"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"\"\<AbcisseMaxValue\>\"", ",", "kmax"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
               "\"\<InitialTailUpperLimit\>\"", ",", "InitialTailPosition"}], 
               "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
               "\"\<GrowingControlStartAbcisse\>\"", ",", 
                "startmonitortime"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
               "\"\<GrowingControlMaxFactor\>\"", ",", "plafondexplosion"}], 
               "}"}]}], "}"}], " ", "//", " ", "MatrixForm"}]}], "]"}]}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "2"}], "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "2"}], "]"}]}], "  ", ",", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<BiHestonLaplaceQuickTransform2[M,Q,\[Rho], \[Mu],\
\[CapitalSigma],{-\[ImaginaryI] 1,-\[ImaginaryI] 1},\[Beta]m,\[Tau]]=\>\"", 
           ",", 
           RowBox[{"BiHestonLaplaceQuickTransform2", "[", 
            RowBox[{
            "M", ",", "Q", ",", "\[Rho]", ",", " ", "\[Mu]", ",", 
             "\[CapitalSigma]", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "\[ImaginaryI]"}], " ", "1"}], ",", 
               RowBox[{
                RowBox[{"-", "\[ImaginaryI]"}], " ", "1"}]}], "}"}], ",", 
             "\[Beta]m", ",", "\[Tau]"}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<integrand(0.1,0.1)=\>\"", ",", 
           RowBox[{
           "SmileSymetrizedBiHestonPaysFloat2DigitalIntegrand2CC", "[", 
            RowBox[{
            "Y", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", "b", ",", 
             "c", ",", "KList", ",", "\[Tau]", ",", "\[CapitalSigma]", ",", 
             "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", "\[Beta]m", ",",
              "\[Lambda]1", ",", "\[Lambda]2", ",", "0.1", ",", "0.1"}], 
            "]"}]}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "4"}], "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "4"}], "]"}]}], " ", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Plot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
              "SmileSymetrizedBiHestonPaysFloat2DigitalIntegrand2", "[", 
               RowBox[{
               "Y", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", "b", 
                ",", "c", ",", 
                RowBox[{"{", 
                 RowBox[{"KList", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", "\[Tau]", ",", 
                "\[CapitalSigma]", ",", "M", ",", "Q", ",", "\[Rho]", ",", 
                "\[Mu]", ",", "\[Beta]m", ",", "\[Lambda]1", ",", 
                "\[Lambda]2", ",", "\[Omega]1", ",", "\[Omega]2"}], "]"}], 
              "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Omega]2", ",", "0", " ", ",", 
               RowBox[{"2", "period1"}]}], "}"}], ",", 
             RowBox[{"PlotPoints", "\[Rule]", "50"}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
             RowBox[{"PlotLabel", "\[Rule]", 
              RowBox[{"\"\<1st Inverse Fourier: K =\>\"", "<>", 
               RowBox[{"ToString", "[", 
                RowBox[{"KList", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", 
               "\"\< \[Omega]1=\>\"", "<>", 
               RowBox[{"ToString", "[", "\[Omega]1", "]"}]}]}]}], "]"}], ",", 
           
           RowBox[{"{", 
            RowBox[{"\[Omega]1", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.2", ",", "2"}], "}"}]}], "}"}]}], "]"}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "6"}], "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "6"}], "]"}]}], " ", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\[Omega]2", ",", 
               RowBox[{
                RowBox[{"VectorAdaptativeIntegrateExplosionSafe", "[", 
                 RowBox[{
                  RowBox[{"Function", "[", 
                   RowBox[{"\[Omega]1", ",", 
                    RowBox[{
                    RowBox[{
                    "SmileSymetrizedBiHestonPaysFloat2DigitalIntegrand2", "[",
                     
                    RowBox[{
                    "Y", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", 
                    "b", ",", "c", ",", 
                    RowBox[{"{", 
                    RowBox[{"KList", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", "\[Tau]", ",",
                     "\[CapitalSigma]", ",", "M", ",", "Q", ",", "\[Rho]", 
                    ",", "\[Mu]", ",", "\[Beta]m", ",", "\[Lambda]1", ",", 
                    "\[Lambda]2", ",", "\[Omega]1", ",", "\[Omega]2"}], "]"}],
                     "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
                  "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", ",",
                   "period1n", ",", "\[Epsilon]1", ",", "imax", ",", "1", ",",
                   "startmonitortime", ",", "plafondexplosion", ",", 
                  "initialTailFlag", ",", "InitialTailPosition"}], "]"}], "[",
                 
                RowBox[{"[", 
                 RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Omega]2", ",", "0", ",", "period2", ",", 
               RowBox[{"period2", "/", "30"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"Joined", "\[Rule]", "True"}], ",", 
           RowBox[{"PlotLabel", "\[Rule]", "\"\<2nd Inverse Fourier:\>\""}], 
           ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "]"}]}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{"VectorAdaptativeIntegrateUnprotected", "[", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{"\[Omega]2", ",", 
           RowBox[{
            RowBox[{"as", "=", 
             RowBox[{"VectorAdaptativeIntegrateExplosionSafe", "[", 
              RowBox[{
               RowBox[{"Function", "[", 
                RowBox[{"\[Omega]1", ",", 
                 RowBox[{
                 "SmileSymetrizedBiHestonPaysFloat2DigitalIntegrand2", "[", 
                  RowBox[{
                  "Y", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a", ",", "b", 
                   ",", "c", ",", "KList", ",", "\[Tau]", ",", 
                   "\[CapitalSigma]", ",", "M", ",", "Q", ",", "\[Rho]", ",", 
                   "\[Mu]", ",", "\[Beta]m", ",", "\[Lambda]1", ",", 
                   "\[Lambda]2", ",", "\[Omega]1", ",", "\[Omega]2"}], 
                  "]"}]}], "]"}], ",", "LegendreCoef1", ",", "LegendreCoef1n",
                ",", "period1", ",", "period1n", ",", "\[Epsilon]1", ",", 
               "imax", ",", 
               RowBox[{"Length", "[", "KList", "]"}], ",", "startmonitortime",
                ",", "plafondexplosion", ",", "initialTailFlag", ",", 
               "InitialTailPosition"}], "]"}]}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"printflag", "\[Equal]", "2"}], ",", 
              RowBox[{"Print", "[", 
               RowBox[{"\"\<Integ_2=\>\"", ",", "as"}], "]"}]}], "]"}], ";", 
            RowBox[{"as", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], ",", "LegendreCoef2", 
         ",", "period2", ",", "period2n", ",", "\[Epsilon]2", ",", "imax", 
         ",", 
         RowBox[{"Length", "[", "KList", "]"}], ",", "printflag", ",", 
         "initialTailFlag", ",", "InitialTailPosition2", ",", "kmax", ",", 
         "StartControl", ",", "IncrementFactor"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"printflag", "\[Equal]", "2"}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Integ_1=\>\"", ",", "res"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"res", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.3997288601267104`*^9, 3.39972890803388*^9, {3.3997289692069297`*^9, 
   3.3997289944261637`*^9}, {3.399729087443575*^9, 3.3997291578199263`*^9}, {
   3.399729214633517*^9, 3.3997292559936857`*^9}, {3.399729338917153*^9, 
   3.399729443137904*^9}, {3.3997297921289797`*^9, 3.399729801332281*^9}, 
   3.3997984631978292`*^9, 3.3997986822957864`*^9, {3.399799475623518*^9, 
   3.3997994825611515`*^9}, {3.399813039024555*^9, 3.3998130523841867`*^9}, {
   3.3998138111956306`*^9, 3.399813818523896*^9}, {3.3998138975254135`*^9, 
   3.3998139300104117`*^9}, {3.399814002074295*^9, 3.3998140680286865`*^9}, {
   3.3998141794214506`*^9, 3.399814187827862*^9}, {3.3998161633189154`*^9, 
   3.399816166818983*^9}, {3.399816989678531*^9, 3.39981701069456*^9}, {
   3.3998175772210617`*^9, 3.3998175797054844`*^9}, {3.3998177980534267`*^9, 
   3.3998178039285393`*^9}, 3.3998191717048006`*^9, {3.399819229424659*^9, 
   3.399819249925052*^9}, {3.3998192996916327`*^9, 3.3998193255202537`*^9}, {
   3.3998194002404385`*^9, 3.399819401990472*^9}, {3.399819437022394*^9, 
   3.399819443678772*^9}, {3.3998195847752314`*^9, 3.3998195956035643`*^9}, {
   3.3998937261423693`*^9, 3.3998937440645885`*^9}, {3.399894673945778*^9, 
   3.3998946780865884`*^9}, 3.399895357951172*^9, {3.3998971752360635`*^9, 
   3.399897202986596*^9}, {3.399995099817901*^9, 3.3999951242558703`*^9}, {
   3.3999951653972855`*^9, 3.3999952424143887`*^9}, {3.399995434089944*^9, 
   3.3999954559809895`*^9}, 3.400214359554536*^9, {3.4002194753715076`*^9, 
   3.4002194862310915`*^9}, {3.400221264780864*^9, 3.400221267812172*^9}, {
   3.400221324438259*^9, 3.4002213249851446`*^9}, {3.4002307045682325`*^9, 
   3.4002307106777253`*^9}, {3.4002309417446613`*^9, 
   3.4002309457603636`*^9}, {3.4002355676772275`*^9, 
   3.4002356840075865`*^9}, {3.4002357813375797`*^9, 3.400235782228222*^9}, {
   3.400238239244146*^9, 3.40023824052542*^9}, {3.4004065560321016`*^9, 
   3.400406572266788*^9}, 3.40040661272069*^9, {3.400406710910075*^9, 
   3.400406802349331*^9}, {3.4004079962316275`*^9, 3.400408003981776*^9}, {
   3.4004080367167797`*^9, 3.400408037591797*^9}, {3.400408141500042*^9, 
   3.4004081422656813`*^9}, 3.400504474791651*^9, {3.4008198209228888`*^9, 
   3.4008198369544463`*^9}, {3.401177200473509*^9, 3.401177296365975*^9}, 
   3.4011776191065464`*^9, 3.4011776885297546`*^9, {3.4011777732345057`*^9, 
   3.4011777815627904`*^9}, {3.4015301347651124`*^9, 3.401530142671514*^9}, {
   3.4015342195318975`*^9, 3.4015342774861345`*^9}, {3.4015343731285963`*^9, 
   3.4015343749255056`*^9}, {3.402033437670154*^9, 3.402033457561161*^9}, {
   3.4020334928118377`*^9, 3.402033502483898*^9}, {3.402143403333747*^9, 
   3.402143421193465*^9}, {3.402143489991661*^9, 3.40214349125731*^9}, {
   3.402143653151044*^9, 3.4021436941674557`*^9}, {3.402205803123693*^9, 
   3.402205848499564*^9}, {3.402294611715026*^9, 3.4022946131681786`*^9}, 
   3.402294775718175*^9, {3.4022949263773174`*^9, 3.4022949270960813`*^9}, 
   3.4023779225819693`*^9, 3.402388039487956*^9, 3.4023881114109564`*^9, 
   3.403871476831417*^9, 3.403871589333577*^9, {3.403871732195695*^9, 
   3.4038719361371107`*^9}, 3.40387197021589*^9, {3.4038729130621176`*^9, 
   3.403872917359075*^9}, {3.4038732665532794`*^9, 3.4038732913350053`*^9}, {
   3.40387338716497*^9, 3.403873392790078*^9}, {3.4038739059561806`*^9, 
   3.403873929300379*^9}, {3.4038757265536356`*^9, 3.403875727100521*^9}, {
   3.4038760173873444`*^9, 3.403876028450057*^9}, {3.4038767128225718`*^9, 
   3.4038767355730085`*^9}, {3.403876883685227*^9, 3.403876894872942*^9}, 
   3.4038770811577682`*^9, {3.403877262489375*^9, 3.403877296927536*^9}, {
   3.4038779003609967`*^9, 3.4038779017516484`*^9}, {3.403877950330706*^9, 
   3.403877995722203*^9}, {3.4038805669746947`*^9, 3.4038805816156006`*^9}, {
   3.403940196949411*^9, 3.403940212309081*^9}, {3.4039402503098106`*^9, 
   3.403940330483225*^9}, {3.403940565097104*^9, 3.4039406320983906`*^9}, {
   3.4039477736886315`*^9, 3.4039478349866834`*^9}, 3.403947942238743*^9, {
   3.4039479736924715`*^9, 3.403948027771635*^9}, 3.403948162852353*^9, {
   3.4039491169487963`*^9, 3.4039491206988688`*^9}, {3.4039492631391034`*^9, 
   3.4039493470938406`*^9}, {3.4039496376931696`*^9, 3.403949723882324*^9}, {
   3.4039498424783516`*^9, 3.4039499998719983`*^9}, {3.404147952397335*^9, 
   3.404147980680135*^9}, {3.404148073983735*^9, 3.404148107492535*^9}, {
   3.404148258531735*^9, 3.4041482678605347`*^9}, {3.404148945009735*^9, 
   3.404148946164135*^9}, {3.4041489846337347`*^9, 3.404149017549735*^9}, {
   3.404149060200135*^9, 3.404149083178935*^9}, {3.404151307641535*^9, 
   3.404151309185935*^9}, {3.404151474499135*^9, 3.404151483219535*^9}, 
   3.404151568223935*^9, 3.4041938717523823`*^9, {3.404193912175033*^9, 
   3.404193917190755*^9}, {3.4042041069801445`*^9, 3.4042041521685123`*^9}, {
   3.4042042123415427`*^9, 3.4042042386076717`*^9}, {3.404204276624027*^9, 
   3.4042044284238167`*^9}, {3.40420452156623*^9, 3.4042045494573903`*^9}, {
   3.404204582895532*^9, 3.4042046181149583`*^9}, {3.404204788415103*^9, 
   3.4042048062748213`*^9}, {3.404204841759877*^9, 3.4042048723542147`*^9}, {
   3.404204936324193*^9, 3.4042052265172644`*^9}, {3.4042052790182724`*^9, 
   3.4042052894403477`*^9}, {3.404205340738208*^9, 3.4042053679418545`*^9}, {
   3.404205400817486*^9, 3.404205419677223*^9}, {3.4042054802252607`*^9, 
   3.404205497178711*^9}, 3.40420552863244*^9, {3.4042072185555105`*^9, 
   3.404207235243331*^9}, {3.4042169113197336`*^9, 3.404216925101248*^9}, {
   3.4043001505299344`*^9, 3.4043002016355343`*^9}, {3.4043234402889433`*^9, 
   3.4043234487441435`*^9}, {3.4043237751273437`*^9, 
   3.4043237822877436`*^9}, {3.404324132304144*^9, 3.4043241429121437`*^9}, {
   3.404324465254944*^9, 3.4043244826177435`*^9}, 3.404324753246544*^9, 
   3.404389086572344*^9, {3.4044647321249523`*^9, 3.404464746624674*^9}, {
   3.404464795092493*^9, 3.4044648116703*^9}, {3.404464856278818*^9, 
   3.404464859169388*^9}, {3.4044649040279016`*^9, 3.4044649336835823`*^9}, 
   3.4044669516448364`*^9, {3.4044672458266883`*^9, 3.4044672763573523`*^9}, {
   3.4046521047218313`*^9, 3.404652136113059*^9}, {3.404662443222945*^9, 
   3.404662495467345*^9}, 3.404811209190919*^9, {3.4048113022257414`*^9, 
   3.404811310991703*^9}, {3.4048123202804585`*^9, 3.4048123315308905`*^9}, {
   3.404826540560871*^9, 3.404826542826583*^9}, {3.404826714333169*^9, 
   3.404826722989751*^9}, 3.4048312176740875`*^9, {3.405145840438179*^9, 
   3.405145840906941*^9}, {3.405164673201535*^9, 3.4051646944989557`*^9}, {
   3.4053351081867948`*^9, 3.405335126874795*^9}, 3.405335273508795*^9, {
   3.4053353738057947`*^9, 3.4053353941967945`*^9}, {3.405347257656844*^9, 
   3.4053472695321484`*^9}, {3.4059348793838143`*^9, 3.40593487939944*^9}, 
   3.405935136763756*^9, 3.405935750119282*^9, {3.4059363615216455`*^9, 
   3.4059363628029203`*^9}, {3.4059369866430225`*^9, 
   3.4059369997995253`*^9}, {3.40647136861388*^9, 3.4064713707233095`*^9}, 
   3.4064714884763236`*^9, {3.4065577543380203`*^9, 3.40655775763498*^9}, {
   3.4065578168708715`*^9, 3.4065578484810553`*^9}, {3.4065584893724623`*^9, 
   3.4065585135293303`*^9}, {3.406562141887839*^9, 3.406562158200756*^9}, {
   3.406611995136577*^9, 3.406611995949098*^9}, 3.4066122645028477`*^9, 
   3.40695966773895*^9, {3.406959722318123*^9, 3.4069597283963647`*^9}, 
   3.406968642926895*^9, 3.4069735016451807`*^9, 3.40842776888428*^9, {
   3.4084296629987717`*^9, 3.4084296687957582`*^9}, {3.4084462903336353`*^9, 
   3.4084462945680914`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Integrands", "Subsubtitle",
 CellChangeTimes->{{3.404631476967207*^9, 3.4046314788891187`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SmileSymetrizedBiHestonPaysFloat2DigitalIntegrand", "[", 
   RowBox[{
   "Y_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "a_", ",", "b_", ",", "c_",
     ",", "KList_", ",", "\[Tau]_", ",", "\[CapitalSigma]_", ",", "M_", ",", 
    "Q_", ",", "\[Rho]_", ",", "\[Mu]_", ",", "\[Beta]_", ",", "\[Lambda]1_", 
    ",", "\[Lambda]2_", ",", "\[Omega]1_", ",", "\[Omega]2_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x1", "=", 
       RowBox[{"Y", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", 
      RowBox[{"x2", "=", 
       RowBox[{"Y", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ",", "\[Lambda]1G", ",", 
      "\[Lambda]2G", ",", "\[Lambda]1D", ",", "\[Lambda]2D", ",", "\[Alpha]D",
       ",", "\[Alpha]G", ",", "Sym\[Alpha]D", ",", "Sym\[Alpha]G", ",", 
      "propagatorDroit", ",", "SympropagatorDroit", ",", "propagatorGauche", 
      ",", "SympropagatorGauche", ",", "propagatorDroit2", ",", 
      "SympropagatorDroit2", ",", "propagatorGauche2", ",", 
      "SympropagatorGauche2"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Lambda]1G", "=", 
      RowBox[{"(", 
       RowBox[{"\[Lambda]1", " ", "+", 
        RowBox[{"\[Lambda]2", " ", 
         RowBox[{"a", "/", "b"}]}], "+", "a"}], ")"}]}], ";", 
     RowBox[{"\[Lambda]2G", "=", 
      RowBox[{"(", 
       RowBox[{"-", "\[Lambda]2"}], ")"}]}], ";", 
     RowBox[{"\[Lambda]1D", "=", 
      RowBox[{"(", 
       RowBox[{"-", "\[Lambda]1"}], ")"}]}], ";", 
     RowBox[{"\[Lambda]2D", "=", 
      RowBox[{"(", 
       RowBox[{"\[Lambda]2", " ", "+", 
        RowBox[{"\[Lambda]1", " ", 
         RowBox[{"b", "/", "a"}]}], "+", "a"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Alpha]D", "=", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "x1", " ", 
         RowBox[{"(", 
          RowBox[{"\[Omega]1", "+", 
           RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1D"}]}], ")"}]}], "-", 
        RowBox[{"\[ImaginaryI]", " ", "x2", " ", 
         RowBox[{"(", 
          RowBox[{"\[Omega]2", "+", 
           RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2D"}]}], ")"}]}]}]]}], ";",
      
     RowBox[{"\[Alpha]G", "=", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "x1", " ", 
         RowBox[{"(", 
          RowBox[{"\[Omega]1", "+", 
           RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1G"}]}], ")"}]}], "-", 
        RowBox[{"\[ImaginaryI]", " ", "x2", " ", 
         RowBox[{"(", 
          RowBox[{"\[Omega]2", "+", 
           RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2G"}]}], ")"}]}]}]]}], ";",
      
     RowBox[{"Sym\[Alpha]D", "=", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"\[ImaginaryI]", " ", "x1", " ", 
         RowBox[{"(", 
          RowBox[{"\[Omega]1", "+", 
           RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1D"}]}], ")"}]}], "-", 
        RowBox[{"\[ImaginaryI]", " ", "x2", " ", 
         RowBox[{"(", 
          RowBox[{"\[Omega]2", "+", 
           RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2D"}]}], ")"}]}]}]]}], ";",
      
     RowBox[{"Sym\[Alpha]G", "=", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"\[ImaginaryI]", " ", "x1", " ", 
         RowBox[{"(", 
          RowBox[{"\[Omega]1", "+", 
           RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1G"}]}], ")"}]}], "-", 
        RowBox[{"\[ImaginaryI]", " ", "x2", " ", 
         RowBox[{"(", 
          RowBox[{"\[Omega]2", "+", 
           RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2G"}]}], ")"}]}]}]]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"propagatorDroit", "=", 
      RowBox[{"BiHestonLaplaceQuickTransform", "[", 
       RowBox[{
       "M", ",", "Q", ",", "\[Rho]", ",", " ", "\[Mu]", ",", 
        "\[CapitalSigma]", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], 
           RowBox[{"(", 
            RowBox[{"\[Omega]1", "+", 
             RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1D"}]}], ")"}]}], ",", 
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", 
           RowBox[{"(", 
            RowBox[{"\[Omega]2", "+", 
             RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2D"}]}], ")"}]}]}], 
         "}"}], ",", "\[Beta]", ",", "\[Tau]"}], "]"}]}], ";", 
     RowBox[{"SympropagatorDroit", "=", 
      RowBox[{"BiHestonLaplaceQuickTransform", "[", 
       RowBox[{
       "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", " ", 
        "\[CapitalSigma]", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"(", 
            RowBox[{"\[Omega]1", "+", 
             RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1D"}]}], ")"}]}], ",", 
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], 
           RowBox[{"(", 
            RowBox[{"\[Omega]2", "+", 
             RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2D"}]}], ")"}]}]}], 
         "}"}], ",", "\[Beta]", ",", "\[Tau]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"propagatorGauche", "=", 
      RowBox[{"BiHestonLaplaceQuickTransform", "[", 
       RowBox[{
       "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", " ", 
        "\[CapitalSigma]", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], 
           RowBox[{"(", 
            RowBox[{"\[Omega]1", "+", 
             RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1G"}]}], ")"}]}], ",", 
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", 
           RowBox[{"(", 
            RowBox[{"\[Omega]2", "+", 
             RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2G"}]}], ")"}]}]}], 
         "}"}], ",", "\[Beta]", ",", "\[Tau]"}], "]"}]}], ";", 
     RowBox[{"SympropagatorGauche", "=", 
      RowBox[{"BiHestonLaplaceQuickTransform", "[", 
       RowBox[{
       "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", " ", 
        "\[CapitalSigma]", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[ImaginaryI]", 
           RowBox[{"(", 
            RowBox[{"\[Omega]1", "+", 
             RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1G"}]}], ")"}]}], ",", 
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", 
           RowBox[{"(", 
            RowBox[{"\[Omega]2", "+", 
             RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2G"}]}], ")"}]}]}], 
         "}"}], ",", "\[Beta]", ",", "\[Tau]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Re", "[", 
        RowBox[{
         RowBox[{"\[Alpha]D", " ", "propagatorDroit", " ", 
          RowBox[{"PaysFloat2DigitalPayOffFourierDroite", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"\[Omega]1", "+", 
              RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1D"}]}], ")"}], ",", 
            RowBox[{"(", 
             RowBox[{"\[Omega]2", "+", 
              RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2D"}]}], ")"}], ",", 
            RowBox[{"KList", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "\[Alpha]1", ",", 
            "\[Beta]1", ",", "a", ",", "b", ",", "c"}], "]"}]}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"Sym\[Alpha]D", " ", "SympropagatorDroit", " ", 
          RowBox[{"PaysFloat2DigitalPayOffFourierDroite", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{"\[Omega]1", "+", 
               RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1D"}]}], ")"}]}], ",", 
            
            RowBox[{"(", 
             RowBox[{"\[Omega]2", "+", 
              RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2D"}]}], ")"}], ",", 
            RowBox[{"KList", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "\[Alpha]1", ",", 
            "\[Beta]1", ",", "a", ",", "b", ",", "c"}], "]"}]}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"\[Alpha]G", " ", "propagatorGauche", " ", 
          RowBox[{"PaysFloat2DigitalPayOffFourierGauche", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"\[Omega]1", "+", 
              RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1G"}]}], ")"}], ",", 
            RowBox[{"(", 
             RowBox[{"\[Omega]2", "+", 
              RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2G"}]}], ")"}], ",", 
            RowBox[{"KList", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "\[Alpha]1", ",", 
            "\[Beta]1", ",", "a", ",", "b", ",", "c"}], "]"}]}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"Sym\[Alpha]G", " ", "SympropagatorGauche", " ", 
          RowBox[{"PaysFloat2DigitalPayOffFourierGauche", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{"\[Omega]1", "+", 
               RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1G"}]}], ")"}]}], ",", 
            
            RowBox[{"(", 
             RowBox[{"\[Omega]2", "+", 
              RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2G"}]}], ")"}], ",", 
            RowBox[{"KList", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "\[Alpha]1", ",", 
            "\[Beta]1", ",", "a", ",", "b", ",", "c"}], "]"}]}]}], "]"}], ",",
        
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "KList", "]"}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.402140085770051*^9, 3.4021400863013115`*^9}, {
   3.4021401238489075`*^9, 3.4021402363666925`*^9}, {3.402140267929798*^9, 
   3.402140316290102*^9}, {3.4021403621347322`*^9, 3.4021403798069468`*^9}, {
   3.402140442948784*^9, 3.4021404698243*^9}, {3.40214052530974*^9, 
   3.4021405261847568`*^9}, {3.402140572076263*^9, 3.4021405730294065`*^9}, {
   3.40214283290092*^9, 3.402142834900958*^9}, 3.402142878995555*^9, {
   3.4021429531532288`*^9, 3.40214297455989*^9}, {3.4021430512488623`*^9, 
   3.4021430865307894`*^9}, {3.402143143625636*^9, 3.4021431463288126`*^9}, {
   3.402143222267771*^9, 3.402143365629898*^9}, {3.4021439797510643`*^9, 
   3.4021440141579747`*^9}, {3.4021444783543873`*^9, 
   3.4021445164332433`*^9}, {3.4021445469025784`*^9, 3.402144574918741*^9}, {
   3.4021446846239724`*^9, 3.4021446895459423`*^9}, {3.4021447226559525`*^9, 
   3.402144729593586*^9}, {3.402144860127342*^9, 3.402144926378614*^9}, {
   3.4021449572542067`*^9, 3.402145180727247*^9}, {3.402149153412896*^9, 
   3.4021491595067635`*^9}, {3.4021496964233217`*^9, 3.402149821410097*^9}, {
   3.40214987416111*^9, 3.402149884755063*^9}, {3.4021499394279876`*^9, 
   3.4021499498344374`*^9}, {3.402150065133526*^9, 3.402150121790864*^9}, {
   3.4021501655260787`*^9, 3.4021502014486437`*^9}, {3.402150388827241*^9, 
   3.4021504643911915`*^9}, {3.4021505016731577`*^9, 3.402150539877016*^9}, {
   3.402150576221464*^9, 3.4021506145190744`*^9}, 3.402150646160307*^9, {
   3.4021507013801165`*^9, 3.402150701614496*^9}, {3.402150792022482*^9, 
   3.4021508226011944`*^9}, {3.4022048852154446`*^9, 
   3.4022049314194565`*^9}, {3.402223441649846*^9, 3.4022234739004655`*^9}, {
   3.4022235664178667`*^9, 3.4022235977934694`*^9}, {3.402225770632062*^9, 
   3.4022257810853877`*^9}, {3.4022260066522183`*^9, 
   3.4022260340902452`*^9}, {3.402227989127781*^9, 3.4022280025967894`*^9}, 
   3.4022280710668545`*^9, {3.4022281624279833`*^9, 3.4022281629904943`*^9}, {
   3.4023193135668306`*^9, 3.4023194603141108`*^9}, {3.402319603150462*^9, 
   3.40231966787294*^9}, {3.4023197252970443`*^9, 3.4023197324378977`*^9}, {
   3.4023205583495092`*^9, 3.4023206749454975`*^9}, {3.4023207399779963`*^9, 
   3.4023207413373976`*^9}, {3.4023208249015017`*^9, 
   3.4023209920765867`*^9}, {3.4023211800958214`*^9, 3.40232123755005*^9}, {
   3.4023216909806304`*^9, 3.4023216975588818`*^9}, {3.402321742184738*^9, 
   3.4023217427316236`*^9}, {3.4023247260232773`*^9, 
   3.4023248331659594`*^9}, {3.4023253919266872`*^9, 
   3.4023255075695324`*^9}, {3.40237831846457*^9, 3.4023783246678143`*^9}, {
   3.4041932487247953`*^9, 3.4041932623344316`*^9}, {3.40419333647648*^9, 
   3.4041933710083933`*^9}, {3.4041937125305753`*^9, 3.404193749953169*^9}, {
   3.4043002135695343`*^9, 3.4043002231947346`*^9}, {3.4044649846669784`*^9, 
   3.4044650123383217`*^9}, {3.4044650477751417`*^9, 
   3.4044651238049316`*^9}, {3.404465582921117*^9, 3.4044656190610476`*^9}, {
   3.4044656599352627`*^9, 3.4044656716225386`*^9}, {3.4044670806423597`*^9, 
   3.404467083939172*^9}, {3.4044685611608086`*^9, 3.4044685642701235`*^9}, {
   3.4044686800022764`*^9, 3.4044687901564116`*^9}, {3.4044707796025887`*^9, 
   3.4044707807275667`*^9}, 3.404652171754368*^9, {3.4046522684124737`*^9, 
   3.404652301397482*^9}, 3.4048112137223434`*^9, {3.4048113224921446`*^9, 
   3.4048113889321957`*^9}, 3.404826533466849*^9, {3.404826732521367*^9, 
   3.404826749568897*^9}, 3.4051647325780554`*^9, {3.405165151291899*^9, 
   3.4051652061058025`*^9}, {3.4051653156086054`*^9, 3.405165325483858*^9}, {
   3.405165713493791*^9, 3.405165736338126*^9}, {3.4051706650736732`*^9, 
   3.4051707229657803`*^9}, {3.405170756826022*^9, 3.405170757685419*^9}, {
   3.4051708129680843`*^9, 3.40517084365637*^9}, {3.4051709842849703`*^9, 
   3.4051709871912947`*^9}, {3.4051711665083847`*^9, 
   3.4051711773680377`*^9}, {3.405186211332777*^9, 3.4051863222019773`*^9}, {
   3.405186712950777*^9, 3.4051870170727773`*^9}, {3.4051870853695774`*^9, 
   3.405187263162777*^9}, {3.405187307544777*^9, 3.405187352800377*^9}, {
   3.4051873882279773`*^9, 3.4051874194123774`*^9}, {3.405187886413977*^9, 
   3.405187894947177*^9}, {3.405335139297795*^9, 3.405335159223795*^9}, 
   3.405335277721795*^9, {3.405335357027795*^9, 3.405335364556795*^9}, {
   3.4053365635697947`*^9, 3.4053365635947948`*^9}, {3.405347274313521*^9, 
   3.4053472958609476`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SmileSymetrizedBiHestonPaysFloat2DigitalIntegrand2", "[", 
   RowBox[{
   "Y_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "a_", ",", "b_", ",", "c_",
     ",", "KList_", ",", "\[Tau]_", ",", "\[CapitalSigma]_", ",", "M_", ",", 
    "Q_", ",", "\[Rho]_", ",", "\[Mu]_", ",", "\[Beta]m_", ",", "\[Lambda]1_",
     ",", "\[Lambda]2_", ",", "\[Omega]1_", ",", "\[Omega]2_"}], "]"}], ":=", 
  
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x1", "=", 
       RowBox[{"Y", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", 
      RowBox[{"x2", "=", 
       RowBox[{"Y", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ",", "\[Lambda]1G", ",", 
      "\[Lambda]2G", ",", "\[Lambda]1D", ",", "\[Lambda]2D", ",", "\[Alpha]D",
       ",", "\[Alpha]G", ",", "Sym\[Alpha]D", ",", "Sym\[Alpha]G", ",", 
      "propagatorDroit", ",", "SympropagatorDroit", ",", "propagatorGauche", 
      ",", "SympropagatorGauche", ",", "propagatorDroit2", ",", 
      "SympropagatorDroit2", ",", "propagatorGauche2", ",", 
      "SympropagatorGauche2"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Lambda]1G", "=", 
      RowBox[{"(", 
       RowBox[{"\[Lambda]1", " ", "+", 
        RowBox[{"\[Lambda]2", " ", 
         RowBox[{"a", "/", "b"}]}], "+", "a"}], ")"}]}], ";", 
     RowBox[{"\[Lambda]2G", "=", 
      RowBox[{"(", 
       RowBox[{"-", "\[Lambda]2"}], ")"}]}], ";", 
     RowBox[{"\[Lambda]1D", "=", 
      RowBox[{"(", 
       RowBox[{"-", "\[Lambda]1"}], ")"}]}], ";", 
     RowBox[{"\[Lambda]2D", "=", 
      RowBox[{"(", 
       RowBox[{"\[Lambda]2", " ", "+", 
        RowBox[{"\[Lambda]1", " ", 
         RowBox[{"b", "/", "a"}]}], "+", "a"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Alpha]D", "=", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "x1", " ", 
         RowBox[{"(", 
          RowBox[{"\[Omega]1", "+", 
           RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1D"}]}], ")"}]}], "-", 
        RowBox[{"\[ImaginaryI]", " ", "x2", " ", 
         RowBox[{"(", 
          RowBox[{"\[Omega]2", "+", 
           RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2D"}]}], ")"}]}]}]]}], ";",
      
     RowBox[{"\[Alpha]G", "=", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "x1", " ", 
         RowBox[{"(", 
          RowBox[{"\[Omega]1", "+", 
           RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1G"}]}], ")"}]}], "-", 
        RowBox[{"\[ImaginaryI]", " ", "x2", " ", 
         RowBox[{"(", 
          RowBox[{"\[Omega]2", "+", 
           RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2G"}]}], ")"}]}]}]]}], ";",
      
     RowBox[{"Sym\[Alpha]D", "=", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"\[ImaginaryI]", " ", "x1", " ", 
         RowBox[{"(", 
          RowBox[{"\[Omega]1", "+", 
           RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1D"}]}], ")"}]}], "-", 
        RowBox[{"\[ImaginaryI]", " ", "x2", " ", 
         RowBox[{"(", 
          RowBox[{"\[Omega]2", "+", 
           RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2D"}]}], ")"}]}]}]]}], ";",
      
     RowBox[{"Sym\[Alpha]G", "=", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"\[ImaginaryI]", " ", "x1", " ", 
         RowBox[{"(", 
          RowBox[{"\[Omega]1", "+", 
           RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1G"}]}], ")"}]}], "-", 
        RowBox[{"\[ImaginaryI]", " ", "x2", " ", 
         RowBox[{"(", 
          RowBox[{"\[Omega]2", "+", 
           RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2G"}]}], ")"}]}]}]]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"propagatorDroit", "=", 
      RowBox[{"BiHestonLaplaceQuickTransform2", "[", 
       RowBox[{
       "M", ",", "Q", ",", "\[Rho]", ",", " ", "\[Mu]", ",", 
        "\[CapitalSigma]", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], 
           RowBox[{"(", 
            RowBox[{"\[Omega]1", "+", 
             RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1D"}]}], ")"}]}], ",", 
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", 
           RowBox[{"(", 
            RowBox[{"\[Omega]2", "+", 
             RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2D"}]}], ")"}]}]}], 
         "}"}], ",", "\[Beta]m", ",", "\[Tau]"}], "]"}]}], ";", 
     RowBox[{"SympropagatorDroit", "=", 
      RowBox[{"BiHestonLaplaceQuickTransform2", "[", 
       RowBox[{
       "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", " ", 
        "\[CapitalSigma]", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"(", 
            RowBox[{"\[Omega]1", "+", 
             RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1D"}]}], ")"}]}], ",", 
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], 
           RowBox[{"(", 
            RowBox[{"\[Omega]2", "+", 
             RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2D"}]}], ")"}]}]}], 
         "}"}], ",", "\[Beta]m", ",", "\[Tau]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"propagatorGauche", "=", 
      RowBox[{"BiHestonLaplaceQuickTransform2", "[", 
       RowBox[{
       "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", " ", 
        "\[CapitalSigma]", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], 
           RowBox[{"(", 
            RowBox[{"\[Omega]1", "+", 
             RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1G"}]}], ")"}]}], ",", 
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", 
           RowBox[{"(", 
            RowBox[{"\[Omega]2", "+", 
             RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2G"}]}], ")"}]}]}], 
         "}"}], ",", "\[Beta]m", ",", "\[Tau]"}], "]"}]}], ";", 
     RowBox[{"SympropagatorGauche", "=", 
      RowBox[{"BiHestonLaplaceQuickTransform2", "[", 
       RowBox[{
       "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", " ", 
        "\[CapitalSigma]", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[ImaginaryI]", 
           RowBox[{"(", 
            RowBox[{"\[Omega]1", "+", 
             RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1G"}]}], ")"}]}], ",", 
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", 
           RowBox[{"(", 
            RowBox[{"\[Omega]2", "+", 
             RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2G"}]}], ")"}]}]}], 
         "}"}], ",", "\[Beta]m", ",", "\[Tau]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Re", "[", 
        RowBox[{
         RowBox[{"\[Alpha]D", " ", "propagatorDroit", " ", 
          RowBox[{"PaysFloat2DigitalPayOffFourierDroite", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"\[Omega]1", "+", 
              RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1D"}]}], ")"}], ",", 
            RowBox[{"(", 
             RowBox[{"\[Omega]2", "+", 
              RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2D"}]}], ")"}], ",", 
            RowBox[{"KList", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "\[Alpha]1", ",", 
            "\[Beta]1", ",", "a", ",", "b", ",", "c"}], "]"}]}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"Sym\[Alpha]D", " ", "SympropagatorDroit", " ", 
          RowBox[{"PaysFloat2DigitalPayOffFourierDroite", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{"\[Omega]1", "+", 
               RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1D"}]}], ")"}]}], ",", 
            
            RowBox[{"(", 
             RowBox[{"\[Omega]2", "+", 
              RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2D"}]}], ")"}], ",", 
            RowBox[{"KList", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "\[Alpha]1", ",", 
            "\[Beta]1", ",", "a", ",", "b", ",", "c"}], "]"}]}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"\[Alpha]G", " ", "propagatorGauche", " ", 
          RowBox[{"PaysFloat2DigitalPayOffFourierGauche", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"\[Omega]1", "+", 
              RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1G"}]}], ")"}], ",", 
            RowBox[{"(", 
             RowBox[{"\[Omega]2", "+", 
              RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2G"}]}], ")"}], ",", 
            RowBox[{"KList", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "\[Alpha]1", ",", 
            "\[Beta]1", ",", "a", ",", "b", ",", "c"}], "]"}]}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"Sym\[Alpha]G", " ", "SympropagatorGauche", " ", 
          RowBox[{"PaysFloat2DigitalPayOffFourierGauche", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{"\[Omega]1", "+", 
               RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1G"}]}], ")"}]}], ",", 
            
            RowBox[{"(", 
             RowBox[{"\[Omega]2", "+", 
              RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2G"}]}], ")"}], ",", 
            RowBox[{"KList", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "\[Alpha]1", ",", 
            "\[Beta]1", ",", "a", ",", "b", ",", "c"}], "]"}]}]}], "]"}], ",",
        
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "KList", "]"}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.402140085770051*^9, 3.4021400863013115`*^9}, {
   3.4021401238489075`*^9, 3.4021402363666925`*^9}, {3.402140267929798*^9, 
   3.402140316290102*^9}, {3.4021403621347322`*^9, 3.4021403798069468`*^9}, {
   3.402140442948784*^9, 3.4021404698243*^9}, {3.40214052530974*^9, 
   3.4021405261847568`*^9}, {3.402140572076263*^9, 3.4021405730294065`*^9}, {
   3.40214283290092*^9, 3.402142834900958*^9}, 3.402142878995555*^9, {
   3.4021429531532288`*^9, 3.40214297455989*^9}, {3.4021430512488623`*^9, 
   3.4021430865307894`*^9}, {3.402143143625636*^9, 3.4021431463288126`*^9}, {
   3.402143222267771*^9, 3.402143365629898*^9}, {3.4021439797510643`*^9, 
   3.4021440141579747`*^9}, {3.4021444783543873`*^9, 
   3.4021445164332433`*^9}, {3.4021445469025784`*^9, 3.402144574918741*^9}, {
   3.4021446846239724`*^9, 3.4021446895459423`*^9}, {3.4021447226559525`*^9, 
   3.402144729593586*^9}, {3.402144860127342*^9, 3.402144926378614*^9}, {
   3.4021449572542067`*^9, 3.402145180727247*^9}, {3.402149153412896*^9, 
   3.4021491595067635`*^9}, {3.4021496964233217`*^9, 3.402149821410097*^9}, {
   3.40214987416111*^9, 3.402149884755063*^9}, {3.4021499394279876`*^9, 
   3.4021499498344374`*^9}, {3.402150065133526*^9, 3.402150121790864*^9}, {
   3.4021501655260787`*^9, 3.4021502014486437`*^9}, {3.402150388827241*^9, 
   3.4021504643911915`*^9}, {3.4021505016731577`*^9, 3.402150539877016*^9}, {
   3.402150576221464*^9, 3.4021506145190744`*^9}, 3.402150646160307*^9, {
   3.4021507013801165`*^9, 3.402150701614496*^9}, {3.402150792022482*^9, 
   3.4021508226011944`*^9}, {3.4022048852154446`*^9, 
   3.4022049314194565`*^9}, {3.402223441649846*^9, 3.4022234739004655`*^9}, {
   3.4022235664178667`*^9, 3.4022235977934694`*^9}, {3.402225770632062*^9, 
   3.4022257810853877`*^9}, {3.4022260066522183`*^9, 
   3.4022260340902452`*^9}, {3.402227989127781*^9, 3.4022280025967894`*^9}, 
   3.4022280710668545`*^9, {3.4022281624279833`*^9, 3.4022281629904943`*^9}, {
   3.4023193135668306`*^9, 3.4023194603141108`*^9}, {3.402319603150462*^9, 
   3.40231966787294*^9}, {3.4023197252970443`*^9, 3.4023197324378977`*^9}, {
   3.4023205583495092`*^9, 3.4023206749454975`*^9}, {3.4023207399779963`*^9, 
   3.4023207413373976`*^9}, {3.4023208249015017`*^9, 
   3.4023209920765867`*^9}, {3.4023211800958214`*^9, 3.40232123755005*^9}, {
   3.4023216909806304`*^9, 3.4023216975588818`*^9}, {3.402321742184738*^9, 
   3.4023217427316236`*^9}, {3.4023247260232773`*^9, 
   3.4023248331659594`*^9}, {3.4023253919266872`*^9, 
   3.4023255075695324`*^9}, {3.40237831846457*^9, 3.4023783246678143`*^9}, {
   3.4041932487247953`*^9, 3.4041932623344316`*^9}, {3.40419333647648*^9, 
   3.4041933710083933`*^9}, {3.4041937125305753`*^9, 3.404193749953169*^9}, {
   3.4043002135695343`*^9, 3.4043002231947346`*^9}, {3.4044649846669784`*^9, 
   3.4044650123383217`*^9}, {3.4044650477751417`*^9, 
   3.4044651238049316`*^9}, {3.404465582921117*^9, 3.4044656190610476`*^9}, {
   3.4044656599352627`*^9, 3.4044656716225386`*^9}, {3.4044670806423597`*^9, 
   3.404467083939172*^9}, {3.4044685611608086`*^9, 3.4044685642701235`*^9}, {
   3.4044686800022764`*^9, 3.4044687901564116`*^9}, {3.4044707796025887`*^9, 
   3.4044707807275667`*^9}, 3.404652171754368*^9, {3.4046522684124737`*^9, 
   3.404652301397482*^9}, 3.4048112137223434`*^9, {3.4048113224921446`*^9, 
   3.4048113889321957`*^9}, 3.404826533466849*^9, {3.404826732521367*^9, 
   3.404826749568897*^9}, 3.4051647325780554`*^9, {3.405165151291899*^9, 
   3.4051652061058025`*^9}, {3.4051653156086054`*^9, 3.405165325483858*^9}, {
   3.405165713493791*^9, 3.405165736338126*^9}, {3.4051706650736732`*^9, 
   3.4051707229657803`*^9}, {3.405170756826022*^9, 3.405170757685419*^9}, {
   3.4051708129680843`*^9, 3.40517084365637*^9}, {3.4051709842849703`*^9, 
   3.4051709871912947`*^9}, {3.4051711665083847`*^9, 
   3.4051711773680377`*^9}, {3.405186211332777*^9, 3.4051863222019773`*^9}, {
   3.405186712950777*^9, 3.4051870170727773`*^9}, {3.4051870853695774`*^9, 
   3.405187263162777*^9}, {3.405187307544777*^9, 3.405187352800377*^9}, {
   3.4051873882279773`*^9, 3.4051874194123774`*^9}, {3.405187649668377*^9, 
   3.405187689105177*^9}, {3.405187871968377*^9, 3.4051878824047775`*^9}, {
   3.4053351648457947`*^9, 3.405335187198795*^9}, 3.405335281506795*^9, {
   3.4053353347367945`*^9, 3.4053353487667947`*^9}, {3.405336563610795*^9, 
   3.405336563664795*^9}, {3.405347300329812*^9, 3.405347317408374*^9}, 
   3.405868424913466*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["Fourier Transform of the payoff", "Subsubtitle",
 CellChangeTimes->{{3.4047174737434516`*^9, 3.404717491805258*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PaysFloat2DigitalPayOffFourierDroite", "[", 
   RowBox[{
   "k1_", ",", "k2_", ",", "K_", ",", "\[Alpha]_", ",", "\[Beta]_", ",", "a_",
     ",", "b_", ",", "c_"}], "]"}], ":=", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", "  ", 
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox["\[Beta]", "\[Alpha]"], ")"}], 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]], "    ", 
    RowBox[{"Hypergeometric2F1", "[", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}], ",", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"a", " ", "c"}], "+", 
         RowBox[{"\[ImaginaryI]", " ", "b", " ", "k1"}], "+", 
         RowBox[{"\[ImaginaryI]", " ", "a", " ", "k2"}]}], 
        RowBox[{"a", " ", "b"}]]}], ",", 
      RowBox[{"1", "-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"], "-", 
       FractionBox[
        RowBox[{"c", "+", 
         RowBox[{"\[ImaginaryI]", " ", "k2"}]}], "b"]}], ",", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{" ", "K"}], "\[Beta]"]}]}], "]"}]}], 
   RowBox[{"b", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"], "+", 
      FractionBox[
       RowBox[{"c", "+", 
        RowBox[{"\[ImaginaryI]", " ", "k2"}]}], "b"]}], ")"}], "k1", 
    "   "}]]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4048102845616646`*^9, 3.404810294702679*^9}, {
   3.4048103293758855`*^9, 3.404810338454359*^9}, {3.404810451536826*^9, 
   3.404810619137012*^9}, {3.40481068953034*^9, 3.404810710187383*^9}, 
   3.4051647566724224`*^9, 3.4051649030980453`*^9, {3.4051679186127405`*^9, 
   3.4051679208471727`*^9}, 3.405170554305213*^9, 3.4053351958737946`*^9, {
   3.4053352880787945`*^9, 3.4053352927417946`*^9}, 3.4053355759587946`*^9, {
   3.4053356357667947`*^9, 3.4053356444657946`*^9}, 3.405335693690795*^9, {
   3.405335859763795*^9, 3.405335860336795*^9}, 3.405336563549795*^9, {
   3.405347322095994*^9, 3.4053473225335054`*^9}, {3.4053532194969635`*^9, 
   3.4053532573416824`*^9}, {3.405353293170725*^9, 3.405353300342783*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"si", "  ", 
   RowBox[{"Im", "[", "k2", "]"}]}], ">", 
  RowBox[{"c", " ", "-", 
   RowBox[{
    FractionBox[
     RowBox[{" ", "b"}], "a"], 
    RowBox[{"Im", "[", " ", "k1", " ", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.4053358516447945`*^9, 3.4053358526967945`*^9}, {
   3.405336037966795*^9, 3.4053360487597947`*^9}, 3.4053534025797753`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PaysFloat2DigitalPayOffFourierGauche", "[", 
   RowBox[{
   "k1_", ",", "k2_", ",", "K_", ",", "\[Alpha]_", ",", "\[Beta]_", ",", "a_",
     ",", "b_", ",", "c_"}], "]"}], ":=", "  ", 
  RowBox[{
   FractionBox[
    RowBox[{"\[ImaginaryI]", "  ", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox["K", "\[Alpha]"], ")"}], 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]], "  "}], 
    RowBox[{"k1", " ", 
     RowBox[{"(", 
      RowBox[{"c", "+", 
       RowBox[{"\[ImaginaryI]", " ", "k2"}]}], ")"}]}]], 
   RowBox[{"Hypergeometric2F1", "[", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}], ",", 
     FractionBox[
      RowBox[{"c", "+", 
       RowBox[{"\[ImaginaryI]", " ", "k2"}]}], "b"], ",", 
     FractionBox[
      RowBox[{"b", "+", "c", "+", 
       RowBox[{"\[ImaginaryI]", " ", "k2"}]}], "b"], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{" ", "\[Beta]"}], "K"]}]}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.404809293461108*^9, 3.4048092956643176`*^9}, 
   3.4048093674014473`*^9, {3.4048094552954473`*^9, 3.404809463092622*^9}, {
   3.4048095314233704`*^9, 3.4048095442363625`*^9}, {3.404809605191828*^9, 
   3.4048096283333416`*^9}, {3.404809817199969*^9, 3.4048098448885317`*^9}, {
   3.4048099035782857`*^9, 3.4048099656900454`*^9}, {3.4048100079572935`*^9, 
   3.4048100840852165`*^9}, 3.405164762141312*^9, 3.4051648317993455`*^9, 
   3.4051652997488246`*^9, {3.4051678858306513`*^9, 3.4051678890807347`*^9}, 
   3.4051705136947985`*^9, 3.4053352020757947`*^9, {3.4053352966947947`*^9, 
   3.4053352999607944`*^9}, 3.405335578221795*^9, 3.4053356412227945`*^9, {
   3.405335863308795*^9, 3.405335863967795*^9}, 3.4053365635557947`*^9, {
   3.4053473255335817`*^9, 3.405347325939842*^9}, {3.405352849971879*^9, 
   3.405352859612751*^9}, {3.405352919083023*^9, 3.4053529380053825`*^9}, {
   3.4053531944181967`*^9, 3.4053531998089595`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"si", "     ", 
   RowBox[{"Im", "[", "k2", "]"}]}], "<", "c"}]], "Input",
 CellChangeTimes->{{3.4053358480027947`*^9, 3.405335849103795*^9}, {
  3.405336055830795*^9, 3.405336059879795*^9}, {3.4053533818448696`*^9, 
  3.405353385501213*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{"/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Alpha]", "\[Rule]", "1"}], ",", 
     RowBox[{"\[Beta]", "\[Rule]", "1"}], ",", 
     RowBox[{"a", "\[Rule]", "1"}], ",", 
     RowBox[{"b", "\[Rule]", "1"}]}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.40516580837122*^9, 3.4051658284342337`*^9}, 
   3.4051679772704926`*^9, 3.405170518288666*^9, 3.405335583356795*^9}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   SuperscriptBox["K", 
    RowBox[{"1", "+", 
     RowBox[{"\[ImaginaryI]", " ", "k1"}], "+", 
     RowBox[{"\[ImaginaryI]", " ", "k2"}]}]], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"\[ImaginaryI]", " ", "k1"}], "+", 
      RowBox[{"\[ImaginaryI]", " ", "k2"}]}], ")"}], " ", "k2", " ", 
    RowBox[{"(", 
     RowBox[{"k1", "+", "k2"}], ")"}]}]]}]], "Output",
 CellChangeTimes->{3.4051658301374025`*^9, 3.4051679803174458`*^9, 
  3.40517052119499*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.405334824658795*^9, 3.4053348257487946`*^9}}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Appendix", "Subtitle",
 CellChangeTimes->{{3.4047175599135294`*^9, 3.4047175674760294`*^9}}],

Cell["Handling", "Text",
 CellChangeTimes->{{3.4059584675710735`*^9, 3.405958469274232*^9}}],

Cell[CellGroupData[{

Cell["Smart Parametrization", "Subsubtitle",
 CellChangeTimes->{{3.404383407939944*^9, 3.404383415193944*^9}, {
  3.404387350604344*^9, 3.404387351228344*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"IntegerConvert", "[", 
   RowBox[{"x_", ",", 
    RowBox[{"{", 
     RowBox[{"x1_", ",", "n1_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x2_", ",", "n2_"}], "}"}], ",", "nmax_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"ntheo", "=", 
      RowBox[{"n1", "+", 
       RowBox[{"Max", "[", 
        RowBox[{"0", ",", 
         RowBox[{"Floor", "[", 
          RowBox[{
           FractionBox[
            RowBox[{"(", 
             RowBox[{"x", "-", "x1"}], ")"}], 
            RowBox[{"x2", "-", "x1"}]], 
           RowBox[{"(", 
            RowBox[{"n2", "-", "n1"}], ")"}]}], "]"}]}], "]"}]}]}], "}"}], 
    ",", 
    RowBox[{"Min", "[", 
     RowBox[{"ntheo", ",", "nmax"}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4043857627583437`*^9, 3.404385968413144*^9}, {
  3.4043860143551435`*^9, 3.404386188295144*^9}, {3.404386488423544*^9, 
  3.404386499842744*^9}, {3.4043868353675437`*^9, 3.4043868551171436`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RealConvert", "[", 
   RowBox[{"x_", ",", 
    RowBox[{"{", 
     RowBox[{"x1_", ",", "n1_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x2_", ",", "n2_"}], "}"}], ",", "nmax_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"ntheo", "=", 
      RowBox[{"n1", "+", 
       RowBox[{"Max", "[", 
        RowBox[{"0", ",", 
         RowBox[{
          FractionBox[
           RowBox[{"(", 
            RowBox[{"x", "-", "x1"}], ")"}], 
           RowBox[{"x2", "-", "x1"}]], 
          RowBox[{"(", 
           RowBox[{"n2", "-", "n1"}], ")"}]}]}], "]"}]}]}], "}"}], ",", 
    RowBox[{"Min", "[", 
     RowBox[{"ntheo", ",", "nmax"}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4043857627583437`*^9, 3.404385968413144*^9}, {
  3.4043860143551435`*^9, 3.404386188295144*^9}, {3.404386488423544*^9, 
  3.404386499842744*^9}, {3.4043868353675437`*^9, 3.4043868551171436`*^9}, {
  3.404388169729144*^9, 3.4043881842371435`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"BiHestonVanillaOptimalParameters", "[", 
   RowBox[{
   "S_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "a1_", ",", "b1_", ",", 
    "K_", ",", "\[Tau]_", ",", "\[CapitalSigma]_", ",", "M_", ",", 
    "\[CapitalSigma]inf_", ",", "Q_", ",", "\[Rho]_", ",", "\[Mu]_", ",", 
    "type_"}], "]"}], ":=", 
  RowBox[{"BiHestonVanillaOptimalParameters", "[", 
   RowBox[{
   "S", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "a1", ",", "b1", ",", "K", 
    ",", "\[Tau]", ",", "\[CapitalSigma]", ",", "M", ",", 
    "\[CapitalSigma]inf", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", "type", 
    ",", "0"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.40509198185186*^9, 3.4050920328531656`*^9}, 
   3.4051008422901726`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BiHestonVanillaOptimalParameters", "[", 
    RowBox[{
    "S_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "a1_", ",", "b1_", ",", 
     "K_", ",", "\[Tau]_", ",", "\[CapitalSigma]_", ",", "M_", ",", 
     "\[CapitalSigma]inf_", ",", "Q_", ",", "\[Rho]_", ",", "\[Mu]_", ",", 
     "type_", ",", "printflag_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Lambda]1", ",", "\[Lambda]2", ",", "scope1", ",", "scope2", ",", 
       "Nb1", ",", "LegendreCoef1", ",", "Nb1n", ",", "LegendreCoef1n", ",", 
       "period1", ",", "period1n", ",", "\[Epsilon]1", ",", "Nb2", ",", 
       "LegendreCoef2", ",", "period2", ",", "period2n", ",", "\[Epsilon]2", 
       ",", "imax", ",", 
       RowBox[{"s1", "=", 
        RowBox[{"S", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", 
       RowBox[{"s2", "=", 
        RowBox[{"S", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ",", "Rmax", ",", "smax", ",", 
       "smin", ",", 
       RowBox[{"forward", "=", 
        RowBox[{
         RowBox[{"S", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "-", 
         RowBox[{"S", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
       RowBox[{"scopeDivisor1", "=", "1"}], ",", 
       RowBox[{"scopeDivisor1n", "=", "1"}], ",", 
       RowBox[{"scopeDivisor2", "=", "1"}], ",", 
       RowBox[{"scopeDivisor2n", "=", "1"}], ",", "VolNb", ",", 
       "\[CapitalSigma]moyen", ",", "startmonitortime", ",", 
       "plafondexplosion", ",", "initialTailFlag", ",", "InitialTailPosition",
        ",", "InitialTailPosition2", ",", "kmax", ",", "StartControl", ",", 
       "IncrementFactor"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"defaut", " ", "parameters"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[CapitalSigma]moyen", "=", 
       FractionBox[
        RowBox[{
         RowBox[{"\[CapitalSigma]", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], "+", 
         RowBox[{"\[CapitalSigma]", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}], "+", 
         RowBox[{"\[CapitalSigma]inf", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], "+", 
         RowBox[{"\[CapitalSigma]inf", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "4"]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"scope1", "=", 
       FractionBox["3", 
        SqrtBox[
         RowBox[{"\[CapitalSigma]moyen", " ", "\[Tau]"}]]]}], ";", 
      RowBox[{"scope2", "=", 
       FractionBox["4", 
        SqrtBox[
         RowBox[{"\[CapitalSigma]moyen", " ", "\[Tau]"}]]]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Nb1", "=", "12"}], ";", 
      RowBox[{"Nb1n", "=", "8"}], ";", 
      RowBox[{"Nb2", "=", "12"}], ";", "\[IndentingNewLine]", 
      RowBox[{"period1", "=", 
       RowBox[{"scope1", "*", " ", "1.21"}]}], ";", 
      RowBox[{"period1n", "=", "scope1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"period2", "=", "scope2"}], ";", 
      RowBox[{"period2n", "=", 
       RowBox[{"scope2", "/", "10"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"non", " ", "default"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"type", "\[Equal]", "\"\<VanillaSpreadoption\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[Lambda]1", "=", "1.1"}], ";", 
         RowBox[{"\[Lambda]2", "=", "1.01"}], ";", "\[IndentingNewLine]", 
         RowBox[{"smin", "=", 
          RowBox[{"Min", "[", 
           RowBox[{
            RowBox[{"\[Alpha]1", " ", "s1"}], ",", 
            RowBox[{"\[Beta]1", " ", "s2"}]}], "]"}]}], ";", 
         RowBox[{"smax", "=", 
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{"\[Alpha]1", " ", "s1"}], ",", 
            RowBox[{"\[Beta]1", " ", "s2"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"K", "\[NotEqual]", " ", "0"}], ",", "\[IndentingNewLine]",
            
           RowBox[{
            RowBox[{"Nb1", "=", 
             RowBox[{"IntegerConvert", "[", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"Log", "[", 
                 FractionBox[
                  RowBox[{"Abs", "[", "K", "]"}], "smax"], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "12"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"6", ",", "12"}], "}"}], ",", "130"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Nb1n", "=", 
             RowBox[{"IntegerConvert", "[", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"Log", "[", 
                 FractionBox[
                  RowBox[{"Abs", "[", "K", "]"}], "smax"], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "8"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"6", ",", "8"}], "}"}], ",", "130"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Nb2", "=", 
             RowBox[{"IntegerConvert", "[", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"Log", "[", 
                 FractionBox[
                  RowBox[{"Abs", "[", "K", "]"}], "smax"], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "12"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"6", ",", "12"}], "}"}], ",", "130"}], "]"}]}]}]}], 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Nb1", "=", 
          RowBox[{"Max", "[", 
           RowBox[{"Nb1", ",", 
            RowBox[{"IntegerConvert", "[", 
             RowBox[{
              FractionBox[
               RowBox[{"smax", "-", "smin"}], "smax"], ",", 
              RowBox[{"{", 
               RowBox[{"0.1", ",", "12"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0.9", ",", "30"}], "}"}], ",", "130"}], "]"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Nb1n", "=", 
          RowBox[{"Max", "[", 
           RowBox[{"Nb1n", ",", 
            RowBox[{"IntegerConvert", "[", 
             RowBox[{
              FractionBox[
               RowBox[{"smax", "-", "smin"}], "smax"], ",", 
              RowBox[{"{", 
               RowBox[{"0.1", ",", "8"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0.9", ",", "20"}], "}"}], ",", "130"}], "]"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Nb2", "=", 
          RowBox[{"Max", "[", 
           RowBox[{"Nb2", ",", 
            RowBox[{"IntegerConvert", "[", 
             RowBox[{
              FractionBox[
               RowBox[{"smax", "-", "smin"}], "smax"], ",", 
              RowBox[{"{", 
               RowBox[{"0.1", ",", "12"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0.9", ",", "30"}], "}"}], ",", "130"}], "]"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Nb1", "=", 
          RowBox[{"Max", "[", 
           RowBox[{"Nb1", ",", 
            RowBox[{"IntegerConvert", "[", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"Log", "[", 
                FractionBox["smin", "smax"], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"0.01", ",", "12"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"2", ",", "20"}], "}"}], ",", "130"}], "]"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Nb1n", "=", 
          RowBox[{"Max", "[", 
           RowBox[{"Nb1n", ",", 
            RowBox[{"IntegerConvert", "[", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"Log", "[", 
                FractionBox["smin", "smax"], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"0.01", ",", "8"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"2", ",", "16"}], "}"}], ",", "130"}], "]"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Nb2", "=", 
          RowBox[{"Max", "[", 
           RowBox[{"Nb2", ",", 
            RowBox[{"IntegerConvert", "[", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"Log", "[", 
                FractionBox["smin", "smax"], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"0.01", ",", "12"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"2", ",", "20"}], "}"}], ",", "130"}], "]"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"K", "\[NotEqual]", "0"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"scopeDivisor1", "=", 
             RowBox[{"RealConvert", "[", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"Log", "[", 
                 FractionBox[
                  RowBox[{"Abs", "[", "K", "]"}], "smax"], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"6", ",", "1"}], "}"}], ",", "2"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"scopeDivisor1n", "=", 
             RowBox[{"RealConvert", "[", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"Log", "[", 
                 FractionBox[
                  RowBox[{"Abs", "[", "K", "]"}], "smax"], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"6", ",", "1"}], "}"}], ",", "2"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"scopeDivisor2", "=", 
             RowBox[{"RealConvert", "[", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"Log", "[", 
                 FractionBox[
                  RowBox[{"Abs", "[", "K", "]"}], "smax"], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"6", ",", "1"}], "}"}], ",", "2"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"scopeDivisor2n", "=", 
             RowBox[{"RealConvert", "[", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"Log", "[", 
                 FractionBox[
                  RowBox[{"Abs", "[", "K", "]"}], "smax"], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"6", ",", "4"}], "}"}], ",", "4"}], "]"}]}]}]}], 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"scopeDivisor1", "=", 
          RowBox[{"Max", "[", 
           RowBox[{"scopeDivisor1", ",", 
            RowBox[{"RealConvert", "[", 
             RowBox[{
              FractionBox[
               RowBox[{"smax", "-", "smin"}], "smax"], ",", 
              RowBox[{"{", 
               RowBox[{"0.1", ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0.9", ",", "2"}], "}"}], ",", "2"}], "]"}]}], "]"}]}],
          ";", "\[IndentingNewLine]", 
         RowBox[{"scopeDivisor1n", "=", 
          RowBox[{"Max", "[", 
           RowBox[{"scopeDivisor1n", ",", 
            RowBox[{"RealConvert", "[", 
             RowBox[{
              FractionBox[
               RowBox[{"smax", "-", "smin"}], "smax"], ",", 
              RowBox[{"{", 
               RowBox[{"0.1", ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0.9", ",", "4"}], "}"}], ",", "4"}], "]"}]}], "]"}]}],
          ";", "\[IndentingNewLine]", 
         RowBox[{"scopeDivisor2", "=", 
          RowBox[{"Max", "[", 
           RowBox[{"scopeDivisor2", ",", 
            RowBox[{"RealConvert", "[", 
             RowBox[{
              FractionBox[
               RowBox[{"smax", "-", "smin"}], "smax"], ",", 
              RowBox[{"{", 
               RowBox[{"0.1", ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0.9", ",", "1"}], "}"}], ",", "2"}], "]"}]}], "]"}]}],
          ";", "\[IndentingNewLine]", 
         RowBox[{"scopeDivisor2n", "=", 
          RowBox[{"Max", "[", 
           RowBox[{"scopeDivisor2n", ",", 
            RowBox[{"RealConvert", "[", 
             RowBox[{
              FractionBox[
               RowBox[{"smax", "-", "smin"}], "smax"], ",", 
              RowBox[{"{", 
               RowBox[{"0.1", ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0.9", ",", "4"}], "}"}], ",", "4"}], "]"}]}], "]"}]}],
          ";", "\[IndentingNewLine]", 
         RowBox[{"\[Epsilon]1", "=", "0.000001"}], ";", 
         RowBox[{"\[Epsilon]2", "=", "0.000001"}], ";", 
         RowBox[{"imax", "=", "20"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"type", "\[Equal]", "\"\<Underlying2Option\>\""}], ")"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[Lambda]1", "=", "2"}], ";", 
         RowBox[{"\[Lambda]2", "=", "1.1"}], ";", "\[IndentingNewLine]", 
         RowBox[{"scope1", "=", 
          FractionBox["2", 
           SqrtBox[
            RowBox[{"\[CapitalSigma]moyen", " ", "\[Tau]"}]]]}], ";", 
         RowBox[{"scope2", "=", 
          FractionBox["3", 
           SqrtBox[
            RowBox[{"\[CapitalSigma]moyen", " ", "\[Tau]"}]]]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Nb1", "=", "30"}], ";", 
         RowBox[{"Nb1n", "=", "20"}], ";", 
         RowBox[{"Nb2", "=", "30"}], ";", "\[IndentingNewLine]", 
         RowBox[{"period1", "=", "scope1"}], ";", 
         RowBox[{"period1n", "=", "scope1"}], ";", "\[IndentingNewLine]", 
         RowBox[{"period2", "=", "scope2"}], ";", 
         RowBox[{"period2n", "=", 
          RowBox[{"scope2", "/", "10"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Nb1", "=", 
          RowBox[{"IntegerConvert", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Log", "[", 
              RowBox[{"\[CapitalSigma]", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "2"}], "]"}], "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"3", ",", "30"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"6", ",", "60"}], "}"}], ",", "130"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Nb1n", "=", 
          RowBox[{"IntegerConvert", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Log", "[", 
              RowBox[{"\[CapitalSigma]", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "2"}], "]"}], "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"3", ",", "20"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"6", ",", "30"}], "}"}], ",", "130"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Nb2", "=", 
          RowBox[{"IntegerConvert", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Log", "[", 
              RowBox[{"\[CapitalSigma]", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "2"}], "]"}], "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"3", ",", "30"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"6", ",", "50"}], "}"}], ",", "130"}], "]"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"type", "\[Equal]", "\"\<MaxOption\>\""}], ")"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[Lambda]1", "=", "2"}], ";", 
         RowBox[{"\[Lambda]2", "=", "1.1"}], ";", "\[IndentingNewLine]", 
         RowBox[{"scope1", "=", 
          FractionBox["5", 
           SqrtBox[
            RowBox[{"\[CapitalSigma]moyen", " ", "\[Tau]"}]]]}], ";", 
         RowBox[{"scope2", "=", 
          FractionBox["5", 
           SqrtBox[
            RowBox[{"\[CapitalSigma]moyen", " ", "\[Tau]"}]]]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Nb1", "=", "30"}], ";", 
         RowBox[{"Nb1n", "=", "20"}], ";", 
         RowBox[{"Nb2", "=", "30"}], ";", "\[IndentingNewLine]", 
         RowBox[{"period1", "=", "scope1"}], ";", 
         RowBox[{"period1n", "=", "scope1"}], ";", "\[IndentingNewLine]", 
         RowBox[{"period2", "=", "scope2"}], ";", 
         RowBox[{"period2n", "=", 
          RowBox[{"scope2", "/", "10"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Nb1", "=", 
          RowBox[{"IntegerConvert", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Log", "[", 
              RowBox[{"\[CapitalSigma]", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "2"}], "]"}], "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"3", ",", "30"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"6", ",", "60"}], "}"}], ",", "130"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Nb1n", "=", 
          RowBox[{"IntegerConvert", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Log", "[", 
              RowBox[{"\[CapitalSigma]", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "2"}], "]"}], "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"3", ",", "20"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"6", ",", "30"}], "}"}], ",", "130"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Nb2", "=", 
          RowBox[{"IntegerConvert", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Log", "[", 
              RowBox[{"\[CapitalSigma]", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "2"}], "]"}], "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"3", ",", "30"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"6", ",", "50"}], "}"}], ",", "130"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"\[Epsilon]1", "=", "0.000001"}], ";", 
         RowBox[{"\[Epsilon]2", "=", "0.000001"}], ";", 
         RowBox[{"imax", "=", "20"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"a1", "\[NotEqual]", "1"}], " ", "||", " ", 
         RowBox[{"b1", "\[NotEqual]", "1"}]}], ",", 
        RowBox[{"Nb2", "=", 
         RowBox[{"Max", "[", 
          RowBox[{"Nb2", ",", "20"}], "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"VolNb", "=", 
       RowBox[{"RealConvert", "[", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Log", "[", "\[CapitalSigma]moyen", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"3", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"6.9", ",", "4.1"}], "}"}], ",", "10"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Nb1", "=", 
       RowBox[{"Floor", "[", 
        RowBox[{"Nb1", "*", "VolNb"}], "]"}]}], ";", 
      RowBox[{"Nb2", "=", 
       RowBox[{"Floor", "[", 
        RowBox[{"Nb2", "*", "VolNb"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Nb2", "=", 
       RowBox[{"Min", "[", 
        RowBox[{"Nb2", ",", "80"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"period1", " ", "/=", "scopeDivisor1"}], ";", 
      RowBox[{"period1n", " ", "/=", "scopeDivisor1n"}], ";", 
      RowBox[{"period2", " ", "/=", "scopeDivisor2"}], ";", 
      RowBox[{"period2n", " ", "/=", "scopeDivisor2n"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"type", "\[Equal]", "\"\<Underlying1Option\>\""}], ")"}], 
        ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"scope1", "=", 
           FractionBox["3", 
            SqrtBox[
             RowBox[{"\[CapitalSigma]moyen", " ", "\[Tau]"}]]]}], ";", 
          RowBox[{"scope2", "=", 
           FractionBox["4", 
            SqrtBox[
             RowBox[{"\[CapitalSigma]moyen", " ", "\[Tau]"}]]]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Nb1", "=", "30"}], ";", 
          RowBox[{"Nb1n", "=", "20"}], ";", 
          RowBox[{"Nb2", "=", "30"}], ";", "\[IndentingNewLine]", 
          RowBox[{"period1", "=", 
           RowBox[{"scope1", "*", "1.21"}]}], ";", 
          RowBox[{"period1n", "=", "scope1"}], ";", "\[IndentingNewLine]", 
          RowBox[{"period2", "=", "scope2"}], ";", 
          RowBox[{"period2n", "=", 
           RowBox[{"scope2", "/", "10"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Nb1", "=", 
           RowBox[{"IntegerConvert", "[", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"Log", "[", 
               RowBox[{"\[CapitalSigma]", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"3", ",", "30"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"6", ",", "30"}], "}"}], ",", "130"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Nb1n", "=", 
           RowBox[{"IntegerConvert", "[", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"Log", "[", 
               RowBox[{"\[CapitalSigma]", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"3", ",", "30"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"6", ",", "30"}], "}"}], ",", "130"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Nb2", "=", 
           RowBox[{"IntegerConvert", "[", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"Log", "[", 
               RowBox[{"\[CapitalSigma]", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"3", ",", "30"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"6", ",", "50"}], "}"}], ",", "130"}], "]"}]}], ";"}], 
         "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\[Lambda]1", "=", "2"}], ";", 
          RowBox[{"\[Lambda]2", "=", "1.1"}], ";", 
          RowBox[{"imax", "=", "10"}], ";", "\[IndentingNewLine]", 
          RowBox[{"period1", "=", "7"}], ";", 
          RowBox[{"period1n", "=", "5"}], ";", 
          RowBox[{"period2", "=", "6"}], ";", 
          RowBox[{"period2n", "=", "2"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Nb1", "=", "25"}], ";", 
          RowBox[{"Nb2", "=", "20"}], ";", 
          RowBox[{"Nb1n", "=", "10"}], ";", 
          RowBox[{"\[Epsilon]1", "=", "0.0000001"}], ";", 
          RowBox[{"\[Epsilon]2", "=", "0.000001"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"startmonitortime", "=", "10"}], ";", "\[IndentingNewLine]",
           
          RowBox[{"plafondexplosion", "=", "0.1"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"initialTailFlag", "=", "0"}], ";", "\[IndentingNewLine]", 
          RowBox[{"InitialTailPosition", "=", "0"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"InitialTailPosition2", "=", "0"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"kmax", "=", "1000"}], ";", "\[IndentingNewLine]", 
          RowBox[{"StartControl", "=", "30"}], ";", "\[IndentingNewLine]", 
          RowBox[{"IncrementFactor", "=", "4"}], ";"}], "\[IndentingNewLine]",
          "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[Lambda]1", "=", "2"}], ";", 
         RowBox[{"\[Lambda]2", "=", "1.1"}], ";", 
         RowBox[{"imax", "=", "10"}], ";", "\[IndentingNewLine]", 
         RowBox[{"period1", "=", "4"}], ";", 
         RowBox[{"period1n", "=", "2"}], ";", 
         RowBox[{"period2", "=", "6"}], ";", 
         RowBox[{"period2n", "=", "3"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Nb1", "=", "35"}], ";", 
         RowBox[{"Nb2", "=", "20"}], ";", 
         RowBox[{"Nb1n", "=", "10"}], ";", 
         RowBox[{"\[Epsilon]1", "=", "0.0000001"}], ";", 
         RowBox[{"\[Epsilon]2", "=", "0.000001"}], ";", "\[IndentingNewLine]",
          
         RowBox[{"startmonitortime", "=", "10"}], ";", "\[IndentingNewLine]", 
         
         RowBox[{"plafondexplosion", "=", "0.1"}], ";", "\[IndentingNewLine]",
          
         RowBox[{"initialTailFlag", "=", "0"}], ";", "\[IndentingNewLine]", 
         RowBox[{"InitialTailPosition", "=", "0"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"InitialTailPosition2", "=", "0"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"kmax", "=", "1000"}], ";", "\[IndentingNewLine]", 
         RowBox[{"StartControl", "=", "30"}], ";", "\[IndentingNewLine]", 
         RowBox[{"IncrementFactor", "=", "4"}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"avec", " ", "correlation"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"\[Lambda]1", "=", "2"}], ";", 
         RowBox[{"\[Lambda]2", "=", "1.1"}], ";", 
         RowBox[{"imax", "=", "10"}], ";", "\[IndentingNewLine]", 
         RowBox[{"period1", "=", "5"}], ";", 
         RowBox[{"period1n", "=", "2"}], ";", 
         RowBox[{"period2", "=", "6"}], ";", 
         RowBox[{"period2n", "=", "2"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Nb1", "=", "35"}], ";", 
         RowBox[{"Nb2", "=", "30"}], ";", 
         RowBox[{"Nb1n", "=", "10"}], ";", 
         RowBox[{"\[Epsilon]1", "=", "0.0000001"}], ";", 
         RowBox[{"\[Epsilon]2", "=", "0.000001"}], ";", "\[IndentingNewLine]",
          
         RowBox[{"startmonitortime", "=", "10"}], ";", "\[IndentingNewLine]", 
         
         RowBox[{"plafondexplosion", "=", "0.1"}], ";", "\[IndentingNewLine]",
          
         RowBox[{"initialTailFlag", "=", "1"}], ";", "\[IndentingNewLine]", 
         RowBox[{"InitialTailPosition", "=", "0.5"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"InitialTailPosition2", "=", "0.5"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"kmax", "=", "16"}], ";", "\[IndentingNewLine]", 
         RowBox[{"StartControl", "=", "30"}], ";", "\[IndentingNewLine]", 
         RowBox[{"IncrementFactor", "=", "4"}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"model", " ", "de", " ", "marche"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"\[Lambda]1", "=", "2"}], ";", 
         RowBox[{"\[Lambda]2", "=", "1.1"}], ";", 
         RowBox[{"imax", "=", "60"}], ";", "\[IndentingNewLine]", 
         RowBox[{"period1", "=", "1"}], ";", 
         RowBox[{"period1n", "=", "3"}], ";", 
         RowBox[{"period2", "=", "1"}], ";", 
         RowBox[{"period2n", "=", "2"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Nb1", "=", "30"}], ";", 
         RowBox[{"Nb2", "=", "20"}], ";", 
         RowBox[{"Nb1n", "=", "8"}], ";", 
         RowBox[{"\[Epsilon]1", "=", "0.0000001"}], ";", 
         RowBox[{"\[Epsilon]2", "=", "0.00000001"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"startmonitortime", "=", "10"}], ";", "\[IndentingNewLine]", 
         
         RowBox[{"plafondexplosion", "=", "0.1"}], ";", "\[IndentingNewLine]",
          
         RowBox[{"initialTailFlag", "=", "1"}], ";", "\[IndentingNewLine]", 
         RowBox[{"InitialTailPosition", "=", "0.5"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"InitialTailPosition2", "=", "0.5"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"kmax", "=", "16"}], ";", "\[IndentingNewLine]", 
         RowBox[{"StartControl", "=", "30"}], ";", "\[IndentingNewLine]", 
         RowBox[{"IncrementFactor", "=", "4"}], ";"}]}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"type", "\[Equal]", "\"\<Underlying2Option\>\""}], ")"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[Lambda]1", "=", "2"}], ";", 
         RowBox[{"\[Lambda]2", "=", "1.2"}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"scope1", "=", 
            FractionBox["2", 
             SqrtBox[
              RowBox[{"\[CapitalSigma]moyen", " ", "\[Tau]"}]]]}], ";", 
           RowBox[{"scope2", "=", 
            FractionBox["3", 
             SqrtBox[
              RowBox[{"\[CapitalSigma]moyen", " ", "\[Tau]"}]]]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Nb1", "=", "30"}], ";", 
           RowBox[{"Nb1n", "=", "20"}], ";", 
           RowBox[{"Nb2", "=", "30"}], ";", "\[IndentingNewLine]", 
           RowBox[{"period1", "=", "scope1"}], ";", 
           RowBox[{"period1n", "=", "scope1"}], ";", "\[IndentingNewLine]", 
           RowBox[{"period2", "=", "scope2"}], ";", 
           RowBox[{"period2n", "=", 
            RowBox[{"scope2", "/", "10"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Nb1", "=", 
            RowBox[{"IntegerConvert", "[", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"Log", "[", 
                RowBox[{"\[CapitalSigma]", "[", 
                 RowBox[{"[", 
                  RowBox[{"2", ",", "2"}], "]"}], "]"}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"3", ",", "30"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"6", ",", "60"}], "}"}], ",", "130"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Nb1n", "=", 
            RowBox[{"IntegerConvert", "[", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"Log", "[", 
                RowBox[{"\[CapitalSigma]", "[", 
                 RowBox[{"[", 
                  RowBox[{"2", ",", "2"}], "]"}], "]"}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"3", ",", "20"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"6", ",", "30"}], "}"}], ",", "130"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Nb2", "=", 
            RowBox[{"IntegerConvert", "[", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"Log", "[", 
                RowBox[{"\[CapitalSigma]", "[", 
                 RowBox[{"[", 
                  RowBox[{"2", ",", "2"}], "]"}], "]"}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"3", ",", "30"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"6", ",", "50"}], "}"}], ",", "130"}], "]"}]}], ";"}], 
          "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"\[Lambda]1", "=", "2"}], ";", 
           RowBox[{"\[Lambda]2", "=", "2"}], ";", 
           RowBox[{"imax", "=", "60"}], ";", "\[IndentingNewLine]", 
           RowBox[{"period1", "=", "1"}], ";", 
           RowBox[{"period1n", "=", "3"}], ";", 
           RowBox[{"period2", "=", "1"}], ";", 
           RowBox[{"period2n", "=", "2"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Nb1", "=", "25"}], ";", 
           RowBox[{"Nb2", "=", "15"}], ";", 
           RowBox[{"Nb1n", "=", "8"}], ";", 
           RowBox[{"\[Epsilon]1", "=", "0.00001"}], ";", 
           RowBox[{"\[Epsilon]2", "=", "0.0001"}], ";", "\[IndentingNewLine]",
            
           RowBox[{"startmonitortime", "=", "10"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"plafondexplosion", "=", "1"}], ";", "\[IndentingNewLine]",
            
           RowBox[{"initialTailFlag", "=", "1"}], ";", "\[IndentingNewLine]", 
           
           RowBox[{"InitialTailPosition", "=", "0.05"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"InitialTailPosition2", "=", "0.05"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"kmax", "=", "100"}], ";", "\[IndentingNewLine]", 
           RowBox[{"StartControl", "=", "3"}], ";", "\[IndentingNewLine]", 
           RowBox[{"IncrementFactor", "=", "2"}], ";"}], 
          "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"\[Lambda]1", "=", "2"}], ";", 
         RowBox[{"\[Lambda]2", "=", "2"}], ";", 
         RowBox[{"imax", "=", "60"}], ";", "\[IndentingNewLine]", 
         RowBox[{"period1", "=", "3"}], ";", 
         RowBox[{"period1n", "=", "3"}], ";", 
         RowBox[{"period2", "=", "5"}], ";", 
         RowBox[{"period2n", "=", "2"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Nb1", "=", "25"}], ";", 
         RowBox[{"Nb2", "=", "15"}], ";", 
         RowBox[{"Nb1n", "=", "8"}], ";", 
         RowBox[{"\[Epsilon]1", "=", "0.00001"}], ";", 
         RowBox[{"\[Epsilon]2", "=", "0.0001"}], ";", "\[IndentingNewLine]", 
         RowBox[{"startmonitortime", "=", "10"}], ";", "\[IndentingNewLine]", 
         
         RowBox[{"plafondexplosion", "=", "1"}], ";", "\[IndentingNewLine]", 
         RowBox[{"initialTailFlag", "=", "1"}], ";", "\[IndentingNewLine]", 
         RowBox[{"InitialTailPosition", "=", "0.05"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"InitialTailPosition2", "=", "0.05"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"kmax", "=", "100"}], ";", "\[IndentingNewLine]", 
         RowBox[{"StartControl", "=", "3"}], ";", "\[IndentingNewLine]", 
         RowBox[{"IncrementFactor", "=", "2"}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"avec", " ", "correlation"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"\[Lambda]1", "=", "2"}], ";", 
         RowBox[{"\[Lambda]2", "=", "2"}], ";", 
         RowBox[{"imax", "=", "60"}], ";", "\[IndentingNewLine]", 
         RowBox[{"period1", "=", "6"}], ";", 
         RowBox[{"period1n", "=", "1"}], ";", 
         RowBox[{"period2", "=", "6"}], ";", 
         RowBox[{"period2n", "=", "1"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Nb1", "=", "35"}], ";", 
         RowBox[{"Nb2", "=", "35"}], ";", 
         RowBox[{"Nb1n", "=", "10"}], ";", 
         RowBox[{"\[Epsilon]1", "=", "0.00001"}], ";", 
         RowBox[{"\[Epsilon]2", "=", "0.0001"}], ";", "\[IndentingNewLine]", 
         RowBox[{"startmonitortime", "=", "8"}], ";", "\[IndentingNewLine]", 
         RowBox[{"plafondexplosion", "=", "0.1"}], ";", "\[IndentingNewLine]",
          
         RowBox[{"initialTailFlag", "=", "0"}], ";", "\[IndentingNewLine]", 
         RowBox[{"InitialTailPosition", "=", "0.05"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"InitialTailPosition2", "=", "0.05"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"kmax", "=", "17"}], ";", "\[IndentingNewLine]", 
         RowBox[{"StartControl", "=", "5"}], ";", "\[IndentingNewLine]", 
         RowBox[{"IncrementFactor", "=", "2"}], ";"}]}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"type", "\[Equal]", "\"\<VanillaSpreadoption\>\""}], ")"}], 
        ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"scope1", "=", 
           FractionBox["3", 
            SqrtBox[
             RowBox[{"\[CapitalSigma]moyen", " ", "\[Tau]"}]]]}], ";", 
          RowBox[{"scope2", "=", 
           FractionBox["4", 
            SqrtBox[
             RowBox[{"\[CapitalSigma]moyen", " ", "\[Tau]"}]]]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Nb1", "=", "30"}], ";", 
          RowBox[{"Nb1n", "=", "20"}], ";", 
          RowBox[{"Nb2", "=", "30"}], ";", "\[IndentingNewLine]", 
          RowBox[{"period1", "=", 
           RowBox[{"scope1", "*", "1.21"}]}], ";", 
          RowBox[{"period1n", "=", "scope1"}], ";", "\[IndentingNewLine]", 
          RowBox[{"period2", "=", "scope2"}], ";", 
          RowBox[{"period2n", "=", 
           RowBox[{"scope2", "/", "10"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Nb1", "=", 
           RowBox[{"IntegerConvert", "[", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"Log", "[", 
               RowBox[{"\[CapitalSigma]", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"3", ",", "30"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"6", ",", "30"}], "}"}], ",", "130"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Nb1n", "=", 
           RowBox[{"IntegerConvert", "[", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"Log", "[", 
               RowBox[{"\[CapitalSigma]", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"3", ",", "30"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"6", ",", "30"}], "}"}], ",", "130"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Nb2", "=", 
           RowBox[{"IntegerConvert", "[", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"Log", "[", 
               RowBox[{"\[CapitalSigma]", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"3", ",", "30"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"6", ",", "50"}], "}"}], ",", "130"}], "]"}]}], ";"}], 
         "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\[Lambda]1", "=", "1.1"}], ";", 
          RowBox[{"\[Lambda]2", "=", "1.01"}], ";", 
          RowBox[{"imax", "=", "10"}], ";", "\[IndentingNewLine]", 
          RowBox[{"period1", "=", "8"}], ";", 
          RowBox[{"period1n", "=", "3"}], ";", 
          RowBox[{"period2", "=", "3"}], ";", 
          RowBox[{"period2n", "=", "1."}], ";", "\[IndentingNewLine]", 
          RowBox[{"Nb1", "=", "25"}], ";", 
          RowBox[{"Nb2", "=", "25"}], ";", 
          RowBox[{"Nb1n", "=", "8"}], ";", 
          RowBox[{"\[Epsilon]1", "=", "0.000001"}], ";", 
          RowBox[{"\[Epsilon]2", "=", "0.00001"}], ";", "\[IndentingNewLine]",
           
          RowBox[{"startmonitortime", "=", "2"}], ";", "\[IndentingNewLine]", 
          
          RowBox[{"plafondexplosion", "=", "0.1"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"initialTailFlag", "=", "1"}], ";", "\[IndentingNewLine]", 
          RowBox[{"InitialTailPosition", "=", "2"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"InitialTailPosition2", "=", "2"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"kmax", "=", "100"}], ";", "\[IndentingNewLine]", 
          RowBox[{"StartControl", "=", "20"}], ";", "\[IndentingNewLine]", 
          RowBox[{"IncrementFactor", "=", "2"}], ";"}], "\[IndentingNewLine]",
          "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[Lambda]1", "=", "1.1"}], ";", 
         RowBox[{"\[Lambda]2", "=", "1.01"}], ";", 
         RowBox[{"imax", "=", "10"}], ";", "\[IndentingNewLine]", 
         RowBox[{"period1", "=", "8"}], ";", 
         RowBox[{"period1n", "=", "3"}], ";", 
         RowBox[{"period2", "=", "5"}], ";", 
         RowBox[{"period2n", "=", "1."}], ";", "\[IndentingNewLine]", 
         RowBox[{"Nb1", "=", "25"}], ";", 
         RowBox[{"Nb2", "=", "25"}], ";", 
         RowBox[{"Nb1n", "=", "8"}], ";", 
         RowBox[{"\[Epsilon]1", "=", "0.000001"}], ";", 
         RowBox[{"\[Epsilon]2", "=", "0.00001"}], ";", "\[IndentingNewLine]", 
         
         RowBox[{"startmonitortime", "=", "2"}], ";", "\[IndentingNewLine]", 
         RowBox[{"plafondexplosion", "=", "0.1"}], ";", "\[IndentingNewLine]",
          
         RowBox[{"initialTailFlag", "=", "1"}], ";", "\[IndentingNewLine]", 
         RowBox[{"InitialTailPosition", "=", "2"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"InitialTailPosition2", "=", "2"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"kmax", "=", "100"}], ";", "\[IndentingNewLine]", 
         RowBox[{"StartControl", "=", "20"}], ";", "\[IndentingNewLine]", 
         RowBox[{"IncrementFactor", "=", "2"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"LegendreCoef1", "=", 
       RowBox[{"LegendreCoeffs", "[", "Nb1", "]"}]}], ";", 
      RowBox[{"LegendreCoef1n", "=", 
       RowBox[{"LegendreCoeffs", "[", "Nb1n", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"LegendreCoef2", "=", 
       RowBox[{"LegendreCoeffs", "[", "Nb2", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "1"}], "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "1"}], "]"}]}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<Nb1=\>\"", ",", "Nb1", ",", "\"\< Nb1n=\>\"", ",", "Nb1n", ",", 
          "\"\< Nb2=\>\"", ",", "Nb2"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", ",", 
          "period1n", ",", "\[Epsilon]1", ",", "startmonitortime", ",", 
          "plafondexplosion", ",", "initialTailFlag", ",", 
          "InitialTailPosition", ",", "InitialTailPosition2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "LegendreCoef2", ",", "period2", ",", "period2n", ",", "\[Epsilon]2",
           ",", "kmax", ",", "StartControl", ",", "IncrementFactor"}], "}"}], 
        ",", "imax", ",", "\[Lambda]1", ",", "\[Lambda]2"}], "}"}]}]}], 
    "]"}]}], "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.404206970488248*^9, 3.4042070773496747`*^9}, {
   3.4042071143347597`*^9, 3.404207163288825*^9}, {3.4042073815430155`*^9, 
   3.404207439044119*^9}, {3.404207590797033*^9, 3.404207592265811*^9}, 
   3.4042080218053083`*^9, {3.4042193238816786`*^9, 3.4042193956955576`*^9}, {
   3.40436125513815*^9, 3.40436146885815*^9}, {3.4043709412927437`*^9, 
   3.4043709917743435`*^9}, {3.404371410696744*^9, 3.4043714124127436`*^9}, {
   3.404379892022144*^9, 3.404379895844144*^9}, {3.4043802460173435`*^9, 
   3.4043802517737436`*^9}, {3.4043803816437435`*^9, 
   3.4043803864953437`*^9}, {3.4043809028397436`*^9, 3.4043809080657434`*^9}, 
   3.4043809481421437`*^9, {3.404380999793744*^9, 3.404381054456144*^9}, {
   3.404381172750944*^9, 3.404381179380944*^9}, {3.404383541148344*^9, 
   3.4043835467175436`*^9}, {3.404383602690344*^9, 3.404383683311144*^9}, {
   3.404384106032344*^9, 3.4043841829091434`*^9}, {3.404384406535144*^9, 
   3.404384450917144*^9}, {3.404384498013544*^9, 3.404384507451544*^9}, {
   3.4043845726907434`*^9, 3.404384583142744*^9}, {3.4043847152123437`*^9, 
   3.404384740219144*^9}, {3.4043847763331437`*^9, 3.4043848473755436`*^9}, {
   3.404386205314744*^9, 3.404386275155944*^9}, {3.404386399597144*^9, 
   3.4043864558039436`*^9}, {3.4043865184223437`*^9, 3.404386525738744*^9}, {
   3.4043865649883437`*^9, 3.404386677667144*^9}, {3.404386732969144*^9, 
   3.4043867353403435`*^9}, {3.404386773310744*^9, 3.4043868160859437`*^9}, {
   3.4043868745391436`*^9, 3.4043869154267435`*^9}, {3.4043869601207438`*^9, 
   3.404386988107144*^9}, {3.4043870432687435`*^9, 3.404387052067144*^9}, {
   3.404387084764744*^9, 3.404387091425944*^9}, {3.4043871566339436`*^9, 
   3.404387168817544*^9}, {3.404387511689944*^9, 3.4043875842299438`*^9}, {
   3.404387648158744*^9, 3.404387847885544*^9}, {3.404387887899544*^9, 
   3.404388043915144*^9}, {3.4043882453735437`*^9, 3.404388484942744*^9}, {
   3.4043886348431435`*^9, 3.404388660957544*^9}, {3.4043893521311436`*^9, 
   3.4043893973867435`*^9}, {3.4043894515187435`*^9, 3.404389466104744*^9}, {
   3.4044067113261476`*^9, 3.4044067667841473`*^9}, {3.4044068889789476`*^9, 
   3.4044068907573476`*^9}, {3.4044072635021477`*^9, 
   3.4044072769649477`*^9}, {3.4044097282983475`*^9, 
   3.4044097309971476`*^9}, {3.404409800947548*^9, 3.4044098049567475`*^9}, {
   3.404409863815548*^9, 3.4044098674347477`*^9}, {3.4044102178107476`*^9, 
   3.4044103703943477`*^9}, {3.4044105926007476`*^9, 3.404410596297948*^9}, {
   3.404410672410348*^9, 3.4044107208951473`*^9}, {3.4044108745083475`*^9, 
   3.4044108748827477`*^9}, {3.4044110777451477`*^9, 
   3.4044110782443476`*^9}, {3.4044112932123475`*^9, 
   3.4044113036175475`*^9}, {3.4044122671337476`*^9, 3.404412270830948*^9}, {
   3.4044129093205476`*^9, 3.4044129134389477`*^9}, {3.4044130657261477`*^9, 
   3.4044130661473475`*^9}, {3.4046440467710423`*^9, 
   3.4046440589900265`*^9}, {3.4046714034331455`*^9, 
   3.4046714322307453`*^9}, {3.4046714863783455`*^9, 3.404671526875945*^9}, {
   3.4046715679975452`*^9, 3.404671590477145*^9}, {3.404671833712345*^9, 
   3.4046718472687454`*^9}, {3.4046719060495453`*^9, 
   3.4046719070011454`*^9}, {3.4046720273083453`*^9, 
   3.4046720700679455`*^9}, {3.404672150080345*^9, 3.4046721506107454`*^9}, {
   3.4046737151951847`*^9, 3.404673726005985*^9}, {3.4046742811943846`*^9, 
   3.404674287418785*^9}, {3.404675072800785*^9, 3.404675088447585*^9}, {
   3.404722606195922*^9, 3.404722760024047*^9}, {3.404722792852172*^9, 
   3.404722828555297*^9}, {3.404722858742797*^9, 3.404722874555297*^9}, {
   3.404723026992797*^9, 3.404723070117797*^9}, {3.404723584805297*^9, 
   3.404723587024047*^9}, {3.404723625367797*^9, 3.404723724945922*^9}, {
   3.404724050649047*^9, 3.404724053367797*^9}, {3.404724126289672*^9, 
   3.404724126852172*^9}, {3.404724346508422*^9, 3.404724346930297*^9}, {
   3.404724412367797*^9, 3.404724419289672*^9}, {3.404724488524047*^9, 
   3.404724494805297*^9}, {3.404724536164672*^9, 3.404724536774047*^9}, {
   3.404724609961547*^9, 3.404724610539672*^9}, {3.404724649352172*^9, 
   3.404724649774047*^9}, {3.404724703289672*^9, 3.404724703774047*^9}, {
   3.404724779289672*^9, 3.404724779945922*^9}, {3.404724983289672*^9, 
   3.404724983899047*^9}, {3.404725141758422*^9, 3.404725142352172*^9}, {
   3.404725251883422*^9, 3.404725256133422*^9}, {3.404725730211547*^9, 
   3.404725741320922*^9}, {3.404725782539672*^9, 3.404725787180297*^9}, {
   3.4048120178000937`*^9, 3.4048120200814314`*^9}, {3.4048120540983624`*^9, 
   3.404812056098439*^9}, {3.4048385442679176`*^9, 3.404838552158846*^9}, {
   3.404904947785347*^9, 3.404905056907347*^9}, {3.404905142395347*^9, 
   3.4049051440801473`*^9}, {3.404905174234947*^9, 3.4049051748589473`*^9}, {
   3.4049055172009473`*^9, 3.4049055245485473`*^9}, 3.4049063731261473`*^9, {
   3.404906609076147*^9, 3.404906628732147*^9}, {3.405012915826548*^9, 
   3.405012918104148*^9}, {3.405013030954548*^9, 3.405013083635748*^9}, {
   3.4050131731641483`*^9, 3.4050131735541477`*^9}, {3.405013298931348*^9, 
   3.405013299321348*^9}, 3.405013387601748*^9, {3.405013672110948*^9, 
   3.4050136728441477`*^9}, {3.4050870992581186`*^9, 3.405087188244772*^9}, {
   3.4050919512885776`*^9, 3.405091970320315*^9}, {3.4050920588538313`*^9, 
   3.4050921463248205`*^9}, 3.4050922096076903`*^9, 3.4051008441777725`*^9, {
   3.405101549126173*^9, 3.4051015502649727`*^9}, {3.4051087689419727`*^9, 
   3.4051088029031725`*^9}, {3.4051474371040525`*^9, 3.405147460839035*^9}, {
   3.4051842251563773`*^9, 3.405184247214777*^9}, {3.405187762815177*^9, 
   3.4051877766835775`*^9}, {3.405782055391534*^9, 3.405782078766983*^9}, {
   3.405782198878664*^9, 3.405782204394395*^9}, {3.4057824962906246`*^9, 
   3.4057825771046762`*^9}, {3.405783004144125*^9, 3.4057830088004646`*^9}, {
   3.405783043926139*^9, 3.4057830526606817`*^9}, {3.4057831590064735`*^9, 
   3.4057831625846667`*^9}, {3.405783516450836*^9, 3.405783516575838*^9}, {
   3.405783929349388*^9, 3.405784011866598*^9}, {3.405784054867423*^9, 
   3.405784079633524*^9}, 3.40578411432169*^9, {3.405784210479786*^9, 
   3.4057842109016695`*^9}, {3.4057843172162104`*^9, 3.405784319935013*^9}, {
   3.4057847778969307`*^9, 3.4057847977098107`*^9}, {3.405785003104379*^9, 
   3.4057850043231525`*^9}, 3.4057850676681185`*^9, {3.4057855103328676`*^9, 
   3.405785511879772*^9}, {3.4057867328407145`*^9, 3.405786770700816*^9}, {
   3.4057868111234674`*^9, 3.4057868121234865`*^9}, {3.4057871768804903`*^9, 
   3.405787178099263*^9}, {3.405787230584646*^9, 3.405787263147771*^9}, {
   3.4057875294028835`*^9, 3.405787530106022*^9}, {3.4057881914155936`*^9, 
   3.405788191696849*^9}, {3.4057883580750437`*^9, 3.405788394403866*^9}, {
   3.4057891793408117`*^9, 3.405789195356744*^9}, {3.4057892624830327`*^9, 
   3.4057892632017965`*^9}, {3.405789299155612*^9, 3.4057893318593645`*^9}, {
   3.405789407485817*^9, 3.405789434064452*^9}, {3.4057904175989604`*^9, 
   3.4057904183802257`*^9}, {3.405790562195487*^9, 3.405790605321315*^9}, {
   3.405790662900545*^9, 3.4057906710257015`*^9}, {3.405790972484614*^9, 
   3.405790976969075*^9}, {3.4057911609569826`*^9, 3.4057911857230835`*^9}, {
   3.405791450275038*^9, 3.4057914535719757`*^9}, {3.405791800297383*^9, 
   3.4057918054537315`*^9}, {3.405791913112049*^9, 3.4057919187684073`*^9}, {
   3.4057919890197563`*^9, 3.405792019410965*^9}, {3.4057920545053883`*^9, 
   3.405792063396184*^9}, 3.4057921215535507`*^9, {3.4057922472278385`*^9, 
   3.405792247712223*^9}, {3.405792400855788*^9, 3.4057924013870487`*^9}, 
   3.40579245460682*^9, {3.405866783928835*^9, 3.405866820132655*^9}, {
   3.405868075906765*^9, 3.4058680763755245`*^9}, {3.40595621734037*^9, 
   3.4059562285124598`*^9}, {3.405956346905358*^9, 3.4059563475928707`*^9}, {
   3.4059572673136544`*^9, 3.405957283954599*^9}, {3.405957318814643*^9, 
   3.4059573194396553`*^9}, {3.40595880772317*^9, 3.4059588236319647`*^9}, {
   3.405959129540866*^9, 3.405959181560153*^9}, {3.4059599331644917`*^9, 
   3.405959941383399*^9}, {3.405960024916253*^9, 3.4059600408228083`*^9}, 
   3.405960080667323*^9, {3.4060284224102015`*^9, 3.406028441801199*^9}, {
   3.406028486442681*^9, 3.406028501755475*^9}, {3.4060285346936073`*^9, 
   3.4060285387718105`*^9}, {3.406313116433578*^9, 3.406313122591578*^9}, {
   3.406313300481578*^9, 3.406313306719578*^9}, {3.4064720867260137`*^9, 
   3.4064721409461517`*^9}, {3.406527247232836*^9, 3.4065272474203405`*^9}, {
   3.4065272918589783`*^9, 3.4065272923902416`*^9}, {3.4065275900228605`*^9, 
   3.4065276161016536`*^9}, {3.4065309311865177`*^9, 3.406530946921295*^9}, {
   3.4065311201444798`*^9, 3.4065311241133313`*^9}, {3.4065326088544645`*^9, 
   3.406532609323227*^9}, {3.406532674512396*^9, 3.406532675168662*^9}, {
   3.4065330856479206`*^9, 3.40653316513433*^9}, {3.4065406920926404`*^9, 
   3.406540708905571*^9}, {3.406540748531585*^9, 3.406540749000347*^9}, 
   3.4065407933452325`*^9, {3.40654089325404*^9, 3.4065408940978117`*^9}, {
   3.4065409250361032`*^9, 3.4065409352707405`*^9}, {3.406541505707218*^9, 
   3.406541506316609*^9}, {3.4065415674900503`*^9, 3.4065415679275613`*^9}, {
   3.406541630616666*^9, 3.406541638163734*^9}, {3.406541697102743*^9, 
   3.4065417119624987`*^9}, 3.4065431039200068`*^9, {3.406543134358286*^9, 
   3.406543155905712*^9}, {3.4065434409755096`*^9, 3.40654344155365*^9}, {
   3.4065442714498944`*^9, 3.4065442742468414`*^9}, 3.4065447334460964`*^9, {
   3.406551466192673*^9, 3.4065514664114285`*^9}, {3.406551545522829*^9, 
   3.406551559741943*^9}, {3.40655686073702*^9, 3.406556888909616*^9}, {
   3.4065586540329275`*^9, 3.4065586790179415`*^9}, {3.4065623382834916`*^9, 
   3.4065623420804634`*^9}, {3.4066123443017654`*^9, 3.406612389646676*^9}, 
   3.406616477111749*^9, {3.4066166596476717`*^9, 3.40661668924218*^9}, {
   3.4066167266806383`*^9, 3.406616742149784*^9}, {3.406617761816512*^9, 
   3.4066177670510206`*^9}, 3.4066178056926355`*^9, {3.406618088309245*^9, 
   3.406618092418725*^9}, {3.4066184137707014`*^9, 3.406618414192587*^9}, {
   3.4066184677408333`*^9, 3.4066184949134035`*^9}, {3.406619603285527*^9, 
   3.4066196047699404`*^9}, 3.406622157085278*^9, {3.406872336701084*^9, 
   3.4068723879377546`*^9}, {3.406872731562523*^9, 3.406872750829011*^9}, {
   3.406872793924692*^9, 3.4068728002687263`*^9}, {3.406872865584152*^9, 
   3.4068728666623254`*^9}, {3.4068750010235653`*^9, 
   3.4068750012423253`*^9}, {3.406875034290681*^9, 3.4068750419628997`*^9}, {
   3.406878543729147*^9, 3.4068785479949627`*^9}, {3.406885566312332*^9, 
   3.4068855669529657`*^9}, {3.4068856232974367`*^9, 
   3.4068856584228864`*^9}, {3.406885976723836*^9, 3.406885979676998*^9}, {
   3.406886014896199*^9, 3.4068860150837016`*^9}, {3.406886372166397*^9, 
   3.4068864067449646`*^9}, 3.406886718155201*^9, {3.4068872465213385`*^9, 
   3.4068872563027143`*^9}, {3.4068873361318607`*^9, 
   3.4068873363349886`*^9}, {3.4068873860231247`*^9, 3.406887387945024*^9}, {
   3.406887454899006*^9, 3.406887455149009*^9}, 3.4068876085884733`*^9, {
   3.4068891314985914`*^9, 3.4068891772335515`*^9}, 3.406889244281285*^9, {
   3.406889705474688*^9, 3.406889713521666*^9}, {3.4068898275856256`*^9, 
   3.406889857867264*^9}, {3.406960721337304*^9, 3.406960863949417*^9}, {
   3.406964705804429*^9, 3.406964713726456*^9}, {3.406973231890002*^9, 
   3.406973232358761*^9}, {3.406975501855459*^9, 3.406975502292968*^9}, {
   3.4075837139394007`*^9, 3.407583769973401*^9}, {3.4075838175304008`*^9, 
   3.407583834878401*^9}, {3.407583894569401*^9, 3.407583911034401*^9}, {
   3.407584372492401*^9, 3.4075843758204007`*^9}, {3.4075844058614006`*^9, 
   3.4075844276584005`*^9}, {3.407584522055401*^9, 3.4075845373754005`*^9}, {
   3.407584856398401*^9, 3.407584860883401*^9}, {3.4075855286034007`*^9, 
   3.407585561128401*^9}, 3.4075915669562006`*^9, {3.407669066973*^9, 
   3.407669073028*^9}, {3.407669128307*^9, 3.407669145632*^9}, {
   3.407670846019*^9, 3.40767087731*^9}, 3.40767137685*^9, {3.407671426678*^9,
    3.407671475852*^9}, 3.4076716477530003`*^9, {3.407671818773*^9, 
   3.4076718374960003`*^9}, {3.407671897007*^9, 3.407671920833*^9}, {
   3.407671983174*^9, 3.407671995396*^9}, {3.4081965282953873`*^9, 
   3.408196547636387*^9}, 3.408205557267*^9, {3.408205855988*^9, 
   3.408205929368*^9}, 3.4082061086140003`*^9, {3.408211708394207*^9, 
   3.4082117441522074`*^9}, {3.408212452378207*^9, 3.408212463687207*^9}, {
   3.408212569728207*^9, 3.4082125907682076`*^9}, {3.4084456191957493`*^9, 
   3.4084457151975927`*^9}, {3.408445846621991*^9, 3.408445847012624*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[" Extended Legendre Coefficients", "Subsubtitle",
 CellChangeTimes->{{3.4042058387946453`*^9, 3.40420584452913*^9}, {
  3.404387284507144*^9, 3.404387287081144*^9}, {3.404672259217945*^9, 
  3.4046722761283455`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"LegendreCoeffsRepository", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "200"}], "}"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.40576765828699*^9, 3.405767705756652*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"LegendreCoeffs", "[", "n_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"ll", ",", "ll1"}], "}"}], ",", 
    RowBox[{
     RowBox[{"ll", "=", 
      RowBox[{"LegendreCoeffsRepository", "[", 
       RowBox[{"[", 
        RowBox[{"n", ",", "2"}], "]"}], "]"}]}], ";", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ll", "===", "0"}], ",", 
       RowBox[{
        RowBox[{"ll1", "=", 
         RowBox[{"LegendreCoeffsAux", "[", "n", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"LegendreCoeffsRepository", "[", 
          RowBox[{"[", 
           RowBox[{"n", ",", "2"}], "]"}], "]"}], "=", "ll1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ll1", "=", "ll"}]}], "]"}], ";", "ll1"}]}], "]"}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.4026436636082716`*^9, 3.4026436896712723`*^9}, {
  3.4057676297551928`*^9, 3.40576763588031*^9}, {3.4057677291008496`*^9, 
  3.40576787727557*^9}, {3.4057679095574393`*^9, 3.4057679109793415`*^9}, {
  3.4057680193095465`*^9, 3.405768030575388*^9}, {3.4057681198583517`*^9, 
  3.4057681276397514`*^9}, {3.4057682951585927`*^9, 3.4057683020181*^9}, {
  3.4057685041157293`*^9, 3.405768509084575*^9}, {3.4057686643688064`*^9, 
  3.405768684744198*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"LegendreCoeffsAux", "[", "n_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Nacc", "=", 
       RowBox[{"2", "Naccurracy"}]}], ",", "lst"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"n", ">", "40"}], ",", 
       RowBox[{"Nacc", "=", "40"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"n", ">", "56"}], ",", 
       RowBox[{"Nacc", "=", "60"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"n", ">", "82"}], ",", 
       RowBox[{"Nacc", "=", "70"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"n", ">", "95"}], ",", 
       RowBox[{"Nacc", "=", "80"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"n", ">", "105"}], ",", 
       RowBox[{"Nacc", "=", "100"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"n", ">", "130"}], ",", 
       RowBox[{"Nacc", "=", "120"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"n", ">", "150"}], ",", 
       RowBox[{"Nacc", "=", "n"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"lst", "=", 
      RowBox[{"LegendreCoeffs", "[", 
       RowBox[{"n", ",", "Nacc"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"SetAccuracy", "[", 
      RowBox[{"lst", ",", "16"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4026436636082716`*^9, 3.4026436896712723`*^9}, {
   3.404670287362345*^9, 3.4046703624295454`*^9}, {3.4046704470595455`*^9, 
   3.404670477666745*^9}, {3.404670510691945*^9, 3.404670510972745*^9}, {
   3.404670570283945*^9, 3.4046705859463453`*^9}, {3.404670642886345*^9, 
   3.4046706432919455`*^9}, {3.404670680295145*^9, 3.4046706932743454`*^9}, {
   3.4046707912735453`*^9, 3.4046708017567453`*^9}, {3.4046708768083453`*^9, 
   3.4046709049663453`*^9}, {3.4046709733411455`*^9, 3.404670982342345*^9}, {
   3.404671099623145*^9, 3.404671145315545*^9}, {3.404671218370345*^9, 
   3.4046712207883453`*^9}, 3.404673604045185*^9, {3.404908005338547*^9, 
   3.4049080171009474`*^9}, 3.404908157719347*^9, {3.40576826325173*^9, 
   3.4057682647830095`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"LegendreCoeffs", "[", 
   RowBox[{"n_", ",", "nprec_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "xj", ",", "i", ",", "racines", ",", "legendreWeight", ",", 
      "legendreRoot", ",", "xxx1973"}], "}"}], ",", 
    RowBox[{
     RowBox[{"racines", "=", 
      RowBox[{"NSolve", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"LegendreP", "[", 
          RowBox[{"n", ",", "xxx1973"}], "]"}], "\[Equal]", "0"}], ",", 
        "xxx1973", ",", "nprec"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"legendreWeight", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"2", "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", " ", 
              RowBox[{"xxx1973", "^", "2"}]}], ")"}], "/.", 
            RowBox[{"racines", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}], ")"}]}], "/", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"LegendreP", "[", 
               RowBox[{"n", ",", "xxx1973"}], "]"}], ",", "xxx1973"}], "]"}], 
            " ", "/.", " ", 
            RowBox[{"racines", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}], ")"}], "^", "2"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{"Length", "[", "racines", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"legendreRoot", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"xxx1973", " ", "/.", 
         RowBox[{"racines", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{"Length", "[", "racines", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Sort", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Re", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"legendreRoot", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"legendreWeight", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "}"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"#1", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "<", 
          RowBox[{"#2", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "&"}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4026419598724356`*^9, 3.4026419969512725`*^9}, {
  3.4026420402021027`*^9, 3.402642194095682*^9}, {3.402642225236905*^9, 
  3.402642290753788*^9}, {3.402642323957551*^9, 3.4026423521143413`*^9}, {
  3.402642397974597*^9, 3.4026424209906635`*^9}, {3.402642465272764*^9, 
  3.4026424962108583`*^9}, {3.402642695636562*^9, 3.402642704589859*^9}, {
  3.4026427879664593`*^9, 3.402642815154482*^9}, {3.4026429145470147`*^9, 
  3.402642930859828*^9}, {3.4026432808509226`*^9, 3.4026432811946793`*^9}, {
  3.402643581575446*^9, 3.402643592106899*^9}, {3.4046563695693398`*^9, 
  3.4046563771788607`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"LegendreCoeffs", "[", 
   RowBox[{"n_", ",", "a_", ",", "b_"}], "]"}], ":=", 
  RowBox[{"LegendreCoeffsFromLegendre", "[", 
   RowBox[{
    RowBox[{"LegendreCoeffs", "[", "n", "]"}], ",", "a", ",", "b"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.405106733984373*^9, 3.405106764310773*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 " ",
 StyleBox["Adaptative Integration",
  FontFamily->"Arial"]
}], "Subsubtitle",
 CellChangeTimes->{{3.4042058387946453`*^9, 3.40420584452913*^9}, {
  3.404387284507144*^9, 3.404387287081144*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"scalar", " ", 
   RowBox[{"case", " ", ":", " ", 
    RowBox[{"adaptatif", " ", "avec", " ", "complex", " ", 
     RowBox[{"(", "Legendre", ")"}], "  ", "increment", " ", "and", " ", 
     "initial", " ", "sequence"}]}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.4044535313100405`*^9, 3.4044535387422094`*^9}, {
  3.405759378168271*^9, 3.405759436247511*^9}, {3.4090356748225374`*^9, 
  3.409035688322797*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AdaptativeIntegrate", "[", 
   RowBox[{
   "Func_", ",", "LegendreCoef0_", ",", "LegendreCoefn_", ",", "period0_", 
    ",", "periodn_", ",", "\[Epsilon]_", ",", "imax_", ",", " ", 
    "initialperiod_", ",", "LegendreCoefn2_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"sum", "=", "0.0"}], ",", 
      RowBox[{"increment", "=", "0"}], ",", 
      RowBox[{"i", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"sum", "=", 
      RowBox[{"CoeffBasedIntegrate", "[", 
       RowBox[{"Func", ",", 
        RowBox[{"LegendreCoeffsFromLegendre", "[", 
         RowBox[{"LegendreCoefn2", ",", "0", ",", "initialperiod"}], "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"sum", "+=", 
      RowBox[{"CoeffBasedIntegrate", "[", 
       RowBox[{"Func", ",", 
        RowBox[{"LegendreCoeffsFromLegendre", "[", 
         RowBox[{"LegendreCoef0", ",", "initialperiod", ",", "period0"}], 
         "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"increment", "=", 
      RowBox[{"CoeffBasedIntegrate", "[", 
       RowBox[{"Func", ",", 
        RowBox[{"LegendreCoeffsFromLegendre", "[", 
         RowBox[{"LegendreCoefn", ",", 
          RowBox[{"period0", "+", 
           RowBox[{"i", "*", "periodn"}]}], ",", 
          RowBox[{"period0", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"i", "+", "1"}], ")"}], "*", "periodn"}]}]}], "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Abs", "[", "increment", "]"}], ">", "\[Epsilon]"}], ")"}], 
        "&&", 
        RowBox[{"(", 
         RowBox[{"i", "<", "imax"}], ")"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sum", "+=", "increment"}], ";", 
        RowBox[{"i", "+=", "1"}], ";", "\[IndentingNewLine]", 
        RowBox[{"increment", "=", 
         RowBox[{"CoeffBasedIntegrate", "[", 
          RowBox[{"Func", ",", 
           RowBox[{"LegendreCoeffsFromLegendre", "[", 
            RowBox[{"LegendreCoefn", ",", 
             RowBox[{"period0", "+", 
              RowBox[{"i", "*", "periodn"}]}], ",", 
             RowBox[{"period0", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"i", "+", "1"}], ")"}], "*", "periodn"}]}]}], "]"}]}],
           "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     RowBox[{"{", 
      RowBox[{"i", ",", "sum"}], "}"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4038679573575945`*^9, 3.4038681122824445`*^9}, {
   3.403868218503234*^9, 3.4038682723011417`*^9}, {3.4038683294272385`*^9, 
   3.403868512993263*^9}, {3.4038685440719843`*^9, 3.403868591635398*^9}, {
   3.403869293008239*^9, 3.4038693566344604`*^9}, {3.403869465261546*^9, 
   3.403869476199256*^9}, {3.4038774840873795`*^9, 3.403877491821903*^9}, {
   3.403877552854325*^9, 3.403877688075671*^9}, {3.4038778333597107`*^9, 
   3.403877834172226*^9}, {3.404323563294944*^9, 3.404323601421344*^9}, {
   3.4057500850523467`*^9, 3.405750211523525*^9}, 3.405750430433978*^9, {
   3.4057507013141785`*^9, 3.405750708095559*^9}, 3.405750869942416*^9, {
   3.4057509053337207`*^9, 3.405750907052504*^9}, 3.40575117143258*^9, {
   3.405751338779543*^9, 3.405751338998297*^9}, {3.4057513974681697`*^9, 
   3.4057514024370155`*^9}, {3.405751830929617*^9, 3.4057518331327844`*^9}, {
   3.405751947619357*^9, 3.405751949213138*^9}, {3.4090356964948287`*^9, 
   3.40903579526235*^9}, {3.4090358291223755`*^9, 3.4090358361693854`*^9}, {
   3.40903617914472*^9, 3.4090362302394514`*^9}, {3.4090367506244426`*^9, 
   3.4090367715623446`*^9}, {3.4090369376436586`*^9, 3.4090369635816565`*^9}, 
   3.4090389908705797`*^9, {3.409059076238324*^9, 3.4090591112546215`*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"vector", " ", 
   RowBox[{"case", " ", ":", " ", 
    RowBox[{"adaptatif", " ", "avec", " ", "complex", " ", 
     RowBox[{"(", "Legendre", ")"}], "  ", "increment", " ", "and", " ", 
     "initial", " ", "sequence"}]}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.4044535313100405`*^9, 3.4044535387422094`*^9}, {
  3.405759378168271*^9, 3.405759436247511*^9}, {3.4090356748225374`*^9, 
  3.409035688322797*^9}, {3.409044584491338*^9, 3.4090445857101116`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"VectorAdaptativeIntegrate", "[", 
   RowBox[{
   "Func_", ",", "LegendreCoef0_", ",", "LegendreCoefn_", ",", "period0_", 
    ",", "periodn_", ",", "\[Epsilon]_", ",", "imax_", ",", " ", 
    "initialperiod_", ",", "LegendreCoefn2_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"sum", "=", "0.0"}], ",", 
      RowBox[{"increment", "=", "0"}], ",", 
      RowBox[{"i", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"sum", "=", 
      RowBox[{"CoeffBasedIntegrate", "[", 
       RowBox[{"Func", ",", 
        RowBox[{"LegendreCoeffsFromLegendre", "[", 
         RowBox[{"LegendreCoefn2", ",", "0", ",", "initialperiod"}], "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"sum", "+=", 
      RowBox[{"CoeffBasedIntegrate", "[", 
       RowBox[{"Func", ",", 
        RowBox[{"LegendreCoeffsFromLegendre", "[", 
         RowBox[{"LegendreCoef0", ",", "initialperiod", ",", "period0"}], 
         "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"increment", "=", 
      RowBox[{"CoeffBasedIntegrate", "[", 
       RowBox[{"Func", ",", 
        RowBox[{"LegendreCoeffsFromLegendre", "[", 
         RowBox[{"LegendreCoefn", ",", 
          RowBox[{"period0", "+", 
           RowBox[{"i", "*", "periodn"}]}], ",", 
          RowBox[{"period0", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"i", "+", "1"}], ")"}], "*", "periodn"}]}]}], "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"increment", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], ">", "\[Epsilon]"}], ")"}],
         "&&", 
        RowBox[{"(", 
         RowBox[{"i", "<", "imax"}], ")"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sum", "+=", "increment"}], ";", 
        RowBox[{"i", "+=", "1"}], ";", "\[IndentingNewLine]", 
        RowBox[{"increment", "=", 
         RowBox[{"CoeffBasedIntegrate", "[", 
          RowBox[{"Func", ",", 
           RowBox[{"LegendreCoeffsFromLegendre", "[", 
            RowBox[{"LegendreCoefn", ",", 
             RowBox[{"period0", "+", 
              RowBox[{"i", "*", "periodn"}]}], ",", 
             RowBox[{"period0", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"i", "+", "1"}], ")"}], "*", "periodn"}]}]}], "]"}]}],
           "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     RowBox[{"{", 
      RowBox[{"i", ",", "sum"}], "}"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4038679573575945`*^9, 3.4038681122824445`*^9}, {
   3.403868218503234*^9, 3.4038682723011417`*^9}, {3.4038683294272385`*^9, 
   3.403868512993263*^9}, {3.4038685440719843`*^9, 3.403868591635398*^9}, {
   3.403869293008239*^9, 3.4038693566344604`*^9}, {3.403869465261546*^9, 
   3.403869476199256*^9}, {3.4038774840873795`*^9, 3.403877491821903*^9}, {
   3.403877552854325*^9, 3.403877688075671*^9}, {3.4038778333597107`*^9, 
   3.403877834172226*^9}, {3.404323563294944*^9, 3.404323601421344*^9}, {
   3.4057500850523467`*^9, 3.405750211523525*^9}, 3.405750430433978*^9, {
   3.4057507013141785`*^9, 3.405750708095559*^9}, 3.405750869942416*^9, {
   3.4057509053337207`*^9, 3.405750907052504*^9}, 3.40575117143258*^9, {
   3.405751338779543*^9, 3.405751338998297*^9}, {3.4057513974681697`*^9, 
   3.4057514024370155`*^9}, {3.405751830929617*^9, 3.4057518331327844`*^9}, {
   3.405751947619357*^9, 3.405751949213138*^9}, {3.4090356964948287`*^9, 
   3.40903579526235*^9}, {3.4090358291223755`*^9, 3.4090358361693854`*^9}, {
   3.40903617914472*^9, 3.4090362302394514`*^9}, {3.4090367506244426`*^9, 
   3.4090367715623446`*^9}, {3.4090369376436586`*^9, 3.4090369635816565`*^9}, 
   3.4090389908705797`*^9, {3.409044589350806*^9, 3.409044590553954*^9}, {
   3.4090446268671513`*^9, 3.409044629851584*^9}, 3.409059114926567*^9, 
   3.409059186771696*^9}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"scalar", " ", 
   RowBox[{"case", " ", ":", " ", 
    RowBox[{"adaptatif", " ", "avec", " ", "complex", " ", 
     RowBox[{"(", "Legendre", ")"}], "  ", "increment"}]}]}], "*)"}]], "Input",\

 CellChangeTimes->{{3.4044535313100405`*^9, 3.4044535387422094`*^9}, {
  3.405759378168271*^9, 3.405759436247511*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AdaptativeIntegrate", "[", 
   RowBox[{
   "Func_", ",", "LegendreCoef0_", ",", "LegendreCoefn_", ",", "period0_", 
    ",", "periodn_", ",", "\[Epsilon]_", ",", "imax_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"sum", "=", "0.0"}], ",", 
      RowBox[{"increment", "=", 
       RowBox[{"\[Epsilon]", " ", "1.1"}]}], ",", 
      RowBox[{"incrementPrec", "=", 
       RowBox[{"10", "^", "8"}]}], ",", 
      RowBox[{"i", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"sum", "=", 
      RowBox[{"CoeffBasedIntegrate", "[", 
       RowBox[{"Func", ",", 
        RowBox[{"LegendreCoeffsFromLegendre", "[", 
         RowBox[{"LegendreCoef0", ",", "0", ",", "period0"}], "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Abs", "[", "increment", "]"}], ">", "\[Epsilon]"}], ")"}], 
        "&&", 
        RowBox[{"(", 
         RowBox[{"i", "<", "imax"}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Abs", "[", "increment", "]"}], "<", 
          RowBox[{"2", " ", 
           RowBox[{"Abs", "[", "incrementPrec", "]"}]}]}], ")"}]}], ",", 
       RowBox[{
        RowBox[{"sum", "+=", "increment"}], ";", 
        RowBox[{"incrementPrec", "=", "increment"}], ";", 
        RowBox[{"increment", "=", 
         RowBox[{"CoeffBasedIntegrate", "[", 
          RowBox[{"Func", ",", 
           RowBox[{"LegendreCoeffsFromLegendre", "[", 
            RowBox[{"LegendreCoefn", ",", 
             RowBox[{"period0", "+", 
              RowBox[{"i", "*", "periodn"}]}], ",", 
             RowBox[{"period0", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"i", "+", "1"}], ")"}], "*", "periodn"}]}]}], "]"}]}],
           "]"}]}], ";", 
        RowBox[{"i", "+=", "1"}]}]}], "]"}], ";", 
     RowBox[{"{", 
      RowBox[{"i", ",", "sum"}], "}"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4038679573575945`*^9, 3.4038681122824445`*^9}, {
   3.403868218503234*^9, 3.4038682723011417`*^9}, {3.4038683294272385`*^9, 
   3.403868512993263*^9}, {3.4038685440719843`*^9, 3.403868591635398*^9}, {
   3.403869293008239*^9, 3.4038693566344604`*^9}, {3.403869465261546*^9, 
   3.403869476199256*^9}, {3.4038774840873795`*^9, 3.403877491821903*^9}, {
   3.403877552854325*^9, 3.403877688075671*^9}, {3.4038778333597107`*^9, 
   3.403877834172226*^9}, {3.404323563294944*^9, 3.404323601421344*^9}, {
   3.4057500850523467`*^9, 3.405750211523525*^9}, 3.405750430433978*^9, {
   3.4057507013141785`*^9, 3.405750708095559*^9}, 3.405750869942416*^9, {
   3.4057509053337207`*^9, 3.405750907052504*^9}, 3.40575117143258*^9, {
   3.405751338779543*^9, 3.405751338998297*^9}, {3.4057513974681697`*^9, 
   3.4057514024370155`*^9}, {3.405751830929617*^9, 3.4057518331327844`*^9}, {
   3.405751947619357*^9, 3.405751949213138*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"scalar", " ", 
   RowBox[{"case", " ", ":", " ", 
    RowBox[{"adaptatif", " ", "avec", " ", "rieman", " ", "increment"}]}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.405759421544104*^9, 3.405759423450391*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AdaptativeIntegrate", "[", 
   RowBox[{
   "Func_", ",", "LegendreCoef0_", ",", "period0_", ",", "periodn_", ",", 
    "\[Epsilon]_", ",", "imax_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"sum", "=", "0.0"}], ",", 
      RowBox[{"increment", "=", 
       RowBox[{"\[Epsilon]", "+", "1"}]}], ",", 
      RowBox[{"incrementPrec", "=", 
       RowBox[{"10", "^", "8"}]}], ",", 
      RowBox[{"i", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"sum", "=", 
      RowBox[{"CoeffBasedIntegrate", "[", 
       RowBox[{"Func", ",", 
        RowBox[{"LegendreCoeffsFromLegendre", "[", 
         RowBox[{"LegendreCoef0", ",", "0", ",", "period0"}], "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Abs", "[", "increment", "]"}], ">", "\[Epsilon]"}], ")"}], 
        "&&", 
        RowBox[{"(", 
         RowBox[{"i", "<", "imax"}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Abs", "[", "increment", "]"}], "<", 
          RowBox[{"2", 
           RowBox[{"Abs", "[", "incrementPrec", "]"}]}]}], ")"}]}], ",", 
       RowBox[{
        RowBox[{"sum", "+=", "increment"}], ";", 
        RowBox[{"incrementPrec", "=", "increment"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"increment", "=", 
         RowBox[{
          RowBox[{"Func", "[", 
           RowBox[{"period0", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"i", "+", 
               RowBox[{"1", "/", "2"}]}], ")"}], "*", "periodn"}]}], "]"}], 
          "periodn"}]}], ";", 
        RowBox[{"i", "+=", "1"}]}]}], "]"}], ";", 
     RowBox[{"{", 
      RowBox[{"i", ",", "sum"}], "}"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4038679573575945`*^9, 3.4038681122824445`*^9}, {
   3.403868218503234*^9, 3.4038682723011417`*^9}, {3.4038683294272385`*^9, 
   3.403868512993263*^9}, {3.4038685440719843`*^9, 3.403868591635398*^9}, {
   3.403869293008239*^9, 3.4038693566344604`*^9}, {3.403869465261546*^9, 
   3.403869476199256*^9}, {3.4038774840873795`*^9, 3.403877491821903*^9}, {
   3.403877552854325*^9, 3.403877688075671*^9}, {3.4038778333597107`*^9, 
   3.403877834172226*^9}, {3.40388015784184*^9, 3.403880158607479*^9}, 
   3.4038802489842143`*^9, 3.403880308188476*^9, {3.403880362970778*^9, 
   3.403880402409035*^9}, {3.403880433222127*^9, 3.4038804766917114`*^9}, {
   3.4038820166744037`*^9, 3.403882032534083*^9}, 3.4038820825506687`*^9, {
   3.4043235726705437`*^9, 3.4043235757281437`*^9}, 3.4043236182069435`*^9, 
   3.4057511067438383`*^9, 3.4057511760576687`*^9, {3.4057513413733425`*^9, 
   3.405751341592097*^9}, {3.4057515993314204`*^9, 3.40575164201974*^9}, 
   3.405751844742382*^9, 3.4057519440411634`*^9, {3.405752032964746*^9, 
   3.405752033402254*^9}, {3.405752068965437*^9, 3.4057520691216903`*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"vector", " ", 
   RowBox[{"case", " ", ":", " ", 
    RowBox[{"adaptatif", " ", "avec", " ", "complex", " ", 
     RowBox[{"(", "Legendre", ")"}], "  ", "increment"}]}]}], "*)"}]], "Input",\

 CellChangeTimes->{{3.404453543207756*^9, 3.404453551014656*^9}, 
   3.4057594487008753`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"VectorAdaptativeIntegrate", "[", 
   RowBox[{
   "Func_", ",", "LegendreCoef0_", ",", "LegendreCoefn_", ",", "period0_", 
    ",", "periodn_", ",", "\[Epsilon]_", ",", "imax_", ",", "n_"}], "]"}], ":=",
   
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"sum", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0.0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ",", 
      RowBox[{"increment", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ",", 
      RowBox[{"i", "=", "0"}], ",", 
      RowBox[{"incrementPrec", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"sum", "=", 
      RowBox[{"CoeffBasedIntegrate", "[", 
       RowBox[{"Func", ",", 
        RowBox[{"LegendreCoeffsFromLegendre", "[", 
         RowBox[{"LegendreCoef0", ",", "0", ",", "period0"}], "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"i", "\[Equal]", "0"}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"i", "\[Equal]", "1"}], ")"}], "&&", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"Abs", "[", "increment", "]"}], "]"}], ">", 
            "\[Epsilon]"}], ")"}]}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"Abs", "[", "increment", "]"}], "]"}], ">", 
            "\[Epsilon]"}], ")"}], "&&", 
          RowBox[{"(", 
           RowBox[{"i", "<", "imax"}], ")"}], "&&", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"Abs", "[", "increment", "]"}], "]"}], "<", 
            RowBox[{"3", 
             RowBox[{"Max", "[", 
              RowBox[{"Abs", "[", "incrementPrec", "]"}], "]"}]}]}], ")"}]}], 
         ")"}]}], ",", 
       RowBox[{
        RowBox[{"sum", "+=", "increment"}], ";", 
        RowBox[{"incrementPrec", "=", "increment"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"increment", "=", 
         RowBox[{"CoeffBasedIntegrate", "[", 
          RowBox[{"Func", ",", 
           RowBox[{"LegendreCoeffsFromLegendre", "[", 
            RowBox[{"LegendreCoefn", ",", 
             RowBox[{"period0", "+", 
              RowBox[{"i", "*", "periodn"}]}], ",", 
             RowBox[{"period0", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"i", "+", "1"}], ")"}], "*", "periodn"}]}]}], "]"}]}],
           "]"}]}], ";", 
        RowBox[{"i", "+=", "1"}]}]}], "]"}], ";", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i", ",", "imax", ",", 
         RowBox[{"Max", "[", 
          RowBox[{"Abs", "[", "increment", "]"}], "]"}], ",", 
         RowBox[{"Max", "[", 
          RowBox[{"Abs", "[", "incrementPrec", "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Max", "[", 
              RowBox[{"Abs", "[", "increment", "]"}], "]"}], ">", 
             "\[Epsilon]"}], ")"}], ",", 
           RowBox[{"(", 
            RowBox[{"i", "<", "imax"}], ")"}], ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Max", "[", 
              RowBox[{"Abs", "[", "increment", "]"}], "]"}], "<", 
             RowBox[{"3", 
              RowBox[{"Max", "[", 
               RowBox[{"Abs", "[", "incrementPrec", "]"}], "]"}]}]}], ")"}]}],
           "}"}]}], "}"}], ",", "sum"}], "}"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4038679573575945`*^9, 3.4038681122824445`*^9}, {
   3.403868218503234*^9, 3.4038682723011417`*^9}, {3.4038683294272385`*^9, 
   3.403868512993263*^9}, {3.4038685440719843`*^9, 3.403868591635398*^9}, {
   3.403869293008239*^9, 3.4038693566344604`*^9}, {3.403869465261546*^9, 
   3.403869476199256*^9}, {3.4038774840873795`*^9, 3.403877491821903*^9}, {
   3.403877552854325*^9, 3.403877688075671*^9}, {3.4038778333597107`*^9, 
   3.403877834172226*^9}, {3.404323563294944*^9, 3.404323601421344*^9}, {
   3.4044535096068583`*^9, 3.404453511199466*^9}, {3.404453625258275*^9, 
   3.4044536566263995`*^9}, 3.4044537555370502`*^9, {3.4044538788033147`*^9, 
   3.4044538846709075`*^9}, {3.4044539840610633`*^9, 
   3.4044539957332516`*^9}, {3.40575112299415*^9, 3.4057511452602024`*^9}, {
   3.4057513553111105`*^9, 3.4057513593424377`*^9}, {3.4057517112241936`*^9, 
   3.4057517830849485`*^9}, 3.4057518522581515`*^9, 3.4057518925558004`*^9, 
   3.4057519377129173`*^9, {3.405752035558546*^9, 3.405752077387474*^9}, {
   3.4057521256540256`*^9, 3.4057521272009306`*^9}, 3.4057523358143106`*^9, {
   3.40575244097258*^9, 3.405752446316432*^9}, {3.405754452542451*^9, 
   3.4057544806992416`*^9}, 3.4057549719742985`*^9, 3.405837157574476*^9, 
   3.4058372963115144`*^9, {3.405840084005662*^9, 3.405840097662174*^9}, {
   3.4058404506377015`*^9, 3.405840477247587*^9}, {3.4058405745932064`*^9, 
   3.4058406209065957`*^9}, {3.4058473715674553`*^9, 3.405847409396307*^9}, {
   3.405848413024951*^9, 3.405848466447852*^9}, {3.405848551433859*^9, 
   3.4058485799344063`*^9}, {3.4058486122162757`*^9, 3.405848616825739*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"vector", " ", 
   RowBox[{"case", " ", ":", " ", 
    RowBox[{"adaptatif", " ", "avec", " ", "rieman", " ", "increment"}]}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{3.405759458638566*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"VectorAdaptativeIntegrate", "[", 
   RowBox[{
   "Func_", ",", "LegendreCoef0_", ",", "period0_", ",", "periodn_", ",", 
    "\[Epsilon]_", ",", "imax_", ",", "n_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"sum", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0.0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ",", 
      RowBox[{"increment", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"\[Epsilon]", " ", "1.1"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ",", 
      RowBox[{"incrementPrec", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"10", "^", "8"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ",", 
      RowBox[{"i", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"sum", "=", 
      RowBox[{"CoeffBasedIntegrate", "[", 
       RowBox[{"Func", ",", 
        RowBox[{"LegendreCoeffsFromLegendre", "[", 
         RowBox[{"LegendreCoef0", ",", "0", ",", "period0"}], "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"i", "\[Equal]", "0"}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"i", "\[Equal]", "1"}], ")"}], "&&", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"Abs", "[", "increment", "]"}], "]"}], ">", 
            "\[Epsilon]"}], ")"}]}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"Abs", "[", "increment", "]"}], "]"}], ">", 
            "\[Epsilon]"}], ")"}], "&&", 
          RowBox[{"(", 
           RowBox[{"i", "<", "imax"}], ")"}], "&&", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"Abs", "[", "increment", "]"}], "]"}], "<", 
            RowBox[{"3", 
             RowBox[{"Max", "[", 
              RowBox[{"Abs", "[", "incrementPrec", "]"}], "]"}]}]}], ")"}]}], 
         ")"}]}], ",", 
       RowBox[{
        RowBox[{"sum", "+=", "increment"}], ";", 
        RowBox[{"incrementPrec", "=", "increment"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"increment", "=", 
         RowBox[{
          RowBox[{"Func", "[", 
           RowBox[{"period0", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"i", "+", 
               RowBox[{"1", "/", "2"}]}], ")"}], "*", "periodn"}]}], "]"}], 
          "periodn"}]}], ";", 
        RowBox[{"i", "+=", "1"}]}]}], "]"}], ";", 
     RowBox[{"{", 
      RowBox[{"i", ",", "sum"}], "}"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4038679573575945`*^9, 3.4038681122824445`*^9}, {
   3.403868218503234*^9, 3.4038682723011417`*^9}, {3.4038683294272385`*^9, 
   3.403868512993263*^9}, {3.4038685440719843`*^9, 3.403868591635398*^9}, {
   3.403869293008239*^9, 3.4038693566344604`*^9}, {3.403869465261546*^9, 
   3.403869476199256*^9}, {3.4038774840873795`*^9, 3.403877491821903*^9}, {
   3.403877552854325*^9, 3.403877688075671*^9}, {3.4038778333597107`*^9, 
   3.403877834172226*^9}, {3.40388015784184*^9, 3.403880158607479*^9}, 
   3.4038802489842143`*^9, 3.403880308188476*^9, {3.403880362970778*^9, 
   3.403880402409035*^9}, {3.403880433222127*^9, 3.4038804766917114`*^9}, {
   3.4038820166744037`*^9, 3.403882032534083*^9}, 3.4038820825506687`*^9, {
   3.4043235726705437`*^9, 3.4043235757281437`*^9}, 3.4043236182069435`*^9, {
   3.404453515290282*^9, 3.4044535166174545`*^9}, {3.4044536323313265`*^9, 
   3.4044536332837687`*^9}, 3.4044536755815525`*^9, {3.4044537234525533`*^9, 
   3.404453732846944*^9}, {3.4044538888219175`*^9, 3.4044538907413692`*^9}, {
   3.4044540008976126`*^9, 3.4044540133638506`*^9}, {3.405751296903739*^9, 
   3.405751297810006*^9}, {3.405751369858265*^9, 3.405751376749022*^9}, {
   3.40575174850616*^9, 3.4057517509749565`*^9}, {3.405751788881935*^9, 
   3.4057517919444933`*^9}, {3.4057518618520856`*^9, 3.4057518906495132`*^9}, 
   3.4057519399004593`*^9, {3.40575203787109*^9, 3.405752081387551*^9}, {
   3.405752131122881*^9, 3.4057521325447826`*^9}, 3.4057523273141475`*^9, {
   3.4057524502383823`*^9, 3.4057524512384014`*^9}, {3.405754454620616*^9, 
   3.405754482589903*^9}, 3.405754973958712*^9, 3.405837162183939*^9, 
   3.4058373001240873`*^9, {3.4058462869997573`*^9, 3.4058462983281*^9}, 
   3.4058483789305468`*^9, 3.4058495413591146`*^9}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"vector", " ", 
   RowBox[{"case", " ", ":", " ", 
    RowBox[{
     RowBox[{"adaptatif", " ", "avec", " ", "complex", " ", 
      RowBox[{"(", "Legendre", ")"}], "  ", "increment"}], " ", "+", " ", 
     RowBox[{"plafond", " ", 
      RowBox[{"d", "'"}], "explosion"}]}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.404453543207756*^9, 3.404453551014656*^9}, 
   3.4057594487008753`*^9, {3.4060308868950186`*^9, 3.406030898989001*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"f", "[", "x_", "]"}], ":=", 
  RowBox[{"1", "/", 
   RowBox[{"(", 
    RowBox[{"4", "-", "x"}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.406033068311901*^9, 3.4060331098751993`*^9}, 
   3.406035356355831*^9, {3.406035425122776*^9, 3.40603544332625*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"f", "[", 
  RowBox[{"{", 
   RowBox[{"1.1", ",", "2.2"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.4060334020370584`*^9, 3.4060334108809786`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.3448275862068966`", ",", "0.5555555555555556`"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.4060334120685015`*^9, 3.406311783941578*^9, 
  3.4063128076405783`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"co", "=", 
   RowBox[{"LegendreCoeffs", "[", "100", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.406033433725167*^9, 3.4060334355377016`*^9}, {
  3.4060339161719294`*^9, 3.406033916640689*^9}, {3.4060342935854263`*^9, 
  3.406034314242072*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"VectorCoeffBasedIntegrate", "[", 
  RowBox[{"f", ",", 
   RowBox[{"LegendreCoeffsFromLegendre", "[", 
    RowBox[{"co", ",", "1", ",", "4"}], "]"}], ",", "4", ",", "100000."}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.4060338765305433`*^9, 3.40603392790653*^9}, {
   3.4060339930484056`*^9, 3.4060340379867687`*^9}, {3.4060342142714033`*^9, 
   3.406034226771643*^9}, {3.4060342681005616`*^9, 3.406034289163466*^9}, {
   3.406034330304881*^9, 3.406034346648945*^9}, 3.4060345109020987`*^9, 
   3.406035066959649*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "10.374755035279241`", ",", "10.374755035279241`", ",", 
     "10.374755035279241`", ",", "10.374755035279241`"}], "}"}], ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.4060340210489435`*^9, 3.4060340396117997`*^9}, {
   3.4060342149432907`*^9, 3.40603422764666*^9}, {3.406034269366211*^9, 
   3.4060342896634755`*^9}, {3.4060343322424183`*^9, 
   3.4060343468676987`*^9}, {3.4060345121677475`*^9, 3.406034521386675*^9}, {
   3.4060346084352207`*^9, 3.406034611294651*^9}, {3.4060350646314793`*^9, 
   3.4060350673190312`*^9}, {3.4063117769235783`*^9, 3.406311793840578*^9}, 
   3.406312815095578*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"VectorAdaptativeIntegrate", "[", 
  RowBox[{
  "f", ",", "co", ",", "co", ",", "30", ",", "0.1", ",", "0.000001", ",", 
   "10", ",", "10", ",", "100000."}], "]"}]], "Input",
 CellChangeTimes->{{3.4060338765305433`*^9, 3.40603392790653*^9}, {
   3.4060339930484056`*^9, 3.4060340379867687`*^9}, {3.4060342142714033`*^9, 
   3.406034226771643*^9}, {3.4060342681005616`*^9, 3.406034289163466*^9}, {
   3.406034330304881*^9, 3.406034346648945*^9}, 3.4060345109020987`*^9, 
   3.406035066959649*^9, {3.4060351777586517`*^9, 3.406035272682349*^9}, {
   3.406035406106786*^9, 3.4060354334041853`*^9}, 3.4060355519845867`*^9, {
   3.406035702846858*^9, 3.4060357033468676`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.003838776307165735`"}], ",", 
     RowBox[{"-", "0.003838776307165735`"}], ",", 
     RowBox[{"-", "0.003838776307165735`"}], ",", 
     RowBox[{"-", "0.003838776307165735`"}], ",", 
     RowBox[{"-", "0.003838776307165735`"}], ",", 
     RowBox[{"-", "0.003838776307165735`"}], ",", 
     RowBox[{"-", "0.003838776307165735`"}], ",", 
     RowBox[{"-", "0.003838776307165735`"}], ",", 
     RowBox[{"-", "0.003838776307165735`"}], ",", 
     RowBox[{"-", "0.003838776307165735`"}]}], "}"}], ",", "0", ",", 
   RowBox[{"{", 
    RowBox[{"10", ",", "0", ",", "0", ",", 
     RowBox[{"{", 
      RowBox[{"True", ",", "False", ",", "True", ",", "False"}], "}"}]}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.406035276010538*^9, {3.4060353301990786`*^9, 3.4060353594496403`*^9}, {
   3.4060354076380653`*^9, 3.4060354497326236`*^9}, 3.4060355531721096`*^9, 
   3.4060357042375097`*^9, {3.406312820377578*^9, 3.4063128244495783`*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Integration", " ", "adaptative", " ", "resistante", " ", "aux", " ",
   "sauts"}]], "Input",
 CellChangeTimes->{{3.406368619055622*^9, 3.4063686353528104`*^9}, {
  3.406368669353463*^9, 3.4063686711347475`*^9}},
 TextAlignment->Center,
 Background->RGBColor[1, 0.5, 0]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.4084288445299325`*^9, 3.408428848983143*^9}}],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"VectorAdaptativeIntegrateUnprotected", "[", 
    RowBox[{
    "Func_", ",", "LegendreCoef0_", ",", "LegendreCoefn_", ",", "period0_", 
     ",", "periodn_", ",", "\[Epsilon]_", ",", "imax_", ",", "n_", ",", 
     "printflag_", ",", "initialTailFlag_", ",", "InitialTailPosition_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"sum", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0.0", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ",", 
       RowBox[{"increment", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ",", 
       RowBox[{"i", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"initialTailFlag", ">", "0"}], ",", 
        RowBox[{
         RowBox[{"sum", "=", 
          RowBox[{"CoeffBasedIntegrate", "[", 
           RowBox[{"Func", ",", 
            RowBox[{"LegendreCoeffsFromLegendre", "[", 
             RowBox[{"LegendreCoef0", ",", "0", ",", "InitialTailPosition"}], 
             "]"}]}], "]"}]}], ";", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"printflag", "\[Equal]", "8"}], "||", " ", 
            RowBox[{"MemberQ", "[", 
             RowBox[{"printflag", ",", "8"}], "]"}]}], " ", ",", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\< sum pre-initiale=\>\"", ",", "sum"}], "]"}]}], 
          "]"}], ";", 
         RowBox[{"sum", "+=", 
          RowBox[{"CoeffBasedIntegrate", "[", 
           RowBox[{"Func", ",", 
            RowBox[{"LegendreCoeffsFromLegendre", "[", 
             RowBox[{
             "LegendreCoef0", ",", "InitialTailPosition", ",", "period0"}], 
             "]"}]}], "]"}]}]}], ",", 
        RowBox[{"sum", "=", 
         RowBox[{"CoeffBasedIntegrate", "[", 
          RowBox[{"Func", ",", 
           RowBox[{"LegendreCoeffsFromLegendre", "[", 
            RowBox[{"LegendreCoef0", ",", "0", ",", "period0"}], "]"}]}], 
          "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "8"}], "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "8"}], "]"}]}], " ", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\< sum initiale=\>\"", ",", "sum"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"increment", "=", 
       RowBox[{"CoeffBasedIntegrate", "[", 
        RowBox[{"Func", ",", 
         RowBox[{"LegendreCoeffsFromLegendre", "[", 
          RowBox[{"LegendreCoefn", ",", 
           RowBox[{"period0", "+", 
            RowBox[{"i", "*", "periodn"}]}], ",", 
           RowBox[{"period0", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"i", "+", "1"}], ")"}], "*", "periodn"}]}]}], "]"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "8"}], "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "8"}], "]"}]}], " ", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<kini=\>\"", ",", 
          RowBox[{"period0", "+", 
           RowBox[{"i", "*", "periodn"}]}], ",", 
          "\"\< increment initial=\>\"", ",", "increment"}], "]"}]}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"increment", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], ">", "\[Epsilon]"}], 
          ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{"i", "<", "imax"}], ")"}]}], ",", 
        RowBox[{
         RowBox[{"sum", "+=", "increment"}], ";", 
         RowBox[{"i", "+=", "1"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"increment", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], ">", "\[Epsilon]"}], 
          ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{"i", "<", "imax"}], ")"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"increment", "=", 
          RowBox[{"CoeffBasedIntegrate", "[", 
           RowBox[{"Func", ",", 
            RowBox[{"LegendreCoeffsFromLegendre", "[", 
             RowBox[{"LegendreCoefn", ",", 
              RowBox[{"period0", "+", 
               RowBox[{"i", "*", "periodn"}]}], ",", 
              RowBox[{"period0", "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"i", "+", "1"}], ")"}], "*", "periodn"}]}]}], 
             "]"}]}], "]"}]}], ";", 
         RowBox[{"sum", "+=", "increment"}], ";", 
         RowBox[{"i", "+=", "1"}], ";", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"printflag", "\[Equal]", "8"}], "||", " ", 
            RowBox[{"MemberQ", "[", 
             RowBox[{"printflag", ",", "8"}], "]"}]}], " ", ",", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\< i=\>\"", ",", "i", ",", "\"\< Kini=\>\"", ",", 
             RowBox[{"period0", "+", 
              RowBox[{"i", "*", "periodn"}]}], ",", "\"\< increment =\>\"", 
             ",", "increment"}], "]"}]}], "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "8"}], "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "8"}], "]"}]}], " ", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\< Sum finale=\>\"", ",", "sum"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Abs", "[", 
           RowBox[{"increment", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Abs", "[", 
                 RowBox[{"increment", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], ">", "\[Epsilon]"}], 
               ")"}], ",", 
              RowBox[{"\"\<Abs[increment[[1]]]>\[Epsilon]:\>\"", "<>", 
               RowBox[{"ToString", "[", 
                RowBox[{"Abs", "[", 
                 RowBox[{"increment", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}]}], "]"}], 
            ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"i", "<", "imax"}], ")"}], ",", 
              RowBox[{"\"\<i<imax:\>\"", "<>", 
               RowBox[{"ToString", "[", "i", "]"}]}]}], "]"}]}], "}"}]}], 
         "}"}], ",", "sum"}], "}"}]}]}], "]"}]}], "\[IndentingNewLine]", 
  "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4038679573575945`*^9, 3.4038681122824445`*^9}, {
   3.403868218503234*^9, 3.4038682723011417`*^9}, {3.4038683294272385`*^9, 
   3.403868512993263*^9}, {3.4038685440719843`*^9, 3.403868591635398*^9}, {
   3.403869293008239*^9, 3.4038693566344604`*^9}, {3.403869465261546*^9, 
   3.403869476199256*^9}, {3.4038774840873795`*^9, 3.403877491821903*^9}, {
   3.403877552854325*^9, 3.403877688075671*^9}, {3.4038778333597107`*^9, 
   3.403877834172226*^9}, {3.404323563294944*^9, 3.404323601421344*^9}, {
   3.4044535096068583`*^9, 3.404453511199466*^9}, {3.404453625258275*^9, 
   3.4044536566263995`*^9}, 3.4044537555370502`*^9, {3.4044538788033147`*^9, 
   3.4044538846709075`*^9}, {3.4044539840610633`*^9, 
   3.4044539957332516`*^9}, {3.40575112299415*^9, 3.4057511452602024`*^9}, {
   3.4057513553111105`*^9, 3.4057513593424377`*^9}, {3.4057517112241936`*^9, 
   3.4057517830849485`*^9}, 3.4057518522581515`*^9, 3.4057518925558004`*^9, 
   3.4057519377129173`*^9, {3.405752035558546*^9, 3.405752077387474*^9}, {
   3.4057521256540256`*^9, 3.4057521272009306`*^9}, 3.4057523358143106`*^9, {
   3.40575244097258*^9, 3.405752446316432*^9}, {3.405754452542451*^9, 
   3.4057544806992416`*^9}, 3.4057549719742985`*^9, 3.405837157574476*^9, 
   3.4058372963115144`*^9, {3.405840084005662*^9, 3.405840097662174*^9}, {
   3.4058404506377015`*^9, 3.405840477247587*^9}, {3.4058405745932064`*^9, 
   3.4058406209065957`*^9}, {3.4058473715674553`*^9, 3.405847409396307*^9}, {
   3.405848413024951*^9, 3.405848466447852*^9}, {3.405848551433859*^9, 
   3.4058485799344063`*^9}, {3.4058486122162757`*^9, 3.405848616825739*^9}, {
   3.4063663187770824`*^9, 3.4063663742312727`*^9}, {3.4063665397500753`*^9, 
   3.4063665410000997`*^9}, {3.4063890810536156`*^9, 
   3.4063890990856733`*^9}, {3.406389131399621*^9, 3.4063891431813984`*^9}, 
   3.406389174979698*^9, {3.406389675674003*^9, 3.4063897221760864`*^9}, {
   3.406389930122902*^9, 3.406389988516143*^9}, {3.4065428010685034`*^9, 
   3.406542808334315*^9}, {3.4065428408976483`*^9, 3.406542913805765*^9}, {
   3.406551816623519*^9, 3.4065518250768604`*^9}, {3.4065518894847593`*^9, 
   3.406551897656843*^9}, {3.406554030227061*^9, 3.4065540777282767`*^9}, {
   3.4065541079009237`*^9, 3.4065541142760873`*^9}, {3.4065543702201395`*^9, 
   3.4065544475658693`*^9}, {3.406554522239656*^9, 3.406554530646121*^9}, {
   3.4065545737878504`*^9, 3.4065547137445583`*^9}, {3.406554818669119*^9, 
   3.4065548375133514`*^9}, {3.406560243667371*^9, 3.4065602501831627`*^9}, {
   3.406608366793694*^9, 3.4066084511552286`*^9}, {3.406608482374778*^9, 
   3.4066084939844503`*^9}, 3.4066085286103363`*^9, 3.4066085725020847`*^9, {
   3.406608635081812*^9, 3.406608678489173*^9}, 3.4066110854414144`*^9, {
   3.406616000224541*^9, 3.406616004927787*^9}, {3.4066195013766685`*^9, 
   3.4066195236897397`*^9}, {3.4068901143861723`*^9, 3.406890163043045*^9}, {
   3.4068902924197006`*^9, 3.4068903026229563`*^9}, {3.4069708982358217`*^9, 
   3.406970913111107*^9}, {3.4069709515805955`*^9, 3.406971000815916*^9}, {
   3.4084288528738422`*^9, 3.4084288597489743`*^9}}],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"VectorAdaptativeIntegrateUnprotected", "[", 
    RowBox[{
    "Func_", ",", "LegendreCoef0_", ",", "LegendreCoefn_", ",", "period0_", 
     ",", "periodn_", ",", "\[Epsilon]_", ",", "imax_", ",", "n_", ",", 
     "printflag_", ",", "initialTailFlag_", ",", "InitialTailPosition_", ",", 
     "kmax_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"sum", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0.0", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ",", 
       RowBox[{"increment", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ",", 
       RowBox[{"i", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"initialTailFlag", ">", "0"}], ",", 
        RowBox[{
         RowBox[{"sum", "=", 
          RowBox[{"CoeffBasedIntegrate", "[", 
           RowBox[{"Func", ",", 
            RowBox[{"LegendreCoeffsFromLegendre", "[", 
             RowBox[{"LegendreCoef0", ",", "0", ",", "InitialTailPosition"}], 
             "]"}]}], "]"}]}], ";", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"printflag", "\[Equal]", "8"}], "||", " ", 
            RowBox[{"MemberQ", "[", 
             RowBox[{"printflag", ",", "8"}], "]"}]}], " ", ",", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\< sum pre-initiale=\>\"", ",", "sum"}], "]"}]}], 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"period0", "<", "kmax"}], ",", 
           RowBox[{"sum", "+=", 
            RowBox[{"CoeffBasedIntegrate", "[", 
             RowBox[{"Func", ",", 
              RowBox[{"LegendreCoeffsFromLegendre", "[", 
               RowBox[{
               "LegendreCoef0", ",", "InitialTailPosition", ",", "period0"}], 
               "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"sum", "+=", 
            RowBox[{"CoeffBasedIntegrate", "[", 
             RowBox[{"Func", ",", 
              RowBox[{"LegendreCoeffsFromLegendre", "[", 
               RowBox[{
               "LegendreCoef0", ",", "InitialTailPosition", ",", "kmax"}], 
               "]"}]}], "]"}]}]}], "]"}]}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"period0", "<", "kmax"}], ",", 
          RowBox[{"sum", "+=", 
           RowBox[{"CoeffBasedIntegrate", "[", 
            RowBox[{"Func", ",", 
             RowBox[{"LegendreCoeffsFromLegendre", "[", 
              RowBox[{"LegendreCoef0", ",", "0", ",", "period0"}], "]"}]}], 
            "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"sum", "+=", 
           RowBox[{"CoeffBasedIntegrate", "[", 
            RowBox[{"Func", ",", 
             RowBox[{"LegendreCoeffsFromLegendre", "[", 
              RowBox[{"LegendreCoef0", ",", "0", ",", "kmax"}], "]"}]}], 
            "]"}]}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "8"}], "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "8"}], "]"}]}], " ", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\< sum initiale=\>\"", ",", "sum"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"period0", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"i", "+", "1"}], ")"}], "*", "periodn"}]}], "<", "kmax"}],
         ",", 
        RowBox[{"increment", "=", 
         RowBox[{"CoeffBasedIntegrate", "[", 
          RowBox[{"Func", ",", 
           RowBox[{"LegendreCoeffsFromLegendre", "[", 
            RowBox[{"LegendreCoefn", ",", 
             RowBox[{"period0", "+", 
              RowBox[{"i", "*", "periodn"}]}], ",", 
             RowBox[{"period0", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"i", "+", "1"}], ")"}], "*", "periodn"}]}]}], "]"}]}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"increment", "=", 
          RowBox[{"CoeffBasedIntegrate", "[", 
           RowBox[{"Func", ",", 
            RowBox[{"LegendreCoeffsFromLegendre", "[", 
             RowBox[{"LegendreCoefn", ",", 
              RowBox[{"period0", "+", 
               RowBox[{"i", "*", "periodn"}]}], ",", 
              RowBox[{"Max", "[", 
               RowBox[{
                RowBox[{"period0", "+", 
                 RowBox[{"i", "*", "periodn"}]}], ",", "kmax"}], "]"}]}], 
             "]"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"increment", "=", 
       RowBox[{"CoeffBasedIntegrate", "[", 
        RowBox[{"Func", ",", 
         RowBox[{"LegendreCoeffsFromLegendre", "[", 
          RowBox[{"LegendreCoefn", ",", 
           RowBox[{"period0", "+", 
            RowBox[{"i", "*", "periodn"}]}], ",", 
           RowBox[{"period0", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"i", "+", "1"}], ")"}], "*", "periodn"}]}]}], "]"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "8"}], "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "8"}], "]"}]}], " ", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<kini=\>\"", ",", 
          RowBox[{"period0", "+", 
           RowBox[{"i", "*", "periodn"}]}], ",", 
          "\"\< increment initial=\>\"", ",", "increment"}], "]"}]}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"increment", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], ">", "\[Epsilon]"}], 
          ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{"i", "<", "imax"}], ")"}]}], ",", 
        RowBox[{
         RowBox[{"sum", "+=", "increment"}], ";", 
         RowBox[{"i", "+=", "1"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"increment", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], ">", "\[Epsilon]"}], 
          ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{"i", "<", "imax"}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"period0", "+", 
            RowBox[{"i", "*", "periodn"}]}], "<", "kmax"}], ")"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"period0", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"i", "+", "1"}], ")"}], "*", "periodn"}]}], "<", 
            "kmax"}], ",", 
           RowBox[{"increment", "=", 
            RowBox[{"CoeffBasedIntegrate", "[", 
             RowBox[{"Func", ",", 
              RowBox[{"LegendreCoeffsFromLegendre", "[", 
               RowBox[{"LegendreCoefn", ",", 
                RowBox[{"period0", "+", 
                 RowBox[{"i", "*", "periodn"}]}], ",", 
                RowBox[{"period0", "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"i", "+", "1"}], ")"}], "*", "periodn"}]}]}], 
               "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"increment", "=", 
            RowBox[{"CoeffBasedIntegrate", "[", 
             RowBox[{"Func", ",", 
              RowBox[{"LegendreCoeffsFromLegendre", "[", 
               RowBox[{"LegendreCoefn", ",", 
                RowBox[{"period0", "+", 
                 RowBox[{"i", "*", "periodn"}]}], ",", 
                RowBox[{"Max", "[", 
                 RowBox[{
                  RowBox[{"period0", "+", 
                   RowBox[{"i", "*", "periodn"}]}], ",", "kmax"}], "]"}]}], 
               "]"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}], 
         "\[IndentingNewLine]", ";", 
         RowBox[{"sum", "+=", "increment"}], ";", 
         RowBox[{"i", "+=", "1"}], ";", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"printflag", "\[Equal]", "8"}], "||", " ", 
            RowBox[{"MemberQ", "[", 
             RowBox[{"printflag", ",", "8"}], "]"}]}], " ", ",", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\< i=\>\"", ",", "i", ",", "\"\< Kini=\>\"", ",", 
             RowBox[{"period0", "+", 
              RowBox[{"i", "*", "periodn"}]}], ",", "\"\< increment =\>\"", 
             ",", "increment"}], "]"}]}], "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"printflag", "\[Equal]", "8"}], "||", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"printflag", ",", "8"}], "]"}]}], " ", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\< Sum finale=\>\"", ",", "sum"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Abs", "[", 
           RowBox[{"increment", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Abs", "[", 
                 RowBox[{"increment", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], "\[LessEqual]", 
                "\[Epsilon]"}], ")"}], ",", 
              RowBox[{"\"\<increment<=\[Epsilon] :\>\"", "<>", 
               RowBox[{"ToString", "[", 
                RowBox[{"Abs", "[", 
                 RowBox[{"increment", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}]}], "]"}], 
            ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"i", "<", "imax"}], ")"}], ",", 
              RowBox[{"\"\<i>imax :\>\"", "<>", 
               RowBox[{"ToString", "[", "i", "]"}]}]}], "]"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"period0", "+", 
                 RowBox[{"i", "*", "periodn"}]}], ">", "kmax"}], ")"}], ",", 
              RowBox[{"\"\<period0+i*periodn>kmax:\>\"", "<>", 
               RowBox[{"ToString", "[", 
                RowBox[{"period0", "+", 
                 RowBox[{"i", "*", "periodn"}]}], "]"}]}]}], "]"}]}], "}"}]}],
          "}"}], ",", "sum"}], "}"}]}]}], "]"}]}], "\[IndentingNewLine]", 
  "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4038679573575945`*^9, 3.4038681122824445`*^9}, {
   3.403868218503234*^9, 3.4038682723011417`*^9}, {3.4038683294272385`*^9, 
   3.403868512993263*^9}, {3.4038685440719843`*^9, 3.403868591635398*^9}, {
   3.403869293008239*^9, 3.4038693566344604`*^9}, {3.403869465261546*^9, 
   3.403869476199256*^9}, {3.4038774840873795`*^9, 3.403877491821903*^9}, {
   3.403877552854325*^9, 3.403877688075671*^9}, {3.4038778333597107`*^9, 
   3.403877834172226*^9}, {3.404323563294944*^9, 3.404323601421344*^9}, {
   3.4044535096068583`*^9, 3.404453511199466*^9}, {3.404453625258275*^9, 
   3.4044536566263995`*^9}, 3.4044537555370502`*^9, {3.4044538788033147`*^9, 
   3.4044538846709075`*^9}, {3.4044539840610633`*^9, 
   3.4044539957332516`*^9}, {3.40575112299415*^9, 3.4057511452602024`*^9}, {
   3.4057513553111105`*^9, 3.4057513593424377`*^9}, {3.4057517112241936`*^9, 
   3.4057517830849485`*^9}, 3.4057518522581515`*^9, 3.4057518925558004`*^9, 
   3.4057519377129173`*^9, {3.405752035558546*^9, 3.405752077387474*^9}, {
   3.4057521256540256`*^9, 3.4057521272009306`*^9}, 3.4057523358143106`*^9, {
   3.40575244097258*^9, 3.405752446316432*^9}, {3.405754452542451*^9, 
   3.4057544806992416`*^9}, 3.4057549719742985`*^9, 3.405837157574476*^9, 
   3.4058372963115144`*^9, {3.405840084005662*^9, 3.405840097662174*^9}, {
   3.4058404506377015`*^9, 3.405840477247587*^9}, {3.4058405745932064`*^9, 
   3.4058406209065957`*^9}, {3.4058473715674553`*^9, 3.405847409396307*^9}, {
   3.405848413024951*^9, 3.405848466447852*^9}, {3.405848551433859*^9, 
   3.4058485799344063`*^9}, {3.4058486122162757`*^9, 3.405848616825739*^9}, {
   3.4063663187770824`*^9, 3.4063663742312727`*^9}, {3.4063665397500753`*^9, 
   3.4063665410000997`*^9}, {3.4063890810536156`*^9, 
   3.4063890990856733`*^9}, {3.406389131399621*^9, 3.4063891431813984`*^9}, 
   3.406389174979698*^9, {3.406389675674003*^9, 3.4063897221760864`*^9}, {
   3.406389930122902*^9, 3.406389988516143*^9}, {3.4065428010685034`*^9, 
   3.406542808334315*^9}, {3.4065428408976483`*^9, 3.406542913805765*^9}, {
   3.406551816623519*^9, 3.4065518250768604`*^9}, {3.4065518894847593`*^9, 
   3.406551897656843*^9}, {3.406554030227061*^9, 3.4065540777282767`*^9}, {
   3.4065541079009237`*^9, 3.4065541142760873`*^9}, {3.4065543702201395`*^9, 
   3.4065544475658693`*^9}, {3.406554522239656*^9, 3.406554530646121*^9}, {
   3.4065545737878504`*^9, 3.4065547137445583`*^9}, {3.406554818669119*^9, 
   3.4065548375133514`*^9}, {3.406560243667371*^9, 3.4065602501831627`*^9}, {
   3.406608366793694*^9, 3.4066084511552286`*^9}, {3.406608482374778*^9, 
   3.4066084939844503`*^9}, 3.4066085286103363`*^9, 3.4066085725020847`*^9, {
   3.406608635081812*^9, 3.406608678489173*^9}, 3.4066110854414144`*^9, {
   3.406616000224541*^9, 3.406616004927787*^9}, {3.4066195013766685`*^9, 
   3.4066195236897397`*^9}, {3.4068901143861723`*^9, 3.406890163043045*^9}, {
   3.4068902924197006`*^9, 3.4068903026229563`*^9}, {3.406890692768575*^9, 
   3.4068906961436186`*^9}, {3.406890960631379*^9, 3.40689112947729*^9}, {
   3.4068911722434626`*^9, 3.406891187696785*^9}, {3.4068912223066034`*^9, 
   3.4068913544020443`*^9}, {3.406963755754938*^9, 3.406963846053547*^9}, {
   3.406964238264202*^9, 3.406964239576728*^9}, {3.4069652251581507`*^9, 
   3.4069652325489173`*^9}, {3.4069652647995367`*^9, 3.406965329410152*^9}, {
   3.406970413210884*^9, 3.406970413882772*^9}, {3.406970448039678*^9, 
   3.406970579885959*^9}, {3.4069706457153482`*^9, 3.406970763873867*^9}, 
   3.406970816281123*^9, {3.408428862905285*^9, 3.4084288694210353`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"VectorAdaptativeIntegrateUnprotected", "[", 
   RowBox[{
   "Func_", ",", "LegendreCoef0_", ",", "LegendreCoefn_", ",", "period0_", 
    ",", "periodn_", ",", "\[Epsilon]_", ",", "imax_", ",", "n_", ",", 
    "printflag_", ",", "initialTailFlag_", ",", "InitialTailPosition_", ",", 
    "kmax_", ",", "StartControl_", ",", "IncrementFactor_"}], "]"}], ":=", 
  RowBox[{"VectorAdaptativeIntegrateUnprotected", "[", 
   RowBox[{
   "Func", ",", "LegendreCoef0", ",", "LegendreCoefn", ",", "period0", ",", 
    "periodn", ",", "\[Epsilon]", ",", "imax", ",", "n", ",", "printflag", 
    ",", "initialTailFlag", ",", "InitialTailPosition", ",", "kmax"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.406964933668179*^9, 3.4069649672938247`*^9}, {
  3.406965106968381*^9, 3.406965109140298*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"VectorAdaptativeIntegrateUnprotected", "[", 
   RowBox[{
   "Func_", ",", "LegendreCoef0_", ",", "LegendreCoefn_", ",", "period0_", 
    ",", "periodn_", ",", "\[Epsilon]_", ",", "imax_", ",", "n_", ",", 
    "printflag_", ",", "initialTailFlag_", ",", "InitialTailPosition_", ",", 
    "kmax_", ",", "StartControl_", ",", "IncrementFactor_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"sum", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0.0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ",", 
      RowBox[{"increment", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ",", 
      RowBox[{"i", "=", "0"}], ",", "incrementPrecedent"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"initialTailFlag", ">", "0"}], ",", 
       RowBox[{
        RowBox[{"sum", "=", 
         RowBox[{"CoeffBasedIntegrate", "[", 
          RowBox[{"Func", ",", 
           RowBox[{"LegendreCoeffsFromLegendre", "[", 
            RowBox[{"LegendreCoef0", ",", "0", ",", "InitialTailPosition"}], 
            "]"}]}], "]"}]}], ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"printflag", "\[Equal]", "8"}], "||", " ", 
           RowBox[{"MemberQ", "[", 
            RowBox[{"printflag", ",", "8"}], "]"}]}], " ", ",", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\< sum pre-initiale=\>\"", ",", "sum"}], "]"}]}], "]"}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"period0", "<", "kmax"}], ",", 
          RowBox[{"sum", "+=", 
           RowBox[{"CoeffBasedIntegrate", "[", 
            RowBox[{"Func", ",", 
             RowBox[{"LegendreCoeffsFromLegendre", "[", 
              RowBox[{
              "LegendreCoef0", ",", "InitialTailPosition", ",", "period0"}], 
              "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"sum", "+=", 
           RowBox[{"CoeffBasedIntegrate", "[", 
            RowBox[{"Func", ",", 
             RowBox[{"LegendreCoeffsFromLegendre", "[", 
              RowBox[{
              "LegendreCoef0", ",", "InitialTailPosition", ",", "kmax"}], 
              "]"}]}], "]"}]}]}], "]"}]}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"period0", "<", "kmax"}], ",", 
         RowBox[{"sum", "+=", 
          RowBox[{"CoeffBasedIntegrate", "[", 
           RowBox[{"Func", ",", 
            RowBox[{"LegendreCoeffsFromLegendre", "[", 
             RowBox[{"LegendreCoef0", ",", "0", ",", "period0"}], "]"}]}], 
           "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"sum", "+=", 
          RowBox[{"CoeffBasedIntegrate", "[", 
           RowBox[{"Func", ",", 
            RowBox[{"LegendreCoeffsFromLegendre", "[", 
             RowBox[{"LegendreCoef0", ",", "0", ",", "kmax"}], "]"}]}], 
           "]"}]}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"printflag", "\[Equal]", "8"}], "||", " ", 
        RowBox[{"MemberQ", "[", 
         RowBox[{"printflag", ",", "8"}], "]"}]}], " ", ",", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\< sum initiale=\>\"", ",", "sum"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"period0", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"i", "+", "1"}], ")"}], "*", "periodn"}]}], "<", "kmax"}], 
       ",", 
       RowBox[{"increment", "=", 
        RowBox[{"CoeffBasedIntegrate", "[", 
         RowBox[{"Func", ",", 
          RowBox[{"LegendreCoeffsFromLegendre", "[", 
           RowBox[{"LegendreCoefn", ",", 
            RowBox[{"period0", "+", 
             RowBox[{"i", "*", "periodn"}]}], ",", 
            RowBox[{"period0", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"i", "+", "1"}], ")"}], "*", "periodn"}]}]}], "]"}]}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"increment", "=", 
         RowBox[{"CoeffBasedIntegrate", "[", 
          RowBox[{"Func", ",", 
           RowBox[{"LegendreCoeffsFromLegendre", "[", 
            RowBox[{"LegendreCoefn", ",", 
             RowBox[{"period0", "+", 
              RowBox[{"i", "*", "periodn"}]}], ",", 
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{"period0", "+", 
                RowBox[{"i", "*", "periodn"}]}], ",", "kmax"}], "]"}]}], 
            "]"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"printflag", "\[Equal]", "8"}], "||", " ", 
        RowBox[{"MemberQ", "[", 
         RowBox[{"printflag", ",", "8"}], "]"}]}], " ", ",", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<k={\>\"", ",", 
         RowBox[{"period0", "+", 
          RowBox[{"i", "*", "periodn"}]}], ",", "\"\<,\>\"", ",", 
         RowBox[{"period0", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"i", "+", "1"}], ")"}], "*", "periodn"}]}], ",", 
         "\"\<}  increment initial=\>\"", ",", "increment"}], "]"}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"increment", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], ">", "\[Epsilon]"}], ")"}],
         "&&", 
        RowBox[{"(", 
         RowBox[{"i", "<", "imax"}], ")"}]}], ",", 
       RowBox[{
        RowBox[{"sum", "+=", "increment"}], ";", 
        RowBox[{"i", "+=", "1"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"incrementPrecedent", "=", 
      RowBox[{"1.1", " ", "increment"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"increment", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], ">", "\[Epsilon]"}], ")"}],
         "&&", 
        RowBox[{"(", 
         RowBox[{"i", "<", "imax"}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"period0", "+", 
           RowBox[{"i", "*", "periodn"}]}], "<", "kmax"}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"increment", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "\[LessEqual]", " ", 
          RowBox[{"IncrementFactor", " ", 
           RowBox[{"Abs", "[", 
            RowBox[{"incrementPrecedent", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}]}]}], ")"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"incrementPrecedent", "=", "increment"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"period0", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"i", "+", "1"}], ")"}], "*", "periodn"}]}], "<", 
           "kmax"}], ",", 
          RowBox[{"increment", "=", 
           RowBox[{"CoeffBasedIntegrate", "[", 
            RowBox[{"Func", ",", 
             RowBox[{"LegendreCoeffsFromLegendre", "[", 
              RowBox[{"LegendreCoefn", ",", 
               RowBox[{"period0", "+", 
                RowBox[{"i", "*", "periodn"}]}], ",", 
               RowBox[{"period0", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"i", "+", "1"}], ")"}], "*", "periodn"}]}]}], 
              "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"increment", "=", 
           RowBox[{"CoeffBasedIntegrate", "[", 
            RowBox[{"Func", ",", 
             RowBox[{"LegendreCoeffsFromLegendre", "[", 
              RowBox[{"LegendreCoefn", ",", 
               RowBox[{"period0", "+", 
                RowBox[{"i", "*", "periodn"}]}], ",", 
               RowBox[{"Max", "[", 
                RowBox[{
                 RowBox[{"period0", "+", 
                  RowBox[{"i", "*", "periodn"}]}], ",", "kmax"}], "]"}]}], 
              "]"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"printflag", "\[Equal]", "8"}], "||", " ", 
           RowBox[{"MemberQ", "[", 
            RowBox[{"printflag", ",", "8"}], "]"}]}], " ", ",", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\< i=\>\"", ",", "i", ",", "\"\< k={\>\"", ",", 
            RowBox[{"period0", "+", 
             RowBox[{"i", "*", "periodn"}]}], ",", "\"\<,\>\"", ",", 
            RowBox[{"period0", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"i", "+", "1"}], ")"}], "*", "periodn"}]}], ",", 
            "\"\<}  increment =\>\"", ",", "increment"}], "]"}]}], "]"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"sum", "+=", "increment"}], ";", 
        RowBox[{"i", "+=", "1"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"printflag", "\[Equal]", "8"}], "||", " ", 
        RowBox[{"MemberQ", "[", 
         RowBox[{"printflag", ",", "8"}], "]"}]}], " ", ",", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<raison=\>\"", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Abs", "[", 
                 RowBox[{"increment", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], "\[LessEqual]", 
                "\[Epsilon]"}], ")"}], ",", 
              RowBox[{"\"\<increment<=\[Epsilon] :\>\"", "<>", 
               RowBox[{"ToString", "[", 
                RowBox[{"Abs", "[", 
                 RowBox[{"increment", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}]}], "]"}], 
            ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"i", ">=", "imax"}], ")"}], ",", 
              RowBox[{"\"\<i>=imax :\>\"", "<>", 
               RowBox[{"ToString", "[", "i", "]"}]}]}], "]"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"period0", "+", 
                 RowBox[{"i", "*", "periodn"}]}], ">", "kmax"}], ")"}], ",", 
              RowBox[{"\"\<period0+i*periodn>kmax:\>\"", "<>", 
               RowBox[{"ToString", "[", 
                RowBox[{"period0", "+", 
                 RowBox[{"i", "*", "periodn"}]}], "]"}]}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Abs", "[", 
                 RowBox[{"increment", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], ">", " ", 
                RowBox[{"IncrementFactor", " ", 
                 RowBox[{"Abs", "[", 
                  RowBox[{"incrementPrecedent", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "]"}]}]}], ")"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
              "\"\<(Abs[increment[[1]]] > IncrementFactor \
Abs[incrementPrecedent[[1]]]):\>\"", "<>", 
               RowBox[{"ToString", "[", 
                RowBox[{"Abs", "[", 
                 RowBox[{"increment", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "<>", 
               "\"\< > \>\"", "<>", 
               RowBox[{"ToString", "[", "IncrementFactor", "]"}], "<>", 
               "\"\< X \>\"", "<>", 
               RowBox[{"ToString", "[", 
                RowBox[{"Abs", "[", 
                 RowBox[{"incrementPrecedent", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}]}], "]"}]}], 
           "}"}]}], "]"}], ";", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\< Sum finale=\>\"", ",", "sum"}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Abs", "[", 
          RowBox[{"increment", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Abs", "[", 
                RowBox[{"increment", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "\[LessEqual]", 
               "\[Epsilon]"}], ")"}], ",", 
             RowBox[{"\"\<increment<=\[Epsilon] :\>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"Abs", "[", 
                RowBox[{"increment", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}]}], "]"}], ",",
            
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"i", ">=", "imax"}], ")"}], ",", 
             RowBox[{"\"\<i>=imax :\>\"", "<>", 
              RowBox[{"ToString", "[", "i", "]"}]}]}], "]"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"period0", "+", 
                RowBox[{"i", "*", "periodn"}]}], ">", "kmax"}], ")"}], ",", 
             RowBox[{"\"\<period0+i*periodn>kmax:\>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"period0", "+", 
                RowBox[{"i", "*", "periodn"}]}], "]"}]}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Abs", "[", 
                RowBox[{"increment", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], ">", " ", 
               RowBox[{"IncrementFactor", " ", 
                RowBox[{"Abs", "[", 
                 RowBox[{"incrementPrecedent", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}]}]}], ")"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
             "\"\<(Abs[increment[[1]]] > IncrementFactor \
Abs[incrementPrecedent[[1]]]):\>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"Abs", "[", 
                RowBox[{"increment", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "<>", 
              "\"\< > \>\"", "<>", 
              RowBox[{"ToString", "[", "IncrementFactor", "]"}], "<>", 
              "\"\< X \>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"Abs", "[", 
                RowBox[{"incrementPrecedent", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}]}], "]"}]}], 
          "}"}]}], "}"}], ",", "sum"}], "}"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4038679573575945`*^9, 3.4038681122824445`*^9}, {
   3.403868218503234*^9, 3.4038682723011417`*^9}, {3.4038683294272385`*^9, 
   3.403868512993263*^9}, {3.4038685440719843`*^9, 3.403868591635398*^9}, {
   3.403869293008239*^9, 3.4038693566344604`*^9}, {3.403869465261546*^9, 
   3.403869476199256*^9}, {3.4038774840873795`*^9, 3.403877491821903*^9}, {
   3.403877552854325*^9, 3.403877688075671*^9}, {3.4038778333597107`*^9, 
   3.403877834172226*^9}, {3.404323563294944*^9, 3.404323601421344*^9}, {
   3.4044535096068583`*^9, 3.404453511199466*^9}, {3.404453625258275*^9, 
   3.4044536566263995`*^9}, 3.4044537555370502`*^9, {3.4044538788033147`*^9, 
   3.4044538846709075`*^9}, {3.4044539840610633`*^9, 
   3.4044539957332516`*^9}, {3.40575112299415*^9, 3.4057511452602024`*^9}, {
   3.4057513553111105`*^9, 3.4057513593424377`*^9}, {3.4057517112241936`*^9, 
   3.4057517830849485`*^9}, 3.4057518522581515`*^9, 3.4057518925558004`*^9, 
   3.4057519377129173`*^9, {3.405752035558546*^9, 3.405752077387474*^9}, {
   3.4057521256540256`*^9, 3.4057521272009306`*^9}, 3.4057523358143106`*^9, {
   3.40575244097258*^9, 3.405752446316432*^9}, {3.405754452542451*^9, 
   3.4057544806992416`*^9}, 3.4057549719742985`*^9, 3.405837157574476*^9, 
   3.4058372963115144`*^9, {3.405840084005662*^9, 3.405840097662174*^9}, {
   3.4058404506377015`*^9, 3.405840477247587*^9}, {3.4058405745932064`*^9, 
   3.4058406209065957`*^9}, {3.4058473715674553`*^9, 3.405847409396307*^9}, {
   3.405848413024951*^9, 3.405848466447852*^9}, {3.405848551433859*^9, 
   3.4058485799344063`*^9}, {3.4058486122162757`*^9, 3.405848616825739*^9}, {
   3.4063663187770824`*^9, 3.4063663742312727`*^9}, {3.4063665397500753`*^9, 
   3.4063665410000997`*^9}, {3.4063890810536156`*^9, 
   3.4063890990856733`*^9}, {3.406389131399621*^9, 3.4063891431813984`*^9}, 
   3.406389174979698*^9, {3.406389675674003*^9, 3.4063897221760864`*^9}, {
   3.406389930122902*^9, 3.406389988516143*^9}, {3.4065428010685034`*^9, 
   3.406542808334315*^9}, {3.4065428408976483`*^9, 3.406542913805765*^9}, {
   3.406551816623519*^9, 3.4065518250768604`*^9}, {3.4065518894847593`*^9, 
   3.406551897656843*^9}, {3.406554030227061*^9, 3.4065540777282767`*^9}, {
   3.4065541079009237`*^9, 3.4065541142760873`*^9}, {3.4065543702201395`*^9, 
   3.4065544475658693`*^9}, {3.406554522239656*^9, 3.406554530646121*^9}, {
   3.4065545737878504`*^9, 3.4065547137445583`*^9}, {3.406554818669119*^9, 
   3.4065548375133514`*^9}, {3.406560243667371*^9, 3.4065602501831627`*^9}, {
   3.406608366793694*^9, 3.4066084511552286`*^9}, {3.406608482374778*^9, 
   3.4066084939844503`*^9}, 3.4066085286103363`*^9, 3.4066085725020847`*^9, {
   3.406608635081812*^9, 3.406608678489173*^9}, 3.4066110854414144`*^9, {
   3.406616000224541*^9, 3.406616004927787*^9}, {3.4066195013766685`*^9, 
   3.4066195236897397`*^9}, {3.4068901143861723`*^9, 3.406890163043045*^9}, {
   3.4068902924197006`*^9, 3.4068903026229563`*^9}, {3.406890692768575*^9, 
   3.4068906961436186`*^9}, {3.406890960631379*^9, 3.40689112947729*^9}, {
   3.4068911722434626`*^9, 3.406891187696785*^9}, {3.4068912223066034`*^9, 
   3.4068913544020443`*^9}, {3.406893025501559*^9, 3.4068930556581945`*^9}, {
   3.406893272004714*^9, 3.406893296317525*^9}, {3.4068936468845124`*^9, 
   3.406893663353473*^9}, {3.4068937025727253`*^9, 3.4068937671360517`*^9}, {
   3.4068938341056585`*^9, 3.4068938947783103`*^9}, {3.406893975107464*^9, 
   3.4068939757793474`*^9}, {3.4068940239205885`*^9, 3.4068940533115897`*^9}, 
   3.4069583708077993`*^9, {3.4069642959996862`*^9, 3.406964393189052*^9}, {
   3.406965363567058*^9, 3.4069653969895744`*^9}, 3.4069710659577913`*^9, {
   3.406971118411924*^9, 3.4069711235682726`*^9}, {3.4069714740281267`*^9, 
   3.406971484278323*^9}, {3.4069715374824696`*^9, 3.406971558748503*^9}, {
   3.4069716825790057`*^9, 3.4069717580960803`*^9}, {3.406973615913*^9, 
   3.4069737230400567`*^9}, {3.406973770212837*^9, 3.406973770556594*^9}, {
   3.406973846339299*^9, 3.4069738478237023`*^9}, {3.406974781841635*^9, 
   3.406974793169978*^9}, {3.406974845874115*^9, 3.4069748505617046`*^9}, 
   3.406975657405321*^9, {3.406975711218854*^9, 3.4069757179689837`*^9}, {
   3.4069758261429358`*^9, 3.4069758282211003`*^9}, {3.406975901910015*^9, 
   3.40697592689487*^9}, {3.4069759720051107`*^9, 3.406975990927349*^9}, {
   3.4082107603362074`*^9, 3.4082107954732075`*^9}, {3.408210876096207*^9, 
   3.408210928656207*^9}, {3.4082110166972075`*^9, 3.408211084753207*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"VectorAdaptativeIntegrateExplosionSafe", "[", 
   RowBox[{
   "Func_", ",", "LegendreCoef0_", ",", "LegendreCoefn_", ",", "period0_", 
    ",", "periodn_", ",", "\[Epsilon]_", ",", "imax_", ",", "n_", ",", 
    "startmonitortime_", ",", "plafondexplosion_", ",", "initialTailFlag_", 
    ",", "InitialTailPosition_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"sum", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0.0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ",", 
      RowBox[{"increment", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ",", 
      RowBox[{"i", "=", "0"}], ",", 
      RowBox[{"incrementPrec", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ",", 
      "exploded"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"initialTailFlag", ">", "0"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"sum", ",", "exploded"}], "}"}], "=", 
         RowBox[{"VectorCoeffBasedIntegrateExplosionSafe", "[", 
          RowBox[{"Func", ",", 
           RowBox[{"LegendreCoeffsFromLegendre", "[", 
            RowBox[{"LegendreCoef0", ",", "0", ",", "InitialTailPosition"}], 
            "]"}], ",", "n", ",", "startmonitortime", ",", 
           "plafondexplosion"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"increment", ",", "exploded"}], "}"}], "=", 
         RowBox[{"VectorCoeffBasedIntegrateExplosionSafe", "[", 
          RowBox[{"Func", ",", 
           RowBox[{"LegendreCoeffsFromLegendre", "[", 
            RowBox[{
            "LegendreCoef0", ",", "InitialTailPosition", ",", "period0"}], 
            "]"}], ",", "n", ",", "startmonitortime", ",", 
           "plafondexplosion"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"sum", "+=", "increment"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"sum", ",", "exploded"}], "}"}], "=", 
        RowBox[{"VectorCoeffBasedIntegrateExplosionSafe", "[", 
         RowBox[{"Func", ",", 
          RowBox[{"LegendreCoeffsFromLegendre", "[", 
           RowBox[{"LegendreCoef0", ",", "0", ",", "period0"}], "]"}], ",", 
          "n", ",", "startmonitortime", ",", "plafondexplosion"}], "]"}]}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"exploded", "<", "1"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"increment", ",", "exploded"}], "}"}], "=", 
         RowBox[{"VectorCoeffBasedIntegrateExplosionSafe", "[", 
          RowBox[{"Func", ",", 
           RowBox[{"LegendreCoeffsFromLegendre", "[", 
            RowBox[{"LegendreCoefn", ",", 
             RowBox[{"period0", "+", 
              RowBox[{"i", "*", "periodn"}]}], ",", 
             RowBox[{"period0", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"i", "+", "1"}], ")"}], "*", "periodn"}]}]}], "]"}], 
           ",", "n", ",", "\[IndentingNewLine]", "startmonitortime", ",", 
           "plafondexplosion"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"exploded", "<", "1"}], ")"}], "&&", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{"increment", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], ">", "\[Epsilon]"}], 
             ")"}], "&&", 
            RowBox[{"(", 
             RowBox[{"i", "<", "imax"}], ")"}]}], ")"}], ",", 
          RowBox[{
           RowBox[{"sum", "+=", "increment"}], ";", 
           RowBox[{"i", "+=", "1"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"increment", ",", "exploded"}], "}"}], "=", 
            RowBox[{"VectorCoeffBasedIntegrateExplosionSafe", "[", 
             RowBox[{"Func", ",", 
              RowBox[{"LegendreCoeffsFromLegendre", "[", 
               RowBox[{"LegendreCoefn", ",", 
                RowBox[{"period0", "+", 
                 RowBox[{"i", "*", "periodn"}]}], ",", 
                RowBox[{"period0", "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"i", "+", "1"}], ")"}], "*", "periodn"}]}]}], 
               "]"}], ",", "n", ",", "\[IndentingNewLine]", 
              "startmonitortime", ",", "plafondexplosion"}], "]"}]}]}]}], 
         "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"exploded", ">", "0"}], ",", "\"\<exploded\>\""}], "]"}], 
         ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Abs", "[", 
             RowBox[{"increment", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "<", "\[Epsilon]"}], ",",
            
           RowBox[{"\"\<Abs[increment[[1]]]<\[Epsilon]:\>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"Abs", "[", 
              RowBox[{"increment", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}]}], "]"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"i", ">=", "imax"}], ")"}], ",", 
           RowBox[{"\"\<i>=imax\>\"", "<>", 
            RowBox[{"ToString", "[", "i", "]"}]}]}], "]"}]}], "}"}], ",", 
       "sum"}], "}"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4038679573575945`*^9, 3.4038681122824445`*^9}, {
   3.403868218503234*^9, 3.4038682723011417`*^9}, {3.4038683294272385`*^9, 
   3.403868512993263*^9}, {3.4038685440719843`*^9, 3.403868591635398*^9}, {
   3.403869293008239*^9, 3.4038693566344604`*^9}, {3.403869465261546*^9, 
   3.403869476199256*^9}, {3.4038774840873795`*^9, 3.403877491821903*^9}, {
   3.403877552854325*^9, 3.403877688075671*^9}, {3.4038778333597107`*^9, 
   3.403877834172226*^9}, {3.404323563294944*^9, 3.404323601421344*^9}, {
   3.4044535096068583`*^9, 3.404453511199466*^9}, {3.404453625258275*^9, 
   3.4044536566263995`*^9}, 3.4044537555370502`*^9, {3.4044538788033147`*^9, 
   3.4044538846709075`*^9}, {3.4044539840610633`*^9, 
   3.4044539957332516`*^9}, {3.40575112299415*^9, 3.4057511452602024`*^9}, {
   3.4057513553111105`*^9, 3.4057513593424377`*^9}, {3.4057517112241936`*^9, 
   3.4057517830849485`*^9}, 3.4057518522581515`*^9, 3.4057518925558004`*^9, 
   3.4057519377129173`*^9, {3.405752035558546*^9, 3.405752077387474*^9}, {
   3.4057521256540256`*^9, 3.4057521272009306`*^9}, 3.4057523358143106`*^9, {
   3.40575244097258*^9, 3.405752446316432*^9}, {3.405754452542451*^9, 
   3.4057544806992416`*^9}, 3.4057549719742985`*^9, 3.405837157574476*^9, 
   3.4058372963115144`*^9, {3.405840084005662*^9, 3.405840097662174*^9}, {
   3.4058404506377015`*^9, 3.405840477247587*^9}, {3.4058405745932064`*^9, 
   3.4058406209065957`*^9}, {3.4058473715674553`*^9, 3.405847409396307*^9}, {
   3.405848413024951*^9, 3.405848466447852*^9}, {3.405848551433859*^9, 
   3.4058485799344063`*^9}, {3.4058486122162757`*^9, 3.405848616825739*^9}, {
   3.4063663187770824`*^9, 3.4063663742312727`*^9}, {3.4063665397500753`*^9, 
   3.4063665410000997`*^9}, {3.4063667367069817`*^9, 3.406366753597931*^9}, {
   3.406366983914853*^9, 3.4063669928212748`*^9}, 3.406386062680172*^9, {
   3.4063861906098843`*^9, 3.406386195453882*^9}, {3.4063862270023727`*^9, 
   3.4063862371278906`*^9}, {3.4063865252516203`*^9, 
   3.4063865393928795`*^9}, {3.406386599286187*^9, 3.40638662009962*^9}, {
   3.406387079838965*^9, 3.4063870900581727`*^9}, {3.4063872400336413`*^9, 
   3.406387272628852*^9}, {3.4063873420694623`*^9, 3.4063873467571726`*^9}, {
   3.4063873808837013`*^9, 3.406387520343074*^9}, {3.4063875734548283`*^9, 
   3.406387583924047*^9}, {3.4063876303011246`*^9, 3.4063877202895308`*^9}, 
   3.406387777213956*^9, 3.4063878116686244`*^9, {3.4063878697649775`*^9, 
   3.4063878753746033`*^9}, {3.4063879056884613`*^9, 3.4063879074385395`*^9}, 
   3.406387943924549*^9, {3.4063904895385876`*^9, 3.4063904898042245`*^9}, {
   3.4063905290872345`*^9, 3.4063905479474545`*^9}, 3.4065424061365185`*^9, {
   3.406555755083716*^9, 3.406555798647331*^9}, {3.406556460789282*^9, 
   3.406556603667939*^9}, {3.4065592356415663`*^9, 3.40655924731374*^9}, 
   3.40656244134863*^9, 3.4066103047339287`*^9, {3.406611121629841*^9, 
   3.4066112033819337`*^9}, 3.406616101586511*^9, {3.4066169895623674`*^9, 
   3.406616996843804*^9}, {3.4066172617880864`*^9, 3.4066172622724743`*^9}, 
   3.406617312258128*^9, {3.406617343024541*^9, 3.406617346977767*^9}, {
   3.406617389931992*^9, 3.406617391244526*^9}, 3.406617651844947*^9, {
   3.4068774630401087`*^9, 3.40687751808945*^9}, {3.4068776105467167`*^9, 
   3.406877673377657*^9}, {3.4068777342553835`*^9, 3.4068777496935754`*^9}, 
   3.406877869292683*^9, {3.406878305530976*^9, 3.406878328594509*^9}, {
   3.406971138115427*^9, 3.406971252680127*^9}, {3.406975099003975*^9, 
   3.4069751100041857`*^9}, {3.406975160958289*^9, 3.4069751709584813`*^9}, {
   3.4069752251782722`*^9, 3.40697524460052*^9}, {3.408430788035997*^9, 
   3.408430804395686*^9}, {3.4084310646819334`*^9, 3.408431087776127*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"VectorCoeffBasedIntegrateExplosionSafe", "[", 
   RowBox[{
   "f_", ",", "coeffs_", ",", "nb_", ",", "startmonitortime_", ",", 
    "plafond_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", "coeffs", "]"}]}], ",", 
      RowBox[{"sum", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0.0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "nb"}], "}"}]}], "]"}]}], ",", 
      RowBox[{"i", "=", "1"}], ",", 
      RowBox[{"increment", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0.0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "nb"}], "}"}]}], "]"}]}], ",", 
      RowBox[{"exploded", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"increment", "=", 
      RowBox[{"f", "[", 
       RowBox[{"coeffs", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"coeffs", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "1"}], "]"}], "]"}], ">", "startmonitortime"}], "&&",
         
        RowBox[{
         RowBox[{"Max", "[", 
          RowBox[{"Abs", "[", "increment", "]"}], "]"}], ">", "plafond"}]}], 
       ",", 
       RowBox[{"exploded", "=", "1"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"i", "<", "n"}], "&&", 
        RowBox[{"exploded", "<", "1"}]}], ",", 
       RowBox[{
        RowBox[{"sum", "+=", 
         RowBox[{"increment", " ", 
          RowBox[{"coeffs", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}]}]}], ";", 
        RowBox[{"i", "++"}], ";", 
        RowBox[{"increment", "=", 
         RowBox[{"f", "[", 
          RowBox[{"coeffs", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}]}], " ", ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"coeffs", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1"}], "]"}], "]"}], ">", 
            "startmonitortime"}], "&&", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"Abs", "[", "increment", "]"}], "]"}], ">", 
            "plafond"}]}], ",", 
          RowBox[{"exploded", "=", "1"}]}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"i", "\[Equal]", "n"}], "&&", 
        RowBox[{"exploded", "<", "1"}]}], ",", 
       RowBox[{"sum", "+=", 
        RowBox[{"increment", " ", 
         RowBox[{"coeffs", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "2"}], "]"}], "]"}]}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"sum", ",", "exploded"}], "}"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4060310894614077`*^9, 3.4060311013678865`*^9}, {
   3.4060313933109913`*^9, 3.406031590033519*^9}, 3.4060316257842054`*^9, {
   3.406031667972515*^9, 3.4060316748788977`*^9}, {3.406031710567083*^9, 
   3.4060318087720933`*^9}, {3.4060318471165795`*^9, 3.406031857491779*^9}, {
   3.406032533817264*^9, 3.4060326012716837`*^9}, {3.4060327331648417`*^9, 
   3.4060327646029453`*^9}, {3.4060328074318924`*^9, 
   3.4060328124632387`*^9}, {3.4060344792608657`*^9, 3.406034486870387*^9}, {
   3.4060345426370826`*^9, 3.406034543652727*^9}, {3.4060346014194613`*^9, 
   3.4060346039820104`*^9}, {3.4060350538968983`*^9, 
   3.4060350548812923`*^9}, {3.4063112515165777`*^9, 3.406311261804578*^9}, {
   3.406312547156578*^9, 3.4063125733725777`*^9}, {3.4063127381485777`*^9, 
   3.4063127409245777`*^9}, 3.4063587838667903`*^9, 3.4063860580236235`*^9, 
   3.4063862054075165`*^9, {3.406386372884841*^9, 3.4063863835572624`*^9}, 
   3.4063864364818473`*^9, {3.4068781129598494`*^9, 3.406878133054499*^9}, {
   3.406878172431263*^9, 3.4068781896507845`*^9}, {3.4068782752014923`*^9, 
   3.406878279592314*^9}}],

Cell[BoxData[
 RowBox[{"Integration", " ", "adaptative", " ", "resistante", " ", "aux", " ",
   "sauts"}]], "Input",
 CellChangeTimes->{{3.406368619055622*^9, 3.4063686666815367`*^9}},
 TextAlignment->Center,
 Background->RGBColor[1, 0.5, 0]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.406035193540205*^9, 3.4060351960558777`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 StyleBox[
  RowBox[{
   RowBox[{"Problem", " ", "of", " ", "the", " ", "relationship", " ", "Q"}], 
   "<", 
   RowBox[{"-", " ", 
    RowBox[{">", " ", 
     SubscriptBox["\[CapitalSigma]", "inf"]}]}]}],
  FontFamily->"Arial"]], "Subsubtitle",
 CellChangeTimes->{{3.407058885346814*^9, 3.407058920847496*^9}}],

Cell[BoxData[
 RowBox[{"Pour", " ", "trouver", " ", 
  SubscriptBox["\[CapitalSigma]", "inf"], " ", "on", " ", "doit", " ", 
  "resoudre", " "}]], "Input",
 CellChangeTimes->{{3.407058226318536*^9, 3.407058263975509*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Q", "=", 
   RowBox[{"CholeskyDecomposition", "[", 
    RowBox[{"-", 
     RowBox[{"(", 
      FractionBox[
       RowBox[{
        RowBox[{"M", ".", "\[CapitalSigma]inf"}], "+", 
        RowBox[{"\[CapitalSigma]inf", ".", " ", 
         RowBox[{"Transpose", "[", "M", "]"}]}]}], "\[Beta]"], ")"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4070514975330963`*^9, 3.4070515061426363`*^9}, {
  3.407051611644662*^9, 3.4070516118946667`*^9}, {3.4070561367627926`*^9, 
  3.407056151294321*^9}, {3.4084659311954355`*^9, 3.4084659364455366`*^9}}],

Cell[BoxData[
 RowBox[{"Soit", " ", "en", " ", 
  RowBox[{"fait", " ", ":"}]}]], "Input",
 CellChangeTimes->{{3.407058273038183*^9, 3.4070582765382504`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Transpose", "[", "Q", "]"}], ".", "Q"}], "=", 
   RowBox[{"-", 
    RowBox[{"(", 
     FractionBox[
      RowBox[{
       RowBox[{"M", ".", "\[CapitalSigma]inf"}], "+", 
       RowBox[{"\[CapitalSigma]inf", ".", " ", 
        RowBox[{"Transpose", "[", "M", "]"}]}]}], "\[Beta]"], ")"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.4070514975330963`*^9, 3.4070515061426363`*^9}, {
  3.407051611644662*^9, 3.4070516118946667`*^9}, {3.4070561367627926`*^9, 
  3.407056151294321*^9}, {3.4070582864446907`*^9, 3.407058304288783*^9}, {
  3.4084659400237303`*^9, 3.4084659483676405`*^9}}],

Cell[BoxData[
 RowBox[{"ce", " ", "qui", " ", "est", " ", "equivalent", " ", 
  RowBox[{"a", " ", ":"}]}]], "Input",
 CellChangeTimes->{{3.4070583104607763`*^9, 3.4070583200234604`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"M", ".", "\[CapitalSigma]inf"}], "+", 
    RowBox[{"\[CapitalSigma]inf", ".", " ", 
     RowBox[{"Transpose", "[", "M", "]"}]}]}], "=", 
   RowBox[{
    RowBox[{"-", "\[Beta]"}], " ", 
    RowBox[{
     RowBox[{"Transpose", "[", "Q", "]"}], ".", "Q"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4070514975330963`*^9, 3.4070515061426363`*^9}, {
  3.407051611644662*^9, 3.4070516118946667`*^9}, {3.4070561367627926`*^9, 
  3.407056151294321*^9}, {3.4070582864446907`*^9, 3.4070583640399303`*^9}, {
  3.4084659547896385`*^9, 3.4084659588990927`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"M11", ",", "M12"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"M21", ",", "M22"}], "}"}]}], "}"}], ".", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "b"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "c"}], "}"}]}], "}"}]}], "+", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "b"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "c"}], "}"}]}], "}"}], ".", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"M11", ",", "M21"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"M12", ",", "M22"}], "}"}]}], "}"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"2", " ", "a", " ", "M11"}], "+", 
      RowBox[{"2", " ", "b", " ", "M12"}]}], ",", 
     RowBox[{
      RowBox[{"b", " ", "M11"}], "+", 
      RowBox[{"c", " ", "M12"}], "+", 
      RowBox[{"a", " ", "M21"}], "+", 
      RowBox[{"b", " ", "M22"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"b", " ", "M11"}], "+", 
      RowBox[{"c", " ", "M12"}], "+", 
      RowBox[{"a", " ", "M21"}], "+", 
      RowBox[{"b", " ", "M22"}]}], ",", 
     RowBox[{
      RowBox[{"2", " ", "b", " ", "M21"}], "+", 
      RowBox[{"2", " ", "c", " ", "M22"}]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.4070586010757313`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"M11", ",", "M12"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"M21", ",", "M22"}], "}"}]}], "}"}], ".", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a", ",", "b"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"b", ",", "c"}], "}"}]}], "}"}]}], "+", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a", ",", "b"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"b", ",", "c"}], "}"}]}], "}"}], ".", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"M11", ",", "M21"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"M12", ",", "M22"}], "}"}]}], "}"}]}]}], "\[Equal]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"h11", ",", "h12"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"h21", ",", "h22"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", "b", ",", "c"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.4070584142908955`*^9, 3.4070585471371956`*^9}}],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{3.407058483589101*^9, 3.407058548293468*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"2", " ", "a", " ", "M11"}], "+", 
       RowBox[{"2", " ", "b", " ", "M12"}]}], "\[Equal]", "h11"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"b", " ", "M11"}], "+", 
       RowBox[{"c", " ", "M12"}], "+", 
       RowBox[{"a", " ", "M21"}], "+", 
       RowBox[{"b", " ", "M22"}]}], "\[Equal]", "h12"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"2", " ", "b", " ", "M21"}], "+", 
       RowBox[{"2", " ", "c", " ", "M22"}]}], "\[Equal]", "h22"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", "b", ",", "c"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.4070586225448933`*^9, 3.407058672577104*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"a", "\[Rule]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "h22"}], " ", 
         SuperscriptBox["M12", "2"]}], "+", 
        RowBox[{"h11", " ", "M12", " ", "M21"}], "-", 
        RowBox[{"h11", " ", "M11", " ", "M22"}], "+", 
        RowBox[{"2", " ", "h12", " ", "M12", " ", "M22"}], "-", 
        RowBox[{"h11", " ", 
         SuperscriptBox["M22", "2"]}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"M11", "+", "M22"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "M12"}], " ", "M21"}], "+", 
          RowBox[{"M11", " ", "M22"}]}], ")"}]}]]}]}], ",", 
    RowBox[{"b", "\[Rule]", 
     FractionBox[
      RowBox[{
       RowBox[{
        RowBox[{"-", "h22"}], " ", "M11", " ", "M12"}], "+", 
       RowBox[{"2", " ", "h12", " ", "M11", " ", "M22"}], "-", 
       RowBox[{"h11", " ", "M21", " ", "M22"}]}], 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{"M11", "+", "M22"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "M12"}], " ", "M21"}], "+", 
         RowBox[{"M11", " ", "M22"}]}], ")"}]}]]}], ",", 
    RowBox[{"c", "\[Rule]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "h22"}], " ", 
         SuperscriptBox["M11", "2"]}], "+", 
        RowBox[{"2", " ", "h12", " ", "M11", " ", "M21"}], "+", 
        RowBox[{"h22", " ", "M12", " ", "M21"}], "-", 
        RowBox[{"h11", " ", 
         SuperscriptBox["M21", "2"]}], "-", 
        RowBox[{"h22", " ", "M11", " ", "M22"}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"M11", "+", "M22"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "M12"}], " ", "M21"}], "+", 
          RowBox[{"M11", " ", "M22"}]}], ")"}]}]]}]}]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.407058674092758*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"h", " ", "doit", " ", "etre", " ", "symetrique"}]], "Input",
 CellChangeTimes->{{3.4070609702930946`*^9, 3.407060975840076*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SolveSymetricEquation", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"M11_", ",", "M12_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"M21_", ",", "M22_"}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"h11_", ",", "h12_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"h21_", ",", "h22_"}], "}"}]}], "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "c"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"a", "=", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{
          RowBox[{"-", "h22"}], " ", 
          SuperscriptBox["M12", "2"]}], "+", 
         RowBox[{"h11", " ", "M12", " ", "M21"}], "-", 
         RowBox[{"h11", " ", "M11", " ", "M22"}], "+", 
         RowBox[{"2", " ", "h12", " ", "M12", " ", "M22"}], "-", 
         RowBox[{"h11", " ", 
          SuperscriptBox["M22", "2"]}]}], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"M11", "+", "M22"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "M12"}], " ", "M21"}], "+", 
           RowBox[{"M11", " ", "M22"}]}], ")"}]}]]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"b", "=", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "h22"}], " ", "M11", " ", "M12"}], "+", 
        RowBox[{"2", " ", "h12", " ", "M11", " ", "M22"}], "-", 
        RowBox[{"h11", " ", "M21", " ", "M22"}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"M11", "+", "M22"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "M12"}], " ", "M21"}], "+", 
          RowBox[{"M11", " ", "M22"}]}], ")"}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{
          RowBox[{"-", "h22"}], " ", 
          SuperscriptBox["M11", "2"]}], "+", 
         RowBox[{"2", " ", "h12", " ", "M11", " ", "M21"}], "+", 
         RowBox[{"h22", " ", "M12", " ", "M21"}], "-", 
         RowBox[{"h11", " ", 
          SuperscriptBox["M21", "2"]}], "-", 
         RowBox[{"h22", " ", "M11", " ", "M22"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"M11", "+", "M22"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "M12"}], " ", "M21"}], "+", 
           RowBox[{"M11", " ", "M22"}]}], ")"}]}]]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "b"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"b", ",", "c"}], "}"}]}], "}"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4070587032183175`*^9, 3.4070588658620653`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Solve\[CapitalSigma]infFrom\[Beta]", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"M11_", ",", "M12_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"M21_", ",", "M22_"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Q11_", ",", "Q12_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Q21_", ",", "Q22_"}], "}"}]}], "}"}], ",", "\[Beta]_"}], 
    "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c", ",", 
       RowBox[{"h11", "=", 
        RowBox[{
         RowBox[{"-", " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["Q11", "2"], "+", 
            SuperscriptBox["Q21", "2"]}], ")"}]}], " ", "\[Beta]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"h12", "=", 
        RowBox[{
         RowBox[{"-", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Q11", " ", "Q12"}], "+", 
            RowBox[{"Q21", " ", "Q22"}]}], ")"}]}], " ", "\[Beta]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"h22", "=", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["Q12", "2"], "+", 
            SuperscriptBox["Q22", "2"]}], ")"}]}], " ", "\[Beta]"}]}]}], 
      "}"}], ",", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{"{", 
        RowBox[{"h11", ",", "h12", ",", "h22"}], "}"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"a", "=", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          RowBox[{
           RowBox[{"-", "h22"}], " ", 
           SuperscriptBox["M12", "2"]}], "+", 
          RowBox[{"h11", " ", "M12", " ", "M21"}], "-", 
          RowBox[{"h11", " ", "M11", " ", "M22"}], "+", 
          RowBox[{"2", " ", "h12", " ", "M12", " ", "M22"}], "-", 
          RowBox[{"h11", " ", 
           SuperscriptBox["M22", "2"]}]}], 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{"M11", "+", "M22"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "M12"}], " ", "M21"}], "+", 
            RowBox[{"M11", " ", "M22"}]}], ")"}]}]]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       FractionBox[
        RowBox[{
         RowBox[{
          RowBox[{"-", "h22"}], " ", "M11", " ", "M12"}], "+", 
         RowBox[{"2", " ", "h12", " ", "M11", " ", "M22"}], "-", 
         RowBox[{"h11", " ", "M21", " ", "M22"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"M11", "+", "M22"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "M12"}], " ", "M21"}], "+", 
           RowBox[{"M11", " ", "M22"}]}], ")"}]}]]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          RowBox[{
           RowBox[{"-", "h22"}], " ", 
           SuperscriptBox["M11", "2"]}], "+", 
          RowBox[{"2", " ", "h12", " ", "M11", " ", "M21"}], "+", 
          RowBox[{"h22", " ", "M12", " ", "M21"}], "-", 
          RowBox[{"h11", " ", 
           SuperscriptBox["M21", "2"]}], "-", 
          RowBox[{"h22", " ", "M11", " ", "M22"}]}], 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{"M11", "+", "M22"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "M12"}], " ", "M21"}], "+", 
            RowBox[{"M11", " ", "M22"}]}], ")"}]}]]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a", ",", "b"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"b", ",", "c"}], "}"}]}], "}"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4084544758661227`*^9, 3.4084546886983337`*^9}, {
  3.4084592030506325`*^9, 3.4084592405201025`*^9}, {3.4084658912727947`*^9, 
  3.4084659077887363`*^9}, {3.4084660931829205`*^9, 3.408466356797357*^9}, {
  3.4084665372226963`*^9, 3.408466546379122*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SolveQFrom\[CapitalSigma]inf", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"M11_", ",", "M12_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"M21_", ",", "M22_"}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"S11_", ",", "S12_", ",", "S22_"}], "}"}], ",", "\[Beta]_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "a", ",", "b", ",", "c", ",", "Q11", ",", "Q12", ",", "Q21", ",", 
      "Q22"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"a", "=", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "M11", " ", "S11"}], "-", 
        RowBox[{"2", " ", "M12", " ", "S12"}]}], "\[Beta]"]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"b", "=", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "M21"}], " ", "S11"}], "-", 
        RowBox[{"M11", " ", "S12"}], "-", 
        RowBox[{"M22", " ", "S12"}], "-", 
        RowBox[{"M12", " ", "S22"}]}], "\[Beta]"]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "M21", " ", "S12"}], "-", 
        RowBox[{"2", " ", "M22", " ", "S22"}]}], "\[Beta]"]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Q11", "=", 
      SqrtBox["a"]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Q12", "=", 
      FractionBox["b", 
       SqrtBox["a"]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Q21", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Q22", "=", 
      SqrtBox[
       RowBox[{"c", "-", " ", 
        FractionBox[
         SuperscriptBox["b", "2"], "a"]}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Q11", ",", "Q12"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Q21", ",", "Q22"}], "}"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"M", "=", 
   RowBox[{"-", 
    RowBox[{"(", GridBox[{
       {"0.35", "0.0"},
       {"0.0", "0.35"}
      }], ")"}]}]}], ";", 
  RowBox[{"Q", "=", 
   RowBox[{"(", GridBox[{
      {"0.08660254", "0.05"},
      {"0.0", "0.1"}
     }], ")"}]}], ";", 
  RowBox[{"\[Beta]", "=", "2.2"}], ";"}]], "Input",
 CellChangeTimes->{{3.4074813104799876`*^9, 3.4074813618269873`*^9}, 
   3.4074827546859875`*^9, 3.407482815884988*^9, {3.407483406804988*^9, 
   3.407483440014988*^9}, {3.4084617325523233`*^9, 3.4084617406149783`*^9}, {
   3.408461814491397*^9, 3.408461872336257*^9}, 3.4084619199777966`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[CapitalSigma]inf", "=", 
  RowBox[{"Solve\[CapitalSigma]infFrom\[Beta]", "[", 
   RowBox[{"M", ",", "Q", ",", "\[Beta]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.4084548059505854`*^9, 3.4084548121694546`*^9}, {
  3.4084665855829997`*^9, 3.4084666034114676`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "0.016499999855793524`"}], ",", 
   RowBox[{"-", "0.009526279400000002`"}], ",", 
   RowBox[{"-", "0.027500000000000007`"}]}], "}"}]], "Print",
 CellChangeTimes->{
  3.408459243160778*^9, {3.4084659805401335`*^9, 3.408465988790292*^9}, {
   3.408466566488883*^9, 3.4084666046927414`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.02357142836541932`", ",", "0.013608970571428576`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0.013608970571428576`", ",", "0.0392857142857143`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.408454812903844*^9, {3.408459196019248*^9, 3.408459243160778*^9}, {
   3.4084659805401335`*^9, 3.408465988790292*^9}, {3.408466566488883*^9, 
   3.4084666046927414`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Q1", "=", 
  RowBox[{"SolveQFrom\[CapitalSigma]inf", "[", 
   RowBox[{"M", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[CapitalSigma]inf", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
      RowBox[{"\[CapitalSigma]inf", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", 
      RowBox[{"\[CapitalSigma]inf", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "}"}], ",", "\[Beta]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.4084666195836525`*^9, 3.4084667011320934`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.08660254`", ",", "0.05`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0.1`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.4084667033352604`*^9}]
}, Open  ]],

Cell["Apparment different mais en fait un Q equivalent :", "Text",
 CellChangeTimes->{{3.408466827212639*^9, 3.408466849494317*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"Transpose", "[", "Q", "]"}], ".", "Q"}], ",", 
   RowBox[{
    RowBox[{"Transpose", "[", "Q1", "]"}], ".", "Q1"}], ",", 
   RowBox[{"-", 
    RowBox[{"(", 
     FractionBox[
      RowBox[{
       RowBox[{"M", ".", "\[CapitalSigma]inf"}], "+", 
       RowBox[{"\[CapitalSigma]inf", ".", " ", 
        RowBox[{"Transpose", "[", "M", "]"}]}]}], "\[Beta]"], ")"}]}]}], 
  "}"}]], "Input",
 CellChangeTimes->{{3.4074815775639877`*^9, 3.4074815925019875`*^9}, {
  3.4084667497424016`*^9, 3.408466759539465*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.0074999999344516005`", ",", "0.0043301270000000005`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.0043301270000000005`", ",", "0.012500000000000002`"}], 
      "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.0074999999344516005`", ",", "0.0043301270000000005`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.0043301270000000005`", ",", "0.012500000000000002`"}], 
      "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.007499999934451601`", ",", "0.0043301270000000005`"}], "}"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"0.0043301270000000005`", ",", "0.012500000000000002`"}], 
      "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.4074815932559876`*^9, 3.407481932325988*^9, 
  3.407483494481988*^9, 3.4084547535120783`*^9, 3.4084617754281464`*^9, 
  3.408466033447399*^9, 3.4084667657427087`*^9}]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Formal Computations", "Subtitle",
 CellChangeTimes->{{3.4059383402471366`*^9, 3.405938348341042*^9}, {
  3.4074813695039873`*^9, 3.4074813727349873`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Calculs", " ", 
  RowBox[{"Formel", " ", ":", 
   FormBox[
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Alpha]", " ", 
        SubscriptBox["S", "1"]}], "-", 
       RowBox[{"\[Beta]", " ", 
        SubscriptBox["S", "2"]}], "-", "K"}], ")"}], "+"],
    TraditionalForm]}]}]], "Section",
 CellChangeTimes->{{3.4047530588767443`*^9, 3.4047530880799437`*^9}}],

Cell[CellGroupData[{

Cell[" Calculs Formels K > 0 ", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"integration1", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    SubsuperscriptBox["\[Integral]", 
     RowBox[{"Log", "[", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", "x2"], "+", "K"}], "]"}], 
     "\[Infinity]"], " ", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "k1", " ", "x1"}]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Alpha]", " ", 
        SuperscriptBox["\[ExponentialE]", "x1"]}], "-", 
       RowBox[{"\[Beta]", " ", 
        SuperscriptBox["\[ExponentialE]", "x2"]}], "-", "K"}], ")"}], 
     RowBox[{"\[DifferentialD]", "x1"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.3997830788528023`*^9, 3.3997830934780827`*^9}, {
  3.399783175698412*^9, 3.3997832121991124`*^9}, {3.3997832703252287`*^9, 
  3.3997832746221857`*^9}, {3.4047536787215443`*^9, 3.404753684930344*^9}}],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Im", "[", "k1", "]"}], ">", "1"}], ",", 
   FractionBox[
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", "x2"], "+", "K"}], ")"}], 
      RowBox[{"\[ImaginaryI]", " ", "k1"}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"K", " ", 
        RowBox[{"(", 
         RowBox[{"\[ImaginaryI]", "+", 
          RowBox[{"k1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "\[Alpha]"}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", "x2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"k1", " ", 
           RowBox[{"(", 
            RowBox[{"\[Alpha]", "-", "\[Beta]"}], ")"}]}], "+", 
          RowBox[{"\[ImaginaryI]", " ", "\[Beta]"}]}], ")"}]}]}], ")"}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "-", 
       RowBox[{"\[ImaginaryI]", " ", "k1"}]}], ")"}], " ", "k1"}]], ",", 
   RowBox[{"Integrate", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "k1", " ", "x1"}]]}], " ", "K"}], "+", 
      
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"x1", "+", 
         RowBox[{"\[ImaginaryI]", " ", "k1", " ", "x1"}]}]], " ", 
       "\[Alpha]"}], "-", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", "k1", " ", "x1"}], "+", "x2"}]], " ", 
       "\[Beta]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"x1", ",", 
       RowBox[{"Log", "[", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", "x2"], "+", "K"}], "]"}], ",", 
       "\[Infinity]"}], "}"}], ",", 
     RowBox[{"Assumptions", "\[Rule]", 
      RowBox[{
       RowBox[{"Im", "[", "k1", "]"}], "\[LessEqual]", "1"}]}]}], "]"}]}], 
  "]"}]], "Output",
 CellChangeTimes->{{3.3997832193242493`*^9, 3.399783241121543*^9}, 
   3.3997832783097568`*^9, 3.404753856612344*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"integration11", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{"integration1", ",", 
    RowBox[{
     RowBox[{"Im", "[", "k1", "]"}], ">", "1"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.3997832863099103`*^9, 3.399783319044914*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", "x2"], "+", "K"}], ")"}], 
    RowBox[{"\[ImaginaryI]", " ", "k1"}]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"K", " ", 
      RowBox[{"(", 
       RowBox[{"\[ImaginaryI]", "+", 
        RowBox[{"k1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Alpha]"}], ")"}]}]}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", "x2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"k1", " ", 
         RowBox[{"(", 
          RowBox[{"\[Alpha]", "-", "\[Beta]"}], ")"}]}], "+", 
        RowBox[{"\[ImaginaryI]", " ", "\[Beta]"}]}], ")"}]}]}], ")"}]}], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "-", 
     RowBox[{"\[ImaginaryI]", " ", "k1"}]}], ")"}], " ", "k1"}]]], "Output",
 CellChangeTimes->{{3.3997833072165613`*^9, 3.399783319935556*^9}, 
   3.404753872118744*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"Integrate", "[", 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "k2", " ", "x2"}]], "integration11"}], 
     ",", "x2"}], "]"}], ",", 
   RowBox[{"K", ">", "0"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.3997833532799463`*^9, 3.3997833668114557`*^9}, {
   3.3997834246563168`*^9, 3.3997834378440695`*^9}, 3.3997895808526382`*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "-", 
      RowBox[{"\[ImaginaryI]", " ", "k1"}]}], ")"}], " ", "k1", " ", "k2", 
    " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "\[ImaginaryI]"}], "+", "k2"}], ")"}]}]], 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"\[ImaginaryI]", " ", "k2", " ", "x2"}]], " ", 
   SuperscriptBox["K", 
    RowBox[{"\[ImaginaryI]", " ", "k1"}]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[ExponentialE]", "x2"], " ", "k2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "k1", " ", 
         RowBox[{"(", 
          RowBox[{"\[Alpha]", "-", "\[Beta]"}], ")"}]}], "+", "\[Beta]"}], 
       ")"}], " ", 
      RowBox[{"Hypergeometric2F1", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "k1"}], ",", 
        RowBox[{"1", "+", 
         RowBox[{"\[ImaginaryI]", " ", "k2"}]}], ",", 
        RowBox[{"2", "+", 
         RowBox[{"\[ImaginaryI]", " ", "k2"}]}], ",", 
        RowBox[{"-", 
         FractionBox[
          SuperscriptBox["\[ExponentialE]", "x2"], "K"]}]}], "]"}]}], "+", 
     RowBox[{"K", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], "+", "k2"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"\[ImaginaryI]", " ", "k1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Alpha]"}], ")"}]}]}], ")"}], " ", 
      RowBox[{"Hypergeometric2F1", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "k1"}], ",", 
        RowBox[{"\[ImaginaryI]", " ", "k2"}], ",", 
        RowBox[{"1", "+", 
         RowBox[{"\[ImaginaryI]", " ", "k2"}]}], ",", 
        RowBox[{"-", 
         FractionBox[
          SuperscriptBox["\[ExponentialE]", "x2"], "K"]}]}], "]"}]}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{3.399783368780244*^9, 3.3997834401253633`*^9, 
  3.399789582040161*^9, 3.404753877407144*^9}]
}, Open  ]],

Cell[TextData[StyleBox["ca converge pour Im[k1] > 1,  Im[k2] > 0  pour x2 \
\[Element] [G, +\[Infinity][",
 FontWeight->"Bold",
 FontColor->RGBColor[1, 0, 0]]], "Text",
 CellChangeTimes->{{3.3997905702622595`*^9, 3.3997906860613575`*^9}, {
  3.399790902971772*^9, 3.3997909145188694`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"Integrate", "[", 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]k2", " ", "x2"}]], 
      RowBox[{"(", 
       RowBox[{"integration11", " ", "/.", " ", 
        RowBox[{"K", "\[Rule]", "0"}]}], ")"}]}], ",", "x2"}], "]"}], ",", 
   RowBox[{"x2", ">", "0"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.399783500470272*^9, 3.3997835140799084`*^9}, {
  3.3997843119702277`*^9, 3.399784318595355*^9}, {3.3997843922530193`*^9, 
  3.399784393753048*^9}, {3.3997905267301736`*^9, 3.399790536230356*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"x2", " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"\[ImaginaryI]", " ", "k1"}], "+", "\[ImaginaryI]k2"}], 
      ")"}]}]], 
   RowBox[{"k1", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "\[ImaginaryI]"}], "+", "k1"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"\[ImaginaryI]", " ", "k1"}], "+", "\[ImaginaryI]k2"}], 
     ")"}]}]]}]], "Output",
 CellChangeTimes->{
  3.399784321564162*^9, 3.3997843954874563`*^9, {3.3997905276208158`*^9, 
   3.3997905371678743`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Calculs Formels K = 0 ", "Subsection",
 CellChangeTimes->{{3.40205058751505*^9, 3.402050591562002*^9}, {
  3.4020506469068146`*^9, 3.402050688376361*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"integration1", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    SubsuperscriptBox["\[Integral]", "x2", "\[Infinity]"], " ", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "k1", " ", "x1"}]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Alpha]", " ", 
        SuperscriptBox["\[ExponentialE]", "x1"]}], "-", 
       RowBox[{"\[Beta]", " ", 
        SuperscriptBox["\[ExponentialE]", "x2"]}]}], ")"}], 
     RowBox[{"\[DifferentialD]", "x1"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.3997830788528023`*^9, 3.3997830934780827`*^9}, {
  3.399783175698412*^9, 3.3997832121991124`*^9}, {3.3997832703252287`*^9, 
  3.3997832746221857`*^9}, {3.4020506914232945`*^9, 3.402050713142462*^9}, {
  3.404753893443944*^9, 3.4047538996527443`*^9}}],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Im", "[", "k1", "]"}], ">", "1"}], ",", 
   FractionBox[
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"x2", "+", 
       RowBox[{"\[ImaginaryI]", " ", "k1", " ", "x2"}]}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"k1", " ", 
        RowBox[{"(", 
         RowBox[{"\[Alpha]", "-", "\[Beta]"}], ")"}]}], "+", 
       RowBox[{"\[ImaginaryI]", " ", "\[Beta]"}]}], ")"}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "-", 
       RowBox[{"\[ImaginaryI]", " ", "k1"}]}], ")"}], " ", "k1"}]], ",", 
   RowBox[{"Integrate", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"x1", "+", 
         RowBox[{"\[ImaginaryI]", " ", "k1", " ", "x1"}]}]], " ", 
       "\[Alpha]"}], "-", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", "k1", " ", "x1"}], "+", "x2"}]], " ", 
       "\[Beta]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"x1", ",", "x2", ",", "\[Infinity]"}], "}"}], ",", 
     RowBox[{"Assumptions", "\[Rule]", 
      RowBox[{
       RowBox[{"Im", "[", "k1", "]"}], "\[LessEqual]", "1"}]}]}], "]"}]}], 
  "]"}]], "Output",
 CellChangeTimes->{{3.3997832193242493`*^9, 3.399783241121543*^9}, 
   3.3997832783097568`*^9, {3.4020507019391212`*^9, 3.4020507168144073`*^9}, 
   3.4047539043795443`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"integration11", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{"integration1", ",", 
    RowBox[{
     RowBox[{"Im", "[", "k1", "]"}], ">", "1"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.3997832863099103`*^9, 3.399783319044914*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"x2", "+", 
     RowBox[{"\[ImaginaryI]", " ", "k1", " ", "x2"}]}]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"k1", " ", 
      RowBox[{"(", 
       RowBox[{"\[Alpha]", "-", "\[Beta]"}], ")"}]}], "+", 
     RowBox[{"\[ImaginaryI]", " ", "\[Beta]"}]}], ")"}]}], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "-", 
     RowBox[{"\[ImaginaryI]", " ", "k1"}]}], ")"}], " ", "k1"}]]], "Output",
 CellChangeTimes->{{3.3997833072165613`*^9, 3.399783319935556*^9}, 
   3.4020507301115375`*^9, 3.4047539075151443`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"Integrate", "[", 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "k2", " ", "x2"}]], "integration11"}], 
     ",", "x2"}], "]"}], ",", 
   RowBox[{"K", ">", "0"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.3997833532799463`*^9, 3.3997833668114557`*^9}, {
   3.3997834246563168`*^9, 3.3997834378440695`*^9}, 3.3997895808526382`*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], "+", "k1", "+", "k2"}], ")"}], " ", 
     "x2"}]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"k1", " ", 
      RowBox[{"(", 
       RowBox[{"\[Alpha]", "-", "\[Beta]"}], ")"}]}], "+", 
     RowBox[{"\[ImaginaryI]", " ", "\[Beta]"}]}], ")"}]}], 
  RowBox[{"k1", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "\[ImaginaryI]"}], "+", "k1"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "\[ImaginaryI]"}], "+", "k1", "+", "k2"}], 
    ")"}]}]]], "Output",
 CellChangeTimes->{3.399783368780244*^9, 3.3997834401253633`*^9, 
  3.399789582040161*^9, 3.4020507389085813`*^9, 3.4047539109315443`*^9}]
}, Open  ]],

Cell["\<\
La regle de transformation des hypergeometrique [z]  en   [1/z]   suivante va \
s' averer importante\
\>", "Text",
 CellChangeTimes->{{3.4008495620303864`*^9, 3.400849618687724*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RuleHyper", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Hypergeometric2F1", "[", 
      RowBox[{"a_", ",", "b_", ",", "c_", ",", "z_"}], "]"}], "->", 
     RowBox[{
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"Gamma", "[", 
          RowBox[{"b", "-", "a"}], "]"}], " ", 
         RowBox[{"Gamma", "[", "c", "]"}]}], 
        RowBox[{
         RowBox[{"Gamma", "[", "b", "]"}], 
         RowBox[{"Gamma", "[", 
          RowBox[{"c", "-", "a"}], "]"}]}]], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"-", "z"}], ")"}], 
        RowBox[{"-", "a"}]], 
       RowBox[{"Hypergeometric2F1", "[", 
        RowBox[{"a", ",", 
         RowBox[{"a", "-", "c", "+", "1"}], ",", 
         RowBox[{"a", "-", "b", "+", "1"}], ",", 
         FractionBox["1", "z"]}], "]"}]}], "+", 
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"Gamma", "[", 
          RowBox[{"a", "-", "b"}], "]"}], " ", 
         RowBox[{"Gamma", "[", "c", "]"}]}], 
        RowBox[{
         RowBox[{"Gamma", "[", "a", "]"}], " ", 
         RowBox[{"Gamma", "[", 
          RowBox[{"c", "-", "b"}], "]"}]}]], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"-", "z"}], ")"}], 
        RowBox[{"-", "b"}]], " ", 
       RowBox[{"Hypergeometric2F1", "[", 
        RowBox[{"b", ",", 
         RowBox[{"b", "-", "c", "+", "1"}], ",", 
         RowBox[{"b", "-", "a", "+", "1"}], ",", 
         FractionBox["1", "z"]}], "]"}]}]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.3990921348304167`*^9, 3.399092134939794*^9}, 
   3.3990921744405527`*^9, {3.3990929238768167`*^9, 3.3990929242830744`*^9}, {
   3.399899254369732*^9, 3.3998993072769976`*^9}},
 Background->RGBColor[1, 1, 0]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Calculs", " ", 
  RowBox[{"Formel", " ", ":", 
   FormBox[
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Alpha]", " ", 
        SuperscriptBox[
         SubscriptBox["S", "1"], "a"]}], "-", "K"}], ")"}], "+"],
    TraditionalForm]}]}]], "Section",
 CellChangeTimes->{{3.4047530588767443`*^9, 3.404753106363144*^9}, {
  3.405003099983147*^9, 3.405003100747547*^9}}],

Cell[CellGroupData[{

Cell["x2 > 0", "Subsection",
 CellChangeTimes->{{3.4059385205005975`*^9, 3.405938523985039*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"\[Alpha]", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"a", " ", "x1"}]]}], "-", "K"}], "\[Equal]", "0"}], ",", 
   "x1"}], "]"}]], "Input",
 CellChangeTimes->{{3.4050030011103473`*^9, 3.405003045507947*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Solve", "::", "\<\"ifun\"\>"}], ":", 
  " ", "\<\"Inverse functions are being used by \\!\\(Solve\\), so some \
solutions may not be found; use Reduce for complete solution information. \\!\
\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/Solve\\\", ButtonNote -> \
\\\"Solve::ifun\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.4050030496419473`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"x1", "\[Rule]", 
    FractionBox[
     RowBox[{"Log", "[", 
      FractionBox["K", "\[Alpha]"], "]"}], "a"]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.3997832193242493`*^9, 3.399783241121543*^9}, 
   3.3997832783097568`*^9, 3.403953784350909*^9, 3.4046243697370987`*^9, 
   3.405003049673147*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"integration1", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    SubsuperscriptBox["\[Integral]", 
     FractionBox[
      RowBox[{"Log", "[", 
       FractionBox["K", "\[Alpha]"], "]"}], "a"], "\[Infinity]"], " ", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "k1", " ", "x1"}]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Alpha]", " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"a", " ", "x1"}]]}], "-", "K"}], ")"}], 
     RowBox[{"\[DifferentialD]", "x1"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.3997830788528023`*^9, 3.3997830934780827`*^9}, {
  3.399783175698412*^9, 3.3997832121991124`*^9}, {3.3997832703252287`*^9, 
  3.3997832746221857`*^9}, {3.403953757897276*^9, 3.403953760772331*^9}, {
  3.404624357783668*^9, 3.40462435886182*^9}, {3.405003070265147*^9, 
  3.4050030795471473`*^9}}],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Im", "[", "k1", "]"}], ">", "0"}], "&&", 
    RowBox[{
     RowBox[{"Re", "[", "a", "]"}], "<", 
     RowBox[{"Im", "[", "k1", "]"}]}]}], ",", 
   FractionBox[
    RowBox[{"a", " ", "K", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox["K", "\[Alpha]"], ")"}], 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]]}], 
    RowBox[{
     RowBox[{"\[ImaginaryI]", " ", "a", " ", "k1"}], "-", 
     SuperscriptBox["k1", "2"]}]], ",", 
   RowBox[{"Integrate", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "k1", " ", "x1"}]]}], " ", "K"}], "+", 
      
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"a", " ", "x1"}], "+", 
         RowBox[{"\[ImaginaryI]", " ", "k1", " ", "x1"}]}]], " ", 
       "\[Alpha]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"x1", ",", 
       FractionBox[
        RowBox[{"Log", "[", 
         FractionBox["K", "\[Alpha]"], "]"}], "a"], ",", "\[Infinity]"}], 
      "}"}], ",", 
     RowBox[{"Assumptions", "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Re", "[", "a", "]"}], "\[LessEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"Im", "[", "k1", "]"}], "\[LessEqual]", "0"}]}], ")"}], "||",
        
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Re", "[", "a", "]"}], ">", "0"}], "&&", 
         RowBox[{
          RowBox[{"Im", "[", "k1", "]"}], "\[LessEqual]", 
          RowBox[{"Re", "[", "a", "]"}]}]}], ")"}]}]}]}], "]"}]}], 
  "]"}]], "Output",
 CellChangeTimes->{3.4050030855843472`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"integration11", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{"integration1", ",", 
    RowBox[{
     RowBox[{
      RowBox[{"Im", "[", "k1", "]"}], ">", "0"}], "&&", 
     RowBox[{
      RowBox[{"Re", "[", "a", "]"}], "<", 
      RowBox[{"Im", "[", "k1", "]"}]}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.3997832863099103`*^9, 3.399783319044914*^9}, 
   3.4050031197639475`*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{"a", " ", "K", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     FractionBox["K", "\[Alpha]"], ")"}], 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]]}], 
  RowBox[{
   RowBox[{"\[ImaginaryI]", " ", "a", " ", "k1"}], "-", 
   SuperscriptBox["k1", "2"]}]]], "Output",
 CellChangeTimes->{{3.3997833072165613`*^9, 3.399783319935556*^9}, 
   3.4039540785440574`*^9, 3.4046243764716463`*^9, 3.4050031214955473`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"integration12", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"Integrate", "[", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "k2", " ", "x2"}]], "integration11"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"x2", ",", "0", ",", "\[Infinity]"}], "}"}]}], "]"}], ",", 
    RowBox[{"K", ">", "0"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.3997833532799463`*^9, 3.3997833668114557`*^9}, {
   3.3997834246563168`*^9, 3.3997834378440695`*^9}, 3.3997895808526382`*^9, {
   3.403954096716281*^9, 3.403954128357514*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"a", " ", "K", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     FractionBox["K", "\[Alpha]"], ")"}], 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]], " ", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Im", "[", "k2", "]"}], ">", "0"}], ",", 
     FractionBox["\[ImaginaryI]", "k2"], ",", 
     RowBox[{"Integrate", "[", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "k2", " ", "x2"}]], ",", 
       RowBox[{"{", 
        RowBox[{"x2", ",", "0", ",", "\[Infinity]"}], "}"}], ",", 
       RowBox[{"Assumptions", "\[Rule]", 
        RowBox[{
         RowBox[{"Im", "[", "k2", "]"}], "\[LessEqual]", "0"}]}]}], "]"}]}], 
    "]"}]}], 
  RowBox[{
   RowBox[{"\[ImaginaryI]", " ", "a", " ", "k1"}], "-", 
   SuperscriptBox["k1", "2"]}]]], "Output",
 CellChangeTimes->{
  3.399783368780244*^9, 3.3997834401253633`*^9, 3.399789582040161*^9, {
   3.4039541092008963`*^9, 3.403954131545075*^9}, 3.4046243809873867`*^9, 
   3.4050031359879475`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"integration12", ",", 
   RowBox[{
    RowBox[{"Im", "[", "k2", "]"}], ">", "0"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.4039540270899444`*^9, 3.4039540492309947`*^9}, {
  3.403954138888966*^9, 3.403954149826676*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"a", " ", "K", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     FractionBox["K", "\[Alpha]"], ")"}], 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]]}], 
  RowBox[{
   RowBox[{"a", " ", "k1", " ", "k2"}], "+", 
   RowBox[{"\[ImaginaryI]", " ", 
    SuperscriptBox["k1", "2"], " ", "k2"}]}]]], "Output",
 CellChangeTimes->{{3.4039540409339604`*^9, 3.4039540500591354`*^9}, 
   3.403954151279829*^9, 3.404624389190722*^9, 3.405003144443147*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["x2<0 ", "Subsection",
 CellChangeTimes->{{3.40205058751505*^9, 3.402050591562002*^9}, {
   3.4020506469068146`*^9, 3.4020506699697576`*^9}, 3.4020641845903263`*^9, {
   3.4039543251112914`*^9, 3.4039543275019627`*^9}, {3.4039543675027304`*^9, 
   3.403954373690349*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"integration1", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    SubsuperscriptBox["\[Integral]", 
     FractionBox[
      RowBox[{"Log", "[", 
       FractionBox["K", "\[Alpha]"], "]"}], "a"], "\[Infinity]"], " ", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "k1", " ", "x1"}]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Alpha]", " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"a", " ", "x1"}]]}], "-", "K"}], ")"}], 
     RowBox[{"\[DifferentialD]", "x1"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.3997830788528023`*^9, 3.3997830934780827`*^9}, {
  3.399783175698412*^9, 3.3997832121991124`*^9}, {3.3997832703252287`*^9, 
  3.3997832746221857`*^9}, {3.403953757897276*^9, 3.403953760772331*^9}, {
  3.4046244068786745`*^9, 3.404624407956827*^9}, {3.4050031780299473`*^9, 
  3.4050031855959473`*^9}}],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Im", "[", "k1", "]"}], ">", "0"}], "&&", 
    RowBox[{
     RowBox[{"Re", "[", "a", "]"}], "<", 
     RowBox[{"Im", "[", "k1", "]"}]}]}], ",", 
   FractionBox[
    RowBox[{"a", " ", "K", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox["K", "\[Alpha]"], ")"}], 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]]}], 
    RowBox[{
     RowBox[{"\[ImaginaryI]", " ", "a", " ", "k1"}], "-", 
     SuperscriptBox["k1", "2"]}]], ",", 
   RowBox[{"Integrate", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "k1", " ", "x1"}]]}], " ", "K"}], "+", 
      
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"a", " ", "x1"}], "+", 
         RowBox[{"\[ImaginaryI]", " ", "k1", " ", "x1"}]}]], " ", 
       "\[Alpha]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"x1", ",", 
       FractionBox[
        RowBox[{"Log", "[", 
         FractionBox["K", "\[Alpha]"], "]"}], "a"], ",", "\[Infinity]"}], 
      "}"}], ",", 
     RowBox[{"Assumptions", "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Re", "[", "a", "]"}], "\[LessEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"Im", "[", "k1", "]"}], "\[LessEqual]", "0"}]}], ")"}], "||",
        
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Re", "[", "a", "]"}], ">", "0"}], "&&", 
         RowBox[{
          RowBox[{"Im", "[", "k1", "]"}], "\[LessEqual]", 
          RowBox[{"Re", "[", "a", "]"}]}]}], ")"}]}]}]}], "]"}]}], 
  "]"}]], "Output",
 CellChangeTimes->{{3.3997832193242493`*^9, 3.399783241121543*^9}, 
   3.3997832783097568`*^9, 3.403953784350909*^9, 3.4046244101443834`*^9, 
   3.4050031925847473`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"integration11", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{"integration1", ",", 
    RowBox[{
     RowBox[{
      RowBox[{"Im", "[", "k1", "]"}], ">", "0"}], "&&", 
     RowBox[{
      RowBox[{"Re", "[", "a", "]"}], "<", 
      RowBox[{"Im", "[", "k1", "]"}]}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.3997832863099103`*^9, 3.399783319044914*^9}, 
   3.405003210914747*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{"a", " ", "K", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     FractionBox["K", "\[Alpha]"], ")"}], 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]]}], 
  RowBox[{
   RowBox[{"\[ImaginaryI]", " ", "a", " ", "k1"}], "-", 
   SuperscriptBox["k1", "2"]}]]], "Output",
 CellChangeTimes->{{3.3997833072165613`*^9, 3.399783319935556*^9}, 
   3.4039540785440574`*^9, 3.4046244133475904`*^9, 3.4050032124123473`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"integration12", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"Integrate", "[", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "k2", " ", "x2"}]], "integration11"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"x2", ",", 
        RowBox[{"-", "\[Infinity]"}], ",", "0"}], "}"}]}], "]"}], ",", 
    RowBox[{"K", ">", "0"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.3997833532799463`*^9, 3.3997833668114557`*^9}, {
   3.3997834246563168`*^9, 3.3997834378440695`*^9}, 3.3997895808526382`*^9, {
   3.403954096716281*^9, 3.403954128357514*^9}, {3.403954383112405*^9, 
   3.403954389550029*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"a", " ", "K", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     FractionBox["K", "\[Alpha]"], ")"}], 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]], " ", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Im", "[", "k2", "]"}], "<", "0"}], ",", 
     RowBox[{"-", 
      FractionBox["\[ImaginaryI]", "k2"]}], ",", 
     RowBox[{"Integrate", "[", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "k2", " ", "x2"}]], ",", 
       RowBox[{"{", 
        RowBox[{"x2", ",", "0", ",", "\[Infinity]"}], "}"}], ",", 
       RowBox[{"Assumptions", "\[Rule]", 
        RowBox[{
         RowBox[{"Im", "[", "k2", "]"}], "\[GreaterEqual]", "0"}]}]}], 
      "]"}]}], "]"}]}], 
  RowBox[{
   RowBox[{"\[ImaginaryI]", " ", "a", " ", "k1"}], "-", 
   SuperscriptBox["k1", "2"]}]]], "Output",
 CellChangeTimes->{
  3.399783368780244*^9, 3.3997834401253633`*^9, 3.399789582040161*^9, {
   3.4039541092008963`*^9, 3.403954131545075*^9}, 3.4039543907219257`*^9, 
   3.404624416878931*^9, 3.405003218948747*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"integration12", ",", 
   RowBox[{
    RowBox[{"Im", "[", "k2", "]"}], "<", "0"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.4039540270899444`*^9, 3.4039540492309947`*^9}, {
  3.403954138888966*^9, 3.403954149826676*^9}, {3.4039543973470535`*^9, 
  3.403954398018941*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"a", " ", "K", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox["K", "\[Alpha]"], ")"}], 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]]}], 
   RowBox[{
    RowBox[{"a", " ", "k1", " ", "k2"}], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     SuperscriptBox["k1", "2"], " ", "k2"}]}]]}]], "Output",
 CellChangeTimes->{{3.4039540409339604`*^9, 3.4039540500591354`*^9}, 
   3.403954151279829*^9, 3.4039544003783617`*^9, 3.40462442173843*^9, 
   3.4050032225679474`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x2", "=", "0.1"}], ",", 
      RowBox[{"K", "=", "1"}], ",", 
      RowBox[{"\[Lambda]1", "=", "2"}], ",", 
      RowBox[{"\[Lambda]2", "=", "1.1"}], ",", 
      RowBox[{"coeff", "=", 
       RowBox[{"LegendreCoeffs", "[", 
        RowBox[{"40", ",", 
         RowBox[{"-", "10"}], ",", "10"}], "]"}]}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"g1", "=", 
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"i", "/", "100"}], ",", 
            RowBox[{"Re", "[", 
             RowBox[{"Module", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x1", "=", 
                 RowBox[{"i", "/", "100"}]}], "}"}], ",", 
               RowBox[{
                FractionBox["1", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"2", "\[Pi]"}], ")"}], "2"]], 
                RowBox[{"CoeffBasedIntegrate", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryI]"}], " ", "x1", 
                    RowBox[{"(", " ", 
                    RowBox[{"#1", "+", 
                    RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1"}]}], ")"}]}], 
                    "-", 
                    RowBox[{"\[ImaginaryI]", " ", "x2", 
                    RowBox[{"(", " ", 
                    RowBox[{"#2", "-", 
                    RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2"}]}], 
                    ")"}]}]}]], 
                    RowBox[{
                    "FirstUnderlyingVanillaPayOffFourierGaucheCC", "[", 
                    RowBox[{
                    RowBox[{"#1", "+", 
                    RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1"}]}], ",", 
                    RowBox[{"(", " ", 
                    RowBox[{"#2", "-", 
                    RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2"}]}], ")"}], 
                    ",", "K", ",", "1", ",", "1"}], "]"}]}], "+", 
                    RowBox[{
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryI]"}], " ", "x1", 
                    RowBox[{"(", " ", 
                    RowBox[{"#1", "+", 
                    RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1"}]}], ")"}]}], 
                    "-", 
                    RowBox[{"\[ImaginaryI]", " ", "x2", 
                    RowBox[{"(", " ", 
                    RowBox[{"#2", "+", 
                    RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2"}]}], 
                    ")"}]}]}]], 
                    RowBox[{
                    "FirstUnderlyingVanillaPayOffFourierDroiteCC", "[", 
                    RowBox[{
                    RowBox[{"#1", "+", 
                    RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1"}]}], ",", 
                    RowBox[{"(", " ", 
                    RowBox[{"#2", "+", 
                    RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2"}]}], ")"}], 
                    ",", "K", ",", "1", ",", "1"}], "]"}]}]}], ")"}], "&"}], 
                  ",", "coeff", ",", "coeff"}], "]"}]}]}], "]"}], "]"}]}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"-", "100"}], ",", "100"}], "}"}]}], "]"}], ",", 
        RowBox[{"Joined", "\[Rule]", "True"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"g2", "=", 
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"i", "/", "100"}], ",", 
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"x1", "=", 
                RowBox[{"i", "/", "100"}]}], "}"}], ",", 
              RowBox[{"Re", "[", 
               RowBox[{"FirstUnderlyingPayOff", "[", 
                RowBox[{"x1", ",", "x2", ",", "K"}], "]"}], "]"}]}], "]"}]}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"-", "100"}], ",", "100"}], "}"}]}], "]"}], ",", 
        RowBox[{"Joined", "\[Rule]", "True"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{"g1", ",", "g2", ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}]}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.3999556654840546`*^9, 3.3999557512982025`*^9}, {
   3.3999570614483566`*^9, 3.399957155340784*^9}, {3.399957187450776*^9, 
   3.399957256108344*^9}, {3.3999572865776787`*^9, 3.399957289358982*^9}, {
   3.3999573384536753`*^9, 3.399957458346602*^9}, {3.399957488347178*^9, 
   3.399957491112856*^9}, {3.3999575288010798`*^9, 3.3999575400512953`*^9}, 
   3.399957975137774*^9, {3.3999580213886623`*^9, 3.3999580266387625`*^9}, {
   3.399958168563363*^9, 3.3999582085328803`*^9}, {3.399958249768047*^9, 
   3.399958269612178*^9}, {3.399958306487886*^9, 3.3999583627702165`*^9}, {
   3.399958399349044*^9, 3.3999584292246175`*^9}, {3.399958482803771*^9, 
   3.399958551508215*^9}, {3.3999586028373256`*^9, 3.3999586128062673`*^9}, {
   3.3999592821628685`*^9, 3.399959417962351*^9}, {3.399960099819192*^9, 
   3.3999601276947274`*^9}, {3.3999601741174936`*^9, 3.399960197352315*^9}, {
   3.3999602492126856`*^9, 3.3999603129170337`*^9}, {3.3999604671231194`*^9, 
   3.3999604959674234`*^9}, {3.3999605369369593`*^9, 
   3.3999605712344933`*^9}, {3.399960603875745*^9, 3.3999606523141747`*^9}, {
   3.3999615105494027`*^9, 3.399961516002632*^9}, {3.399961736084983*^9, 
   3.399961736772496*^9}, {3.399961784242158*^9, 3.399961807820735*^9}, {
   3.3999618546966352`*^9, 3.399961856946678*^9}, {3.399961919697883*^9, 
   3.399961947323414*^9}, {3.3999630382193584`*^9, 3.3999630660323925`*^9}, {
   3.399967597931903*^9, 3.399967657042413*^9}, {3.3999690651006975`*^9, 
   3.399969069257027*^9}, {3.399971279752593*^9, 3.399971280190101*^9}, 
   3.39997171318279*^9, 3.3999893849595814`*^9, {3.399989436788701*^9, 
   3.3999894428356924`*^9}, 3.3999895797914467`*^9, 3.399989778701516*^9, {
   3.3999904852775817`*^9, 3.399990544403717*^9}, 3.399990779095723*^9, 
   3.399991142962084*^9, {3.3999912466672*^9, 3.3999912547454805`*^9}, {
   3.399993024158537*^9, 3.3999931833602357`*^9}, {3.3999940119063888`*^9, 
   3.3999940209534373`*^9}, {3.400217686430911*^9, 3.4002176869309206`*^9}, {
   3.4002177763232613`*^9, 3.4002177765263906`*^9}, {3.400234016303692*^9, 
   3.400234024491349*^9}, 3.4003001976747813`*^9, {3.403955016421439*^9, 
   3.4039550206715207`*^9}, {3.4039551412050853`*^9, 3.403955234081868*^9}, 
   3.403955308895805*^9, {3.4039554006944423`*^9, 3.4039554385701694`*^9}, {
   3.4039605508714485`*^9, 3.403960554309015*^9}, {3.4039606268104067`*^9, 
   3.4039607076244583`*^9}, {3.403960838658224*^9, 3.403960857142954*^9}, {
   3.403960953926062*^9, 3.4039610087864904`*^9}, {3.403961110788449*^9, 
   3.403961111304084*^9}, 3.4039612870105824`*^9, {3.403961470857862*^9, 
   3.403961509046095*^9}, {3.4039615492968683`*^9, 3.4039615521562977`*^9}, 
   3.4039616721273513`*^9, {3.4051064895415726`*^9, 3.4051065673699727`*^9}, 
   3.4051065980395727`*^9, {3.4051066331083727`*^9, 3.405106633779173*^9}, {
   3.405106901138373*^9, 3.405106904913573*^9}, {3.4051070430827727`*^9, 
   3.4051070469047728`*^9}, {3.4051070906315727`*^9, 3.405107097448773*^9}, {
   3.405107236304373*^9, 3.405107244026373*^9}, {3.405108630335973*^9, 
   3.4051086402107725`*^9}, {3.4051086715511727`*^9, 3.4051086753575726`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"13.431999999999885`", ",", 
   GraphicsBox[{{{}, {}, 
      {Hue[0.67, 0.6, 0.6], LineBox[CompressedData["
1:eJw1lgk41HsXx1U35N6ISm63pLi31BuypAUn4sVNdeVBpigqJQqtoj3LlVRo
w5vqmrJrt3RxsmV57ftWGWMYY4ylUN5Lb8z5/55nnnnm+c///M/5fs75nv9S
F88dB6ZLSEiUfP9MfovPAOZo9epLWypgqjnHd15qP4bsjEv8NX0R7r6RN7xi
dz+qef4U18xRRZnGWC9DmX6U+mGT9+NkdcxQDui1zhBhhuv+wPqnmug6dURo
r5Zg90mkjfOmAopwO/Ksp81bi/nfo93I68MyZS0VGViP3oaTEfvwquEGNa+D
BrhkMpxyH6pPKF2W9wcsL5s8QswwfRCbbGaMflMBhTj84smJhEwTVJ9KUIhh
srOl2pVMcSq9xl4cc1trquRkhlPhAnqxqOYnfVn/f6PO1OnFpAZvhYsB5jhZ
rTlHgBzZNcqGjhY4Ve4NAcq4CL31JC1xKj1DAc4xbnW+6meJwqlwPSipE3vu
QYYlRkVOnh4sK1CYWJVpiRZTAXvQqUjdz+qMJY5MljvMx9OX2G9vDVsgezK9
WD6OVhrcWrrKAndMCchHibmyRokLzFHMg49HZs56FJZpRjy60Vqo+3REzpR4
dGPPocczChaaEI9u9Lm1pv7sayAeXejobmukFruBeHRh2Q6eTPYMPeLRhbx0
7QcS2auJBw8D5Cq+upxRIR48vB0ZofUoaihHzIOHr+Xbis7p/gxiHp04JtOc
vUrrXyDm0YnB57ctC/51LYh5dGJVv6JihrMRiHlwceFWSQuvXZtBzIOL0UoX
pycFmoOYBxd/YxVdrHy8BcQ8OnC9wlCjVdJ2EPPowH3Sx3luBdYg5tGBrNuW
KzPu2oCYBwf3s+OP1ZrbgpgHB+sauAmlZXYg5sHBZU+7skKUd4KYRzsauTxL
G9V1ADGPdqydHRXzRYoFYh7tKCmbJhV5gwViHu1o4i9nsLiABWL9P6JT3FjP
4hgWiPX+gEpnZfTYiiwQ6/sB5YfjpcyXO4BYz/cYuafwnGWpPenXhhpL7hu8
GbMlvdqwusIuKOKVDenTiqPyP7a1fv6D9GhBpbvduaHHt1D9LZge9ua/yTNN
qd5mnD/tkUC4WZ/qa8JFlbEhDu4KVE8T1ihcXemQo0n91Ijz2N/+nDtrM/VP
I3IKL9tt7N9G/dKAjhtf9SkW2VJ/1OOx2Rc0Ol1303zWI2+PxnZHtjPNYx2y
F4jWSGgcoPmrxRFBRXPbu0M0b7W4IjXH02C/B81XDUbrW1atGPOkearGupXa
oy+zvWl+qjHc2Sg4y+M4zUsVOjqOS/8+/STNRxUGOXtb1Z88Rf1egd2f1Sv0
ck5T/5ajtFmmP7vah/yhDEeeHmrHx2do3ktx/nyb4ZuavjS/JbjZQrohbJ8v
zWMxqgf8rfJaz5f0KUI5p7yco5FnSI9C3NJSX5t9yYfqL8AEJ5Umfc4pqjcf
d2Uk189LPEH15eLpJks0qPCmet7inPj2+KTzHpR/DvKM90jGv99H+WbhcZeo
FrV1NpRfJhrNb1K+t0gHxPmkIz+yem6B0V6av1eYMebJPjzLi+bhOf7i+63G
dcKH+jMV3bau5mwPvET9koAy6Qe0pZcG0f1sFF3VTVlhF0r/j0FfL3ftpYrh
dP0Wpj6RiKiqu02//TF3X16BiiASmA3i9GRuNHdnDHMdTIZ1m9vCHjH3w7t/
okWBv7GZ+GCXkOjyZ+8T5vmQfin7QAsngckP3n9UW2Ark8LkD8d5/u0N2s+Y
+sDQ/vbDDWPPmfrhsCHLOqT1JaMPyB55OCJoeE3xMoE33enOQWE6zVsWBNnX
tIz98obi58DfW/fUBR/IIj94C5h7qq2zOIeelwtLfPeWc/96S36VDzH7X94R
9uXS8wtAcPrOBjuzfKD+AJsRnkl7fAHlUwSmZ+3ub1J6R/NYDCk3R0ZVI4oo
vxL4vf6BpsbPJTTvpXDd9VvlWEIp5VsG+g/S2YvNyshPyiHp6yhLVVBO+VfA
j3552uH3KolHFSg98dkzHFdF9VRBacRJh7qgavLDanDa6PbhkXsN1VcNxpUe
eko2teS3NWD0RjV0wLCO6q2FuHSr09xV9eTntXBeMeRgwqIGqr8Oqu0DdP8n
1wjkDzCe6x4VPrOJ9KiHjdcHsleONwH5C6ivfpV6caSZ9GmE5PplfJvBFiB/
gvAt2ZWufa2Mf8HDiELNC4I2xt+ABZYprvz3jP9B9rLAdb1dHxh/BK3EpFMf
eR8Z/4QE1rTw0GPtjL/CREdRmuFQO+O/4JUX93DQm8P4MwgmFpfeH+Qw/g1B
mFyx3ruD8XdQsLl++e1AB+P/4Nto/oOWF5fZD+D8rrkouJ/L7A+4krYzuuZo
J7NfYPaZQraCqJPZP5BpMMvB9giP2U/wykfaI0HIY/YX1IyUZ6p4dDH7DVgm
H1ZU9XYx+w/uDdUEVLp3M/sRvoV57Fwv7Gb2J5zTdHix8gif2a8QVPzPaJ6I
z+xfSL1zN1bVu4fZz2CaqTvD63MPs79h/GbzYJmPgNnvcGGb37W9EwJm/8Pj
YCuudUAv834ASXMk4otnC6kfeCB1ML5ZeFdIevKgx7PzaJdqH/UHDyTOy39r
e95H+nZBgKmx+6ixiPqlC2R5aUG76kSkdxe8P/n83Wq3fuqfbtjY/fiYhcQA
6d8Nn67+p3zH1gHqp24oy5JfXhg9QDz4ULwpfX9K7wDx4EPf7mvjCwwHiQcf
Qt3WtcrdHCQefBg8zTaK6RwkHj1g2KAaX7phiHj0wLq8E/lR4UPEowcW2rfa
KwiHiIcAFr24aaBj/ol4CCDlUrr1eOwn4iEAp6zxc0enfyYevWCvNev5ZZfP
xKMXKmbmCXQKPhOP7zpbXTH3XT5MPIRwbIuGvNW1YeIhhKVP5OvvDw0TDyGY
PQs+78IaIR594Oyscyokf4R49EHWXxcKpTVGiUcfBCq4GZVEjhIPEfwxY0bc
G8kvxEMEBrdD+SUnvhAPESxweGbM5X4hHv3gsuS435DNV+LRD4aBV1S4BV+J
Rz8cvrM17eHaMeIxAInHXEcVE8bg/9k2eWU=
        "]]}}, {{}, {}, 
      {Hue[0.67, 0.6, 0.6], LineBox[CompressedData["
1:eJxdlQlQlHUYxrGilFQEhTxIDVNRhsAzVPChwyEFahQyDyzBc7AkNY08icGD
MYW8SvMgoAS0BQ1tUfNAlMNFdrnBFfc+YGGXGwXHZHnjm3n/Mzu7z3zf9/7f
5/m933/fCY9ctOYVGxubgpefnu/eZbn1/y+Rv3L7MJG5T4fG57S5hQrarjL5
W187QYtH761fKG7s02utS9DDrAUFffdltfichj69ybenoqDH9JQbLegiSc8y
9ekd1oKCnmRtUNDW9irr+7S13F5BT7MuQfe49VfW9Wmr3XhBW9vzFbTJWs7Y
p0+d7FmC/sRaUNDtPXbbDH06pae9ZEEvsgYo6N5lYDz0jIee8dAzHjrGQ8d4
6BgPLeOhZTy0jIeG8dAwHhrGQ814qBkPNeOhYjxUjIeK8VAyHkrGQ8l4KBgP
BeOhYDwULP8nLO9alm8ty/Mxy0/O8pKzfB6xPGqY/xrmt5r5q2J+BN07T5Vs
fgTdOy8VbD7K2TyUM/5ljHcp41vKeJYwfjLGS8b4SBkPKcv/Icu7iOUrYXkW
svwKWF75LJ88lsc95j+X+b3L/N1hfm6z/m+yfm+w/rJZP/+w/bPYfpdYfRGr
l8aeT2H3n2XXjzEdy3gIi67DZujPv7x3PBb0PKIDbbpSM46B6sMvIczjB89z
dD0Fie+2L5mgTQH1h5X7QmKn+6XT/SLYzPOeapeWAfKHRJ3HBm38ZXo+C9Ku
yjFBi66A8oF0WXLgw1FiqpcNv0GJM3aYroHyhVQlD1qb+y/Vv4mVHpZRsoW3
QXzQGeagHnvvDu13B5YHuc/dfe6C+GLIgGbb7qu5tH8uxLHTRadm3AfNB8S2
o3IcxHnUTx78FOsmbJhbAJovREsWVmfmF1J/BVi/+l6zabEENJ/In38+ZZKx
iPqVILPdec6mPcWg+YbEZelg/U9S6v8hUjO+XjM+VIZeClIMf/2ZJcqjhPxI
Ebjq0UC9TSno/cJrp7Jct1aUkj8ZLu51TncTlYHeTyTUJrm9caCc/JZiSYTX
VOfVFaD3Gwlx5vXLP6wk/2UIGRe/S+5aBTofUGYO8zxnW015lKPVNTYwra4a
dL4g8/t+l21KaiifSuw80xVw4foj0PmE7/rLnDLOyymvKqwc//FIxxOPQecb
cpuTttTsq6X8qhH9ojFg8PYnoPMRiw0xjdXvKyjPGpyoXC02/K0Ana9wi/wj
c+YUJeUrh/fZqIF5GUrQ+YyIicEDzniqKO/HuCZ/YbqeqQKd75jseMV24jQ1
5V+LaP/J6cqratD/AwoHiGaZ52iIhwLeg3xcgnM05EeBG3uO5gxZoCU+Cngd
D/rTvVRL/hTYHNQ6//wKHfFSYvTWEbP2G3XkV4kI5Tf9i7fpiZ8SCn3V5zG2
BvKvwpeOCfkpxw3EUwWvIZ4OsycaKQ8VEjXFxnnXjMRXjdrgcc6ST+soHzVE
h+NWSTV1xFuNhLfd0xbvrKe8NLAb6Jgf7mQi/hpkhXx0oTPDRPlpkHK4yt8l
sIHmQYtW+YgzMmMD5alF99hfs1ziGmk+tOiM9E/qN9lM+epwVXIyNlZipnnR
YfDQoJwQbwvlrUN00asbZh+00Pzo4RYjXt5Wa6H89egMd8veP62J5kmPxC3H
/mo50EQ8DLBkF6+f86SJeBggPhI0NmxmM/Ew4LS7l/26w83Ew4BXXL/Y9pm+
mXgYke+/8bTLBy3Ew4iSQ91F0t9aiIcRw522rNjY0UI86hC+1ie5I7iVeNTB
R/bg+cZLrcSjDmubL8oq7NuIRz3mhh+NmxLZRjzqEXsw4sSPxW3Eox7y9DWR
BV7txMOEqA77I28ebSceJoS0hcYsaG8nHi+vN4kLDyzrIB4NOJI6ojv/Vgfx
aMC+4faiQRM6iUcDRu4q2730UCfxaMTOqLChGW2dxKMRinU73nL46inxaESq
5r5vTMFT4mFG0uZq2M54RjzMKFweUHv692fEw4zm7AJFgH0X8bCgROTm7LS7
C/8BmJDiJA==
        "]]}}},
    AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
    Axes->True,
    AxesOrigin->{0, 0},
    PlotRange->All,
    PlotRangeClipping->True,
    PlotRangePadding->{
      Scaled[0.02], 
      Scaled[0.02]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.4051068871139727`*^9, 3.405106997109573*^9, 3.405107194761573*^9, 
   3.405107458151973*^9, {3.405108635374773*^9, 3.405108654531573*^9}, 
   3.405108689647173*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x1", "=", "0.1"}], ",", 
      RowBox[{"K", "=", "1"}], ",", 
      RowBox[{"\[Lambda]1", "=", "2"}], ",", 
      RowBox[{"\[Lambda]2", "=", "1.2"}], ",", 
      RowBox[{"coeff", "=", 
       RowBox[{"RiemanCoeffs", "[", 
        RowBox[{"40", ",", 
         RowBox[{"-", "8"}], ",", "8"}], "]"}]}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"g1", "=", 
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"i", "/", "100"}], ",", 
            RowBox[{"Re", "[", 
             RowBox[{"Module", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x2", "=", 
                 RowBox[{"i", "/", "100"}]}], "}"}], ",", 
               RowBox[{
                FractionBox["1", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"2", "\[Pi]"}], ")"}], "2"]], 
                RowBox[{"CoeffBasedIntegrate", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryI]"}], " ", "x1", 
                    RowBox[{"(", " ", 
                    RowBox[{"#1", "-", 
                    RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1"}]}], ")"}]}], 
                    "-", 
                    RowBox[{"\[ImaginaryI]", " ", "x2", 
                    RowBox[{"(", " ", 
                    RowBox[{"#2", "+", 
                    RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2"}]}], 
                    ")"}]}]}]], 
                    RowBox[{
                    "SecondUnderlyingVanillaPayOffFourierGaucheCC", "[", 
                    RowBox[{
                    RowBox[{"#1", "-", 
                    RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1"}]}], ",", 
                    RowBox[{"(", " ", 
                    RowBox[{"#2", "+", 
                    RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2"}]}], ")"}], 
                    ",", "K", ",", "1", ",", "1"}], "]"}]}], "+", 
                    RowBox[{
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryI]"}], " ", "x1", 
                    RowBox[{"(", " ", 
                    RowBox[{"#1", "+", 
                    RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1"}]}], ")"}]}], 
                    "-", 
                    RowBox[{"\[ImaginaryI]", " ", "x2", 
                    RowBox[{"(", " ", 
                    RowBox[{"#2", "+", 
                    RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2"}]}], 
                    ")"}]}]}]], 
                    RowBox[{
                    "SecondUnderlyingVanillaPayOffFourierDroiteCC", "[", 
                    RowBox[{
                    RowBox[{"#1", "+", 
                    RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1"}]}], ",", 
                    RowBox[{"(", " ", 
                    RowBox[{"#2", "+", 
                    RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2"}]}], ")"}], 
                    ",", "K", ",", "1", ",", "1"}], "]"}]}]}], ")"}], "&"}], 
                  ",", "coeff", ",", "coeff"}], "]"}]}]}], "]"}], "]"}]}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"-", "100"}], ",", "100"}], "}"}]}], "]"}], ",", 
        RowBox[{"Joined", "\[Rule]", "True"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"g2", "=", 
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"i", "/", "100"}], ",", 
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"x2", "=", 
                RowBox[{"i", "/", "100"}]}], "}"}], ",", 
              RowBox[{"Re", "[", 
               RowBox[{"SecondUnderlyingPayOff", "[", 
                RowBox[{"x1", ",", "x2", ",", "K"}], "]"}], "]"}]}], "]"}]}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"-", "100"}], ",", "100"}], "}"}]}], "]"}], ",", 
        RowBox[{"Joined", "\[Rule]", "True"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{"g1", ",", "g2", ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}]}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.3999556654840546`*^9, 3.3999557512982025`*^9}, {
   3.3999570614483566`*^9, 3.399957155340784*^9}, {3.399957187450776*^9, 
   3.399957256108344*^9}, {3.3999572865776787`*^9, 3.399957289358982*^9}, {
   3.3999573384536753`*^9, 3.399957458346602*^9}, {3.399957488347178*^9, 
   3.399957491112856*^9}, {3.3999575288010798`*^9, 3.3999575400512953`*^9}, 
   3.399957975137774*^9, {3.3999580213886623`*^9, 3.3999580266387625`*^9}, {
   3.399958168563363*^9, 3.3999582085328803`*^9}, {3.399958249768047*^9, 
   3.399958269612178*^9}, {3.399958306487886*^9, 3.3999583627702165`*^9}, {
   3.399958399349044*^9, 3.3999584292246175`*^9}, {3.399958482803771*^9, 
   3.399958551508215*^9}, {3.3999586028373256`*^9, 3.3999586128062673`*^9}, {
   3.3999592821628685`*^9, 3.399959417962351*^9}, {3.399960099819192*^9, 
   3.3999601276947274`*^9}, {3.3999601741174936`*^9, 3.399960197352315*^9}, {
   3.3999602492126856`*^9, 3.3999603129170337`*^9}, {3.3999604671231194`*^9, 
   3.3999604959674234`*^9}, {3.3999605369369593`*^9, 
   3.3999605712344933`*^9}, {3.399960603875745*^9, 3.3999606523141747`*^9}, {
   3.3999615105494027`*^9, 3.399961516002632*^9}, {3.399961736084983*^9, 
   3.399961736772496*^9}, {3.399961784242158*^9, 3.399961807820735*^9}, {
   3.3999618546966352`*^9, 3.399961856946678*^9}, {3.399961919697883*^9, 
   3.399961947323414*^9}, {3.3999630382193584`*^9, 3.3999630660323925`*^9}, {
   3.399967597931903*^9, 3.399967657042413*^9}, {3.3999690651006975`*^9, 
   3.399969069257027*^9}, {3.399971279752593*^9, 3.399971280190101*^9}, 
   3.39997171318279*^9, 3.3999893849595814`*^9, {3.399989436788701*^9, 
   3.3999894428356924`*^9}, 3.3999895797914467`*^9, 3.399989778701516*^9, {
   3.3999904852775817`*^9, 3.399990544403717*^9}, 3.399990779095723*^9, 
   3.399991142962084*^9, {3.3999912466672*^9, 3.3999912547454805`*^9}, {
   3.399993024158537*^9, 3.3999931833602357`*^9}, {3.3999940119063888`*^9, 
   3.3999940209534373`*^9}, {3.400217686430911*^9, 3.4002176869309206`*^9}, {
   3.4002177763232613`*^9, 3.4002177765263906`*^9}, {3.400234016303692*^9, 
   3.400234024491349*^9}, 3.4003001976747813`*^9, {3.403955016421439*^9, 
   3.4039550206715207`*^9}, {3.4039551412050853`*^9, 3.403955234081868*^9}, 
   3.403955308895805*^9, {3.4039554006944423`*^9, 3.4039554385701694`*^9}, {
   3.4039605508714485`*^9, 3.403960554309015*^9}, {3.4039606268104067`*^9, 
   3.4039607076244583`*^9}, {3.403960838658224*^9, 3.403960857142954*^9}, {
   3.403960953926062*^9, 3.4039610087864904`*^9}, {3.403961110788449*^9, 
   3.403961111304084*^9}, 3.4039612870105824`*^9, {3.403961470857862*^9, 
   3.403961509046095*^9}, {3.4039615492968683`*^9, 3.4039615521562977`*^9}, 
   3.4039616721273513`*^9, {3.403984220537546*^9, 3.403984224702746*^9}, {
   3.403984281127946*^9, 3.403984306399946*^9}, {3.403984648149146*^9, 
   3.403984665683546*^9}, {3.4051069291715727`*^9, 3.4051069384535728`*^9}, {
   3.405106969138773*^9, 3.405107015720373*^9}, {3.405107064158373*^9, 
   3.405107075577573*^9}, {3.405107111707173*^9, 3.405107116075173*^9}, {
   3.4051072715915728`*^9, 3.405107287612773*^9}, {3.4051074206027727`*^9, 
   3.4051074209615726`*^9}, 3.4051075512839727`*^9, {3.405107646100773*^9, 
   3.405107661903573*^9}, 3.405107756954373*^9, {3.405109009369173*^9, 
   3.405109009649973*^9}, {3.405109304287173*^9, 3.405109304489973*^9}, 
   3.405109336703973*^9, {3.4051095242003727`*^9, 3.405109554573573*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"11.669000000000002`", ",", 
   GraphicsBox[{{{}, {}, 
      {Hue[0.67, 0.6, 0.6], LineBox[CompressedData["
1:eJw1lwtUzfkWx0ulkSGP0GUmjazyKsKSctlmorp5HJomN1FphEz00mVqSlIZ
V5xeOo/kkUYJJXqTrZwkQ0+936fT+/TWqXC505nf/q3VarVOZ//3/n72b+/v
/zsnNyvnKQoKCkV//Uz+/vsMop3o2M87Ry5Bsnmrj0byAOZ1blgXZxoKB7j5
o8sODKBusvoERxAKatW33TerDeDLBKvNAe9DIUsruHdvVj96B3IV9/10GY7I
Tz8aftloNPTkMmjIA/bj7elvNx1edgVe/BWNm9+H/Mpgu1zhFfDYPBmxD7MT
79opzuXC4slwWn049JE7Y1U4F96+mTxSLPLPGuWphYGvPKAUn+tNa/HhhMFy
eYJSdEharW/ACwN5etW9OJTzQfdaaxjIwwX3omNIectdg3BYJz+9qKTtpmvk
Hw6T1Zq39uB3oz6eWqXhIC+X24PR4rC+9UsjQJ7e5h6s3fTZ29InAqTycN24
tCfx4fLyCBAKJk836pW66/BXRoKFPGA33iqztbUJiQTZZLmjXeizM2+WtjgS
4ifTu92FR3yrvO5viQIruYBd+Hn1ObvkmCj4m0cXTomtvPZuPIrx6ER+uO6h
1z9dZTw6cWpc9u9Gj64yHp3YZjFHM29GNOPRgZ0bclKmHYtmPDrw8ZODMx89
j2Y8OnBbklKs7QIe49GO4WaaKjd+4TEe7biparhEO5fHeLSjs9MJdf/pfMZD
gp9XzVffZ8NnPCQ4dtxzxu5YPuMhQfPZOZ9UW/iMRxvOV3a21NcSMB5tqFdd
fv/4PgHj0YaO8eYyj0sCxkOM2fbHpR+yBYyHGOuu/KwjEgsYDzFmJCXXR6oI
GY9WNOTEt25cImQ8WrEwIevEpY1CxqMVf9ntoHzSQsh4tGDDV37WxXuFjEcL
Fs6wmHvHWsh4tKDiuPu7j3uEjEcLTnV2aWwzEzL9m1HqKhgO2CBkejfhpgKr
b1W0hUzfJhy7wHF5pCRkejYiZ8slfn2rgOnXgLla5m8kOQKmVwP2b5+5ZBuX
9KlHs+1RpoEOpEcd+lzkdJmsovrrsGpqjvm3Mj6rtxZtNfV9pbl8Vl8NFjyx
LT4bxGf11OBjA9f/5VvyWT9V48CxCYeM2XzWP9VYrdTx5WQdj/VLFZ5O+z1m
/h3qj0p8xLOP6PWmfqhEj5m5T7bu4DH+79A1T0nPT4/HeFdgQmC3aNHXPMa3
AptV+BNJH6IZz3IsfXV4wZv30YxfGXqVzspf+yma8SpDkcpVk/g5PManFCUt
sZEyYx7jUYodwbJi9VM8pn8xath9L5HkU/++xacOPqlnllE/vsGEjsbKujt8
pudrNMuQntbdKmD6FaFK8eGxAJmA6fUKU8Z1QjXfCJk+hXgof2rFkhcxTI8C
DDAa+Vd94zVWvwg9X+1/ek7rOqv3BZqi4Na/L9xg9eVhoNn+zL2Xb7J6nqOT
NPik1YlbLP9n2JRUH1l8OI7l+xSV/e9oS07dZvllY8YXmWLy9XiWTyZmu+Qb
mLb9wZ6fhqP3FuSmmyaw56WiTNVtbHZeIoufjA5WWl4HDySxeHfR5pzC8uj5
99n343H4P07hqYMP2P9fxyUDFqKY3hT2eRTmqEdwFimnsr+DUMsz8Mx9nUdA
G8Qydm11h/Vj+hxGlhZFL+en0ffB8Y7jhrd96RQfVq9yMdSxyaTnQ9XCpgfe
ZVmUHxxMKlqj6phD+YNf4kXbOVOeUn0g/cE0vigzl+oH/U/SdfvOIekDol16
VidTnpN+kBCs52mcmEf6gvdLt6/n3csn/cHtR2eRctYL4gPKhWWvVEtExA/U
DylXaA4WEF/wm5q6wmBRIfGHmVExycZ7XlF/wNkQTfEybhH1D5SuOfJFUv2a
+gtWl9fP/HHFG+o/aG5pn2Id8pb6EzzfPq8R9RZT/0JtRr896JdSf0Pz7J5r
K7tLqf/htMTJIOxuGd0PMH6o+Kv1yXK6P+BRe9TO3qiC7hfsmBtkGaH8ju4f
hJo/c6+ofEf3Ex4ubihWuldJ9xdGcn6zVw6qovsNs+JVN6Q7VtP9h6iCrgej
W2toPoBx32BI/NJamh+Q6PFw9s3pdTRfICL7hs3L0TqaP2Bc1LllVFxP8wmC
LsfkqlU00PwCe0/DCUlBI803UKiZ7u30pInmH3iZNZk4PW6m+QhcpyZFsU0L
zU/4zXTvmvWVLTRfoT1Cy4Nv3UrzF77/KFmsUNlK8xkuFrlsOWgjpvkNNy1K
QuJqxDTfoSBLze+FXRvNf7gcG3g2rbmN9gME9TyrOn5YQvsDsi7OEzV0S2i/
gOTPLVxF93baP5AX8CyiTNZO+wkeFKqbm/l30P6CzfPO79w/tZP2G3Dc0Wsa
t5P2H9SF1or2aHbRfgRD7dEgg7gu2p8wEnPEJG5VN+1XSLXblXI/s5v2L8wy
uznMMe2h/QxVrYn7uCU9tL+B09/j5Xagl/Y7JMadWSTr7qX9D6q16XYrzkjJ
H8DaC1dOaaj2kX8AFTW90tzoPvIXYN89c2KNXj/5D2irUOD+mtVP/gQ04/9p
Em85QP4FDpr9N/ZZ4wD5G9i1wvd278ZB8j8w/cqDEv/zg+SPwI/jLL1ZPEj+
CXb0jp3Yv3CI/BWURMDCtCND5L8A045+zng8RP4MnE3tDrsqDpN/A6tCcWEj
Z5j8HWg1B/ypcWOY/B8Id36jv2hgmPwhdM2/kPMBRsg/Qtit4e254SPkL8G8
xlHoKhkh/wnvMpe4z9n4nvwpKIWfOpQV+p78K6x0tGg+Kn5P/hZcvHfrrjAe
Jf8L3r47138VPkr+GPSul+eq9YySf4ZLhvZLTbbJyF9DxvNx1+s3ZOS/IaH5
kBF8kpE/h9duZek6+8fIv8N5K4c/rLLHyN+Da8o35uX/GCf/Dxfn9tgm+o7T
+wEcSdeYV9c0Tu8PcEJHpONqOkHvF/AyZOstp7sTjMcgKJ3VnJ836wP8H2kE
ag8=
        "]]}}, {{}, {}, 
      {Hue[0.67, 0.6, 0.6], LineBox[CompressedData["
1:eJxdlQlQlHUYxrGilFQEhTxIDVNRhsAzVPChwyEFahQyDyzBc7AkNY08icGD
MYW8SvMgoAS0BQ1tUfNAlMNFdrnBFfc+YGGXGwXHZHnjm3n/Mzu7z3zf9/7f
5/m933/fCY9ctOYVGxubgpefnu/eZbn1/y+Rv3L7MJG5T4fG57S5hQrarjL5
W187QYtH761fKG7s02utS9DDrAUFffdltfichj69ybenoqDH9JQbLegiSc8y
9ekd1oKCnmRtUNDW9irr+7S13F5BT7MuQfe49VfW9Wmr3XhBW9vzFbTJWs7Y
p0+d7FmC/sRaUNDtPXbbDH06pae9ZEEvsgYo6N5lYDz0jIee8dAzHjrGQ8d4
6BgPLeOhZTy0jIeG8dAwHhrGQ814qBkPNeOhYjxUjIeK8VAyHkrGQ8l4KBgP
BeOhYDwULP8nLO9alm8ty/Mxy0/O8pKzfB6xPGqY/xrmt5r5q2J+BN07T5Vs
fgTdOy8VbD7K2TyUM/5ljHcp41vKeJYwfjLGS8b4SBkPKcv/Icu7iOUrYXkW
svwKWF75LJ88lsc95j+X+b3L/N1hfm6z/m+yfm+w/rJZP/+w/bPYfpdYfRGr
l8aeT2H3n2XXjzEdy3gIi67DZujPv7x3PBb0PKIDbbpSM46B6sMvIczjB89z
dD0Fie+2L5mgTQH1h5X7QmKn+6XT/SLYzPOeapeWAfKHRJ3HBm38ZXo+C9Ku
yjFBi66A8oF0WXLgw1FiqpcNv0GJM3aYroHyhVQlD1qb+y/Vv4mVHpZRsoW3
QXzQGeagHnvvDu13B5YHuc/dfe6C+GLIgGbb7qu5tH8uxLHTRadm3AfNB8S2
o3IcxHnUTx78FOsmbJhbAJovREsWVmfmF1J/BVi/+l6zabEENJ/In38+ZZKx
iPqVILPdec6mPcWg+YbEZelg/U9S6v8hUjO+XjM+VIZeClIMf/2ZJcqjhPxI
Ebjq0UC9TSno/cJrp7Jct1aUkj8ZLu51TncTlYHeTyTUJrm9caCc/JZiSYTX
VOfVFaD3Gwlx5vXLP6wk/2UIGRe/S+5aBTofUGYO8zxnW015lKPVNTYwra4a
dL4g8/t+l21KaiifSuw80xVw4foj0PmE7/rLnDLOyymvKqwc//FIxxOPQecb
cpuTttTsq6X8qhH9ojFg8PYnoPMRiw0xjdXvKyjPGpyoXC02/K0Ana9wi/wj
c+YUJeUrh/fZqIF5GUrQ+YyIicEDzniqKO/HuCZ/YbqeqQKd75jseMV24jQ1
5V+LaP/J6cqratD/AwoHiGaZ52iIhwLeg3xcgnM05EeBG3uO5gxZoCU+Cngd
D/rTvVRL/hTYHNQ6//wKHfFSYvTWEbP2G3XkV4kI5Tf9i7fpiZ8SCn3V5zG2
BvKvwpeOCfkpxw3EUwWvIZ4OsycaKQ8VEjXFxnnXjMRXjdrgcc6ST+soHzVE
h+NWSTV1xFuNhLfd0xbvrKe8NLAb6Jgf7mQi/hpkhXx0oTPDRPlpkHK4yt8l
sIHmQYtW+YgzMmMD5alF99hfs1ziGmk+tOiM9E/qN9lM+epwVXIyNlZipnnR
YfDQoJwQbwvlrUN00asbZh+00Pzo4RYjXt5Wa6H89egMd8veP62J5kmPxC3H
/mo50EQ8DLBkF6+f86SJeBggPhI0NmxmM/Ew4LS7l/26w83Ew4BXXL/Y9pm+
mXgYke+/8bTLBy3Ew4iSQ91F0t9aiIcRw522rNjY0UI86hC+1ie5I7iVeNTB
R/bg+cZLrcSjDmubL8oq7NuIRz3mhh+NmxLZRjzqEXsw4sSPxW3Eox7y9DWR
BV7txMOEqA77I28ebSceJoS0hcYsaG8nHi+vN4kLDyzrIB4NOJI6ojv/Vgfx
aMC+4faiQRM6iUcDRu4q2730UCfxaMTOqLChGW2dxKMRinU73nL46inxaESq
5r5vTMFT4mFG0uZq2M54RjzMKFweUHv692fEw4zm7AJFgH0X8bCgROTm7LS7
C/8BmJDiJA==
        "]]}}},
    AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
    Axes->True,
    AxesOrigin->{0, 0},
    PlotRange->All,
    PlotRangeClipping->True,
    PlotRangePadding->{
      Scaled[0.02], 
      Scaled[0.02]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.403984332108746*^9, 3.403984681845146*^9, 3.405106218382373*^9, 
   3.4051070556251726`*^9, 3.4051072585499725`*^9, 3.405107373568773*^9, 
   3.4051075420331726`*^9, 3.4051076392367725`*^9, 3.4051077469235725`*^9, 
   3.405107842769973*^9, 3.4051090297739725`*^9, 3.4051093184987726`*^9, 
   3.405109349807973*^9, {3.4051095400655727`*^9, 3.4051095670379725`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x1", "=", "0.1"}], ",", 
      RowBox[{"K", "=", "1"}], ",", 
      RowBox[{"\[Lambda]1", "=", "2"}], ",", 
      RowBox[{"\[Lambda]2", "=", "1.2"}], ",", 
      RowBox[{"coeff", "=", 
       RowBox[{"LegendreCoeffs", "[", 
        RowBox[{"40", ",", 
         RowBox[{"-", "8"}], ",", "8"}], "]"}]}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"g1", "=", 
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"i", "/", "100"}], ",", 
            RowBox[{"Re", "[", 
             RowBox[{"Module", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x2", "=", 
                 RowBox[{"i", "/", "100"}]}], "}"}], ",", 
               RowBox[{
                FractionBox["1", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"2", "\[Pi]"}], ")"}], "2"]], 
                RowBox[{"CoeffBasedIntegrate", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryI]"}], " ", "x1", 
                    RowBox[{"(", " ", 
                    RowBox[{"#1", "-", 
                    RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1"}]}], ")"}]}], 
                    "-", 
                    RowBox[{"\[ImaginaryI]", " ", "x2", 
                    RowBox[{"(", " ", 
                    RowBox[{"#2", "+", 
                    RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2"}]}], 
                    ")"}]}]}]], 
                    RowBox[{
                    "SecondUnderlyingVanillaPayOffFourierGaucheCC", "[", 
                    RowBox[{
                    RowBox[{"#1", "-", 
                    RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1"}]}], ",", 
                    RowBox[{"(", " ", 
                    RowBox[{"#2", "+", 
                    RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2"}]}], ")"}], 
                    ",", "K", ",", "1", ",", "1"}], "]"}]}], "+", 
                    RowBox[{
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryI]"}], " ", "x1", 
                    RowBox[{"(", " ", 
                    RowBox[{"#1", "+", 
                    RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1"}]}], ")"}]}], 
                    "-", 
                    RowBox[{"\[ImaginaryI]", " ", "x2", 
                    RowBox[{"(", " ", 
                    RowBox[{"#2", "+", 
                    RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2"}]}], 
                    ")"}]}]}]], 
                    RowBox[{
                    "SecondUnderlyingVanillaPayOffFourierDroiteCC", "[", 
                    RowBox[{
                    RowBox[{"#1", "+", 
                    RowBox[{"\[ImaginaryI]", " ", "\[Lambda]1"}]}], ",", 
                    RowBox[{"(", " ", 
                    RowBox[{"#2", "+", 
                    RowBox[{"\[ImaginaryI]", " ", "\[Lambda]2"}]}], ")"}], 
                    ",", "K", ",", "1", ",", "1"}], "]"}]}]}], ")"}], "&"}], 
                  ",", "coeff", ",", "coeff"}], "]"}]}]}], "]"}], "]"}]}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"-", "100"}], ",", "100"}], "}"}]}], "]"}], ",", 
        RowBox[{"Joined", "\[Rule]", "True"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"g2", "=", 
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"i", "/", "100"}], ",", 
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"x2", "=", 
                RowBox[{"i", "/", "100"}]}], "}"}], ",", 
              RowBox[{"Re", "[", 
               RowBox[{"SecondUnderlyingPayOff", "[", 
                RowBox[{"x1", ",", "x2", ",", "K"}], "]"}], "]"}]}], "]"}]}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"-", "100"}], ",", "100"}], "}"}]}], "]"}], ",", 
        RowBox[{"Joined", "\[Rule]", "True"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{"g1", ",", "g2", ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}]}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.3999556654840546`*^9, 3.3999557512982025`*^9}, {
   3.3999570614483566`*^9, 3.399957155340784*^9}, {3.399957187450776*^9, 
   3.399957256108344*^9}, {3.3999572865776787`*^9, 3.399957289358982*^9}, {
   3.3999573384536753`*^9, 3.399957458346602*^9}, {3.399957488347178*^9, 
   3.399957491112856*^9}, {3.3999575288010798`*^9, 3.3999575400512953`*^9}, 
   3.399957975137774*^9, {3.3999580213886623`*^9, 3.3999580266387625`*^9}, {
   3.399958168563363*^9, 3.3999582085328803`*^9}, {3.399958249768047*^9, 
   3.399958269612178*^9}, {3.399958306487886*^9, 3.3999583627702165`*^9}, {
   3.399958399349044*^9, 3.3999584292246175`*^9}, {3.399958482803771*^9, 
   3.399958551508215*^9}, {3.3999586028373256`*^9, 3.3999586128062673`*^9}, {
   3.3999592821628685`*^9, 3.399959417962351*^9}, {3.399960099819192*^9, 
   3.3999601276947274`*^9}, {3.3999601741174936`*^9, 3.399960197352315*^9}, {
   3.3999602492126856`*^9, 3.3999603129170337`*^9}, {3.3999604671231194`*^9, 
   3.3999604959674234`*^9}, {3.3999605369369593`*^9, 
   3.3999605712344933`*^9}, {3.399960603875745*^9, 3.3999606523141747`*^9}, {
   3.3999615105494027`*^9, 3.399961516002632*^9}, {3.399961736084983*^9, 
   3.399961736772496*^9}, {3.399961784242158*^9, 3.399961807820735*^9}, {
   3.3999618546966352`*^9, 3.399961856946678*^9}, {3.399961919697883*^9, 
   3.399961947323414*^9}, {3.3999630382193584`*^9, 3.3999630660323925`*^9}, {
   3.399967597931903*^9, 3.399967657042413*^9}, {3.3999690651006975`*^9, 
   3.399969069257027*^9}, {3.399971279752593*^9, 3.399971280190101*^9}, 
   3.39997171318279*^9, 3.3999893849595814`*^9, {3.399989436788701*^9, 
   3.3999894428356924`*^9}, 3.3999895797914467`*^9, 3.399989778701516*^9, {
   3.3999904852775817`*^9, 3.399990544403717*^9}, 3.399990779095723*^9, 
   3.399991142962084*^9, {3.3999912466672*^9, 3.3999912547454805`*^9}, {
   3.399993024158537*^9, 3.3999931833602357`*^9}, {3.3999940119063888`*^9, 
   3.3999940209534373`*^9}, {3.400217686430911*^9, 3.4002176869309206`*^9}, {
   3.4002177763232613`*^9, 3.4002177765263906`*^9}, {3.400234016303692*^9, 
   3.400234024491349*^9}, 3.4003001976747813`*^9, {3.403955016421439*^9, 
   3.4039550206715207`*^9}, {3.4039551412050853`*^9, 3.403955234081868*^9}, 
   3.403955308895805*^9, {3.4039554006944423`*^9, 3.4039554385701694`*^9}, {
   3.4039605508714485`*^9, 3.403960554309015*^9}, {3.4039606268104067`*^9, 
   3.4039607076244583`*^9}, {3.403960838658224*^9, 3.403960857142954*^9}, {
   3.403960953926062*^9, 3.4039610087864904`*^9}, {3.403961110788449*^9, 
   3.403961111304084*^9}, 3.4039612870105824`*^9, {3.403961470857862*^9, 
   3.403961509046095*^9}, {3.4039615492968683`*^9, 3.4039615521562977`*^9}, 
   3.4039616721273513`*^9, {3.403984220537546*^9, 3.403984224702746*^9}, {
   3.403984281127946*^9, 3.403984306399946*^9}, {3.403984648149146*^9, 
   3.403984665683546*^9}, {3.405109409555973*^9, 3.405109416419973*^9}, {
   3.4051094477915726`*^9, 3.4051094842175727`*^9}, {3.4051095602831726`*^9, 
   3.405109563059973*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"13.026000000000018`", ",", 
   GraphicsBox[{{{}, {}, 
      {Hue[0.67, 0.6, 0.6], LineBox[CompressedData["
1:eJw1lQs4lGkbx62tlUObNlk6WLQi+sSn0Ke6O1yVjj6HStJJaVEUKSGlovW1
a9HBlkNbYcaM8ziMCnfkMFGtY4zjzGAMximfkrZ20T3Pdc0111zv+97v8//9
7uceHZfTdq7ycnJyLyY/U99f1jC6u7ZxfjVPxPStwgC19CHcaiLvdMEtEZ0j
SsYMnIdwp/EYFN1LRKXGhDNrlYawPk0tZE9lIuZrhfbb5g+iMPn0W/OJRDwx
vQbR9bjF0oPLklBtuuAgmsfz2KX7kvD5ZLWIkgEcN1VYeCo0Cb3XTlUcwG1V
5escOEn4w1Q5rQE8MT6hF9yehK9eTi0pPgh33zCmyMDA6YJSHK+OufB0JQOX
TW9Qio0GpWvaDjFwenuN/bjzzsm7P4UxcLpcaD9Wrw2x8shioNn06sfoyvJr
7/kMnEq7VdiHKxYrX/lRnonTcSP68PT2U2OzDJk4vb21fWjp9rUt2jJROl2u
F+dKFVnH/ZkYc29q9aJ1uyVb4yETracL9qLJ93D9E4+J76bijknwpJpxq8UI
ExOntpcgQc2EkthBzWS0mwYowZxk387tm5Lxiw8JnuIC388zmXz0YG7pokuP
7iaTjx70tF1+8UNpMvnoQVHI70Opb5PJhxjjDM0NB3VY5EOMsxfN8RmyY5EP
Maa5VD/pDGWRj25UX3Pc6fMTFvnoxj80q/N93rLIRzfqZN78eHY5m3x0oesP
Rakr3dnkowu19OYdEiezyUcXxi70sH7czyYfnahuWtTTYppCPjrx12Lz2wGB
KeSjE0veR2kgL4V8iLDyjdOWas1U8iHCrV4Hwmq8UsmHCNM3lpwVVaSSDyEe
ee3nqKWXRj6E6HFsaU3s9TTyIcTH9wPtT0nTyIcAg0aNi2P3ppMPAZ677zyx
oiydfAgwxLfC28Ayg3wIsDQ4+nlQRgbx78AlMTeZkfMziXc7LpIHj0t7Molv
O7LqlZX9f88knm0IJ/LAsyWT+LWiv9NVt006WcSrFXfz1rt3uGURnxa0VEkI
1eZkEY9m/G2f9gbhX1mUvxmVazkb31tzKC8fDfzT15hFcyhfE+q0Djcd6eJQ
niYMOJDE2mKWTf3UiJc5DVqMq9nUP43YZj8RbFWbTf3yBlf6Px4u1Mmh/mhA
+8rPJzvO5FA/NGCFbmTTTswh//VotHudWrpKLvmuw+g7lUoMx1zyW4cqmbdq
ah/lks9abFmg/uJVXy75q0FPjc2lRiZ55KsGl0Q/WRXkk0d+qjFwTq7L7qw8
8lGNPuZ1sfrSPOL/Go0KzgWG63KJ9yvU1Uxe9pUDl/i+RD7bPUkumEs8K9Fm
1GCeAoNL/F5g0i4r1fAyLvHi4dGP85QV27nEpwJD9d/9MTTIJR5leH7vmw/Z
77mUvxTNqzQseJO/v+R9jk/z62riJ+//kq8Y57JXKTNauJTnGTJ92fvtiri0
/yJs32bPV4uW7bcATfWPFh1xke3vMep/aOGxdWX7mbzP0fmx+5s8en8Olteu
LlcPyqP3ZeFB+1RVY3UZn/Sp+zVXPMyleiy0820xi1+cS88nYp304vjfN3Lo
/vt423pmTqckm67fRoYNs55vLvsdgtY2Zfb+vhyU/YNIAgYXHn6YJbsO/h+i
PIwLM2XPg/nqiv26ERmy+vB3jij9THCa7P1QMNp0On9Ximx/sLzqwBX/d7J5
lg76rBmxmwIYsnwgn/6wJK8pQZYfjtW551+b+1DGB+xvZDGarONk/MD/xMyY
n3WjZXzBtHrGyNPDETL+IB7NHI8SXpH5gfCZjLh7ew7J/IGeb6RwgHcOyC/8
yL9dYGV0A8g/fP35QrPtjDtA/QFWekvy89fGA/UPfOoYTwsTPALqL7CxyAsq
2MIE6j/Y/PrAp7HqFKD+BEXn2QW2kAnUv7Cxfv9oFJMD1N9w6b9zqjq1c4H6
HyLl/39awuYCnQ8wbKz3/8/mJ0DnBzb84ufoNVQAdL4gb9ch3ncsBDp/ENZ+
ntlkWQx0PoETW3jop8QSylsH3OuH28bUS4HON/C0v2VtjCyj/PWQMXdeqZJq
BdB8gOYM4QfFaB7xaICb3yT866NOJdB8AVe/4+y72VXEpxF8K8N947a/AppP
4MJaH/dM/Jp4NYF5mDavY1M10HyDa/pXLdnqNcSPD5f3FGfFT+ag+QgHj2SP
3C2pJZ7N4BSz4EZgbB3QfIVbyddmLT1fT3xbIZS/enGAXQPQfIZVcdrFTiZv
iHcbCD6vd0qd0wg030HJqKXdYbiR+LeD3rJX76xqm4D+H0Dzpc7CHbl88iGA
q5fjsj3vNVMeAaRWavw76lIL+RGAHSfaKOl4K+UTQGb+n16xO9rIlxB2fWOm
4WbWTnmF0LvTMOGrRR3kTwg26lsuZsoLKL8IdPS+K3zmJyCfIgj1uh9qMiAg
HiIYiVZRljsmJL+d0LDKsMKELyQ+neCl9u2FMhsR+e4EvwltrZJyEfHqgh0N
UeNG6zrJfxfc0rUIVszrJH5dMIMpPOJi3EX90A1n45d6A7OLeHaDBZuVzNbu
pv7ohn0Tw2oZMd3EVwwNKtUvHeeLqV/E8CDFT5QTKSbeYvCPsXKoUemh/umB
NR7afxX8r4f494BBweZLPytIqJ96wFRuk/mG6xLyIYFY19+WfJzZSz4kcGuD
QkP59V7yIYGOB0X2ebP6yIcE+DMXzG79pY989IJDiGfBdtV+8tELez2NHOZH
95OPXniawBPvXiwlH31Qd/RchBJDSj76gFNR6XTAZIB8TL6nL3yFQ8EA+egH
axsWV2H7IPnoh9XcoG1h/EHy0Q8mc1NqejyGyIcUage8Cy0+D5EPKbhniH1K
tw2TDynkWnAKz90ZJh8DoPg0399CNEw+BmC9VfuEqskI+RgA9nqRnuLlEfIx
CIXb7rkt/XOEfAxCjncjx0v7LfkYhJui78/0+LwlH0OQktN/5U75W/IxBBmN
q62CFo6SjyE4eMPR+ZH3KPkYhipUUJ31YhT+Ab2en2Q=
        "]]}}, {{}, {}, 
      {Hue[0.67, 0.6, 0.6], LineBox[CompressedData["
1:eJxdlQlQlHUYxrGilFQEhTxIDVNRhsAzVPChwyEFahQyDyzBc7AkNY08icGD
MYW8SvMgoAS0BQ1tUfNAlMNFdrnBFfc+YGGXGwXHZHnjm3n/Mzu7z3zf9/7f
5/m933/fCY9ctOYVGxubgpefnu/eZbn1/y+Rv3L7MJG5T4fG57S5hQrarjL5
W187QYtH761fKG7s02utS9DDrAUFffdltfichj69ybenoqDH9JQbLegiSc8y
9ekd1oKCnmRtUNDW9irr+7S13F5BT7MuQfe49VfW9Wmr3XhBW9vzFbTJWs7Y
p0+d7FmC/sRaUNDtPXbbDH06pae9ZEEvsgYo6N5lYDz0jIee8dAzHjrGQ8d4
6BgPLeOhZTy0jIeG8dAwHhrGQ814qBkPNeOhYjxUjIeK8VAyHkrGQ8l4KBgP
BeOhYDwULP8nLO9alm8ty/Mxy0/O8pKzfB6xPGqY/xrmt5r5q2J+BN07T5Vs
fgTdOy8VbD7K2TyUM/5ljHcp41vKeJYwfjLGS8b4SBkPKcv/Icu7iOUrYXkW
svwKWF75LJ88lsc95j+X+b3L/N1hfm6z/m+yfm+w/rJZP/+w/bPYfpdYfRGr
l8aeT2H3n2XXjzEdy3gIi67DZujPv7x3PBb0PKIDbbpSM46B6sMvIczjB89z
dD0Fie+2L5mgTQH1h5X7QmKn+6XT/SLYzPOeapeWAfKHRJ3HBm38ZXo+C9Ku
yjFBi66A8oF0WXLgw1FiqpcNv0GJM3aYroHyhVQlD1qb+y/Vv4mVHpZRsoW3
QXzQGeagHnvvDu13B5YHuc/dfe6C+GLIgGbb7qu5tH8uxLHTRadm3AfNB8S2
o3IcxHnUTx78FOsmbJhbAJovREsWVmfmF1J/BVi/+l6zabEENJ/In38+ZZKx
iPqVILPdec6mPcWg+YbEZelg/U9S6v8hUjO+XjM+VIZeClIMf/2ZJcqjhPxI
Ebjq0UC9TSno/cJrp7Jct1aUkj8ZLu51TncTlYHeTyTUJrm9caCc/JZiSYTX
VOfVFaD3Gwlx5vXLP6wk/2UIGRe/S+5aBTofUGYO8zxnW015lKPVNTYwra4a
dL4g8/t+l21KaiifSuw80xVw4foj0PmE7/rLnDLOyymvKqwc//FIxxOPQecb
cpuTttTsq6X8qhH9ojFg8PYnoPMRiw0xjdXvKyjPGpyoXC02/K0Ana9wi/wj
c+YUJeUrh/fZqIF5GUrQ+YyIicEDzniqKO/HuCZ/YbqeqQKd75jseMV24jQ1
5V+LaP/J6cqratD/AwoHiGaZ52iIhwLeg3xcgnM05EeBG3uO5gxZoCU+Cngd
D/rTvVRL/hTYHNQ6//wKHfFSYvTWEbP2G3XkV4kI5Tf9i7fpiZ8SCn3V5zG2
BvKvwpeOCfkpxw3EUwWvIZ4OsycaKQ8VEjXFxnnXjMRXjdrgcc6ST+soHzVE
h+NWSTV1xFuNhLfd0xbvrKe8NLAb6Jgf7mQi/hpkhXx0oTPDRPlpkHK4yt8l
sIHmQYtW+YgzMmMD5alF99hfs1ziGmk+tOiM9E/qN9lM+epwVXIyNlZipnnR
YfDQoJwQbwvlrUN00asbZh+00Pzo4RYjXt5Wa6H89egMd8veP62J5kmPxC3H
/mo50EQ8DLBkF6+f86SJeBggPhI0NmxmM/Ew4LS7l/26w83Ew4BXXL/Y9pm+
mXgYke+/8bTLBy3Ew4iSQ91F0t9aiIcRw522rNjY0UI86hC+1ie5I7iVeNTB
R/bg+cZLrcSjDmubL8oq7NuIRz3mhh+NmxLZRjzqEXsw4sSPxW3Eox7y9DWR
BV7txMOEqA77I28ebSceJoS0hcYsaG8nHi+vN4kLDyzrIB4NOJI6ojv/Vgfx
aMC+4faiQRM6iUcDRu4q2730UCfxaMTOqLChGW2dxKMRinU73nL46inxaESq
5r5vTMFT4mFG0uZq2M54RjzMKFweUHv692fEw4zm7AJFgH0X8bCgROTm7LS7
C/8BmJDiJA==
        "]]}}},
    AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
    Axes->True,
    AxesOrigin->{0, 0},
    PlotRange->All,
    PlotRangeClipping->True,
    PlotRangePadding->{
      Scaled[0.02], 
      Scaled[0.02]},
    ImageCache->GraphicsData["CompressedBitmap", "\<\
eJytWluIVVUYXp49Z+aMZ47OeE07zhzNW1p5yevJ64i3xtGEwkCCJmkYH0oz
g6gXe8mXokM9lBD50I0syAiPBEaRUAmREEnRCcQg7CERkoiBYHe+f132Wnv+
tfc+5si57LX/9f3///2XtdY+Dg4dHXn8iaGjBw8MVbYfGTo8cvDA05Vth440
h4JxQogzzddTFYHvYfOrejsjwjDETfujgz6Koj4s5F+1JhrNkTCsi+Hmvzp9
D839aq0hemmk4IyFsTmNWjVHNwMxXA/V7VBsvvmp5ZuwNLCdxEVD1KpStI3G
8iKE/HBdTa2KWkOr4u+1K6z6cKRyU4vy5RbtyUk3MMN4L4QkKW8RMRatyWVE
YnMuSJmqtY/B6jBY3DztSaM2TFbZnmeVT/Kcw8ilB1Dy5U4rJ9zLa6xGTVRV
3mxuUX5Wi/ZkcIPzvpxwT6Z2mzILf4TX3/qU3lsfk1aLqk0XSU2ncigqckz2
LjXW1yJGkmsJhdauiaJphiidCWN7oTuWH8MzoRNqsOni97+L4PCHp344dvKt
7/ASOXoPzj5ztP7FoSc/xUu0413dePbddy5i2ppLP/4hg0isVLKrLmd3SLXM
lXJG940bo1CtX4G06OPnn/sMBl488NhHzRBtXH8iIKuDV1579eu4XzsufPub
ni/a8S5vdB4/8cYFTPvm4MhpYFze99B7QIZzECuMjv4r9kl7VOO47dq1vw1W
h+Ry5JPTl4xOZaCGJqty9J6HsVCjX9cHdp4UZLea9MD5ry4Dcmnjlz/FTLlS
Va5e/QvjsAmi/2zd8iYCBaW496A0b7w0D6NGraLk6t49b2uVopPeaczIdUi5
119+6XzcDR15cjQn3SXrdEEsoPdOu0hAN7DAJph99Gz9Z2Jyr2Oqw6TKSowZ
6B1M/cnkyCMRTx5/8Uu4gU8yaY8DD86MN7ulN4CiHFYFiHckGCxEcBB7ghq0
OswpzGpzsB2T5jNj+f8xVpJ39BgigPgsvHLlenPfQkUB32Avkh2UFW6xCb1e
ObGfPtrtW2AU1oDFTjkT3eWnR/Z/gHRUcVQzCw5o84XMQAjBPWJRiOoeSYQE
guvbbBAuJwJNCgVY2aFNA4liqwWRC2nnQkKoIqiB0WpiG6xCCaPSwPAWv3q1
y0AstA9aPSoBNOBT9PshOiIPYAiloIIAHIwAvNolsBAqBUAVIAClsxV+YYyK
a6MfQmmE63CENI6PeAQEcbvBD1GMNMJomwuwjDx++PNzv4r18VCUIsJ0xG17
3n/h2DmEQ6zz6y65DFBDUeYj/ICgLlT1Q0yIOIeplL0KAmZjjFxa64folmNI
XTLYIlaTCCbEGj9ED2N0Z+Qc8pkyZHWcxMmRqfFM1C4RK6v8uidHcYA4pUws
EymZV/ohpsgxmMiFEhDoFGKFH2KqW5jkrYoDWgUVKq6W+yGmuX7bEHqLQFfL
/BDTXQjyW0FgOiyhq6XxOMyIJiIO9kR4biYu8eue4daiF+IeP8TMZAjEgVLr
bgmxS7WRmzgY5xjtt/u14zvGSPtdUvsAfWQ/wHIqyxlVLnZVZj05kkrSOCtZ
kWkTi1xFWc92AeNbr18l2opReWe6b55DWBujtc8tW7uloqCM1oXpQeQOR5zK
ir9uHZUL7KzNdAThaJ2dUdt8f5nNkWPolKa5cxDz4l1ibtTkIOSdONevey4j
zkHc4YeYxxQIBzHHD6E2wFh2sF7RFQcx2w8ho0lLnlk1OYhKnESZ77Tc0mrt
m9jn160gzNIWg0BQiZXeVAgnjYoMsbP8EIuibMACT0ZzEGU/xGK3H5C4gsB2
EBBWa2YhZDd2l5giMzbTgiAEuYjQ0mpW5yIT1Bl+3XIpC8wuxUDQYT19IigD
dVRIXXIMBtNmA1fT/RBLGOq6mLyY5odY6qcOcICl3bMNQSm8nEnhIuPSVL/u
ZYyeLiahpvghljPiXQwrcoOo+m5rz8K5dn8vk59dDJOTbLXZH6dxPX8Fk6pK
JdKUjoq46klX6V9eWZVOfEpMenWnq+Q2EdETuZX+KOK72Y9nUJTVt1VMtJRK
fRQjMybeugiuZopbqQSVoJSu5HFObUsyPXvkUnR1FDyc5akWS6YvTfCXlDzi
0ZMtesCGqxLT5Lr8EGuNHjUR2wxElg5m9kRqJdXIVHNuKjFWFP0aq1HooIdq
PvI2YeJ9cszp9py3nX6IdV5y3IxOh4A4ghWZH+sxBQuCEOQTCXp+ik5sm+/k
WYdf9wa/+U4jT4fgzAekObW2+yE2MnFIWDrk72eBebiDq4RlQok7GyNbnNKw
3+RLAtLmKFfBDLWlyX7xfiaNJ/nFtzCh60kVd6qrJ+6WfH7odrpuP+ZWhtmJ
qeJgln7UsMTjR3NusW3haC4fpbobjgm2Jrc765/Z0o7f2xgOM8COOWLHYLd7
C5OF1Sf3MQdqQlU/KZhHaFGJJixMmY7KClk/40tDNotPynF4pxxD36JHurhS
TThxWct0+t0ZRQy/1VgHBjZD7zdlbQtRaQxExQwkiv14P5ISd06MCU19FxO1
Qqq4sxVIEB9kKE5o0YNMndrixMcepv0k9OzdUSDo8XiKuPpFUv0HGjHuPx4d
4iU=\
\>"]]}], "}"}]], "Output",
 CellChangeTimes->{
  3.403984332108746*^9, 3.403984681845146*^9, 3.405109292212773*^9, {
   3.4051094703491726`*^9, 3.4051094989907727`*^9}, 3.405109580126373*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Calculs", " ", 
  RowBox[{"Formel", " ", ":", 
   FormBox[
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Alpha]", " ", 
        SuperscriptBox[
         SubscriptBox["S", "1"], "a"]}], "-", 
       RowBox[{"\[Beta]", " ", 
        SuperscriptBox[
         SubscriptBox["S", "2"], "b"]}], "-", "K"}], ")"}], "+"],
    TraditionalForm]}]}]], "Section",
 CellChangeTimes->{{3.4047530588767443`*^9, 3.4047530880799437`*^9}, {
  3.404753954096744*^9, 3.404753999399144*^9}}],

Cell[CellGroupData[{

Cell["Calculs Formels x2> 0 ", "Subsection",
 CellChangeTimes->{{3.40205058751505*^9, 3.402050591562002*^9}, {
   3.4020506469068146`*^9, 3.4020506699697576`*^9}, 3.4020641845903263`*^9, {
   3.4048032629639206`*^9, 3.404803263120177*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"\[Alpha]", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"a", " ", "x1"}]]}], "-", 
     RowBox[{"\[Beta]", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"b", " ", "x2"}]]}], "-", "K"}], "\[Equal]", "0"}], ",", 
   "x1"}], "]"}]], "Input",
 CellChangeTimes->{{3.404754194211944*^9, 3.4047542174247437`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Solve", "::", "\<\"ifun\"\>"}], ":", 
  " ", "\<\"Inverse functions are being used by \\!\\(Solve\\), so some \
solutions may not be found; use Reduce for complete solution information. \\!\
\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/Solve\\\", ButtonNote -> \
\\\"Solve::ifun\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.404754221449544*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"x1", "\[Rule]", 
    FractionBox[
     RowBox[{"Log", "[", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"-", "K"}], "-", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"b", " ", "x2"}]], " ", "\[Beta]"}]}], "\[Alpha]"]}], 
      "]"}], "a"]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.404754221449544*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"integration1", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    SubsuperscriptBox["\[Integral]", 
     FractionBox[
      RowBox[{"Log", "[", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          RowBox[{"-", "K"}], "-", 
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"b", "  ", "x2"}]], " ", "\[Beta]"}]}], "\[Alpha]"]}], 
       "]"}], "a"], "\[Infinity]"], " ", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", "  ", "k1", " ", "x1"}]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Alpha]", " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"a", "  ", "x1"}]]}], "-", 
       RowBox[{"\[Beta]", " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"b", "  ", "x2"}]]}], "-", "K"}], ")"}], 
     RowBox[{"\[DifferentialD]", "x1"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.3997830788528023`*^9, 3.3997830934780827`*^9}, {
   3.399783175698412*^9, 3.3997832121991124`*^9}, {3.3997832703252287`*^9, 
   3.3997832746221857`*^9}, {3.4047536787215443`*^9, 3.404753684930344*^9}, {
   3.404753975671544*^9, 3.404754006559544*^9}, 3.4047542504343443`*^9, {
   3.4047551636583443`*^9, 3.404755170881144*^9}}],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Im", "[", "k1", "]"}], ">", "0"}], "&&", 
    RowBox[{
     RowBox[{"Re", "[", "a", "]"}], "<", 
     RowBox[{"Im", "[", "k1", "]"}]}]}], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "a", " ", "\[Alpha]", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox[
         RowBox[{"K", "+", 
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"b", " ", "x2"}]], " ", "\[Beta]"}]}], "\[Alpha]"], ")"}],
        
       RowBox[{"1", "+", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}]]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"a", "+", 
        RowBox[{"\[ImaginaryI]", " ", "k1"}]}], ")"}], " ", "k1"}]]}], ",", 
   RowBox[{"Integrate", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "k1", " ", "x1"}]]}], " ", "K"}], "+", 
      
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"a", " ", "x1"}], "+", 
         RowBox[{"\[ImaginaryI]", " ", "k1", " ", "x1"}]}]], " ", 
       "\[Alpha]"}], "-", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", "k1", " ", "x1"}], "+", 
         RowBox[{"b", " ", "x2"}]}]], " ", "\[Beta]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"x1", ",", 
       FractionBox[
        RowBox[{"Log", "[", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{
            RowBox[{"-", "K"}], "-", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"b", " ", "x2"}]], " ", "\[Beta]"}]}], "\[Alpha]"]}], 
         "]"}], "a"], ",", "\[Infinity]"}], "}"}], ",", 
     RowBox[{"Assumptions", "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Re", "[", "a", "]"}], "\[LessEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"Im", "[", "k1", "]"}], "\[LessEqual]", "0"}]}], ")"}], "||",
        
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Re", "[", "a", "]"}], ">", "0"}], "&&", 
         RowBox[{
          RowBox[{"Im", "[", "k1", "]"}], "\[LessEqual]", 
          RowBox[{"Re", "[", "a", "]"}]}]}], ")"}]}]}]}], "]"}]}], 
  "]"}]], "Output",
 CellChangeTimes->{{3.3997832193242493`*^9, 3.399783241121543*^9}, 
   3.3997832783097568`*^9, 3.404753856612344*^9, 3.4047540171207438`*^9, 
   3.404754272757944*^9, 3.4047551730027437`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"integration11", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{"integration1", ",", 
    RowBox[{
     RowBox[{
      RowBox[{"Im", "[", "k1", "]"}], ">", "0"}], "&&", 
     RowBox[{
      RowBox[{"Re", "[", "a", "]"}], "<", 
      RowBox[{"Im", "[", "k1", "]"}]}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.3997832863099103`*^9, 3.399783319044914*^9}, 
   3.404754044576744*^9}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "a", " ", "\[Alpha]", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox[
       RowBox[{"K", "+", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"b", " ", "x2"}]], " ", "\[Beta]"}]}], "\[Alpha]"], ")"}], 
     RowBox[{"1", "+", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}]]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"a", "+", 
      RowBox[{"\[ImaginaryI]", " ", "k1"}]}], ")"}], " ", "k1"}]]}]], "Output",\

 CellChangeTimes->{{3.3997833072165613`*^9, 3.399783319935556*^9}, 
   3.404753872118744*^9, 3.404754047525144*^9, 3.404754281727944*^9, 
   3.4047551775891438`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"Integrate", "[", 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", "  ", "k2", "  ", "x2"}]], "integration11"}], 
     ",", "x2"}], "]"}], ",", 
   RowBox[{"K", ">", "0"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.3997833532799463`*^9, 3.3997833668114557`*^9}, {
   3.3997834246563168`*^9, 3.3997834378440695`*^9}, 3.3997895808526382`*^9, {
   3.404755146311144*^9, 3.4047551487759438`*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{
   FractionBox["1", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"a", "+", 
       RowBox[{"\[ImaginaryI]", " ", "k1"}]}], ")"}], " ", "k1", " ", "k2", 
     " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "b"}], "+", "k2"}], ")"}]}]], 
   RowBox[{"a", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", "k2", " ", "x2"}]], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox[
       RowBox[{"K", "+", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"b", " ", "x2"}]], " ", "\[Beta]"}]}], "\[Alpha]"], ")"}], 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "+", 
       FractionBox[
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"b", " ", "x2"}]], " ", "\[Beta]"}], "K"]}], ")"}], 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"K", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", "b"}], "+", "k2"}], ")"}], " ",
        
       RowBox[{"Hypergeometric2F1", "[", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}], ",", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"], ",", 
         RowBox[{"1", "+", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ",", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"b", " ", "x2"}]], " ", "\[Beta]"}], "K"]}]}], "]"}]}], 
      "+", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"b", " ", "x2"}]], " ", "k2", " ", "\[Beta]", " ", 
       RowBox[{"Hypergeometric2F1", "[", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}], ",", 
         RowBox[{"1", "+", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ",", 
         RowBox[{"2", "+", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ",", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"b", " ", "x2"}]], " ", "\[Beta]"}], "K"]}]}], "]"}]}]}],
      ")"}]}]}]}]], "Output",
 CellChangeTimes->{3.399783368780244*^9, 3.3997834401253633`*^9, 
  3.399789582040161*^9, 3.404753877407144*^9, 3.4047540708159437`*^9, 
  3.404754301477544*^9, 3.404755182050744*^9}]
}, Open  ]],

Cell[TextData[StyleBox["ca converge pour Im[k1] > a,  Im[k2] > 0  pour x2 \
\[Element] [0, +\[Infinity][ ",
 FontWeight->"Bold",
 FontColor->RGBColor[1, 0, 0]]], "Text",
 CellChangeTimes->{{3.3997905702622595`*^9, 3.3997906860613575`*^9}, {
   3.399790902971772*^9, 3.3997909145188694`*^9}, {3.404754364361144*^9, 
   3.404754371193944*^9}, {3.4047554462211437`*^9, 3.404755487732744*^9}, 
   3.404755532504744*^9, 3.404756278028544*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"on", " ", "fabrique", " ", "donc", " ", 
   RowBox[{"F", "[", 
    RowBox[{"x2", "=", "\[Infinity]"}], "]"}]}], " ", "-", 
  RowBox[{
   RowBox[{"F", "[", 
    RowBox[{"x2", "=", "0"}], "]"}], " ", "pour", " ", "obtenir", " ", 
   RowBox[{"l", "'"}], "integrale", " ", 
   RowBox[{"(", 
    RowBox[{"x2", ">", "0"}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.4047555538299437`*^9, 3.404755643997944*^9}}],

Cell[BoxData[
 RowBox[{"finf", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     FractionBox["1", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"a", "+", 
         RowBox[{"\[ImaginaryI]", " ", "k1"}]}], ")"}], " ", "k1", " ", "k2", 
       " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", "b"}], "+", "k2"}], ")"}]}]]}],
     "a", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", "k2", " ", "x2"}]], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox["1", "\[Alpha]"], ")"}], 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox["1", "K"], ")"}], 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"K", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", "b"}], "+", "k2"}], ")"}], " ",
        
       RowBox[{"Hypergeometric2F1", "[", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}], ",", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"], ",", 
         RowBox[{"1", "+", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ",", "0"}], "]"}]}], 
      "+", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"b", " ", "x2"}]], " ", "k2", " ", "\[Beta]", " ", 
       RowBox[{"Hypergeometric2F1", "[", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}], ",", 
         RowBox[{"1", "+", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ",", 
         RowBox[{"2", "+", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ",", "0"}], 
        "]"}]}]}], ")"}]}], "=", "0"}]}]], "Input",
 CellChangeTimes->{{3.404755665775544*^9, 3.404755696023944*^9}, {
  3.4047557403903437`*^9, 3.404755746879944*^9}, {3.404755795395944*^9, 
  3.404755800122744*^9}, {3.4047558767187443`*^9, 3.404755877311544*^9}, {
  3.4047559202583437`*^9, 3.4047559222707443`*^9}}],

Cell[BoxData[
 RowBox[{"on", " ", 
  RowBox[{"emploie", " ", ":"}]}]], "Input",
 CellChangeTimes->{{3.4048003192727623`*^9, 3.4048003223510056`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RuleHyper", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Hypergeometric2F1", "[", 
      RowBox[{"a_", ",", "b_", ",", "c_", ",", "z_"}], "]"}], "->", 
     RowBox[{
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"Gamma", "[", 
          RowBox[{"b", "-", "a"}], "]"}], " ", 
         RowBox[{"Gamma", "[", "c", "]"}]}], 
        RowBox[{
         RowBox[{"Gamma", "[", "b", "]"}], 
         RowBox[{"Gamma", "[", 
          RowBox[{"c", "-", "a"}], "]"}]}]], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"-", "z"}], ")"}], 
        RowBox[{"-", "a"}]], 
       RowBox[{"Hypergeometric2F1", "[", 
        RowBox[{"a", ",", 
         RowBox[{"a", "-", "c", "+", "1"}], ",", 
         RowBox[{"a", "-", "b", "+", "1"}], ",", 
         FractionBox["1", "z"]}], "]"}]}], "+", 
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"Gamma", "[", 
          RowBox[{"a", "-", "b"}], "]"}], " ", 
         RowBox[{"Gamma", "[", "c", "]"}]}], 
        RowBox[{
         RowBox[{"Gamma", "[", "a", "]"}], " ", 
         RowBox[{"Gamma", "[", 
          RowBox[{"c", "-", "b"}], "]"}]}]], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"-", "z"}], ")"}], 
        RowBox[{"-", "b"}]], " ", 
       RowBox[{"Hypergeometric2F1", "[", 
        RowBox[{"b", ",", 
         RowBox[{"b", "-", "c", "+", "1"}], ",", 
         RowBox[{"b", "-", "a", "+", "1"}], ",", 
         FractionBox["1", "z"]}], "]"}]}]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.3990921348304167`*^9, 3.399092134939794*^9}, 
   3.3990921744405527`*^9, {3.3990929238768167`*^9, 3.3990929242830744`*^9}, {
   3.399899254369732*^9, 3.3998993072769976`*^9}},
 Background->RGBColor[1., 1., 0.9019607843137255]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"a", "+", 
        RowBox[{"\[ImaginaryI]", " ", "k1"}]}], ")"}], " ", "k1", " ", "k2", 
      " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "b"}], "+", "k2"}], ")"}]}]]}], 
   "a", " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"\[ImaginaryI]", " ", "k2", " ", "x2"}]], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     FractionBox["1", "\[Alpha]"], ")"}], 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     FractionBox["1", "K"], ")"}], 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"K", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "b"}], "+", "k2"}], ")"}], " ", 
      
      RowBox[{"Hypergeometric2F1", "[", 
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}], ",", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"], ",", 
        RowBox[{"1", "+", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ",", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"b", " ", "x2"}]], " ", "\[Beta]"}], "K"]}]}], "]"}]}], 
     "+", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"b", " ", "x2"}]], " ", "k2", " ", "\[Beta]", " ", 
      RowBox[{"Hypergeometric2F1", "[", 
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}], ",", 
        RowBox[{"1", "+", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ",", 
        RowBox[{"2", "+", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ",", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"b", " ", "x2"}]], " ", "\[Beta]"}], "K"]}]}], "]"}]}]}], 
    ")"}]}], "/.", "RuleHyper"}]], "Input",
 CellChangeTimes->{{3.404800342914295*^9, 3.4048003490395308`*^9}, {
  3.404800390337991*^9, 3.4048003943850217`*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{
   FractionBox["1", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"a", "+", 
       RowBox[{"\[ImaginaryI]", " ", "k1"}]}], ")"}], " ", "k1", " ", "k2", 
     " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "b"}], "+", "k2"}], ")"}]}]], 
   RowBox[{"a", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", "k2", " ", "x2"}]], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox["1", "K"], ")"}], 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}]], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox["1", "\[Alpha]"], ")"}], 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"b", " ", "x2"}]], " ", "k2", " ", "\[Beta]", " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             FractionBox[
              RowBox[{
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{"b", " ", "x2"}]], " ", "\[Beta]"}], "K"], ")"}], 
            RowBox[{
             RowBox[{"-", "1"}], "-", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}]], " ", 
           RowBox[{"Gamma", "[", 
            RowBox[{
             RowBox[{"-", "1"}], "-", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"], "-", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], "]"}], " ", 
           RowBox[{"Gamma", "[", 
            RowBox[{"2", "+", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], "]"}]}], 
          RowBox[{"Gamma", "[", 
           RowBox[{"-", 
            FractionBox[
             RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}], "]"}]], "+", 
         FractionBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             FractionBox[
              RowBox[{
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{"b", " ", "x2"}]], " ", "\[Beta]"}], "K"], ")"}], 
            FractionBox[
             RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]], " ", 
           RowBox[{"Gamma", "[", 
            RowBox[{"2", "+", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], "]"}], " ", 
           RowBox[{"Gamma", "[", 
            RowBox[{"1", "+", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"], "+", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], "]"}], " ", 
           RowBox[{"Hypergeometric2F1", "[", 
            RowBox[{
             RowBox[{"-", 
              FractionBox[
               RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}], ",", 
             RowBox[{
              RowBox[{"-", "1"}], "-", 
              FractionBox[
               RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"], "-", 
              FractionBox[
               RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ",", 
             RowBox[{
              RowBox[{"-", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}], "-", 
              FractionBox[
               RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ",", 
             RowBox[{"-", 
              FractionBox[
               RowBox[{
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{
                  RowBox[{"-", "b"}], " ", "x2"}]], " ", "K"}], 
               "\[Beta]"]}]}], "]"}]}], 
          RowBox[{
           RowBox[{"Gamma", "[", 
            RowBox[{"1", "+", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], "]"}], " ", 
           RowBox[{"Gamma", "[", 
            RowBox[{"2", "+", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"], "+", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], "]"}]}]]}], 
        ")"}]}], "+", 
      RowBox[{"K", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", "b"}], "+", "k2"}], ")"}], " ",
        
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             FractionBox[
              RowBox[{
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{"b", " ", "x2"}]], " ", "\[Beta]"}], "K"], ")"}], 
            RowBox[{"-", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}]], " ", 
           RowBox[{"Gamma", "[", 
            RowBox[{
             RowBox[{"-", 
              FractionBox[
               RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}], "-", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], "]"}], " ", 
           RowBox[{"Gamma", "[", 
            RowBox[{"1", "+", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], "]"}]}], 
          RowBox[{"Gamma", "[", 
           RowBox[{"-", 
            FractionBox[
             RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}], "]"}]], "+", 
         FractionBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             FractionBox[
              RowBox[{
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{"b", " ", "x2"}]], " ", "\[Beta]"}], "K"], ")"}], 
            FractionBox[
             RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]], " ", 
           RowBox[{"Gamma", "[", 
            RowBox[{"1", "+", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], "]"}], " ", 
           RowBox[{"Gamma", "[", 
            RowBox[{
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"], "+", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], "]"}], " ", 
           RowBox[{"Hypergeometric2F1", "[", 
            RowBox[{
             RowBox[{"-", 
              FractionBox[
               RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}], ",", 
             RowBox[{
              RowBox[{"-", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}], "-", 
              FractionBox[
               RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ",", 
             RowBox[{"1", "-", 
              FractionBox[
               RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"], "-", 
              FractionBox[
               RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ",", 
             RowBox[{"-", 
              FractionBox[
               RowBox[{
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{
                  RowBox[{"-", "b"}], " ", "x2"}]], " ", "K"}], 
               "\[Beta]"]}]}], "]"}]}], 
          RowBox[{
           RowBox[{"Gamma", "[", 
            FractionBox[
             RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"], "]"}], " ", 
           RowBox[{"Gamma", "[", 
            RowBox[{"1", "+", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"], "+", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], "]"}]}]]}], 
        ")"}]}]}], ")"}]}]}]}]], "Output",
 CellChangeTimes->{3.4048003498208103`*^9, 3.404800400385252*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"la", " ", "partie", " ", "hypergeometrique", " ", 
   RowBox[{"s", "'"}], "annule", " ", "a", " ", 
   RowBox[{"l", "'"}], "infini", " ", "pouvu", " ", "que", " ", 
   RowBox[{"Im", "[", "k2", "]"}]}], " ", ">", " ", 
  RowBox[{"Re", "[", "b", "]"}]}]], "Input",
 CellChangeTimes->{{3.4048004092449675`*^9, 3.4048004247924395`*^9}, {
  3.4048008569809093`*^9, 3.40480087651291*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{
   FractionBox["1", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"a", "+", 
       RowBox[{"\[ImaginaryI]", " ", "k1"}]}], ")"}], " ", "k1", " ", "k2", 
     " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "b"}], "+", "k2"}], ")"}]}]], 
   "a", " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"\[ImaginaryI]", " ", "k2", " ", "x2"}]], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     FractionBox["1", "K"], ")"}], 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}]], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     FractionBox["1", "\[Alpha]"], ")"}], 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"b", " ", "x2"}]], " ", "k2", " ", "\[Beta]", " ", 
      RowBox[{"(", 
       FractionBox[
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           FractionBox[
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"b", " ", "x2"}]], " ", "\[Beta]"}], "K"], ")"}], 
          RowBox[{
           RowBox[{"-", "1"}], "-", 
           FractionBox[
            RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}]], " ", 
         RowBox[{"Gamma", "[", 
          RowBox[{
           RowBox[{"-", "1"}], "-", 
           FractionBox[
            RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"], "-", 
           FractionBox[
            RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], "]"}], " ", 
         RowBox[{"Gamma", "[", 
          RowBox[{"2", "+", 
           FractionBox[
            RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], "]"}]}], 
        RowBox[{"Gamma", "[", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}], "]"}]], ")"}]}], "+",
      
     RowBox[{"K", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "b"}], "+", "k2"}], ")"}], " ", 
      
      RowBox[{"(", 
       FractionBox[
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           FractionBox[
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"b", " ", "x2"}]], " ", "\[Beta]"}], "K"], ")"}], 
          RowBox[{"-", 
           FractionBox[
            RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}]], " ", 
         RowBox[{"Gamma", "[", 
          RowBox[{
           RowBox[{"-", 
            FractionBox[
             RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}], "-", 
           FractionBox[
            RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], "]"}], " ", 
         RowBox[{"Gamma", "[", 
          RowBox[{"1", "+", 
           FractionBox[
            RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], "]"}]}], 
        RowBox[{"Gamma", "[", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}], "]"}]], ")"}]}]}], 
    ")"}]}]}]], "Input",
 CellChangeTimes->{{3.4048018241899242`*^9, 3.4048018287838507`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"a", "+", 
       RowBox[{"\[ImaginaryI]", " ", "k1"}]}], ")"}], " ", "k1", " ", "k2", 
     " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "b"}], "+", "k2"}], ")"}]}]]}], 
  "a", "  ", 
  SuperscriptBox["K", 
   RowBox[{"1", "+", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"], "+", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}]], " ", 
  SuperscriptBox["\[Alpha]", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}]], "  ", 
  SuperscriptBox["\[Beta]", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}]], 
  FractionBox[
   RowBox[{" ", 
    RowBox[{
     RowBox[{"Gamma", "[", 
      RowBox[{"1", "+", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], "]"}], 
     RowBox[{"Gamma", "[", 
      RowBox[{
       RowBox[{"-", "1"}], "-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"], "-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], "]"}]}]}], 
   RowBox[{"Gamma", "[", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}], "]"}]], 
  RowBox[{"(", " ", 
   RowBox[{
    RowBox[{"k2", " ", 
     RowBox[{"(", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ")"}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "b"}], "+", "k2"}], ")"}], " ", 
     RowBox[{"(", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "-", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"], "-", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ")"}], " ", ")"}]}]}], 
   ")"}]}]], "Input",
 CellChangeTimes->{{3.4048004656221323`*^9, 3.4048004712785993`*^9}, {
  3.404800515670929*^9, 3.404800532218439*^9}, {3.4048005968146696`*^9, 
  3.404800643207076*^9}, {3.404800683396119*^9, 3.404800772071399*^9}, {
  3.404800806775857*^9, 3.404800816963748*^9}, {3.404800891138471*^9, 
  3.404801061395009*^9}, {3.404801125272462*^9, 3.404801126788145*^9}, {
  3.4048011695554123`*^9, 3.4048011774150887`*^9}, {3.404801408392708*^9, 
  3.404801498474292*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"(", " ", 
   RowBox[{
    RowBox[{"k2", " ", 
     RowBox[{"(", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ")"}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "b"}], "+", "k2"}], ")"}], " ", 
     RowBox[{"(", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "-", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"], "-", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ")"}], " ", ")"}]}]}], 
   ")"}], "]"}]], "Input",
 CellChangeTimes->{{3.4048015243971624`*^9, 3.40480152849107*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"\[ImaginaryI]", " ", 
   RowBox[{"(", 
    RowBox[{"a", "+", 
     RowBox[{"\[ImaginaryI]", " ", "k1"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"b", "+", 
     RowBox[{"\[ImaginaryI]", " ", "k2"}]}], ")"}]}], "a"]], "Output",
 CellChangeTimes->{3.4048015296942406`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"1", "  "}], 
   RowBox[{"  ", 
    RowBox[{"k1", " ", "k2", " "}]}]], "  ", 
  SuperscriptBox["K", 
   RowBox[{"1", "+", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"], "+", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}]], " ", 
  SuperscriptBox["\[Alpha]", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}]], "  ", 
  SuperscriptBox["\[Beta]", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}]], 
  FractionBox[
   RowBox[{" ", 
    RowBox[{
     RowBox[{"Gamma", "[", 
      RowBox[{"1", "+", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], "]"}], 
     RowBox[{"Gamma", "[", 
      RowBox[{
       RowBox[{"-", "1"}], "-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"], "-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], "]"}]}]}], 
   RowBox[{"Gamma", "[", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}], "]"}]]}]], "Input",
 CellChangeTimes->{{3.4048015564921446`*^9, 3.404801588899639*^9}, {
  3.404801629635578*^9, 3.4048016433861065`*^9}, {3.4048017171389384`*^9, 
  3.4048017410929832`*^9}}],

Cell[BoxData[
 RowBox[{"or", " ", "on", " ", "aussi", " ", "que"}]], "Input",
 CellChangeTimes->{{3.404801905646177*^9, 3.4048019122558055`*^9}}],

Cell[BoxData[
 RowBox[{"f0", "=", 
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"a", "+", 
        RowBox[{"\[ImaginaryI]", " ", "k1"}]}], ")"}], " ", "k1", " ", "k2", 
      " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "b"}], "+", "k2"}], ")"}]}]]}], 
   "a", "  ", 
   SuperscriptBox[
    RowBox[{"(", 
     FractionBox["1", "\[Alpha]"], ")"}], 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     FractionBox[
      RowBox[{" ", "1"}], "K"], ")"}], 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"K", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "b"}], "+", "k2"}], ")"}], " ", 
      
      RowBox[{"Hypergeometric2F1", "[", 
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}], ",", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"], ",", 
        RowBox[{"1", "+", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ",", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{" ", "\[Beta]"}], "K"]}]}], "]"}]}], "+", " ", 
     RowBox[{"k2", " ", "\[Beta]", " ", 
      RowBox[{"Hypergeometric2F1", "[", 
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}], ",", 
        RowBox[{"1", "+", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ",", 
        RowBox[{"2", "+", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ",", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{" ", "\[Beta]"}], "K"]}]}], "]"}]}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.404755880041544*^9, 3.404755892303144*^9}, {
   3.404756173321344*^9, 3.404756209123344*^9}, 3.404759371149744*^9}],

Cell[BoxData[{"donc", "\[IndentingNewLine]", 
 RowBox[{"optplus", "=", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{"1", "  "}], 
     RowBox[{"  ", 
      RowBox[{"k1", " ", "k2", " "}]}]], "  ", 
    SuperscriptBox["K", 
     RowBox[{"1", "+", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"], "+", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}]], " ", 
    SuperscriptBox["\[Alpha]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}]], "  ", 
    SuperscriptBox["\[Beta]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}]], 
    FractionBox[
     RowBox[{" ", 
      RowBox[{
       RowBox[{"Gamma", "[", 
        RowBox[{"1", "+", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], "]"}], 
       RowBox[{"Gamma", "[", 
        RowBox[{
         RowBox[{"-", "1"}], "-", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"], "-", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], "]"}]}]}], 
     RowBox[{"Gamma", "[", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}], "]"}]]}], "+", 
   RowBox[{
    FractionBox["1", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"a", "+", 
        RowBox[{"\[ImaginaryI]", " ", "k1"}]}], ")"}], " ", "k1", " ", "k2", 
      " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "b"}], "+", "k2"}], ")"}]}]], 
    "a", "  ", 
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox["1", "\[Alpha]"], ")"}], 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox[
       RowBox[{" ", "1"}], "K"], ")"}], 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"K", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", "b"}], "+", "k2"}], ")"}], " ",
        
       RowBox[{"Hypergeometric2F1", "[", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}], ",", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"], ",", 
         RowBox[{"1", "+", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ",", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{" ", "\[Beta]"}], "K"]}]}], "]"}]}], "+", " ", 
      RowBox[{"k2", " ", "\[Beta]", " ", 
       RowBox[{"Hypergeometric2F1", "[", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}], ",", 
         RowBox[{"1", "+", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ",", 
         RowBox[{"2", "+", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ",", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{" ", "\[Beta]"}], "K"]}]}], "]"}]}]}], 
     ")"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.4047562298089437`*^9, 3.404756257389744*^9}, 
   3.404759373115344*^9, {3.4048019371005096`*^9, 3.40480193841306*^9}}],

Cell[BoxData[
 RowBox[{"On", " ", "applique", " ", "alors", " ", "la", " ", "regle", " ", 
  "et", " ", "maintenant", " ", "il", " ", "ne", " ", "reste", " ", "plus", 
  " ", "que", " ", "la", " ", "partie", " ", 
  RowBox[{"hypergeometrique", " ", "!"}]}]], "Input",
 CellChangeTimes->{{3.40480202044746*^9, 3.404802031229124*^9}, {
  3.4048020696212234`*^9, 3.404802088731332*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"a", "+", 
       RowBox[{"\[ImaginaryI]", " ", "k1"}]}], ")"}], " ", "k1", " ", "k2", 
     " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "b"}], "+", "k2"}], ")"}]}]]}], 
  "a", "  ", 
  SuperscriptBox[
   RowBox[{"(", 
    FractionBox["1", "K"], ")"}], 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}]], " ", 
  SuperscriptBox[
   RowBox[{"(", 
    FractionBox["1", "\[Alpha]"], ")"}], 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]], " ", 
  RowBox[{"(", " ", 
   RowBox[{
    RowBox[{"k2", " ", "\[Beta]", " ", 
     RowBox[{"(", 
      FractionBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          FractionBox[
           RowBox[{" ", "\[Beta]"}], "K"], ")"}], 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]], " ", 
        RowBox[{"Gamma", "[", 
         RowBox[{"2", "+", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], "]"}], " ", 
        RowBox[{"Gamma", "[", 
         RowBox[{"1", "+", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"], "+", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], "]"}], " ", 
        RowBox[{"Hypergeometric2F1", "[", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}], ",", 
          RowBox[{
           RowBox[{"-", "1"}], "-", 
           FractionBox[
            RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"], "-", 
           FractionBox[
            RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ",", 
          RowBox[{
           RowBox[{"-", 
            FractionBox[
             RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}], "-", 
           FractionBox[
            RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ",", 
          RowBox[{"-", 
           FractionBox[
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{
               RowBox[{"-", "b"}], " ", "x2"}]], " ", "K"}], "\[Beta]"]}]}], 
         "]"}]}], 
       RowBox[{
        RowBox[{"Gamma", "[", 
         RowBox[{"1", "+", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], "]"}], " ", 
        RowBox[{"Gamma", "[", 
         RowBox[{"2", "+", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"], "+", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], "]"}]}]], ")"}]}], 
    "+", 
    RowBox[{"K", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "b"}], "+", "k2"}], ")"}], " ", 
     RowBox[{"(", 
      FractionBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          FractionBox[
           RowBox[{" ", "\[Beta]"}], "K"], ")"}], 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]], " ", 
        RowBox[{"Gamma", "[", 
         RowBox[{"1", "+", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], "]"}], " ", 
        RowBox[{"Gamma", "[", 
         RowBox[{
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"], "+", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], "]"}], " ", 
        RowBox[{"Hypergeometric2F1", "[", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}], ",", 
          RowBox[{
           RowBox[{"-", 
            FractionBox[
             RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}], "-", 
           FractionBox[
            RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ",", 
          RowBox[{"1", "-", 
           FractionBox[
            RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"], "-", 
           FractionBox[
            RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ",", 
          RowBox[{"-", 
           FractionBox[
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{
               RowBox[{"-", "b"}], " ", "x2"}]], " ", "K"}], "\[Beta]"]}]}], 
         "]"}]}], 
       RowBox[{
        RowBox[{"Gamma", "[", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"], "]"}], " ", 
        RowBox[{"Gamma", "[", 
         RowBox[{"1", "+", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"], "+", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], "]"}]}]], ")"}]}]}], 
   ")"}]}]], "Input",
 CellChangeTimes->{{3.4048021268577957`*^9, 3.4048021306235657`*^9}, {
  3.404802408071719*^9, 3.404802423666068*^9}}],

Cell[BoxData[
 RowBox[{"que", " ", "on", " ", "simplifie", " ", "avec", " ", "la", " ", 
  "regle", " ", 
  RowBox[{"classique", " ", ":", " ", 
   RowBox[{
    RowBox[{"x", " ", 
     RowBox[{"Gamma", "[", "x", "]"}]}], " ", "\[Equal]", " ", 
    RowBox[{"Gamma", "[", 
     RowBox[{"x", "+", "1"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.4048022077046504`*^9, 3.4048022426278667`*^9}}],

Cell[BoxData[
 RowBox[{"optplus", "=", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "a", "   ", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["\[Beta]", "\[Alpha]"], ")"}], 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]], " "}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"a", "+", 
        RowBox[{"\[ImaginaryI]", " ", "k1"}]}], ")"}], " ", "k1", " ", 
      "b"}]]}], " ", 
   RowBox[{"(", " ", 
    RowBox[{
     RowBox[{"\[Beta]", " ", 
      RowBox[{"(", 
       FractionBox[
        RowBox[{"Hypergeometric2F1", "[", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}], ",", 
          RowBox[{
           RowBox[{"-", "1"}], "-", 
           FractionBox[
            RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"], "-", 
           FractionBox[
            RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ",", 
          RowBox[{
           RowBox[{"-", 
            FractionBox[
             RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}], "-", 
           FractionBox[
            RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ",", 
          RowBox[{"-", 
           FractionBox[
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{
               RowBox[{"-", "b"}], " ", "x2"}]], " ", "K"}], "\[Beta]"]}]}], 
         "]"}], 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"], "+", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ")"}]], ")"}]}], "+",
      
     RowBox[{"K", "  ", 
      RowBox[{"(", 
       FractionBox[
        RowBox[{"  ", 
         RowBox[{"Hypergeometric2F1", "[", 
          RowBox[{
           RowBox[{"-", 
            FractionBox[
             RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}], ",", 
           RowBox[{
            RowBox[{"-", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}], "-", 
            FractionBox[
             RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ",", 
           RowBox[{"1", "-", 
            FractionBox[
             RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"], "-", 
            FractionBox[
             RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ",", 
           RowBox[{"-", 
            FractionBox[
             RowBox[{
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{
                RowBox[{"-", "b"}], " ", "x2"}]], " ", "K"}], "\[Beta]"]}]}], 
          "]"}]}], 
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"], "+", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ")"}]], ")"}]}]}], 
    ")"}]}]}]], "Input",
 CellChangeTimes->{{3.404802266394404*^9, 3.4048023553509445`*^9}, {
   3.4048023938993*^9, 3.404802402993399*^9}, {3.4048024653707943`*^9, 
   3.404802512606983*^9}, {3.404802568468503*^9, 3.404802580281457*^9}, {
   3.4048026805353065`*^9, 3.4048027398813353`*^9}, {3.404802823447044*^9, 
   3.404802832556769*^9}, {3.404802896449847*^9, 3.4048029392483654`*^9}, 
   3.4048029784373703`*^9, {3.40480304587746*^9, 3.40480305031513*^9}, {
   3.404803124489854*^9, 3.404803147553239*^9}, {3.4048033027935753`*^9, 
   3.404803303371722*^9}},
 Background->RGBColor[
  0.7058823529411765, 0.9607843137254902, 0.9372549019607843]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Calculs Formels x2< 0 ", "Subsection",
 CellChangeTimes->{{3.40205058751505*^9, 3.402050591562002*^9}, {
   3.4020506469068146`*^9, 3.4020506699697576`*^9}, 3.4020641845903263`*^9, {
   3.4048032629639206`*^9, 3.404803290464977*^9}}],

Cell[BoxData[
 RowBox[{"on", " ", "reprends", " ", 
  RowBox[{"l", "'"}], "expression", " ", "de", " ", "la", " ", 
  "primitive"}]], "Input",
 CellChangeTimes->{{3.404803442220804*^9, 3.4048034562213416`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"a", "+", 
       RowBox[{"\[ImaginaryI]", " ", "k1"}]}], ")"}], " ", "k1", " ", "k2", 
     " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "b"}], "+", "k2"}], ")"}]}]]}], 
  "a", " ", 
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"\[ImaginaryI]", " ", "k2", " ", "x2"}]], " ", 
  SuperscriptBox[
   RowBox[{"(", 
    FractionBox["1", "\[Alpha]"], ")"}], 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]], " ", 
  SuperscriptBox[
   RowBox[{"(", 
    FractionBox["1", "K"], ")"}], 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}]], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"K", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "b"}], "+", "k2"}], ")"}], " ", 
     RowBox[{"Hypergeometric2F1", "[", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}], ",", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"], ",", 
       RowBox[{"1", "+", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ",", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"b", " ", "x2"}]], " ", "\[Beta]"}], "K"]}]}], "]"}]}], 
    "+", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"b", " ", "x2"}]], " ", "k2", " ", "\[Beta]", " ", 
     RowBox[{"Hypergeometric2F1", "[", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}], ",", 
       RowBox[{"1", "+", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ",", 
       RowBox[{"2", "+", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ",", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"b", " ", "x2"}]], " ", "\[Beta]"}], "K"]}]}], "]"}]}]}], 
   ")"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"quand", " ", "x2"}], " ", "\[Rule]", " ", 
  RowBox[{
   RowBox[{"-", "\[Infinity]"}], " ", "les", " ", "hypergeometrique", " ", 
   "deviennent", " ", "1", "  ", "et", " ", "tout", " ", "tends", " ", "vers",
    " ", 
   RowBox[{"0", "  ", ".", " ", "donc"}]}]}]], "Input",
 CellChangeTimes->{{3.404803570616359*^9, 3.4048036185088234`*^9}, {
  3.4048046797526984`*^9, 3.4048046874561195`*^9}, {3.4048048293678184`*^9, 
  3.4048048315866537`*^9}}],

Cell[BoxData[
 RowBox[{"optmoins", " ", "=", 
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"a", "+", 
        RowBox[{"\[ImaginaryI]", " ", "k1"}]}], ")"}], " ", "k1", " ", "k2", 
      " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "b"}], "+", "k2"}], ")"}]}]]}], 
   "a", "  ", 
   SuperscriptBox[
    RowBox[{"(", 
     FractionBox["K", "\[Alpha]"], ")"}], 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]], "  ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"K", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "b"}], "+", "k2"}], ")"}], " ", 
      
      RowBox[{"Hypergeometric2F1", "[", 
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}], ",", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"], ",", 
        RowBox[{"1", "+", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ",", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{" ", "\[Beta]"}], "K"]}]}], "]"}]}], "+", " ", 
     RowBox[{"k2", " ", "\[Beta]", " ", 
      RowBox[{"Hypergeometric2F1", "[", 
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}], ",", 
        RowBox[{"1", "+", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ",", 
        RowBox[{"2", "+", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ",", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{" ", "\[Beta]"}], "K"]}]}], "]"}]}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.4048036218527017`*^9, 3.404803626743514*^9}, {
  3.4048038029534054`*^9, 3.4048038531428328`*^9}, {3.4048046938313637`*^9, 
  3.4048047598182726`*^9}, {3.404804825008276*^9, 3.404804826602087*^9}}],

Cell[BoxData[
 RowBox[{"Il", " ", "est", " ", "malgr\[EAcute]", " ", "tout", " ", 
  "interressant", " ", 
  RowBox[{"d", "'"}], "voir", " ", "les", " ", "formule", " ", "valable", " ",
   "pour", " ", "K", " ", "tres", " ", "petit"}]], "Input",
 CellChangeTimes->{{3.4048090702806635`*^9, 3.4048090946878505`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"a", "+", 
        RowBox[{"\[ImaginaryI]", " ", "k1"}]}], ")"}], " ", "k1", " ", "k2", 
      " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "b"}], "+", "k2"}], ")"}]}]]}], 
   "a", "  ", 
   SuperscriptBox[
    RowBox[{"(", 
     FractionBox["K", "\[Alpha]"], ")"}], 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]], "  ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"K", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "b"}], "+", "k2"}], ")"}], " ", 
      
      RowBox[{"Hypergeometric2F1", "[", 
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}], ",", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"], ",", 
        RowBox[{"1", "+", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ",", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{" ", "\[Beta]"}], "K"]}]}], "]"}]}], "+", " ", 
     RowBox[{"k2", " ", "\[Beta]", " ", 
      RowBox[{"Hypergeometric2F1", "[", 
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}], ",", 
        RowBox[{"1", "+", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ",", 
        RowBox[{"2", "+", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ",", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{" ", "\[Beta]"}], "K"]}]}], "]"}]}]}], ")"}]}], " ", "/.", 
  "RuleHyper"}]], "Input",
 CellChangeTimes->{{3.404809103797575*^9, 3.4048091186731462`*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{
   FractionBox["1", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"a", "+", 
       RowBox[{"\[ImaginaryI]", " ", "k1"}]}], ")"}], " ", "k1", " ", "k2", 
     " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "b"}], "+", "k2"}], ")"}]}]], 
   RowBox[{"a", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox["K", "\[Alpha]"], ")"}], 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"k2", " ", "\[Beta]", " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             FractionBox["\[Beta]", "K"], ")"}], 
            RowBox[{
             RowBox[{"-", "1"}], "-", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}]], " ", 
           RowBox[{"Gamma", "[", 
            RowBox[{
             RowBox[{"-", "1"}], "-", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"], "-", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], "]"}], " ", 
           RowBox[{"Gamma", "[", 
            RowBox[{"2", "+", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], "]"}]}], 
          RowBox[{"Gamma", "[", 
           RowBox[{"-", 
            FractionBox[
             RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}], "]"}]], "+", 
         FractionBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             FractionBox["\[Beta]", "K"], ")"}], 
            FractionBox[
             RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]], " ", 
           RowBox[{"Gamma", "[", 
            RowBox[{"2", "+", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], "]"}], " ", 
           RowBox[{"Gamma", "[", 
            RowBox[{"1", "+", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"], "+", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], "]"}], " ", 
           RowBox[{"Hypergeometric2F1", "[", 
            RowBox[{
             RowBox[{"-", 
              FractionBox[
               RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}], ",", 
             RowBox[{
              RowBox[{"-", "1"}], "-", 
              FractionBox[
               RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"], "-", 
              FractionBox[
               RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ",", 
             RowBox[{
              RowBox[{"-", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}], "-", 
              FractionBox[
               RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ",", 
             RowBox[{"-", 
              FractionBox["K", "\[Beta]"]}]}], "]"}]}], 
          RowBox[{
           RowBox[{"Gamma", "[", 
            RowBox[{"1", "+", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], "]"}], " ", 
           RowBox[{"Gamma", "[", 
            RowBox[{"2", "+", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"], "+", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], "]"}]}]]}], 
        ")"}]}], "+", 
      RowBox[{"K", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", "b"}], "+", "k2"}], ")"}], " ",
        
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             FractionBox["\[Beta]", "K"], ")"}], 
            RowBox[{"-", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}]], " ", 
           RowBox[{"Gamma", "[", 
            RowBox[{
             RowBox[{"-", 
              FractionBox[
               RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}], "-", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], "]"}], " ", 
           RowBox[{"Gamma", "[", 
            RowBox[{"1", "+", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], "]"}]}], 
          RowBox[{"Gamma", "[", 
           RowBox[{"-", 
            FractionBox[
             RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}], "]"}]], "+", 
         FractionBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             FractionBox["\[Beta]", "K"], ")"}], 
            FractionBox[
             RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]], " ", 
           RowBox[{"Gamma", "[", 
            RowBox[{"1", "+", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], "]"}], " ", 
           RowBox[{"Gamma", "[", 
            RowBox[{
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"], "+", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], "]"}], " ", 
           RowBox[{"Hypergeometric2F1", "[", 
            RowBox[{
             RowBox[{"-", 
              FractionBox[
               RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}], ",", 
             RowBox[{
              RowBox[{"-", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}], "-", 
              FractionBox[
               RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ",", 
             RowBox[{"1", "-", 
              FractionBox[
               RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"], "-", 
              FractionBox[
               RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ",", 
             RowBox[{"-", 
              FractionBox["K", "\[Beta]"]}]}], "]"}]}], 
          RowBox[{
           RowBox[{"Gamma", "[", 
            FractionBox[
             RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"], "]"}], " ", 
           RowBox[{"Gamma", "[", 
            RowBox[{"1", "+", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"], "+", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], "]"}]}]]}], 
        ")"}]}]}], ")"}]}]}]}]], "Output",
 CellChangeTimes->{3.4048091196888103`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"optmoins", "=", 
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"a", "+", 
        RowBox[{"\[ImaginaryI]", " ", "k1"}]}], ")"}], " ", "k1", " ", "k2", 
      " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "b"}], "+", "k2"}], ")"}]}]]}], 
   
   RowBox[{"a", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox["K", "\[Alpha]"], ")"}], 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"k2", " ", "\[Beta]", " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             FractionBox["\[Beta]", "K"], ")"}], 
            RowBox[{
             RowBox[{"-", "1"}], "-", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}]], " ", 
           RowBox[{"Gamma", "[", 
            RowBox[{
             RowBox[{"-", "1"}], "-", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"], "-", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], "]"}], " ", 
           RowBox[{"Gamma", "[", 
            RowBox[{"2", "+", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], "]"}]}], 
          RowBox[{"Gamma", "[", 
           RowBox[{"-", 
            FractionBox[
             RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}], "]"}]], "+", 
         FractionBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             FractionBox["\[Beta]", "K"], ")"}], 
            FractionBox[
             RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]], 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ")"}], "  ", 
           RowBox[{"Hypergeometric2F1", "[", 
            RowBox[{
             RowBox[{"-", 
              FractionBox[
               RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}], ",", 
             RowBox[{
              RowBox[{"-", "1"}], "-", 
              FractionBox[
               RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"], "-", 
              FractionBox[
               RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ",", 
             RowBox[{
              RowBox[{"-", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}], "-", 
              FractionBox[
               RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ",", 
             RowBox[{"-", 
              FractionBox["K", "\[Beta]"]}]}], "]"}]}], 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            FractionBox[
             RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"], "+", 
            FractionBox[
             RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ")"}]]}], ")"}]}], 
      "+", 
      RowBox[{"K", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", "b"}], "+", "k2"}], ")"}], " ",
        
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             FractionBox["\[Beta]", "K"], ")"}], 
            RowBox[{"-", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}]], " ", 
           RowBox[{"Gamma", "[", 
            RowBox[{
             RowBox[{"-", 
              FractionBox[
               RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}], "-", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], "]"}], " ", 
           RowBox[{"Gamma", "[", 
            RowBox[{"1", "+", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], "]"}]}], 
          RowBox[{"Gamma", "[", 
           RowBox[{"-", 
            FractionBox[
             RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}], "]"}]], "+", 
         FractionBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             FractionBox["\[Beta]", "K"], ")"}], 
            FractionBox[
             RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]], " ", 
           RowBox[{"(", 
            FractionBox[
             RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"], ")"}], " ", 
           RowBox[{"Hypergeometric2F1", "[", 
            RowBox[{
             RowBox[{"-", 
              FractionBox[
               RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}], ",", 
             RowBox[{
              RowBox[{"-", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}], "-", 
              FractionBox[
               RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ",", 
             RowBox[{"1", "-", 
              FractionBox[
               RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"], "-", 
              FractionBox[
               RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ",", 
             RowBox[{"-", 
              FractionBox["K", "\[Beta]"]}]}], "]"}]}], 
          RowBox[{"(", 
           RowBox[{
            FractionBox[
             RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"], "+", 
            FractionBox[
             RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ")"}]]}], 
        ")"}]}]}], ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.404809146580468*^9, 3.4048092258647623`*^9}, {
  3.404809268803911*^9, 3.404809269319556*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"VanillaPayOffFourierGauche", "[", 
   RowBox[{
   "k1_", ",", "k2_", ",", "K_", ",", "\[Alpha]_", ",", "\[Beta]_", ",", "a_",
     ",", "b_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"H", "=", 
       FractionBox[
        RowBox[{" ", 
         RowBox[{
          RowBox[{"Gamma", "[", 
           RowBox[{
            RowBox[{"-", "1"}], "-", 
            FractionBox[
             RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"], "-", 
            FractionBox[
             RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], "]"}], " ", 
          RowBox[{"Gamma", "[", 
           RowBox[{"1", "+", 
            FractionBox[
             RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], "]"}]}]}], 
        RowBox[{"Gamma", "[", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}], "]"}]]}], ",", 
      RowBox[{"g1", "=", 
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox["\[Beta]", "K"], ")"}], 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}]]}], ",", 
      RowBox[{"g2", "=", 
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox["\[Beta]", "K"], ")"}], 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"a", "+", 
          RowBox[{"\[ImaginaryI]", " ", "k1"}]}], ")"}], " ", "k1", " ", "k2",
         " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", "b"}], "+", "k2"}], 
         ")"}]}]]}], "a", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox["K", "\[Alpha]"], ")"}], 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"k2", " ", "\[Beta]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["K", "\[Beta]"], "g1", " ", "H", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ")"}]}], "+", 
          FractionBox[
           RowBox[{"g2", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              FractionBox[
               RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ")"}], "  ", 
            RowBox[{"Hypergeometric2F1", "[", 
             RowBox[{
              RowBox[{"-", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}], ",", 
              RowBox[{
               RowBox[{"-", "1"}], "-", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"], "-", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ",", 
              RowBox[{
               RowBox[{"-", 
                FractionBox[
                 RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}], "-", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ",", 
              RowBox[{"-", 
               FractionBox["K", "\[Beta]"]}]}], "]"}]}], 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"], "+", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ")"}]]}], ")"}]}],
        "+", "\[IndentingNewLine]", 
       RowBox[{"K", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", "b"}], "+", "k2"}], ")"}], 
        " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g1", "  ", "H", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "-", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"], "-", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ")"}]}], " ", "+",
           
          FractionBox[
           RowBox[{"g2", " ", 
            RowBox[{"(", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"], ")"}], " ", 
            RowBox[{"Hypergeometric2F1", "[", 
             RowBox[{
              RowBox[{"-", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}], ",", 
              RowBox[{
               RowBox[{"-", 
                FractionBox[
                 RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}], "-", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ",", 
              RowBox[{"1", "-", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"], "-", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ",", 
              RowBox[{"-", 
               FractionBox["K", "\[Beta]"]}]}], "]"}]}], 
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"], "+", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ")"}]]}], 
         ")"}]}]}], ")"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.404809293461108*^9, 3.4048092956643176`*^9}, 
   3.4048093674014473`*^9, {3.4048094552954473`*^9, 3.404809463092622*^9}, {
   3.4048095314233704`*^9, 3.4048095442363625`*^9}, {3.404809605191828*^9, 
   3.4048096283333416`*^9}, {3.404809817199969*^9, 3.4048098448885317`*^9}, {
   3.4048099035782857`*^9, 3.4048099656900454`*^9}, {3.4048100079572935`*^9, 
   3.4048100840852165`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Verification de la limite quand k -> 0", "Subsection",
 CellChangeTimes->{{3.404756305094544*^9, 3.404756330974944*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "a", "   ", 
         SuperscriptBox[
          RowBox[{"(", 
           FractionBox["\[Beta]", "\[Alpha]"], ")"}], 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]], " "}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"a", "+", 
           RowBox[{"\[ImaginaryI]", " ", "k1"}]}], ")"}], " ", "k1", " ", 
         "b"}]]}], " ", 
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{"\[Beta]", " ", 
         RowBox[{"(", 
          FractionBox[
           RowBox[{"Hypergeometric2F1", "[", 
            RowBox[{
             RowBox[{"-", 
              FractionBox[
               RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}], ",", 
             RowBox[{
              RowBox[{"-", "1"}], "-", 
              FractionBox[
               RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"], "-", 
              FractionBox[
               RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ",", 
             RowBox[{
              RowBox[{"-", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}], "-", 
              FractionBox[
               RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ",", 
             RowBox[{"-", 
              FractionBox[
               RowBox[{" ", "K"}], "\[Beta]"]}]}], "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"], "+", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ")"}]], ")"}]}], 
        "+", 
        RowBox[{"K", "  ", 
         RowBox[{"(", 
          FractionBox[
           RowBox[{"  ", 
            RowBox[{"Hypergeometric2F1", "[", 
             RowBox[{
              RowBox[{"-", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}], ",", 
              RowBox[{
               RowBox[{"-", 
                FractionBox[
                 RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}], "-", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ",", 
              RowBox[{"1", "-", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"], "-", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ",", 
              RowBox[{"-", 
               FractionBox[
                RowBox[{" ", "K"}], "\[Beta]"]}]}], "]"}]}], 
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"], "+", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ")"}]], ")"}]}]}],
        ")"}]}], ")"}], " ", "/.", " ", 
    RowBox[{"K", "\[Rule]", "0"}]}], ",", 
   RowBox[{"x2", ">", "0"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.399783500470272*^9, 3.3997835140799084`*^9}, {
   3.3997843119702277`*^9, 3.399784318595355*^9}, {3.3997843922530193`*^9, 
   3.399784393753048*^9}, {3.3997905267301736`*^9, 3.399790536230356*^9}, 
   3.404755189335944*^9, {3.4048050896590633`*^9, 3.404805119675841*^9}, {
   3.404805558364561*^9, 3.40480556798993*^9}, {3.404805608694618*^9, 
   3.4048056117884874`*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["a", "2"], " ", "\[Beta]", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     FractionBox["\[Beta]", "\[Alpha]"], ")"}], 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]]}], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"\[ImaginaryI]", " ", "a"}], "-", "k1"}], ")"}], " ", "k1", " ", 
   
   RowBox[{"(", 
    RowBox[{
     RowBox[{"a", " ", "b"}], "+", 
     RowBox[{"\[ImaginaryI]", " ", "b", " ", "k1"}], "+", 
     RowBox[{"\[ImaginaryI]", " ", "a", " ", "k2"}]}], ")"}]}]]], "Output",
 CellChangeTimes->{
  3.399784321564162*^9, 3.3997843954874563`*^9, {3.3997905276208158`*^9, 
   3.3997905371678743`*^9}, 3.404754529705544*^9, 3.404755194717944*^9, 
   3.404805122082183*^9, {3.4048055599271207`*^9, 3.4048055693181067`*^9}, 
   3.4048056156011333`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Calculs Formels K = 0 ", "Subsection",
 CellChangeTimes->{{3.40205058751505*^9, 3.402050591562002*^9}, {
  3.4020506469068146`*^9, 3.402050688376361*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"\[Alpha]", " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"a", " ", "x1"}]]}], "-", 
       RowBox[{"\[Beta]", " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"b", " ", "x2"}]]}]}], "\[Equal]", "0"}], ",", "x1"}], "]"}],
    ",", 
   RowBox[{
    RowBox[{"\[Alpha]", ">", "0"}], "&&", 
    RowBox[{"\[Beta]", ">", "0"}], "&&", 
    RowBox[{"b", ">", "0"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.404754194211944*^9, 3.4047542174247437`*^9}, {
  3.404754612401144*^9, 3.404754667469144*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Solve", "::", "\<\"ifun\"\>"}], ":", 
  " ", "\<\"Inverse functions are being used by \\!\\(Solve\\), so some \
solutions may not be found; use Reduce for complete solution information. \\!\
\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/Solve\\\", ButtonNote -> \
\\\"Solve::ifun\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.404754614288744*^9, 3.404754669575144*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"x1", "\[Rule]", 
    FractionBox[
     RowBox[{"Log", "[", 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"b", " ", "x2"}]], " ", "\[Beta]"}], "\[Alpha]"], "]"}], 
     "a"]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.404754614288744*^9, 3.404754669590744*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"a", " ", "x1"}], "+", 
       RowBox[{"Log", "[", "\[Alpha]", "]"}]}], "\[Equal]", 
      RowBox[{
       RowBox[{"b", " ", "x2"}], "+", 
       RowBox[{"Log", "[", "\[Beta]", "]"}]}]}], ",", "x1"}], "]"}], ",", 
   RowBox[{
    RowBox[{"\[Alpha]", ">", "0"}], "&&", 
    RowBox[{"\[Beta]", ">", "0"}], "&&", 
    RowBox[{"b", ">", "0"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.404754194211944*^9, 3.4047542174247437`*^9}, {
  3.404754612401144*^9, 3.404754667469144*^9}, {3.4048053701229577`*^9, 
  3.404805408749441*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"x1", "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{"b", " ", "x2"}], "-", 
      RowBox[{"Log", "[", "\[Alpha]", "]"}], "+", 
      RowBox[{"Log", "[", "\[Beta]", "]"}]}], "a"]}], "}"}], "}"}]], "Output",\

 CellChangeTimes->{3.404805411046404*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"=", 
  RowBox[{
   RowBox[{"b", " ", "x2"}], "+", 
   FractionBox[
    RowBox[{"Log", "[", 
     FractionBox[
      RowBox[{" ", "\[Beta]"}], "\[Alpha]"], "]"}], "a"]}]}]], "Input",
 CellChangeTimes->{{3.4047547073271437`*^9, 3.404754731741144*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"integration1", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    SubsuperscriptBox["\[Integral]", 
     RowBox[{
      RowBox[{
       FractionBox["b", "a"], " ", "x2"}], "+", 
      FractionBox[
       RowBox[{"Log", "[", 
        FractionBox[
         RowBox[{" ", "\[Beta]"}], "\[Alpha]"], "]"}], "a"]}], "\[Infinity]"],
     " ", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "k1", " ", "x1"}]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Alpha]", " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"a", " ", "x1"}]]}], "-", 
       RowBox[{"\[Beta]", " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"b", " ", "x2"}]]}]}], ")"}], 
     RowBox[{"\[DifferentialD]", "x1"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.3997830788528023`*^9, 3.3997830934780827`*^9}, {
   3.399783175698412*^9, 3.3997832121991124`*^9}, {3.3997832703252287`*^9, 
   3.3997832746221857`*^9}, {3.4020506914232945`*^9, 3.402050713142462*^9}, {
   3.404753893443944*^9, 3.4047538996527443`*^9}, {3.404754537349544*^9, 
   3.4047545418735437`*^9}, 3.404754752645144*^9, {3.404755355990744*^9, 
   3.4047553566927443`*^9}}],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Im", "[", "k1", "]"}], ">", "0"}], "&&", 
    RowBox[{
     RowBox[{"Re", "[", "a", "]"}], "<", 
     RowBox[{"Im", "[", "k1", "]"}]}]}], ",", 
   FractionBox[
    RowBox[{"a", " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"b", " ", "x2"}], "+", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "b", " ", "k1", " ", "x2"}], "a"]}]], 
     " ", "\[Beta]", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox["\[Beta]", "\[Alpha]"], ")"}], 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]]}], 
    RowBox[{
     RowBox[{"\[ImaginaryI]", " ", "a", " ", "k1"}], "-", 
     SuperscriptBox["k1", "2"]}]], ",", 
   RowBox[{"Integrate", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"a", " ", "x1"}], "+", 
         RowBox[{"\[ImaginaryI]", " ", "k1", " ", "x1"}]}]], " ", 
       "\[Alpha]"}], "-", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", "k1", " ", "x1"}], "+", 
         RowBox[{"b", " ", "x2"}]}]], " ", "\[Beta]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"x1", ",", 
       RowBox[{
        FractionBox[
         RowBox[{"b", " ", "x2"}], "a"], "+", 
        FractionBox[
         RowBox[{"Log", "[", 
          FractionBox["\[Beta]", "\[Alpha]"], "]"}], "a"]}], ",", 
       "\[Infinity]"}], "}"}], ",", 
     RowBox[{"Assumptions", "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Re", "[", "a", "]"}], "\[LessEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"Im", "[", "k1", "]"}], "\[LessEqual]", "0"}]}], ")"}], "||",
        
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Re", "[", "a", "]"}], ">", "0"}], "&&", 
         RowBox[{
          RowBox[{"Im", "[", "k1", "]"}], "\[LessEqual]", 
          RowBox[{"Re", "[", "a", "]"}]}]}], ")"}]}]}]}], "]"}]}], 
  "]"}]], "Output",
 CellChangeTimes->{{3.3997832193242493`*^9, 3.399783241121543*^9}, 
   3.3997832783097568`*^9, {3.4020507019391212`*^9, 3.4020507168144073`*^9}, 
   3.4047539043795443`*^9, 3.404754761084744*^9, 3.404755221612344*^9, 
   3.404755363073144*^9, 3.4048052329770665`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"integration11", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{"integration1", ",", 
    RowBox[{
     RowBox[{
      RowBox[{"Im", "[", "k1", "]"}], ">", "0"}], "&&", 
     RowBox[{
      RowBox[{"Re", "[", "a", "]"}], "<", 
      RowBox[{"Im", "[", "k1", "]"}]}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.3997832863099103`*^9, 3.399783319044914*^9}, 
   3.404754779867144*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{"a", " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"b", " ", "x2"}], "+", 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "b", " ", "k1", " ", "x2"}], "a"]}]], " ",
    "\[Beta]", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     FractionBox["\[Beta]", "\[Alpha]"], ")"}], 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]]}], 
  RowBox[{
   RowBox[{"\[ImaginaryI]", " ", "a", " ", "k1"}], "-", 
   SuperscriptBox["k1", "2"]}]]], "Output",
 CellChangeTimes->{{3.3997833072165613`*^9, 3.399783319935556*^9}, 
   3.4020507301115375`*^9, 3.4047539075151443`*^9, 3.4047547819107437`*^9, 
   3.404755224669944*^9, 3.404755367456744*^9, 3.404805236711585*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"Integrate", "[", 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "k2", " ", "x2"}]], "integration11"}], 
     ",", "x2"}], "]"}], ",", 
   RowBox[{"K", ">", "0"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.3997833532799463`*^9, 3.3997833668114557`*^9}, {
   3.3997834246563168`*^9, 3.3997834378440695`*^9}, 3.3997895808526382`*^9, {
   3.404754834108344*^9, 3.404754864216344*^9}, {3.404754943277144*^9, 
   3.404754944743544*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["a", "2"], " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"b", "+", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "b", " ", "k1"}], "a"], "+", 
       RowBox[{"\[ImaginaryI]", " ", "k2"}]}], ")"}], " ", "x2"}]], " ", 
   "\[Beta]", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     FractionBox["\[Beta]", "\[Alpha]"], ")"}], 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]]}], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"\[ImaginaryI]", " ", "a"}], "-", "k1"}], ")"}], " ", "k1", " ", 
   
   RowBox[{"(", 
    RowBox[{
     RowBox[{"a", " ", "b"}], "+", 
     RowBox[{"\[ImaginaryI]", " ", "b", " ", "k1"}], "+", 
     RowBox[{"\[ImaginaryI]", " ", "a", " ", "k2"}]}], ")"}]}]]], "Output",
 CellChangeTimes->{
  3.399783368780244*^9, 3.3997834401253633`*^9, 3.399789582040161*^9, 
   3.4020507389085813`*^9, 3.4047539109315443`*^9, 3.404754793173944*^9, {
   3.404754848943944*^9, 3.404754865464344*^9}, 3.4047549457419443`*^9, 
   3.4047552316431437`*^9, 3.404755371840344*^9, 3.404805239039799*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x2", "=", "1.2"}], ",", 
     RowBox[{"a", "=", "1.31"}], ",", 
     RowBox[{"b", "=", "0.78"}], ",", 
     RowBox[{"\[Alpha]", "=", "0.87"}], ",", 
     RowBox[{"\[Beta]", "=", "1.09"}], ",", 
     RowBox[{"k1", "=", "4.31"}], ",", 
     RowBox[{"k2", "=", "3.158"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{
       SuperscriptBox["a", "2"], " ", "\[Beta]", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox["\[Beta]", "\[Alpha]"], ")"}], 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", "a"}], "-", "k1"}], ")"}], " ", "k1", 
       " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"a", " ", "b"}], "+", 
         RowBox[{"\[ImaginaryI]", " ", "b", " ", "k1"}], "+", 
         RowBox[{"\[ImaginaryI]", " ", "a", " ", "k2"}]}], ")"}]}]], ",", 
     FractionBox[
      RowBox[{
       SuperscriptBox["a", "2"], "  ", "\[Beta]", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox["\[Beta]", "\[Alpha]"], ")"}], 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", "a"}], "-", "k1"}], ")"}], " ", "k1", 
       " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"a", " ", "b"}], "+", 
         RowBox[{"\[ImaginaryI]", " ", "b", " ", "k1"}], "+", 
         RowBox[{"\[ImaginaryI]", " ", "a", " ", "k2"}]}], ")"}]}]]}], 
    "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.404754950624744*^9, 3.404754984585944*^9}, {
   3.404755019779544*^9, 3.404755079231144*^9}, 3.404755244513144*^9, 
   3.404755388454344*^9, {3.4048052593999557`*^9, 3.4048052690878277`*^9}, {
   3.4048054998935657`*^9, 3.404805507643863*^9}, 3.404805628632884*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "0.011732481378046562`"}], "+", 
    RowBox[{"0.004940824562843297`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "0.011732481378046562`"}], "+", 
    RowBox[{"0.004940824562843297`", " ", "\[ImaginaryI]"}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.404755247929544*^9, 3.404755392026744*^9, {3.404805260962516*^9, 
   3.4048052703691273`*^9}, 3.4048055137222214`*^9, 3.404805630039188*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Calculs", " ", 
  RowBox[{"Formel", " ", ":", 
   FormBox[
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{"\[Alpha]", " ", 
          SuperscriptBox[
           SubscriptBox["S", "1"], "a"]}], ",", 
         RowBox[{"\[Beta]", " ", 
          SuperscriptBox[
           SubscriptBox["S", "2"], "b"]}]}], "]"}], "-", "K"}], ")"}], "+"],
    TraditionalForm]}]}]], "Section",
 CellChangeTimes->{{3.4047530588767443`*^9, 3.404753106363144*^9}, {
  3.405003099983147*^9, 3.405003100747547*^9}, {3.4051626978697186`*^9, 
  3.4051627279642386`*^9}}],

Cell[BoxData[
 RowBox[{"=", 
  FormBox[
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["e", 
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"a", " ", 
           SubscriptBox["x", "1"]}], "+", 
          RowBox[{"Log", "[", "\[Alpha]", "]"}]}], ",", 
         RowBox[{
          RowBox[{"b", " ", 
           SubscriptBox["x", "2"]}], "+", 
          RowBox[{"Log", "[", "\[Beta]", "]"}]}]}], "]"}]], "-", "K"}], ")"}],
     "+"],
   TraditionalForm]}]], "Input",
 CellChangeTimes->{{3.4051627419489717`*^9, 3.4051628887027283`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"a", " ", "x1"}], "+", 
     RowBox[{"Log", "[", "\[Alpha]", "]"}]}], "\[Equal]", 
    RowBox[{
     RowBox[{"b", " ", "x2"}], "+", 
     RowBox[{"Log", "[", "\[Beta]", "]"}]}]}], ",", "x1"}], "]"}]], "Input",
 CellChangeTimes->{{3.4050030011103473`*^9, 3.405003045507947*^9}, {
  3.405162898765486*^9, 3.4051629183441124`*^9}, {3.4051636048148108`*^9, 
  3.4051636057210836`*^9}, {3.405163795116557*^9, 3.4051637956321955`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"x1", "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{"b", " ", "x2"}], "-", 
      RowBox[{"Log", "[", "\[Alpha]", "]"}], "+", 
      RowBox[{"Log", "[", "\[Beta]", "]"}]}], "a"]}], "}"}], "}"}]], "Output",\

 CellChangeTimes->{{3.3997832193242493`*^9, 3.399783241121543*^9}, 
   3.3997832783097568`*^9, 3.403953784350909*^9, 3.4046243697370987`*^9, 
   3.405003049673147*^9, 3.405162922047332*^9, 3.4051636066586075`*^9, 
   3.405163796647846*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"a", " ", "x1"}], "+", 
     RowBox[{"Log", "[", "\[Alpha]", "]"}]}], "\[Equal]", 
    RowBox[{"Log", "[", "K", "]"}]}], ",", "x1"}], "]"}]], "Input",
 CellChangeTimes->{{3.4050030011103473`*^9, 3.405003045507947*^9}, {
  3.405162898765486*^9, 3.4051629183441124`*^9}, {3.4051633675743623`*^9, 
  3.4051633712150803`*^9}, {3.4051700379169936`*^9, 3.40517004754224*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"x1", "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{"Log", "[", "K", "]"}], "-", 
      RowBox[{"Log", "[", "\[Alpha]", "]"}]}], "a"]}], "}"}], "}"}]], "Output",\

 CellChangeTimes->{{3.3997832193242493`*^9, 3.399783241121543*^9}, 
   3.3997832783097568`*^9, 3.403953784350909*^9, 3.4046243697370987`*^9, 
   3.405003049673147*^9, 3.405162922047332*^9, 3.4051633721994805`*^9, 
   3.4051700551361847`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"quand", " ", "x2"}], "<", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"a", " ", "x1"}], "+", 
     RowBox[{"Log", "[", "\[Alpha]", "]"}], "-", 
     RowBox[{"Log", "[", "\[Beta]", "]"}]}], "b"], "  ", "et", "  ", "x1"}], 
  ">", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"Log", "[", "K", "]"}], "-", 
      RowBox[{"Log", "[", "\[Alpha]", "]"}]}], "a"], " ", "on", " ", "paye", "   ",
     "\[Alpha]", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"a", " ", "x1"}], "+", 
      RowBox[{"Log", "[", "\[Alpha]", "]"}]}]]}], "-", "K"}]}]], "Input",
 CellChangeTimes->{{3.405163210539092*^9, 3.4051632287583084`*^9}, {
   3.4051633331672316`*^9, 3.4051633402455378`*^9}, {3.4051633787152724`*^9, 
   3.4051634038565407`*^9}, {3.4051636144244313`*^9, 3.405163619237055*^9}, {
   3.4051637024735603`*^9, 3.405163711755048*^9}, {3.405163742880845*^9, 
   3.4051637603344164`*^9}, 3.405170069261546*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"sinon", " ", "quand", "  ", "x1"}], "<", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"b", " ", "x2"}], "-", 
     RowBox[{"Log", "[", "\[Alpha]", "]"}], "+", 
     RowBox[{"Log", "[", "\[Beta]", "]"}]}], "a"], "  ", "et", "  ", "x2"}], 
  " ", ">", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"Log", "[", "K", "]"}], "-", 
      RowBox[{"Log", "[", "\[Beta]", "]"}]}], "b"], "  ", "on", " ", "paye", 
    " ", "\[Beta]", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"a", " ", "x2"}], "+", 
      RowBox[{"Log", "[", "\[Beta]", "]"}]}]]}], "-", "K"}]}]], "Input",
 CellChangeTimes->{{3.4051634073878813`*^9, 3.4051634554516115`*^9}, {
   3.405163629096682*^9, 3.40516363351867*^9}, {3.4051636838793344`*^9, 
   3.4051637135988455`*^9}, {3.4051637527092214`*^9, 
   3.4051637626469755`*^9}, {3.4051638035073967`*^9, 
   3.4051638068824835`*^9}, {3.40516413332834*^9, 3.4051641343127403`*^9}, 
   3.4051700723241243`*^9}],

Cell[BoxData[
 RowBox[{"donc", " ", "le", " ", "payoff", " ", "est", " ", "la", " ", 
  "somme", " ", "des", " ", "deux"}]], "Input",
 CellChangeTimes->{{3.4051638261954775`*^9, 3.4051638348206987`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"integration1", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    SubsuperscriptBox["\[Integral]", 
     RowBox[{"-", "\[Infinity]"}], 
     FractionBox[
      RowBox[{
       RowBox[{"a", " ", "x1"}], "+", 
       RowBox[{"Log", "[", "\[Alpha]", "]"}], "-", 
       RowBox[{"Log", "[", "\[Beta]", "]"}]}], "b"]], " ", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "k2", " ", "x2"}]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Alpha]", " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"a", " ", "x1"}], "+", 
          RowBox[{"Log", "[", "\[Alpha]", "]"}]}]]}], "-", "K"}], ")"}], 
     RowBox[{"\[DifferentialD]", "x2"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.3997830788528023`*^9, 3.3997830934780827`*^9}, {
   3.399783175698412*^9, 3.3997832121991124`*^9}, {3.3997832703252287`*^9, 
   3.3997832746221857`*^9}, {3.403953757897276*^9, 3.403953760772331*^9}, {
   3.404624357783668*^9, 3.40462435886182*^9}, {3.405003070265147*^9, 
   3.4050030795471473`*^9}, {3.405162966735976*^9, 3.405162992283505*^9}, 
   3.405163863602685*^9, {3.405167180765727*^9, 3.4051672102196064`*^9}, {
   3.405167256689546*^9, 3.4051672574864416`*^9}, 3.4051700803399544`*^9, 
   3.4051704571308503`*^9}],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Im", "[", "k2", "]"}], "<", "0"}], ",", 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", 
     SuperscriptBox["\[ExponentialE]", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "k2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", " ", "x1"}], "+", 
          RowBox[{"Log", "[", "\[Alpha]", "]"}], "-", 
          RowBox[{"Log", "[", "\[Beta]", "]"}]}], ")"}]}], "b"]], " ", 
     RowBox[{"(", 
      RowBox[{"K", "-", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"a", " ", "x1"}]], " ", 
        SuperscriptBox["\[Alpha]", "2"]}]}], ")"}]}], "k2"], ",", 
   RowBox[{"Integrate", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "k2", " ", "x2"}]]}], " ", "K"}], "+", 
      
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"a", " ", "x1"}], "+", 
         RowBox[{"\[ImaginaryI]", " ", "k2", " ", "x2"}]}]], " ", 
       SuperscriptBox["\[Alpha]", "2"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"x2", ",", 
       RowBox[{"-", "\[Infinity]"}], ",", 
       FractionBox[
        RowBox[{
         RowBox[{"a", " ", "x1"}], "+", 
         RowBox[{"Log", "[", "\[Alpha]", "]"}], "-", 
         RowBox[{"Log", "[", "\[Beta]", "]"}]}], "b"]}], "}"}], ",", 
     RowBox[{"Assumptions", "\[Rule]", 
      RowBox[{
       RowBox[{"Im", "[", "k2", "]"}], "\[GreaterEqual]", "0"}]}]}], "]"}]}], 
  "]"}]], "Output",
 CellChangeTimes->{3.4050030855843472`*^9, 3.405163017456024*^9, 
  3.405163878759323*^9, 3.405167262033433*^9, 3.4051700889026737`*^9, 
  3.4051704603028064`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"integration11", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{"integration1", ",", 
    RowBox[{
     RowBox[{"Im", "[", "k2", "]"}], "<", "0"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.3997832863099103`*^9, 3.399783319044914*^9}, 
   3.4050031197639475`*^9, 3.4051638906502523`*^9, 3.4051672944092617`*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{"\[ImaginaryI]", " ", 
   SuperscriptBox["\[ExponentialE]", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "k2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", " ", "x1"}], "+", 
        RowBox[{"Log", "[", "\[Alpha]", "]"}], "-", 
        RowBox[{"Log", "[", "\[Beta]", "]"}]}], ")"}]}], "b"]], " ", 
   RowBox[{"(", 
    RowBox[{"K", "-", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"a", " ", "x1"}]], " ", 
      SuperscriptBox["\[Alpha]", "2"]}]}], ")"}]}], "k2"]], "Output",
 CellChangeTimes->{{3.3997833072165613`*^9, 3.399783319935556*^9}, 
   3.4039540785440574`*^9, 3.4046243764716463`*^9, 3.4050031214955473`*^9, 
   3.4051638920096626`*^9, 3.405167296456189*^9, 3.4051700916839952`*^9, 
   3.4051704635060134`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"integration111", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"Integrate", "[", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "k1", " ", "x1"}]], "integration11"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"x1", ",", 
        FractionBox[
         RowBox[{
          RowBox[{"Log", "[", "K", "]"}], "-", 
          RowBox[{"Log", "[", "\[Alpha]", "]"}]}], "a"], ",", "\[Infinity]"}],
        "}"}]}], "]"}], ",", 
    RowBox[{"K", ">", "0"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.3997833532799463`*^9, 3.3997833668114557`*^9}, {
   3.3997834246563168`*^9, 3.3997834378440695`*^9}, 3.3997895808526382`*^9, {
   3.403954096716281*^9, 3.403954128357514*^9}, {3.4051639000254927`*^9, 
   3.4051639253073897`*^9}, {3.4051673026594725`*^9, 3.405167339238534*^9}, 
   3.4051700980904093`*^9}],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Re", "[", "a", "]"}], "<", 
     RowBox[{
      RowBox[{"Im", "[", "k1", "]"}], "+", 
      RowBox[{"Im", "[", 
       FractionBox[
        RowBox[{"a", " ", "k2"}], "b"], "]"}]}]}], "&&", 
    RowBox[{
     RowBox[{"Im", "[", 
      RowBox[{"k1", "+", 
       FractionBox[
        RowBox[{"a", " ", "k2"}], "b"]}], "]"}], ">", "0"}]}], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"b", " ", 
      SuperscriptBox["K", 
       RowBox[{"1", "+", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"], "+", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", " ", 
         RowBox[{"(", 
          RowBox[{"b", "-", 
           RowBox[{"\[ImaginaryI]", " ", "k2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "\[Alpha]"}], ")"}]}]}], ")"}]}], "-", 
        
        RowBox[{"\[ImaginaryI]", " ", "b", " ", "k1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Alpha]"}], ")"}]}]}], ")"}], " ", 
      SuperscriptBox["\[Alpha]", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}]], " ", 
      SuperscriptBox["\[Beta]", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}]]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[ImaginaryI]", " ", "b", " ", "k1"}], "+", 
        RowBox[{"a", " ", 
         RowBox[{"(", 
          RowBox[{"b", "+", 
           RowBox[{"\[ImaginaryI]", " ", "k2"}]}], ")"}]}]}], ")"}], " ", 
      "k2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"b", " ", "k1"}], "+", 
        RowBox[{"a", " ", "k2"}]}], ")"}]}]]}], ",", 
   RowBox[{"Integrate", "[", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"k1", " ", "x1"}], "+", 
            FractionBox[
             RowBox[{"k2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"a", " ", "x1"}], "+", 
                RowBox[{"Log", "[", "\[Alpha]", "]"}], "-", 
                RowBox[{"Log", "[", "\[Beta]", "]"}]}], ")"}]}], "b"]}], 
           ")"}]}]], " ", "K"}], "k2"], "-", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"a", " ", "x1"}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"k1", " ", "x1"}], "+", 
             FractionBox[
              RowBox[{"k2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"a", " ", "x1"}], "+", 
                 RowBox[{"Log", "[", "\[Alpha]", "]"}], "-", 
                 RowBox[{"Log", "[", "\[Beta]", "]"}]}], ")"}]}], "b"]}], 
            ")"}]}]}]], " ", 
        SuperscriptBox["\[Alpha]", "2"]}], "k2"]}], ",", 
     RowBox[{"{", 
      RowBox[{"x1", ",", 
       FractionBox[
        RowBox[{
         RowBox[{"Log", "[", "K", "]"}], "-", 
         RowBox[{"Log", "[", "\[Alpha]", "]"}]}], "a"], ",", "\[Infinity]"}], 
      "}"}], ",", 
     RowBox[{"Assumptions", "\[Rule]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Im", "[", "k1", "]"}], "+", 
         RowBox[{"Im", "[", 
          FractionBox[
           RowBox[{"a", " ", "k2"}], "b"], "]"}]}], "\[LessEqual]", 
        RowBox[{"Re", "[", "a", "]"}]}], "||", 
       RowBox[{
        RowBox[{"Im", "[", 
         RowBox[{"k1", "+", 
          FractionBox[
           RowBox[{"a", " ", "k2"}], "b"]}], "]"}], "\[LessEqual]", 
        "0"}]}]}]}], "]"}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.399783368780244*^9, 3.3997834401253633`*^9, 3.399789582040161*^9, {
   3.4039541092008963`*^9, 3.403954131545075*^9}, 3.4046243809873867`*^9, 
   3.4050031359879475`*^9, 3.405163936963938*^9, 3.405167367895518*^9, 
   3.4051701227941666`*^9, 3.4051704800376863`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"integration111", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Re", "[", "a", "]"}], "<", 
     RowBox[{
      RowBox[{"Im", "[", "k1", "]"}], "+", 
      RowBox[{"Im", "[", 
       FractionBox[
        RowBox[{"a", " ", "k2"}], "b"], "]"}]}]}], "&&", 
    RowBox[{
     RowBox[{"Im", "[", 
      RowBox[{"k1", "+", 
       FractionBox[
        RowBox[{"a", " ", "k2"}], "b"]}], "]"}], ">", "0"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.4039540270899444`*^9, 3.4039540492309947`*^9}, {
   3.403954138888966*^9, 3.403954149826676*^9}, {3.4051639603551617`*^9, 
   3.4051639652146616`*^9}, 3.4051673950993395`*^9}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"b", " ", 
    SuperscriptBox["K", 
     RowBox[{"1", "+", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"], "+", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"a", " ", 
       RowBox[{"(", 
        RowBox[{"b", "-", 
         RowBox[{"\[ImaginaryI]", " ", "k2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Alpha]"}], ")"}]}]}], ")"}]}], "-", 
      RowBox[{"\[ImaginaryI]", " ", "b", " ", "k1", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Alpha]"}], ")"}]}]}], ")"}], " ", 
    SuperscriptBox["\[Alpha]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}]], " ", 
    SuperscriptBox["\[Beta]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}]]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[ImaginaryI]", " ", "b", " ", "k1"}], "+", 
      RowBox[{"a", " ", 
       RowBox[{"(", 
        RowBox[{"b", "+", 
         RowBox[{"\[ImaginaryI]", " ", "k2"}]}], ")"}]}]}], ")"}], " ", "k2", 
    " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"b", " ", "k1"}], "+", 
      RowBox[{"a", " ", "k2"}]}], ")"}]}]]}]], "Output",
 CellChangeTimes->{{3.4039540409339604`*^9, 3.4039540500591354`*^9}, 
   3.403954151279829*^9, 3.404624389190722*^9, 3.405003144443147*^9, 
   3.4051639663553157`*^9, 3.405167400677607*^9, 3.4051701230285473`*^9, 
   3.4051704802720675`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"donc", " ", "partie", " ", "gauche"}], " ", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"b", " ", 
        SuperscriptBox["K", 
         RowBox[{"1", "+", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"], "+", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", " ", 
           RowBox[{"(", 
            RowBox[{"b", "-", 
             RowBox[{"\[ImaginaryI]", " ", "k2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "\[Alpha]"}], ")"}]}]}], ")"}]}], 
          "-", 
          RowBox[{"\[ImaginaryI]", " ", "b", " ", "k1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "\[Alpha]"}], ")"}]}]}], ")"}], " ", 
        SuperscriptBox["\[Alpha]", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}]], " ", 
        SuperscriptBox["\[Beta]", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}]]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[ImaginaryI]", " ", "b", " ", "k1"}], "+", 
          RowBox[{"a", " ", 
           RowBox[{"(", 
            RowBox[{"b", "+", 
             RowBox[{"\[ImaginaryI]", " ", "k2"}]}], ")"}]}]}], ")"}], " ", 
        "k2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"b", " ", "k1"}], "+", 
          RowBox[{"a", " ", "k2"}]}], ")"}]}]]}], "   ", "si", " ", 
     RowBox[{"Re", "[", "a", "]"}]}], "<", 
    RowBox[{
     RowBox[{"Im", "[", "k1", "]"}], "+", 
     RowBox[{"Im", "[", 
      FractionBox[
       RowBox[{"a", " ", "k2"}], "b"], "]"}]}]}], "&&", 
   RowBox[{
    RowBox[{"Im", "[", 
     RowBox[{"k1", "+", 
      FractionBox[
       RowBox[{"a", " ", "k2"}], "b"]}], "]"}], ">", "0"}], " ", "&&", " ", 
   RowBox[{
    RowBox[{"Im", "[", "k2", "]"}], "<", "0"}]}]}]], "Input",
 CellChangeTimes->{{3.405163978683756*^9, 3.405164038825921*^9}, {
   3.4051674254751167`*^9, 3.40516744550688*^9}, 3.40516776056182*^9, 
   3.405170183717601*^9, 3.405170492288*^9}],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{"de", " ", "meme", " "}]}]], "Input",
 CellChangeTimes->{{3.4051640430604043`*^9, 3.405164045169833*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"integration2", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    SubsuperscriptBox["\[Integral]", 
     RowBox[{"-", "\[Infinity]"}], 
     FractionBox[
      RowBox[{
       RowBox[{"b", " ", "x2"}], "-", 
       RowBox[{"Log", "[", "\[Alpha]", "]"}], "+", 
       RowBox[{"Log", "[", "\[Beta]", "]"}]}], "a"]], " ", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "k1", "  ", "x1"}]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Beta]", " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"a", " ", "x2"}], "+", 
          RowBox[{"Log", "[", "\[Beta]", "]"}]}]]}], "-", "K"}], ")"}], 
     RowBox[{"\[DifferentialD]", "x1"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.3997830788528023`*^9, 3.3997830934780827`*^9}, {
   3.399783175698412*^9, 3.3997832121991124`*^9}, {3.3997832703252287`*^9, 
   3.3997832746221857`*^9}, {3.403953757897276*^9, 3.403953760772331*^9}, {
   3.404624357783668*^9, 3.40462435886182*^9}, {3.405003070265147*^9, 
   3.4050030795471473`*^9}, {3.405162966735976*^9, 3.405162992283505*^9}, 
   3.405163863602685*^9, {3.4051640633577986`*^9, 3.4051640634984274`*^9}, 
   3.405164116952921*^9, {3.405164148359975*^9, 3.4051641614696856`*^9}, {
   3.4051676249958496`*^9, 3.4051676504652514`*^9}}],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Im", "[", "k1", "]"}], "<", "0"}], ",", 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", 
     SuperscriptBox["\[ExponentialE]", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "k1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"b", " ", "x2"}], "-", 
          RowBox[{"Log", "[", "\[Alpha]", "]"}], "+", 
          RowBox[{"Log", "[", "\[Beta]", "]"}]}], ")"}]}], "a"]], " ", 
     RowBox[{"(", 
      RowBox[{"K", "-", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"a", " ", "x2"}]], " ", 
        SuperscriptBox["\[Beta]", "2"]}]}], ")"}]}], "k1"], ",", 
   RowBox[{"Integrate", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "k1", " ", "x1"}]]}], " ", "K"}], "+", 
      
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", "k1", " ", "x1"}], "+", 
         RowBox[{"a", " ", "x2"}]}]], " ", 
       SuperscriptBox["\[Beta]", "2"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"x1", ",", 
       RowBox[{"-", "\[Infinity]"}], ",", 
       FractionBox[
        RowBox[{
         RowBox[{"b", " ", "x2"}], "-", 
         RowBox[{"Log", "[", "\[Alpha]", "]"}], "+", 
         RowBox[{"Log", "[", "\[Beta]", "]"}]}], "a"]}], "}"}], ",", 
     RowBox[{"Assumptions", "\[Rule]", 
      RowBox[{
       RowBox[{"Im", "[", "k1", "]"}], "\[GreaterEqual]", "0"}]}]}], "]"}]}], 
  "]"}]], "Output",
 CellChangeTimes->{3.4050030855843472`*^9, 3.405163017456024*^9, 
  3.405163878759323*^9, 3.40516417806386*^9, 3.405167662340555*^9, 
  3.4051702637352743`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"integration22", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{"integration2", ",", 
    RowBox[{
     RowBox[{"Im", "[", "k1", "]"}], "<", "0"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.3997832863099103`*^9, 3.399783319044914*^9}, 
   3.4050031197639475`*^9, 3.4051638906502523`*^9, {3.4051640674516535`*^9, 
   3.405164072420531*^9}, 3.4051641905798054`*^9, 3.405167673653345*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{"\[ImaginaryI]", " ", 
   SuperscriptBox["\[ExponentialE]", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "k1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"b", " ", "x2"}], "-", 
        RowBox[{"Log", "[", "\[Alpha]", "]"}], "+", 
        RowBox[{"Log", "[", "\[Beta]", "]"}]}], ")"}]}], "a"]], " ", 
   RowBox[{"(", 
    RowBox[{"K", "-", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"a", " ", "x2"}]], " ", 
      SuperscriptBox["\[Beta]", "2"]}]}], ")"}]}], "k1"]], "Output",
 CellChangeTimes->{{3.3997833072165613`*^9, 3.399783319935556*^9}, 
   3.4039540785440574`*^9, 3.4046243764716463`*^9, 3.4050031214955473`*^9, 
   3.4051638920096626`*^9, 3.4051641921423454`*^9, 3.405167675481517*^9, 
   3.40517026531344*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"integration222", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"Integrate", "[", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "k2", " ", "x2"}]], "integration22"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"x2", ",", 
        FractionBox[
         RowBox[{
          RowBox[{"Log", "[", "K", "]"}], "-", 
          RowBox[{"Log", "[", "\[Beta]", "]"}]}], "b"], ",", "\[Infinity]"}], 
       "}"}]}], "]"}], ",", 
    RowBox[{"K", ">", "0"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.3997833532799463`*^9, 3.3997833668114557`*^9}, {
   3.3997834246563168`*^9, 3.3997834378440695`*^9}, 3.3997895808526382`*^9, {
   3.403954096716281*^9, 3.403954128357514*^9}, {3.4051639000254927`*^9, 
   3.4051639253073897`*^9}, {3.4051640747174644`*^9, 
   3.4051640810457516`*^9}, {3.405164201267579*^9, 3.4051642266276035`*^9}, {
   3.405167685950535*^9, 3.4051677201545353`*^9}, 3.40517024676609*^9}],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Re", "[", "a", "]"}], "<", 
     RowBox[{
      RowBox[{"Im", "[", 
       FractionBox[
        RowBox[{"b", " ", "k1"}], "a"], "]"}], "+", 
      RowBox[{"Im", "[", "k2", "]"}]}]}], "&&", 
    RowBox[{
     RowBox[{"Im", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"b", " ", "k1"}], "a"], "+", "k2"}], "]"}], ">", "0"}]}], ",",
    
   FractionBox[
    RowBox[{"a", " ", 
     SuperscriptBox["K", 
      RowBox[{"\[ImaginaryI]", " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox["k1", "a"], "+", 
         FractionBox["k2", "b"]}], ")"}]}]], " ", 
     SuperscriptBox["\[Alpha]", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}]], " ", 
     SuperscriptBox["\[Beta]", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"a", "+", 
         RowBox[{"\[ImaginaryI]", " ", "k2"}]}], "b"]}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[ImaginaryI]", " ", 
        SuperscriptBox["K", 
         RowBox[{"a", "/", "b"}]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"b", " ", "k1"}], "+", 
          RowBox[{"a", " ", "k2"}]}], ")"}], " ", 
        SuperscriptBox["\[Beta]", "2"]}], "-", 
       RowBox[{"K", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["a", "2"], "+", 
          RowBox[{"\[ImaginaryI]", " ", "b", " ", "k1"}], "+", 
          RowBox[{"\[ImaginaryI]", " ", "a", " ", "k2"}]}], ")"}], " ", 
        SuperscriptBox["\[Beta]", 
         RowBox[{"a", "/", "b"}]]}]}], ")"}]}], 
    RowBox[{"k1", " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["a", "2"], "+", 
       RowBox[{"\[ImaginaryI]", " ", "b", " ", "k1"}], "+", 
       RowBox[{"\[ImaginaryI]", " ", "a", " ", "k2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"b", " ", "k1"}], "+", 
       RowBox[{"a", " ", "k2"}]}], ")"}]}]], ",", 
   RowBox[{"Integrate", "[", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"k2", " ", "x2"}], "+", 
            FractionBox[
             RowBox[{"k1", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"b", " ", "x2"}], "-", 
                RowBox[{"Log", "[", "\[Alpha]", "]"}], "+", 
                RowBox[{"Log", "[", "\[Beta]", "]"}]}], ")"}]}], "a"]}], 
           ")"}]}]], " ", "K"}], "k1"], "-", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"a", " ", "x2"}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"k2", " ", "x2"}], "+", 
             FractionBox[
              RowBox[{"k1", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"b", " ", "x2"}], "-", 
                 RowBox[{"Log", "[", "\[Alpha]", "]"}], "+", 
                 RowBox[{"Log", "[", "\[Beta]", "]"}]}], ")"}]}], "a"]}], 
            ")"}]}]}]], " ", 
        SuperscriptBox["\[Beta]", "2"]}], "k1"]}], ",", 
     RowBox[{"{", 
      RowBox[{"x2", ",", 
       FractionBox[
        RowBox[{
         RowBox[{"Log", "[", "K", "]"}], "-", 
         RowBox[{"Log", "[", "\[Beta]", "]"}]}], "b"], ",", "\[Infinity]"}], 
      "}"}], ",", 
     RowBox[{"Assumptions", "\[Rule]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Im", "[", 
          FractionBox[
           RowBox[{"b", " ", "k1"}], "a"], "]"}], "+", 
         RowBox[{"Im", "[", "k2", "]"}]}], "\[LessEqual]", 
        RowBox[{"Re", "[", "a", "]"}]}], "||", 
       RowBox[{
        RowBox[{"Im", "[", 
         RowBox[{
          FractionBox[
           RowBox[{"b", " ", "k1"}], "a"], "+", "k2"}], "]"}], "\[LessEqual]",
         "0"}]}]}]}], "]"}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.399783368780244*^9, 3.3997834401253633`*^9, 3.399789582040161*^9, {
   3.4039541092008963`*^9, 3.403954131545075*^9}, 3.4046243809873867`*^9, 
   3.4050031359879475`*^9, 3.405163936963938*^9, 3.4051642399873204`*^9, 
   3.405167760999331*^9, 3.4051702853139515`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"integration222", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Re", "[", "a", "]"}], "<", 
     RowBox[{
      RowBox[{"Im", "[", 
       FractionBox[
        RowBox[{"b", " ", "k1"}], "a"], "]"}], "+", 
      RowBox[{"Im", "[", "k2", "]"}]}]}], "&&", 
    RowBox[{
     RowBox[{"Im", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"b", " ", "k1"}], "a"], "+", "k2"}], "]"}], ">", "0"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.4039540270899444`*^9, 3.4039540492309947`*^9}, {
   3.403954138888966*^9, 3.403954149826676*^9}, {3.4051639603551617`*^9, 
   3.4051639652146616`*^9}, {3.4051640837489457`*^9, 
   3.4051640852646093`*^9}, {3.405164252143882*^9, 3.40516425265952*^9}, 
   3.4051677791404204`*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{"a", " ", 
   SuperscriptBox["K", 
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["k1", "a"], "+", 
       FractionBox["k2", "b"]}], ")"}]}]], " ", 
   SuperscriptBox["\[Alpha]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}]], " ", 
   SuperscriptBox["\[Beta]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"a", "+", 
       RowBox[{"\[ImaginaryI]", " ", "k2"}]}], "b"]}]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"\[ImaginaryI]", " ", 
      SuperscriptBox["K", 
       RowBox[{"a", "/", "b"}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"b", " ", "k1"}], "+", 
        RowBox[{"a", " ", "k2"}]}], ")"}], " ", 
      SuperscriptBox["\[Beta]", "2"]}], "-", 
     RowBox[{"K", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["a", "2"], "+", 
        RowBox[{"\[ImaginaryI]", " ", "b", " ", "k1"}], "+", 
        RowBox[{"\[ImaginaryI]", " ", "a", " ", "k2"}]}], ")"}], " ", 
      SuperscriptBox["\[Beta]", 
       RowBox[{"a", "/", "b"}]]}]}], ")"}]}], 
  RowBox[{"k1", " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["a", "2"], "+", 
     RowBox[{"\[ImaginaryI]", " ", "b", " ", "k1"}], "+", 
     RowBox[{"\[ImaginaryI]", " ", "a", " ", "k2"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"b", " ", "k1"}], "+", 
     RowBox[{"a", " ", "k2"}]}], ")"}]}]]], "Output",
 CellChangeTimes->{{3.4039540409339604`*^9, 3.4039540500591354`*^9}, 
   3.403954151279829*^9, 3.404624389190722*^9, 3.405003144443147*^9, 
   3.4051639663553157`*^9, 3.405164253503291*^9, 3.405167780624833*^9, 
   3.405170285642085*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"et", " ", "partie", " ", "droite"}], " ", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"a", " ", 
       SuperscriptBox["K", 
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox["k1", "a"], "+", 
           FractionBox["k2", "b"]}], ")"}]}]], " ", 
       SuperscriptBox["\[Alpha]", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}]], " ", 
       SuperscriptBox["\[Beta]", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"a", "+", 
           RowBox[{"\[ImaginaryI]", " ", "k2"}]}], "b"]}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", 
          SuperscriptBox["K", 
           RowBox[{"a", "/", "b"}]], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"b", " ", "k1"}], "+", 
            RowBox[{"a", " ", "k2"}]}], ")"}], " ", 
          SuperscriptBox["\[Beta]", "2"]}], "-", 
         RowBox[{"K", " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["a", "2"], "+", 
            RowBox[{"\[ImaginaryI]", " ", "b", " ", "k1"}], "+", 
            RowBox[{"\[ImaginaryI]", " ", "a", " ", "k2"}]}], ")"}], " ", 
          SuperscriptBox["\[Beta]", 
           RowBox[{"a", "/", "b"}]]}]}], ")"}]}], 
      RowBox[{"k1", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["a", "2"], "+", 
         RowBox[{"\[ImaginaryI]", " ", "b", " ", "k1"}], "+", 
         RowBox[{"\[ImaginaryI]", " ", "a", " ", "k2"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"b", " ", "k1"}], "+", 
         RowBox[{"a", " ", "k2"}]}], ")"}]}]], "   ", "si", " ", 
     RowBox[{"Re", "[", "a", "]"}]}], "<", 
    RowBox[{
     RowBox[{"Im", "[", 
      FractionBox[
       RowBox[{"b", " ", "k1"}], "a"], "]"}], "+", 
     RowBox[{"Im", "[", "k2", "]"}]}]}], "&&", 
   RowBox[{
    RowBox[{"Im", "[", 
     RowBox[{
      FractionBox[
       RowBox[{"b", " ", "k1"}], "a"], "+", "k2"}], "]"}], ">", "0"}], " ", "&&",
    
   RowBox[{
    RowBox[{"Im", "[", "k1", "]"}], "<", "0"}]}]}]], "Input",
 CellChangeTimes->{{3.405164265628602*^9, 3.405164271159993*^9}, {
   3.4051643265989127`*^9, 3.4051643535214767`*^9}, {3.40516779045321*^9, 
   3.4051678124693985`*^9}, 3.405170301736247*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{"a", " ", 
      SuperscriptBox["K", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"(", 
         RowBox[{
          FractionBox["k1", "a"], "+", 
          FractionBox["k2", "b"]}], ")"}]}]], " ", 
      SuperscriptBox["\[Alpha]", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}]], " ", 
      SuperscriptBox["\[Beta]", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{"a", "+", 
          RowBox[{"\[ImaginaryI]", " ", "k2"}]}], "b"]}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[ImaginaryI]", " ", 
         SuperscriptBox["K", 
          RowBox[{"a", "/", "b"}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"b", " ", "k1"}], "+", 
           RowBox[{"a", " ", "k2"}]}], ")"}], " ", 
         SuperscriptBox["\[Beta]", "2"]}], "-", 
        RowBox[{"K", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["a", "2"], "+", 
           RowBox[{"\[ImaginaryI]", " ", "b", " ", "k1"}], "+", 
           RowBox[{"\[ImaginaryI]", " ", "a", " ", "k2"}]}], ")"}], " ", 
         SuperscriptBox["\[Beta]", 
          RowBox[{"a", "/", "b"}]]}]}], ")"}]}], 
     RowBox[{"k1", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["a", "2"], "+", 
        RowBox[{"\[ImaginaryI]", " ", "b", " ", "k1"}], "+", 
        RowBox[{"\[ImaginaryI]", " ", "a", " ", "k2"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"b", " ", "k1"}], "+", 
        RowBox[{"a", " ", "k2"}]}], ")"}]}]], " ", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Rule]", "1"}], ",", 
      RowBox[{"\[Beta]", "\[Rule]", "1"}], ",", 
      RowBox[{"a", "\[Rule]", "1"}], ",", 
      RowBox[{"b", "\[Rule]", "1"}]}], "}"}]}], ",", 
   RowBox[{"K", ">", "0"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.40516580837122*^9, 3.4051658284342337`*^9}, 
   3.4051679772704926`*^9, {3.405170307236388*^9, 3.405170330705739*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"\[ImaginaryI]", " ", 
   SuperscriptBox["K", 
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], "+", "k1", "+", "k2"}], ")"}]}]]}], 
  RowBox[{"k1", " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["k1", "2"], "+", 
     RowBox[{"k2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], "+", "k2"}], ")"}]}], "+", 
     RowBox[{"k1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], "+", 
        RowBox[{"2", " ", "k2"}]}], ")"}]}]}], ")"}]}]]], "Output",
 CellChangeTimes->{
  3.4051658301374025`*^9, 3.4051679803174458`*^9, {3.405170308752052*^9, 
   3.4051703319870214`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Factor", "[", 
  RowBox[{"k1", " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["k1", "2"], "+", 
     RowBox[{"k2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], "+", "k2"}], ")"}]}], "+", 
     RowBox[{"k1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], "+", 
        RowBox[{"2", " ", "k2"}]}], ")"}]}]}], ")"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.4051703990981145`*^9, 3.4051704050357666`*^9}}],

Cell[BoxData[
 RowBox[{"k1", " ", 
  RowBox[{"(", 
   RowBox[{"k1", "+", "k2"}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "\[ImaginaryI]"}], "+", "k1", "+", "k2"}], ")"}]}]], "Output",\

 CellChangeTimes->{3.4051704070670686`*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Calculs", " ", 
  RowBox[{"Formel", " ", ":", 
   FormBox[
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["S", "1"], "c"], 
       SubscriptBox["1", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Alpha]", " ", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"a", " ", "x1"}]]}], "-", 
          RowBox[{"\[Beta]", " ", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"b", " ", "x2"}]]}], "-", "K"}], ">", "0"}]]}], ")"}], 
     "+"],
    TraditionalForm]}]}]], "Section",
 CellChangeTimes->{{3.4047530588767443`*^9, 3.404753106363144*^9}, {
  3.405003099983147*^9, 3.405003100747547*^9}, {3.4051626978697186`*^9, 
  3.4051627279642386`*^9}, {3.405333769592795*^9, 3.4053338036477947`*^9}, {
  3.405333990867795*^9, 3.4053340103197947`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"\[Alpha]", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"a", " ", "x1"}]]}], "-", 
     RowBox[{"\[Beta]", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"b", " ", "x2"}]]}], "-", "K"}], "\[Equal]", "0"}], ",", 
   "x1"}], "]"}]], "Input",
 CellChangeTimes->{{3.404754194211944*^9, 3.4047542174247437`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Solve", "::", "\<\"ifun\"\>"}], ":", 
  " ", "\<\"Inverse functions are being used by \\!\\(Solve\\), so some \
solutions may not be found; use Reduce for complete solution information. \\!\
\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/Solve\\\", ButtonNote -> \
\\\"Solve::ifun\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.404754221449544*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"x1", "\[Rule]", 
    FractionBox[
     RowBox[{"Log", "[", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"-", "K"}], "-", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"b", " ", "x2"}]], " ", "\[Beta]"}]}], "\[Alpha]"]}], 
      "]"}], "a"]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.404754221449544*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"integration1", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    SubsuperscriptBox["\[Integral]", 
     FractionBox[
      RowBox[{"Log", "[", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          RowBox[{"-", "K"}], "-", 
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"b", "  ", "x2"}]], " ", "\[Beta]"}]}], "\[Alpha]"]}], 
       "]"}], "a"], "\[Infinity]"], " ", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", "  ", "k1", " ", "x1"}]], " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"c", "  ", "x1"}]], 
     RowBox[{"\[DifferentialD]", "x1"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.3997830788528023`*^9, 3.3997830934780827`*^9}, {
   3.399783175698412*^9, 3.3997832121991124`*^9}, {3.3997832703252287`*^9, 
   3.3997832746221857`*^9}, {3.4047536787215443`*^9, 3.404753684930344*^9}, {
   3.404753975671544*^9, 3.404754006559544*^9}, 3.4047542504343443`*^9, {
   3.4047551636583443`*^9, 3.404755170881144*^9}, {3.4053340351217947`*^9, 
   3.405334042179795*^9}, 3.405334086058795*^9}],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Re", "[", "c", "]"}], "<", 
    RowBox[{"Im", "[", "k1", "]"}]}], ",", 
   RowBox[{"-", 
    FractionBox[
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox[
        RowBox[{"K", "+", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"b", " ", "x2"}]], " ", "\[Beta]"}]}], "\[Alpha]"], ")"}], 
      
      FractionBox[
       RowBox[{"c", "+", 
        RowBox[{"\[ImaginaryI]", " ", "k1"}]}], "a"]], 
     RowBox[{"c", "+", 
      RowBox[{"\[ImaginaryI]", " ", "k1"}]}]]}], ",", 
   RowBox[{"Integrate", "[", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"c", "+", 
         RowBox[{"\[ImaginaryI]", " ", "k1"}]}], ")"}], " ", "x1"}]], ",", 
     RowBox[{"{", 
      RowBox[{"x1", ",", 
       FractionBox[
        RowBox[{"Log", "[", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{
            RowBox[{"-", "K"}], "-", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"b", " ", "x2"}]], " ", "\[Beta]"}]}], "\[Alpha]"]}], 
         "]"}], "a"], ",", "\[Infinity]"}], "}"}], ",", 
     RowBox[{"Assumptions", "\[Rule]", 
      RowBox[{
       RowBox[{"Re", "[", "c", "]"}], "\[GreaterEqual]", 
       RowBox[{"Im", "[", "k1", "]"}]}]}]}], "]"}]}], "]"}]], "Output",
 CellChangeTimes->{{3.3997832193242493`*^9, 3.399783241121543*^9}, 
   3.3997832783097568`*^9, 3.404753856612344*^9, 3.4047540171207438`*^9, 
   3.404754272757944*^9, 3.4047551730027437`*^9, 3.4053340974467945`*^9, 
   3.405351101692749*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"integration11", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{"integration1", ",", 
    RowBox[{
     RowBox[{"Re", "[", "c", "]"}], "<", 
     RowBox[{"Im", "[", "k1", "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.3997832863099103`*^9, 3.399783319044914*^9}, 
   3.4050031197639475`*^9, 3.4051638906502523`*^9, 3.4051672944092617`*^9, 
   3.405334150414795*^9}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   SuperscriptBox[
    RowBox[{"(", 
     FractionBox[
      RowBox[{"K", "+", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"b", " ", "x2"}]], " ", "\[Beta]"}]}], "\[Alpha]"], ")"}], 
    FractionBox[
     RowBox[{"c", "+", 
      RowBox[{"\[ImaginaryI]", " ", "k1"}]}], "a"]], 
   RowBox[{"c", "+", 
    RowBox[{"\[ImaginaryI]", " ", "k1"}]}]]}]], "Output",
 CellChangeTimes->{{3.3997833072165613`*^9, 3.399783319935556*^9}, 
   3.4039540785440574`*^9, 3.4046243764716463`*^9, 3.4050031214955473`*^9, 
   3.4051638920096626`*^9, 3.405167296456189*^9, 3.4051700916839952`*^9, 
   3.4051704635060134`*^9, 3.405334160643795*^9, 3.405351103177162*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"integration111", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"Integrate", "[", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "k2", " ", "x2"}]], "integration11"}], 
      ",", "x2"}], "]"}], ",", 
    RowBox[{"K", ">", "0"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.3997833532799463`*^9, 3.3997833668114557`*^9}, {
   3.3997834246563168`*^9, 3.3997834378440695`*^9}, 3.3997895808526382`*^9, {
   3.403954096716281*^9, 3.403954128357514*^9}, {3.4051639000254927`*^9, 
   3.4051639253073897`*^9}, {3.4051673026594725`*^9, 3.405167339238534*^9}, 
   3.4051700980904093`*^9, {3.405334558507795*^9, 3.405334592162795*^9}, {
   3.40535041087819*^9, 3.4053504137688885`*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"\[ImaginaryI]", " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"\[ImaginaryI]", " ", "k2", " ", "x2"}]], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     FractionBox[
      RowBox[{"K", "+", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"b", " ", "x2"}]], " ", "\[Beta]"}]}], "\[Alpha]"], ")"}], 
    FractionBox[
     RowBox[{"c", "+", 
      RowBox[{"\[ImaginaryI]", " ", "k1"}]}], "a"]], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "+", 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"b", " ", "x2"}]], " ", "\[Beta]"}], "K"]}], ")"}], 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"c", "+", 
       RowBox[{"\[ImaginaryI]", " ", "k1"}]}], "a"]}]], " ", 
   RowBox[{"Hypergeometric2F1", "[", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"c", "+", 
        RowBox[{"\[ImaginaryI]", " ", "k1"}]}], "a"]}], ",", 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"], ",", 
     RowBox[{"1", "+", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"b", " ", "x2"}]], " ", "\[Beta]"}], "K"]}]}], "]"}]}], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"c", "+", 
     RowBox[{"\[ImaginaryI]", " ", "k1"}]}], ")"}], " ", "k2"}]]], "Output",
 CellChangeTimes->{
  3.399783368780244*^9, 3.3997834401253633`*^9, 3.399789582040161*^9, {
   3.4039541092008963`*^9, 3.403954131545075*^9}, 3.4046243809873867`*^9, 
   3.4050031359879475`*^9, 3.405163936963938*^9, 3.405167367895518*^9, 
   3.4051701227941666`*^9, 3.4051704800376863`*^9, 3.405334168198795*^9, 
   3.405334604756795*^9, 3.4053504177064896`*^9, 3.405351106505372*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "k2", " ", "x2"}]], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox["K", "\[Alpha]"], ")"}], 
      FractionBox[
       RowBox[{"c", "+", 
        RowBox[{"\[ImaginaryI]", " ", "k1"}]}], "a"]], "  ", 
     RowBox[{"Hypergeometric2F1", "[", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"c", "+", 
          RowBox[{"\[ImaginaryI]", " ", "k1"}]}], "a"]}], ",", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"], ",", 
       RowBox[{"1", "+", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ",", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"b", " ", "x2"}]], " ", "\[Beta]"}], "K"]}]}], "]"}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"c", "+", 
       RowBox[{"\[ImaginaryI]", " ", "k1"}]}], ")"}], " ", "k2"}]], " ", "/.",
    " ", "RuleHyper"}], "]"}]], "Input",
 CellChangeTimes->{{3.4053511871324368`*^9, 3.4053512341492653`*^9}, {
  3.4053513149482083`*^9, 3.405351330667361*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"\[ImaginaryI]", " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"\[ImaginaryI]", " ", "k2", " ", "x2"}]], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     FractionBox["K", "\[Alpha]"], ")"}], 
    FractionBox[
     RowBox[{"c", "+", 
      RowBox[{"\[ImaginaryI]", " ", "k1"}]}], "a"]], " ", 
   RowBox[{"Gamma", "[", 
    RowBox[{"1", "+", 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"b", " ", "x2"}]], " ", "\[Beta]"}], "K"], ")"}], 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}]], " ", 
       RowBox[{"Gamma", "[", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"c", "+", 
            RowBox[{"\[ImaginaryI]", " ", "k1"}]}], "a"]}], "-", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], "]"}]}], 
      RowBox[{"Gamma", "[", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{"c", "+", 
          RowBox[{"\[ImaginaryI]", " ", "k1"}]}], "a"]}], "]"}]], "+", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"b", " ", "x2"}]], " ", "\[Beta]"}], "K"], ")"}], 
        FractionBox[
         RowBox[{"c", "+", 
          RowBox[{"\[ImaginaryI]", " ", "k1"}]}], "a"]], " ", 
       RowBox[{"Gamma", "[", 
        RowBox[{
         FractionBox[
          RowBox[{"c", "+", 
           RowBox[{"\[ImaginaryI]", " ", "k1"}]}], "a"], "+", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], "]"}], " ", 
       RowBox[{"Hypergeometric2F1", "[", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"c", "+", 
            RowBox[{"\[ImaginaryI]", " ", "k1"}]}], "a"]}], ",", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"c", "+", 
             RowBox[{"\[ImaginaryI]", " ", "k1"}]}], "a"]}], "-", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ",", 
         RowBox[{"1", "-", 
          FractionBox[
           RowBox[{"c", "+", 
            RowBox[{"\[ImaginaryI]", " ", "k1"}]}], "a"], "-", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ",", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{
              RowBox[{"-", "b"}], " ", "x2"}]], " ", "K"}], "\[Beta]"]}]}], 
        "]"}]}], 
      RowBox[{
       RowBox[{"Gamma", "[", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"], "]"}], " ", 
       RowBox[{"Gamma", "[", 
        RowBox[{"1", "+", 
         FractionBox[
          RowBox[{"c", "+", 
           RowBox[{"\[ImaginaryI]", " ", "k1"}]}], "a"], "+", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], "]"}]}]]}], ")"}]}], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"c", "+", 
     RowBox[{"\[ImaginaryI]", " ", "k1"}]}], ")"}], " ", "k2"}]]], "Output",
 CellChangeTimes->{{3.4053513203858476`*^9, 3.4053513321361485`*^9}}]
}, Open  ]],

Cell[BoxData[
 FractionBox[
  RowBox[{"\[ImaginaryI]", "  ", 
   SuperscriptBox[
    RowBox[{"(", 
     FractionBox["K", "\[Alpha]"], ")"}], 
    FractionBox[
     RowBox[{"c", "+", 
      RowBox[{"\[ImaginaryI]", " ", "k1"}]}], "a"]], " ", 
   RowBox[{"Gamma", "[", 
    RowBox[{"1", "+", 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", " ", "\[Beta]", ")"}], 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}]], 
       SuperscriptBox[
        RowBox[{"(", "K", ")"}], 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]], " ", 
       RowBox[{"Gamma", "[", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"c", "+", 
            RowBox[{"\[ImaginaryI]", " ", "k1"}]}], "a"]}], "-", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], "]"}]}], 
      RowBox[{"Gamma", "[", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{"c", "+", 
          RowBox[{"\[ImaginaryI]", " ", "k1"}]}], "a"]}], "]"}]], "+", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            FractionBox[
             RowBox[{"c", "+", 
              RowBox[{"\[ImaginaryI]", " ", "k1"}]}], "a"], "b"}], " ", "+", 
           RowBox[{"\[ImaginaryI]", " ", "k2"}]}], ")"}], "x2", " "}]], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          RowBox[{" ", "\[Beta]"}], "K"], ")"}], 
        FractionBox[
         RowBox[{"c", "+", 
          RowBox[{"\[ImaginaryI]", " ", "k1"}]}], "a"]], " ", 
       RowBox[{"Hypergeometric2F1", "[", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"c", "+", 
            RowBox[{"\[ImaginaryI]", " ", "k1"}]}], "a"]}], ",", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"c", "+", 
             RowBox[{"\[ImaginaryI]", " ", "k1"}]}], "a"]}], "-", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ",", 
         RowBox[{"1", "-", 
          FractionBox[
           RowBox[{"c", "+", 
            RowBox[{"\[ImaginaryI]", " ", "k1"}]}], "a"], "-", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ",", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{
              RowBox[{"-", "b"}], " ", "x2"}]], " ", "K"}], "\[Beta]"]}]}], 
        "]"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"c", "+", 
           RowBox[{"\[ImaginaryI]", " ", "k1"}]}], "a"], "+", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"]}], ")"}], 
       RowBox[{"Gamma", "[", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "k2"}], "b"], "]"}], " "}]]}], ")"}]}],
   
  RowBox[{
   RowBox[{"(", 
    RowBox[{"c", "+", 
     RowBox[{"\[ImaginaryI]", " ", "k1"}]}], ")"}], " ", "k2"}]]], "Input",
 CellChangeTimes->{{3.405351419200877*^9, 3.405351429466765*^9}, {
  3.405351500515459*^9, 3.405351579704986*^9}, {3.405351614784009*^9, 
  3.4053517500999727`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"la", " ", "convergence", " ", "pour", " ", "le", " ", "x2"}], ">",
    
   RowBox[{"0", " ", 
    RowBox[{"est", " ", ":", " ", 
     RowBox[{
      RowBox[{"Re", "[", 
       RowBox[{
        FractionBox[
         RowBox[{"c", " ", "b"}], "a"], "+", 
        RowBox[{"\[ImaginaryI]", 
         RowBox[{"(", " ", 
          RowBox[{
           FractionBox[
            RowBox[{"b", " ", "k1"}], "a"], " ", "+", " ", "k2"}], ")"}]}]}], 
       "]"}], "<", 
      RowBox[{"0", "  ", "soit"}]}]}]}]}], ",", 
  RowBox[{
   RowBox[{
    RowBox[{"b", " ", 
     RowBox[{"Im", "[", "k1", "]"}]}], " ", " ", "+", 
    RowBox[{"a", " ", 
     RowBox[{"Im", "[", "k2", "]"}]}]}], ">", 
   RowBox[{"c", " ", "b", " ", "soit", "  ", 
    RowBox[{"Im", "[", "k2", "]"}]}], ">", 
   RowBox[{
    FractionBox[
     RowBox[{"c", " ", "b", " "}], "a"], "-", 
    RowBox[{
     FractionBox["b", "a"], " ", 
     RowBox[{"Im", "[", "k1", "]"}], " "}]}]}]}]], "Input",
 CellChangeTimes->{{3.4053504412070913`*^9, 3.4053506010549335`*^9}, 
   3.4053506422434874`*^9, {3.4053517794132233`*^9, 3.4053519490269403`*^9}, {
   3.405352237362447*^9, 3.4053522770040865`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"la", " ", "convergence", " ", "pour", " ", "le", " ", "x2"}], "<",
    
   RowBox[{"0", " ", 
    RowBox[{"est", " ", ":", " ", 
     RowBox[{
      RowBox[{"Re", "[", 
       RowBox[{"\[ImaginaryI]", " ", "k2"}], "]"}], ">", 
      RowBox[{"0", " ", "soit"}]}]}]}]}], ",", "  ", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"Im", "[", "k2", "]"}]}], ">", 
   RowBox[{"0", " ", "soit", " ", 
    RowBox[{"Im", "[", "k2", "]"}]}], "<", "0"}]}]], "Input",
 CellChangeTimes->{{3.4053504412070913`*^9, 3.4053506010549335`*^9}, {
  3.4053506443841677`*^9, 3.405350650618702*^9}, {3.4053506925416503`*^9, 
  3.405350699666833*^9}, {3.4053522033772016`*^9, 3.4053522241589837`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Calculs", " ", 
  RowBox[{"Formel", " ", ":", 
   FormBox[
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["S", "2"], "c"], 
       SubscriptBox["1", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Alpha]", " ", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"a", " ", "x1"}]]}], "-", 
          RowBox[{"\[Beta]", " ", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"b", " ", "x2"}]]}], "-", "K"}], ">", "0"}]]}], ")"}], 
     "+"],
    TraditionalForm]}]}]], "Section",
 CellChangeTimes->{{3.4047530588767443`*^9, 3.404753106363144*^9}, {
  3.405003099983147*^9, 3.405003100747547*^9}, {3.4051626978697186`*^9, 
  3.4051627279642386`*^9}, {3.405333769592795*^9, 3.4053338036477947`*^9}, {
  3.405333990867795*^9, 3.4053340103197947`*^9}, {3.4053473588313093`*^9, 
  3.405347359331322*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"\[Alpha]", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"a", " ", "x1"}]]}], "-", 
     RowBox[{"\[Beta]", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"b", " ", "x2"}]]}], "-", "K"}], "\[Equal]", "0"}], ",", 
   "x1"}], "]"}]], "Input",
 CellChangeTimes->{{3.404754194211944*^9, 3.4047542174247437`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Solve", "::", "\<\"ifun\"\>"}], ":", 
  " ", "\<\"Inverse functions are being used by \\!\\(Solve\\), so some \
solutions may not be found; use Reduce for complete solution information. \\!\
\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/Solve\\\", ButtonNote -> \
\\\"Solve::ifun\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.404754221449544*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"x1", "\[Rule]", 
    FractionBox[
     RowBox[{"Log", "[", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"-", "K"}], "-", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"b", " ", "x2"}]], " ", "\[Beta]"}]}], "\[Alpha]"]}], 
      "]"}], "a"]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.404754221449544*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"integration1", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    SubsuperscriptBox["\[Integral]", 
     FractionBox[
      RowBox[{"Log", "[", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          RowBox[{"-", "K"}], "-", 
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"b", "  ", "x2"}]], " ", "\[Beta]"}]}], "\[Alpha]"]}], 
       "]"}], "a"], "\[Infinity]"], " ", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", "  ", "k1", " ", "x1"}]], " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"c", "  ", "x2"}]], 
     RowBox[{"\[DifferentialD]", "x1"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.3997830788528023`*^9, 3.3997830934780827`*^9}, {
   3.399783175698412*^9, 3.3997832121991124`*^9}, {3.3997832703252287`*^9, 
   3.3997832746221857`*^9}, {3.4047536787215443`*^9, 3.404753684930344*^9}, {
   3.404753975671544*^9, 3.404754006559544*^9}, 3.4047542504343443`*^9, {
   3.4047551636583443`*^9, 3.404755170881144*^9}, {3.4053340351217947`*^9, 
   3.405334042179795*^9}, 3.405334086058795*^9, {3.4053473711753755`*^9, 
   3.40534737173789*^9}}],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Im", "[", "k1", "]"}], ">", "0"}], ",", 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"c", " ", "x2"}]], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox[
        RowBox[{"K", "+", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"b", " ", "x2"}]], " ", "\[Beta]"}]}], "\[Alpha]"], ")"}], 
      
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]]}], "k1"], ",", 
   RowBox[{"Integrate", "[", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"\[ImaginaryI]", " ", "k1", " ", "x1"}], "+", 
       RowBox[{"c", " ", "x2"}]}]], ",", 
     RowBox[{"{", 
      RowBox[{"x1", ",", 
       FractionBox[
        RowBox[{"Log", "[", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{
            RowBox[{"-", "K"}], "-", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"b", " ", "x2"}]], " ", "\[Beta]"}]}], "\[Alpha]"]}], 
         "]"}], "a"], ",", "\[Infinity]"}], "}"}], ",", 
     RowBox[{"Assumptions", "\[Rule]", 
      RowBox[{
       RowBox[{"Im", "[", "k1", "]"}], "\[LessEqual]", "0"}]}]}], "]"}]}], 
  "]"}]], "Output",
 CellChangeTimes->{{3.3997832193242493`*^9, 3.399783241121543*^9}, 
   3.3997832783097568`*^9, 3.404753856612344*^9, 3.4047540171207438`*^9, 
   3.404754272757944*^9, 3.4047551730027437`*^9, 3.4053340974467945`*^9, 
   3.405347384972604*^9, 3.4053511183650513`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"integration11", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{"integration1", ",", 
    RowBox[{
     RowBox[{"Im", "[", "k1", "]"}], ">", "0"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.3997832863099103`*^9, 3.399783319044914*^9}, 
   3.4050031197639475`*^9, 3.4051638906502523`*^9, 3.4051672944092617`*^9, 
   3.405334150414795*^9, 3.405347402551179*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{"\[ImaginaryI]", " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"c", " ", "x2"}]], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     FractionBox[
      RowBox[{"K", "+", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"b", " ", "x2"}]], " ", "\[Beta]"}]}], "\[Alpha]"], ")"}], 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]]}], "k1"]], "Output",
 CellChangeTimes->{{3.3997833072165613`*^9, 3.399783319935556*^9}, 
   3.4039540785440574`*^9, 3.4046243764716463`*^9, 3.4050031214955473`*^9, 
   3.4051638920096626`*^9, 3.405167296456189*^9, 3.4051700916839952`*^9, 
   3.4051704635060134`*^9, 3.405334160643795*^9, 3.4053474041449695`*^9, 
   3.4053511232401757`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"integration111", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"Integrate", "[", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "k2", " ", "x2"}]], "integration11"}], 
      ",", "x2"}], "]"}], ",", 
    RowBox[{"K", ">", "0"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.3997833532799463`*^9, 3.3997833668114557`*^9}, {
   3.3997834246563168`*^9, 3.3997834378440695`*^9}, 3.3997895808526382`*^9, {
   3.403954096716281*^9, 3.403954128357514*^9}, {3.4051639000254927`*^9, 
   3.4051639253073897`*^9}, {3.4051673026594725`*^9, 3.405167339238534*^9}, 
   3.4051700980904093`*^9, {3.405334558507795*^9, 3.405334592162795*^9}, {
   3.405350711604638*^9, 3.4053507150891027`*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"\[ImaginaryI]", " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"c", "+", 
       RowBox[{"\[ImaginaryI]", " ", "k2"}]}], ")"}], " ", "x2"}]], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     FractionBox[
      RowBox[{"K", "+", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"b", " ", "x2"}]], " ", "\[Beta]"}]}], "\[Alpha]"], ")"}], 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "+", 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"b", " ", "x2"}]], " ", "\[Beta]"}], "K"]}], ")"}], 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}]], " ", 
   RowBox[{"Hypergeometric2F1", "[", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}], ",", 
     FractionBox[
      RowBox[{"c", "+", 
       RowBox[{"\[ImaginaryI]", " ", "k2"}]}], "b"], ",", 
     FractionBox[
      RowBox[{"b", "+", "c", "+", 
       RowBox[{"\[ImaginaryI]", " ", "k2"}]}], "b"], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"b", " ", "x2"}]], " ", "\[Beta]"}], "K"]}]}], "]"}]}], 
  RowBox[{"k1", " ", 
   RowBox[{"(", 
    RowBox[{"c", "+", 
     RowBox[{"\[ImaginaryI]", " ", "k2"}]}], ")"}]}]]], "Output",
 CellChangeTimes->{
  3.399783368780244*^9, 3.3997834401253633`*^9, 3.399789582040161*^9, {
   3.4039541092008963`*^9, 3.403954131545075*^9}, 3.4046243809873867`*^9, 
   3.4050031359879475`*^9, 3.405163936963938*^9, 3.405167367895518*^9, 
   3.4051701227941666`*^9, 3.4051704800376863`*^9, 3.405334168198795*^9, 
   3.405334604756795*^9, 3.4053474923034763`*^9, 3.4053507169328995`*^9, 
   3.405351126568386*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"c", "+", 
         RowBox[{"\[ImaginaryI]", " ", "k2"}]}], ")"}], " ", "x2"}]], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox["K", "\[Alpha]"], ")"}], 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]], "  ", 
     RowBox[{"Hypergeometric2F1", "[", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}], ",", 
       FractionBox[
        RowBox[{"c", "+", 
         RowBox[{"\[ImaginaryI]", " ", "k2"}]}], "b"], ",", 
       FractionBox[
        RowBox[{"b", "+", "c", "+", 
         RowBox[{"\[ImaginaryI]", " ", "k2"}]}], "b"], ",", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"b", " ", "x2"}]], " ", "\[Beta]"}], "K"]}]}], "]"}]}], 
    RowBox[{"k1", " ", 
     RowBox[{"(", 
      RowBox[{"c", "+", 
       RowBox[{"\[ImaginaryI]", " ", "k2"}]}], ")"}]}]], " ", "/.", " ", 
   "RuleHyper"}], "]"}]], "Input",
 CellChangeTimes->{{3.4053512509934464`*^9, 3.4053512668688526`*^9}, {
  3.405351367168295*^9, 3.405351377637313*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"k1", " ", 
    RowBox[{"(", 
     RowBox[{"c", "+", 
      RowBox[{"\[ImaginaryI]", " ", "k2"}]}], ")"}]}]], "\[ImaginaryI]", "  ",
   
  SuperscriptBox[
   RowBox[{"(", 
    FractionBox["K", "\[Alpha]"], ")"}], 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]], " ", 
  RowBox[{"Gamma", "[", 
   FractionBox[
    RowBox[{"b", "+", "c", "+", 
     RowBox[{"\[ImaginaryI]", " ", "k2"}]}], "b"], "]"}], " ", 
  RowBox[{"(", 
   RowBox[{
    FractionBox[
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox[
         RowBox[{" ", "\[Beta]"}], "K"], ")"}], 
       RowBox[{"-", 
        FractionBox[
         RowBox[{"c", "+", 
          RowBox[{"\[ImaginaryI]", " ", "k2"}]}], "b"]}]], " ", 
      RowBox[{"Gamma", "[", 
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}], "-", 
        FractionBox[
         RowBox[{"c", "+", 
          RowBox[{"\[ImaginaryI]", " ", "k2"}]}], "b"]}], "]"}]}], 
     RowBox[{"Gamma", "[", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}], "]"}]], "+", 
    FractionBox[
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"c", "+", 
          RowBox[{"\[ImaginaryI]", " ", "k2"}], "+", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", "b", " ", "k1", " "}], "a"]}], ")"}],
         " ", "x2"}]], 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox[
         RowBox[{" ", "\[Beta]"}], "K"], ")"}], 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]], " ", 
      RowBox[{"Gamma", "[", 
       RowBox[{
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"], "+", 
        FractionBox[
         RowBox[{"c", "+", 
          RowBox[{"\[ImaginaryI]", " ", "k2"}]}], "b"]}], "]"}], " ", 
      RowBox[{"Hypergeometric2F1", "[", 
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"]}], ",", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{
           RowBox[{"a", " ", "c"}], "+", 
           RowBox[{"\[ImaginaryI]", " ", "b", " ", "k1"}], "+", 
           RowBox[{"\[ImaginaryI]", " ", "a", " ", "k2"}]}], 
          RowBox[{"a", " ", "b"}]]}], ",", 
        RowBox[{"1", "-", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"], "-", 
         FractionBox[
          RowBox[{"c", "+", 
           RowBox[{"\[ImaginaryI]", " ", "k2"}]}], "b"]}], ",", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{
             RowBox[{"-", "b"}], " ", "x2"}]], " ", "K"}], "\[Beta]"]}]}], 
       "]"}]}], 
     RowBox[{
      RowBox[{"Gamma", "[", 
       RowBox[{"1", "+", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "k1"}], "a"], "+", 
        FractionBox[
         RowBox[{"c", "+", 
          RowBox[{"\[ImaginaryI]", " ", "k2"}]}], "b"]}], "]"}], " ", 
      RowBox[{"Gamma", "[", 
       FractionBox[
        RowBox[{"c", "+", 
         RowBox[{"\[ImaginaryI]", " ", "k2"}]}], "b"], "]"}]}]]}], 
   ")"}]}]], "Input",
 CellChangeTimes->{
  3.4053513789185963`*^9, {3.405352448742858*^9, 3.405352626325529*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"la", " ", "convergence", " ", "pour", " ", "le", " ", "x2"}], ">",
    
   RowBox[{"0", " ", 
    RowBox[{"est", " ", ":", " ", 
     RowBox[{
      RowBox[{"Re", "[", 
       RowBox[{"c", "+", 
        RowBox[{"\[ImaginaryI]", " ", "k2"}], "+", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "b", " ", "k1", " "}], "a"]}], "]"}], 
      "<", 
      RowBox[{"0", " ", "soit"}]}]}]}]}], ",", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"Re", "[", "c", "]"}], " ", "-", 
    RowBox[{"Im", "[", 
     RowBox[{"k2", "+", 
      FractionBox[
       RowBox[{" ", 
        RowBox[{"b", " ", "k1", " "}]}], "a"]}], "]"}]}], "<", 
   RowBox[{
    RowBox[{"0", " ", "soit", "  ", "c"}], " ", "-", 
    RowBox[{"Im", "[", "k2", "]"}], "-", 
    RowBox[{
     FractionBox[
      RowBox[{" ", "b"}], "a"], 
     RowBox[{"Im", "[", " ", "k1", " ", "]"}]}]}], "<", 
   RowBox[{"0", " ", "soit", " ", 
    RowBox[{"Im", "[", "k2", "]"}]}], ">", 
   RowBox[{"c", " ", "-", 
    RowBox[{
     FractionBox[
      RowBox[{" ", "b"}], "a"], 
     RowBox[{"Im", "[", " ", "k1", " ", "]"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.4053504412070913`*^9, 3.4053506010549335`*^9}, 
   3.4053506422434874`*^9, {3.4053526433415895`*^9, 3.405352749578684*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"la", " ", "convergence", " ", "pour", " ", "le", " ", "x2"}], "<",
    
   RowBox[{"0", " ", 
    RowBox[{"est", " ", ":", " ", 
     RowBox[{
      RowBox[{"Re", "[", 
       RowBox[{"(", 
        RowBox[{"c", "+", 
         RowBox[{"\[ImaginaryI]", " ", "k2"}]}], ")"}], "]"}], ">", 
      RowBox[{"0", " ", "soit"}]}]}]}]}], ",", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"Re", "[", "c", "]"}], " ", "-", 
    RowBox[{"Im", "[", "k2", "]"}]}], ">", 
   RowBox[{"0", " ", "soit", " ", 
    RowBox[{"Im", "[", "k2", "]"}]}], "<", "c"}]}]], "Input",
 CellChangeTimes->{{3.4053504412070913`*^9, 3.4053506010549335`*^9}, {
  3.4053506443841677`*^9, 3.405350650618702*^9}, {3.4053506925416503`*^9, 
  3.405350699666833*^9}}]
}, Closed]]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{1167, 912},
WindowMargins->{{Automatic, -1203}, {-43, Automatic}},
ShowSelection->True,
FrontEndVersion->"6.0 for Microsoft Windows (32-bit) (June 19, 2007)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[590, 23, 301, 6, 31, "Input",
 InitializationCell->True],
Cell[894, 31, 1352, 31, 64, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2283, 67, 597, 17, 57, "Subtitle"],
Cell[2883, 86, 92, 1, 29, "Text"],
Cell[CellGroupData[{
Cell[3000, 91, 109, 1, 28, "Subsubtitle"],
Cell[3112, 94, 8705, 183, 479, "Input",
 InitializationCell->True],
Cell[11820, 279, 8806, 185, 460, "Input",
 InitializationCell->True],
Cell[20629, 466, 4284, 83, 139, "Input",
 InitializationCell->True],
Cell[24916, 551, 5034, 107, 339, "Input",
 InitializationCell->True],
Cell[29953, 660, 8932, 188, 481, "Input",
 InitializationCell->True],
Cell[38888, 850, 4537, 90, 139, "Input",
 InitializationCell->True],
Cell[43428, 942, 5050, 110, 339, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[48515, 1057, 205, 4, 28, "Subsubtitle"],
Cell[48723, 1063, 4499, 73, 132, "Input",
 InitializationCell->True],
Cell[53225, 1138, 4971, 82, 132, "Input",
 InitializationCell->True],
Cell[58199, 1222, 4528, 74, 132, "Input",
 InitializationCell->True],
Cell[62730, 1298, 5030, 83, 132, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[67797, 1386, 117, 1, 28, "Subsubtitle"],
Cell[CellGroupData[{
Cell[67939, 1391, 153, 3, 31, "Input",
 InitializationCell->True],
Cell[68095, 1396, 154, 2, 30, "Output"]
}, Open  ]],
Cell[68264, 1401, 26562, 513, 1031, "Input",
 InitializationCell->True],
Cell[94829, 1916, 24447, 468, 951, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[119313, 2389, 101, 1, 28, "Subsubtitle"],
Cell[119417, 2392, 17758, 370, 601, "Input",
 InitializationCell->True],
Cell[137178, 2764, 18102, 375, 621, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[155317, 3144, 122, 1, 28, "Subsubtitle"],
Cell[155442, 3147, 873, 26, 62, "Input",
 InitializationCell->True],
Cell[156318, 3175, 850, 25, 62, "Input",
 InitializationCell->True],
Cell[157171, 3202, 2098, 60, 88, "Input",
 InitializationCell->True],
Cell[159272, 3264, 4128, 107, 181, "Input",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[163449, 3377, 554, 15, 49, "Subtitle"],
Cell[164006, 3394, 92, 1, 29, "Text"],
Cell[CellGroupData[{
Cell[164123, 3399, 109, 1, 28, "Subsubtitle"],
Cell[164235, 3402, 5617, 114, 299, "Input",
 InitializationCell->True],
Cell[169855, 3518, 252, 5, 31, "Input"],
Cell[170110, 3525, 5764, 118, 299, "Input",
 InitializationCell->True],
Cell[175877, 3645, 5637, 113, 280, "Input",
 InitializationCell->True],
Cell[181517, 3760, 4682, 90, 139, "Input",
 InitializationCell->True],
Cell[186202, 3852, 4271, 78, 92, "Input",
 InitializationCell->True],
Cell[190476, 3932, 6286, 118, 279, "Input",
 InitializationCell->True],
Cell[196765, 4052, 4882, 95, 139, "Input",
 InitializationCell->True],
Cell[201650, 4149, 6393, 121, 299, "Input",
 InitializationCell->True],
Cell[208046, 4272, 5912, 107, 252, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[213995, 4384, 149, 2, 28, "Subsubtitle"],
Cell[214147, 4388, 4511, 74, 132, "Input",
 InitializationCell->True],
Cell[218661, 4464, 4551, 74, 132, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[223249, 4543, 117, 1, 28, "Subsubtitle"],
Cell[223369, 4546, 25734, 501, 1031, "Input",
 InitializationCell->True],
Cell[249106, 5049, 22385, 436, 911, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[271528, 5490, 101, 1, 28, "Subsubtitle"],
Cell[271632, 5493, 10182, 206, 301, "Input",
 InitializationCell->True],
Cell[281817, 5701, 10308, 208, 301, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[292162, 5914, 122, 1, 28, "Subsubtitle"],
Cell[292287, 5917, 842, 20, 62, "Input",
 InitializationCell->True],
Cell[293132, 5939, 873, 21, 62, "Input",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[294054, 5966, 602, 16, 57, "Subtitle"],
Cell[294659, 5984, 92, 1, 29, "Text"],
Cell[CellGroupData[{
Cell[294776, 5989, 109, 1, 28, "Subsubtitle"],
Cell[294888, 5992, 5624, 114, 301, "Input",
 InitializationCell->True],
Cell[300515, 6108, 252, 5, 31, "Input"],
Cell[300770, 6115, 5859, 119, 301, "Input",
 InitializationCell->True],
Cell[306632, 6236, 5651, 114, 282, "Input",
 InitializationCell->True],
Cell[312286, 6352, 5342, 102, 159, "Input",
 InitializationCell->True],
Cell[317631, 6456, 5302, 99, 159, "Input",
 InitializationCell->True],
Cell[322936, 6557, 5549, 107, 159, "Input",
 InitializationCell->True],
Cell[328488, 6666, 7372, 141, 359, "Input",
 InitializationCell->True],
Cell[335863, 6809, 7539, 144, 379, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[343439, 6958, 149, 2, 28, "Subsubtitle"],
Cell[343591, 6962, 4740, 78, 132, "Input",
 InitializationCell->True],
Cell[348334, 7042, 4813, 79, 132, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[353184, 7126, 117, 1, 28, "Subsubtitle"],
Cell[353304, 7129, 22141, 434, 911, "Input",
 InitializationCell->True],
Cell[375448, 7565, 22233, 435, 911, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[397718, 8005, 101, 1, 28, "Subsubtitle"],
Cell[397822, 8008, 10226, 204, 301, "Input",
 InitializationCell->True],
Cell[408051, 8214, 10415, 207, 301, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[418503, 8426, 122, 1, 28, "Subsubtitle"],
Cell[418628, 8429, 893, 21, 64, "Input",
 InitializationCell->True],
Cell[419524, 8452, 948, 22, 64, "Input",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[420521, 8480, 681, 20, 57, "Subtitle"],
Cell[421205, 8502, 92, 1, 29, "Text"],
Cell[CellGroupData[{
Cell[421322, 8507, 109, 1, 28, "Subsubtitle"],
Cell[421434, 8510, 6634, 133, 341, "Input",
 InitializationCell->True],
Cell[428071, 8645, 5021, 103, 204, "Input",
 InitializationCell->True],
Cell[433095, 8750, 6691, 136, 321, "Input",
 InitializationCell->True],
Cell[439789, 8888, 6701, 133, 342, "Input",
 InitializationCell->True],
Cell[446493, 9023, 7237, 161, 293, "Input",
 InitializationCell->True],
Cell[453733, 9186, 252, 5, 31, "Input"],
Cell[453988, 9193, 333, 7, 31, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[454358, 9205, 117, 1, 28, "Subsubtitle"],
Cell[454478, 9208, 23340, 443, 891, "Input",
 InitializationCell->True],
Cell[477821, 9653, 22169, 421, 851, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[500027, 10079, 101, 1, 28, "Subsubtitle"],
Cell[500131, 10082, 13605, 285, 298, "Input",
 InitializationCell->True],
Cell[513739, 10369, 13663, 285, 298, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[527439, 10659, 122, 1, 28, "Subsubtitle"],
Cell[CellGroupData[{
Cell[527586, 10664, 2633, 75, 101, "Input",
 InitializationCell->True],
Cell[530222, 10741, 984, 24, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[531243, 10770, 2761, 77, 93, "Input",
 InitializationCell->True],
Cell[534007, 10849, 983, 24, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[535027, 10878, 1754, 52, 57, "Input"],
Cell[536784, 10932, 525, 15, 51, "Output"]
}, Open  ]],
Cell[537324, 10950, 94, 1, 31, "Input"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[537467, 10957, 838, 23, 57, "Subtitle"],
Cell[538308, 10982, 92, 1, 29, "Text"],
Cell[CellGroupData[{
Cell[538425, 10987, 109, 1, 28, "Subsubtitle"],
Cell[538537, 10990, 6417, 126, 339, "Input",
 InitializationCell->True],
Cell[544957, 11118, 6498, 129, 319, "Input",
 InitializationCell->True],
Cell[551458, 11249, 6459, 126, 320, "Input",
 InitializationCell->True],
Cell[557920, 11377, 5269, 107, 204, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[563226, 11489, 117, 1, 28, "Subsubtitle"],
Cell[563346, 11492, 23747, 450, 911, "Input",
 InitializationCell->True],
Cell[587096, 11944, 22531, 428, 871, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[609664, 12377, 101, 1, 28, "Subsubtitle"],
Cell[609768, 12380, 13900, 288, 298, "Input",
 InitializationCell->True],
Cell[623671, 12670, 13987, 290, 298, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[637695, 12965, 122, 1, 28, "Subsubtitle"],
Cell[637820, 12968, 1816, 45, 62, "Input",
 InitializationCell->True],
Cell[639639, 13015, 332, 8, 31, "Input"],
Cell[639974, 13025, 1934, 46, 62, "Input",
 InitializationCell->True],
Cell[641911, 13073, 327, 8, 31, "Input"],
Cell[CellGroupData[{
Cell[642263, 13085, 412, 10, 31, "Input"],
Cell[642678, 13097, 525, 15, 51, "Output"]
}, Open  ]],
Cell[643218, 13115, 94, 1, 31, "Input"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[643361, 13122, 891, 24, 57, "Subtitle"],
Cell[644255, 13148, 92, 1, 29, "Text"],
Cell[CellGroupData[{
Cell[644372, 13153, 109, 1, 28, "Subsubtitle"],
Cell[644484, 13156, 6335, 125, 339, "Input",
 InitializationCell->True],
Cell[650822, 13283, 5221, 106, 204, "Input",
 InitializationCell->True],
Cell[656046, 13391, 6525, 130, 319, "Input",
 InitializationCell->True],
Cell[662574, 13523, 6381, 125, 320, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[668992, 13653, 117, 1, 28, "Subsubtitle"],
Cell[669112, 13656, 23803, 452, 911, "Input",
 InitializationCell->True],
Cell[692918, 14110, 22491, 429, 871, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[715446, 14544, 101, 1, 28, "Subsubtitle"],
Cell[715550, 14547, 13928, 289, 298, "Input",
 InitializationCell->True],
Cell[729481, 14838, 14015, 291, 298, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[743533, 15134, 122, 1, 28, "Subsubtitle"],
Cell[743658, 15137, 2190, 53, 71, "Input",
 InitializationCell->True],
Cell[745851, 15192, 384, 10, 45, "Input"],
Cell[746238, 15204, 2025, 45, 62, "Input",
 InitializationCell->True],
Cell[748266, 15251, 276, 6, 31, "Input"],
Cell[CellGroupData[{
Cell[748567, 15261, 412, 10, 31, "Input"],
Cell[748982, 15273, 525, 15, 51, "Output"]
}, Open  ]],
Cell[749522, 15291, 94, 1, 31, "Input"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[749665, 15298, 98, 1, 49, "Subtitle"],
Cell[749766, 15301, 92, 1, 29, "Text"],
Cell[CellGroupData[{
Cell[749883, 15306, 159, 2, 28, "Subsubtitle"],
Cell[750045, 15310, 1034, 29, 45, "Input",
 InitializationCell->True],
Cell[751082, 15341, 1031, 28, 45, "Input",
 InitializationCell->True],
Cell[752116, 15371, 770, 16, 52, "Input",
 InitializationCell->True],
Cell[752889, 15389, 55005, 1126, 4732, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[807931, 16520, 221, 3, 28, "Subsubtitle"],
Cell[808155, 16525, 358, 10, 31, "Input",
 InitializationCell->True],
Cell[808516, 16537, 1336, 33, 72, "Input",
 InitializationCell->True],
Cell[809855, 16572, 2424, 56, 232, "Input",
 InitializationCell->True],
Cell[812282, 16630, 3272, 84, 112, "Input",
 InitializationCell->True],
Cell[815557, 16716, 355, 9, 31, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[815949, 16730, 215, 6, 28, "Subsubtitle"],
Cell[816167, 16738, 461, 9, 31, "Input"],
Cell[816631, 16749, 3895, 82, 192, "Input",
 InitializationCell->True],
Cell[820529, 16833, 509, 9, 31, "Input"],
Cell[821041, 16844, 4069, 86, 192, "Input",
 InitializationCell->True],
Cell[825113, 16932, 356, 8, 31, "Input"],
Cell[825472, 16942, 3033, 68, 112, "Input",
 InitializationCell->True],
Cell[828508, 17012, 259, 6, 31, "Input"],
Cell[828770, 17020, 3025, 68, 92, "Input",
 InitializationCell->True],
Cell[831798, 17090, 331, 8, 31, "Input"],
Cell[832132, 17100, 5591, 130, 172, "Input",
 InitializationCell->True],
Cell[837726, 17232, 235, 6, 31, "Input"],
Cell[837964, 17240, 4717, 106, 132, "Input",
 InitializationCell->True],
Cell[842684, 17348, 481, 10, 31, "Input"],
Cell[843168, 17360, 290, 7, 31, "Input"],
Cell[CellGroupData[{
Cell[843483, 17371, 175, 4, 31, "Input"],
Cell[843661, 17377, 205, 5, 30, "Output"]
}, Open  ]],
Cell[843881, 17385, 282, 6, 31, "Input"],
Cell[CellGroupData[{
Cell[844188, 17395, 541, 10, 31, "Input"],
Cell[844732, 17407, 683, 14, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[845452, 17426, 695, 11, 31, "Input"],
Cell[846150, 17439, 1043, 23, 50, "Output"]
}, Open  ]],
Cell[847208, 17465, 293, 6, 47, "Input"],
Cell[847504, 17473, 94, 1, 31, "Input"],
Cell[847601, 17476, 10329, 224, 372, "Input",
 InitializationCell->True],
Cell[857933, 17702, 14613, 319, 572, "Input",
 InitializationCell->True],
Cell[872549, 18023, 825, 15, 92, "Input"],
Cell[873377, 18040, 19627, 430, 772, "Input",
 InitializationCell->True],
Cell[893007, 18472, 9682, 192, 432, "Input",
 InitializationCell->True],
Cell[902692, 18666, 4158, 104, 172, "Input",
 InitializationCell->True],
Cell[906853, 18772, 242, 5, 47, "Input"],
Cell[907098, 18779, 94, 1, 31, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[907229, 18785, 325, 9, 28, "Subsubtitle"],
Cell[907557, 18796, 221, 4, 31, "Input"],
Cell[907781, 18802, 588, 14, 47, "Input"],
Cell[908372, 18818, 157, 3, 31, "Input"],
Cell[908532, 18823, 643, 16, 47, "Input"],
Cell[909178, 18841, 186, 3, 31, "Input"],
Cell[909367, 18846, 608, 14, 31, "Input"],
Cell[CellGroupData[{
Cell[910000, 18864, 731, 27, 31, "Input"],
Cell[910734, 18893, 747, 23, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[911518, 18921, 1195, 39, 31, "Input"],
Cell[912716, 18962, 109, 2, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[912862, 18969, 757, 22, 31, "Input"],
Cell[913622, 18993, 2039, 60, 90, "Output"]
}, Open  ]],
Cell[915676, 19056, 152, 2, 31, "Input"],
Cell[915831, 19060, 2929, 86, 182, "Input",
 InitializationCell->True],
Cell[918763, 19148, 4226, 120, 266, "Input",
 InitializationCell->True],
Cell[922992, 19270, 2019, 61, 327, "Input",
 InitializationCell->True],
Cell[925014, 19333, 630, 17, 42, "Input"],
Cell[CellGroupData[{
Cell[925669, 19354, 290, 5, 31, "Input"],
Cell[925962, 19361, 344, 8, 23, "Print"],
Cell[926309, 19371, 450, 12, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[926796, 19388, 598, 16, 31, "Input"],
Cell[927397, 19406, 232, 7, 30, "Output"]
}, Open  ]],
Cell[927644, 19416, 132, 1, 29, "Text"],
Cell[CellGroupData[{
Cell[927801, 19421, 570, 16, 47, "Input"],
Cell[928374, 19439, 1025, 29, 30, "Output"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[929460, 19475, 160, 2, 49, "Subtitle"],
Cell[CellGroupData[{
Cell[929645, 19481, 408, 12, 70, "Section"],
Cell[CellGroupData[{
Cell[930078, 19497, 45, 0, 36, "Subsection"],
Cell[CellGroupData[{
Cell[930148, 19501, 881, 21, 48, "Input"],
Cell[931032, 19524, 2106, 63, 54, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[933175, 19592, 257, 6, 31, "Input"],
Cell[933435, 19600, 997, 31, 54, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[934469, 19636, 452, 11, 35, "Input"],
Cell[934924, 19649, 2099, 61, 85, "Output"]
}, Open  ]],
Cell[937038, 19713, 289, 5, 29, "Text"],
Cell[CellGroupData[{
Cell[937352, 19722, 609, 14, 35, "Input"],
Cell[937964, 19738, 621, 19, 52, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[938634, 19763, 160, 2, 36, "Subsection"],
Cell[CellGroupData[{
Cell[938819, 19769, 813, 18, 44, "Input"],
Cell[939635, 19789, 1458, 42, 51, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[941130, 19836, 257, 6, 31, "Input"],
Cell[941390, 19844, 627, 18, 51, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[942054, 19867, 452, 11, 35, "Input"],
Cell[942509, 19880, 807, 24, 52, "Output"]
}, Open  ]],
Cell[943331, 19907, 192, 4, 29, "Text"],
Cell[943526, 19913, 1763, 49, 121, "Input"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[945338, 19968, 414, 12, 40, "Section"],
Cell[CellGroupData[{
Cell[945777, 19984, 96, 1, 36, "Subsection"],
Cell[CellGroupData[{
Cell[945898, 19989, 314, 9, 33, "Input"],
Cell[946215, 20000, 464, 8, 21, "Message"],
Cell[946682, 20010, 360, 9, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[947079, 20024, 900, 21, 50, "Input"],
Cell[947982, 20047, 1785, 56, 62, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[949804, 20108, 406, 11, 31, "Input"],
Cell[950213, 20121, 464, 12, 62, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[950714, 20138, 620, 15, 35, "Input"],
Cell[951337, 20155, 1063, 29, 62, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[952437, 20189, 271, 6, 31, "Input"],
Cell[952711, 20197, 497, 13, 62, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[953257, 20216, 276, 4, 36, "Subsection"],
Cell[CellGroupData[{
Cell[953558, 20224, 905, 21, 50, "Input"],
Cell[954466, 20247, 1911, 58, 62, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[956414, 20310, 404, 11, 31, "Input"],
Cell[956821, 20323, 464, 12, 62, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[957322, 20340, 694, 17, 35, "Input"],
Cell[958019, 20359, 1135, 31, 62, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[959191, 20395, 322, 7, 31, "Input"],
Cell[959516, 20404, 554, 15, 62, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[960107, 20424, 7844, 159, 278, "Input"],
Cell[967954, 20585, 5785, 104, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[973776, 20694, 8127, 163, 278, "Input"],
Cell[981906, 20859, 5892, 105, 136, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[987835, 20969, 7713, 158, 278, "Input"],
Cell[995551, 21129, 8397, 148, 130, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[1004009, 21284, 519, 15, 45, "Section"],
Cell[CellGroupData[{
Cell[1004553, 21303, 239, 3, 36, "Subsection"],
Cell[CellGroupData[{
Cell[1004817, 21310, 427, 12, 33, "Input"],
Cell[1005247, 21324, 462, 8, 21, "Message"],
Cell[1005712, 21334, 433, 14, 56, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1006182, 21353, 1260, 31, 52, "Input"],
Cell[1007445, 21386, 2609, 77, 113, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1010091, 21468, 404, 11, 31, "Input"],
Cell[1010498, 21481, 729, 21, 64, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1011264, 21507, 506, 12, 35, "Input"],
Cell[1011773, 21521, 2760, 81, 91, "Output"]
}, Open  ]],
Cell[1014548, 21605, 437, 7, 29, "Text"],
Cell[1014988, 21614, 440, 11, 31, "Input"],
Cell[1015431, 21627, 2278, 66, 96, "Input"],
Cell[1017712, 21695, 149, 3, 31, "Input"],
Cell[1017864, 21700, 1782, 49, 121, "Input"],
Cell[CellGroupData[{
Cell[1019671, 21753, 2390, 73, 91, "Input"],
Cell[1022064, 21828, 7542, 205, 207, "Output"]
}, Open  ]],
Cell[1029621, 22036, 417, 8, 31, "Input"],
Cell[1030041, 22046, 3129, 95, 126, "Input"],
Cell[1033173, 22143, 2445, 74, 64, "Input"],
Cell[CellGroupData[{
Cell[1035643, 22221, 774, 24, 46, "Input"],
Cell[1036420, 22247, 313, 9, 45, "Output"]
}, Open  ]],
Cell[1036748, 22259, 1284, 40, 64, "Input"],
Cell[1038035, 22301, 145, 2, 31, "Input"],
Cell[1038183, 22305, 2067, 64, 53, "Input"],
Cell[1040253, 22371, 3327, 102, 132, "Input"],
Cell[1043583, 22475, 383, 6, 31, "Input"],
Cell[1043969, 22483, 4803, 142, 198, "Input"],
Cell[1048775, 22627, 393, 9, 31, "Input"],
Cell[1049171, 22638, 3491, 95, 87, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1052699, 22738, 239, 3, 36, "Subsection"],
Cell[1052941, 22743, 210, 4, 31, "Input"],
Cell[1053154, 22749, 2164, 69, 91, "Input"],
Cell[1055321, 22820, 483, 10, 31, "Input"],
Cell[1055807, 22832, 1971, 58, 53, "Input"],
Cell[1057781, 22892, 315, 5, 31, "Input"],
Cell[CellGroupData[{
Cell[1058121, 22901, 1824, 57, 75, "Input"],
Cell[1059948, 22960, 6313, 173, 191, "Output"]
}, Open  ]],
Cell[1066276, 23136, 5498, 154, 212, "Input"],
Cell[1071777, 23292, 5717, 156, 184, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1077531, 23453, 126, 1, 36, "Subsection"],
Cell[CellGroupData[{
Cell[1077682, 23458, 3367, 88, 105, "Input"],
Cell[1081052, 23548, 841, 23, 62, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[1081942, 23577, 160, 2, 36, "Subsection"],
Cell[CellGroupData[{
Cell[1082127, 23583, 667, 19, 33, "Input"],
Cell[1082797, 23604, 484, 8, 21, "Message"],
Cell[1083284, 23614, 371, 11, 56, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1083692, 23630, 663, 18, 31, "Input"],
Cell[1084358, 23650, 316, 10, 45, "Output"]
}, Open  ]],
Cell[1084689, 23663, 273, 8, 53, "Input"],
Cell[CellGroupData[{
Cell[1084987, 23675, 1211, 30, 50, "Input"],
Cell[1086201, 23707, 2354, 68, 107, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1088592, 23780, 404, 11, 31, "Input"],
Cell[1088999, 23793, 736, 19, 62, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1089772, 23817, 552, 13, 35, "Input"],
Cell[1090327, 23832, 1142, 31, 64, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1091506, 23868, 1971, 54, 62, "Input"],
Cell[1093480, 23924, 483, 12, 30, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[1094024, 23943, 636, 18, 45, "Section"],
Cell[1094663, 23963, 592, 19, 33, "Input"],
Cell[CellGroupData[{
Cell[1095280, 23986, 516, 12, 31, "Input"],
Cell[1095799, 24000, 514, 13, 45, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1096350, 24018, 456, 10, 31, "Input"],
Cell[1096809, 24030, 472, 12, 45, "Output"]
}, Open  ]],
Cell[1097296, 24045, 994, 25, 45, "Input"],
Cell[1098293, 24072, 1016, 26, 45, "Input"],
Cell[1099312, 24100, 203, 3, 31, "Input"],
Cell[CellGroupData[{
Cell[1099540, 24107, 1307, 29, 50, "Input"],
Cell[1100850, 24138, 1753, 49, 59, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1102640, 24192, 333, 7, 31, "Input"],
Cell[1102976, 24201, 812, 20, 59, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1103825, 24226, 899, 22, 45, "Input"],
Cell[1104727, 24250, 4208, 122, 107, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1108972, 24377, 670, 19, 45, "Input"],
Cell[1109645, 24398, 1605, 47, 57, "Output"]
}, Open  ]],
Cell[1111265, 24448, 2276, 65, 57, "Input"],
Cell[1113544, 24515, 144, 3, 31, "Input"],
Cell[CellGroupData[{
Cell[1113713, 24522, 1332, 29, 50, "Input"],
Cell[1115048, 24553, 1748, 49, 59, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1116833, 24607, 407, 8, 31, "Input"],
Cell[1117243, 24617, 808, 20, 59, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1118088, 24642, 997, 23, 45, "Input"],
Cell[1119088, 24667, 4301, 124, 115, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1123426, 24796, 773, 21, 45, "Input"],
Cell[1124202, 24819, 1697, 49, 64, "Output"]
}, Open  ]],
Cell[1125914, 24871, 2376, 67, 64, "Input"],
Cell[CellGroupData[{
Cell[1128315, 24942, 2061, 57, 64, "Input"],
Cell[1130379, 25001, 746, 23, 56, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1131162, 25029, 507, 15, 33, "Input"],
Cell[1131672, 25046, 247, 8, 30, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[1131968, 25060, 863, 23, 40, "Section"],
Cell[CellGroupData[{
Cell[1132856, 25087, 427, 12, 33, "Input"],
Cell[1133286, 25101, 462, 8, 21, "Message"],
Cell[1133751, 25111, 433, 14, 56, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1134221, 25130, 1125, 26, 52, "Input"],
Cell[1135349, 25158, 1643, 47, 63, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1137029, 25210, 391, 9, 31, "Input"],
Cell[1137423, 25221, 724, 18, 63, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1138184, 25244, 773, 16, 35, "Input"],
Cell[1138960, 25262, 1843, 51, 64, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1140840, 25318, 1251, 35, 63, "Input"],
Cell[1142094, 25355, 3404, 100, 92, "Output"]
}, Open  ]],
Cell[1145513, 25458, 3380, 101, 89, "Input"],
Cell[1148896, 25561, 1195, 35, 45, "Input"],
Cell[1150094, 25598, 718, 18, 31, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[1150849, 25621, 914, 24, 40, "Section"],
Cell[CellGroupData[{
Cell[1151788, 25649, 427, 12, 33, "Input"],
Cell[1152218, 25663, 462, 8, 21, "Message"],
Cell[1152683, 25673, 433, 14, 56, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1153153, 25692, 1176, 27, 52, "Input"],
Cell[1154332, 25721, 1584, 44, 62, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1155953, 25770, 381, 8, 31, "Input"],
Cell[1156337, 25780, 758, 18, 62, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1157132, 25803, 774, 16, 35, "Input"],
Cell[1157909, 25821, 1896, 53, 64, "Output"]
}, Open  ]],
Cell[1159820, 25877, 1306, 37, 63, "Input"],
Cell[1161129, 25916, 3358, 103, 200, "Input"],
Cell[1164490, 26021, 1289, 38, 80, "Input"],
Cell[1165782, 26061, 767, 21, 31, "Input"]
}, Closed]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
