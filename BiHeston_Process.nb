(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 6.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    443078,      12427]
NotebookOptionsPosition[    421851,      11800]
NotebookOutlinePosition[    422223,      11816]
CellTagsIndexPosition[    422180,      11813]
WindowFrame->Normal
ContainsDynamic->False*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"<<", " ", 
  "\"\<C:\\\\Documents and Settings\\\\ocroissant\\\\My \
Documents\\\\NumericalIntegration.m\>\""}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{"<<", " ", 
  "\"\<C:\\\\Documents and Settings\\\\ocroissant\\\\My \
Documents\\\\BS.m\>\""}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.3998713858696938`*^9, 3.3998713864009542`*^9}}],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<PlotLegends`\>\"", "]"}]], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell["The Super  Biheston  Spread Risks Model", "Title",
 CellChangeTimes->{{3.4028140178933587`*^9, 3.4028140637692394`*^9}, {
  3.4028153033711643`*^9, 3.4028153182151995`*^9}}],

Cell["Introduction", "Subtitle",
 CellChangeTimes->{{3.402814075035081*^9, 3.4028140777851334`*^9}}],

Cell["\<\
BiSabr, NormalHeston are common ways to represent a spread risk.The main \
problem is to have a consistent way to :
 1) - take into account the smile of the underlyings inside an arbitrage free \
framework, 
 2) - have additional flexibility to introduce the notion of correlation \
smile that can be adjusted to market data
 3) - be useable up to 40 years maturity options
 
 The final test of acceptance will be of course the stability of the hedge \
ratios
 
 In addition of these requirements some \"nice to have\" feature can also be \
considered:
4) - The ability to fit several maturities for the options, so allowing to \
have a real diffusion model, that can be used to price american deals
5)- The ability to do fit several matiurities in an autonomous way, that mean \
without using ime dependant coefficients, so improving forward smile \
behaviour, which is important for american deals
6) - The ability to have \"closed form\" formula for other type of options: \
Digitals on the underlyings, Min-Max options, Double condition options, 
7) - The ability to have additional flexibility to represent smile behaviour \
of the tail of the underlying beyond the usual 4 parameters framework 
 
 The Super BiHeston Framework fullfill all the requirements from 1) to 7) at \
a certain cost (computation time and complexity) but is very likely the only \
one to do so\
\>", "Text",
 CellChangeTimes->{{3.4028140955511*^9, 3.4028143382588844`*^9}, {
  3.402814382619111*^9, 3.402814447932865*^9}, {3.4028144786209545`*^9, 
  3.402814718609937*^9}, {3.402814785126839*^9, 3.402815072038598*^9}, {
  3.402815155712079*^9, 3.402815244495034*^9}}],

Cell[CellGroupData[{

Cell["Specification of the model", "Subtitle",
 CellChangeTimes->{{3.402815400185523*^9, 3.4028154073731613`*^9}, 
   3.402815457921007*^9}],

Cell["notation", "Subsubtitle",
 CellChangeTimes->{{3.4028159821966977`*^9, 3.4028159838373537`*^9}}],

Cell[TextData[{
 "M : mean reversion\n",
 Cell[BoxData[
  SubscriptBox["\[CapitalSigma]", "\[Infinity]"]],
  CellChangeTimes->{{3.398746969101185*^9, 3.3987470046337996`*^9}}],
 " : Long term variance\n\[Rho] : correlation underlying - variance\n\
\[CapitalSigma] : variance initial value\n\[Gamma] : frequency (Fourier \
parameters)\nY : Log of Underlying initial value\n\[Beta] : Relative  vol of \
vol ( convergence : \[Beta] > 1)\n\[Tau] : maturity"
}], "Text",
 CellChangeTimes->{{3.3996095140180473`*^9, 3.3996096325515733`*^9}, {
  3.3996098428837366`*^9, 3.3996099264322157`*^9}, {3.3996100178714714`*^9, 
  3.3996100410594163`*^9}, {3.4003066891744156`*^9, 3.4003067331752605`*^9}, {
  3.402815484718396*^9, 3.4028155990018406`*^9}}],

Cell[CellGroupData[{

Cell["Variance Process", "Subsubtitle",
 CellChangeTimes->{{3.3984932410280504`*^9, 3.3984932479029627`*^9}, {
  3.402815465561778*^9, 3.402815476108856*^9}, {3.4028157995369406`*^9, 
  3.4028158003025804`*^9}}],

Cell[BoxData[
 RowBox[{
  SubscriptBox["d\[CapitalSigma]", "t"], "=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"M", " ", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["\[CapitalSigma]", "t"], "-", 
         SubscriptBox["\[CapitalSigma]", "\[Infinity]"]}], ")"}]}], "+", " ", 
      
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["\[CapitalSigma]", "t"], "-", 
         SubscriptBox["\[CapitalSigma]", "\[Infinity]"]}], ")"}], 
       SuperscriptBox["M", "*"]}]}], ")"}], "dt"}], "+", 
   RowBox[{
    SqrtBox[
     SubscriptBox["\[CapitalSigma]", "t"]], 
    SubscriptBox["dW", "t"], "Q"}], " ", "+", 
   RowBox[{
    SuperscriptBox["Q", "*"], 
    SuperscriptBox[
     SubscriptBox["dW", "t"], "*"], 
    SuperscriptBox[
     RowBox[{"(", 
      SqrtBox[
       SubscriptBox["\[CapitalSigma]", "t"]], ")"}], "*"]}]}]}]], "Text",
 CellChangeTimes->{{3.398493257699712*^9, 3.398493303496001*^9}, {
  3.39849340749467*^9, 3.398493522540072*^9}, {3.398503431285205*^9, 
  3.398503461426409*^9}, {3.4008432459038897`*^9, 3.400843250075845*^9}}],

Cell["\<\
Bru shows the \[Beta]>1 is enough to insure non explosion  of the model \
\>", "Text",
 CellChangeTimes->{{3.4003070886352105`*^9, 3.4003071365423803`*^9}, {
  3.402815638315095*^9, 3.4028156772533426`*^9}}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["\[CapitalOmega]\[CapitalOmega]", "*"], "=", 
  RowBox[{
   RowBox[{"\[Beta]", " ", 
    SuperscriptBox["Q", "*"], "Q"}], " ", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "M"}], " ", 
     SubscriptBox["\[CapitalSigma]", "\[Infinity]"]}], "-", 
    RowBox[{
     SubscriptBox["\[CapitalSigma]", "\[Infinity]"], 
     SuperscriptBox["M", "*"], " "}]}]}]}]], "Text",
 CellChangeTimes->{{3.3987468872551174`*^9, 3.3987469430064325`*^9}, {
  3.405171581112748*^9, 3.4051715833315554`*^9}}],

Cell["where ", "Text",
 CellChangeTimes->{{3.398746954991268*^9, 3.3987469558975525`*^9}, {
  3.4003067945826893`*^9, 3.400306829286481*^9}, {3.400307147948849*^9, 
  3.4003071482926054`*^9}, {3.4028156845816083`*^9, 3.402815685503501*^9}}],

Cell["\[Beta]  Gindikin   index \[Element]]2,+\[Infinity][", "Text",
 CellChangeTimes->{{3.4051715863628826`*^9, 3.405171589175455*^9}, {
  3.4051719448720603`*^9, 3.4051719702164593`*^9}, {3.4051720542967367`*^9, 
  3.4051720838599935`*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.404729089492797*^9}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["\[CapitalOmega]\[CapitalOmega]", "*"], "=", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "M"}], " ", 
    SubscriptBox["\[CapitalSigma]", "\[Infinity]"]}], "-", 
   RowBox[{
    SubscriptBox["\[CapitalSigma]", "\[Infinity]"], 
    SuperscriptBox["M", "*"]}]}]}]], "Text",
 CellChangeTimes->{{3.398746969101185*^9, 3.3987470046337996`*^9}}],

Cell[BoxData[
 RowBox[{
  SubscriptBox["\[CapitalSigma]", "t"], "=", 
  RowBox[{
   RowBox[{"(", GridBox[{
      {
       SubscriptBox[
        RowBox[{"(", 
         SuperscriptBox["\[CapitalSigma]", "11"], ")"}], "t"], 
       SubscriptBox[
        RowBox[{"(", 
         SuperscriptBox["\[CapitalSigma]", "12"], ")"}], "t"]},
      {
       SubscriptBox[
        RowBox[{"(", 
         SuperscriptBox["\[CapitalSigma]", "12"], ")"}], "t"], 
       SubscriptBox[
        RowBox[{"(", 
         SuperscriptBox["\[CapitalSigma]", "22"], ")"}], "t"]}
     }], ")"}], " ", 
   StyleBox["3",
    FontVariations->{"Underline"->True}], 
   StyleBox[" ",
    FontVariations->{"Underline"->True}], 
   StyleBox["process",
    FontVariations->{"Underline"->True}], 
   StyleBox[" ",
    FontVariations->{"Underline"->True}], 
   StyleBox["of",
    FontVariations->{"Underline"->True}], 
   StyleBox[" ",
    FontVariations->{"Underline"->True}], 
   StyleBox["variance",
    FontVariations->{"Underline"->True}]}]}]], "Text",
 CellChangeTimes->{{3.3984936645538793`*^9, 3.39849374186539*^9}, {
  3.3984944660748696`*^9, 3.3984944720279183`*^9}, {3.402815690706726*^9, 
  3.4028156966755905`*^9}}],

Cell["we note : ", "Text",
 CellChangeTimes->{{3.398515708193855*^9, 3.398515710225131*^9}, {
  3.4028157021756964`*^9, 3.402815702675706*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SqrtBox[
    SubscriptBox["\[CapitalSigma]", "t"]], "=", 
   RowBox[{
    SubscriptBox["\[Sigma]", "t"], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", GridBox[{
         {
          SubscriptBox[
           RowBox[{"(", 
            SuperscriptBox["\[Sigma]", "11"], ")"}], "t"], 
          SubscriptBox[
           RowBox[{"(", 
            SuperscriptBox["\[Sigma]", "12"], ")"}], "t"]},
         {
          SubscriptBox[
           RowBox[{"(", 
            SuperscriptBox["\[Sigma]", "21"], ")"}], "t"], 
          SubscriptBox[
           RowBox[{"(", 
            SuperscriptBox["\[Sigma]", "22"], ")"}], "t"]}
        }], ")"}], " ", "such", " ", "that", "  ", 
      SubscriptBox["\[CapitalSigma]", "t"]}], "=", 
     RowBox[{
      SubscriptBox["\[Sigma]", "t"], 
      SuperscriptBox[
       SubscriptBox["\[Sigma]", "t"], "*"]}]}]}]}], 
  "\[IndentingNewLine]"}]], "Text",
 CellChangeTimes->{{3.398515461221944*^9, 3.398515473425225*^9}, {
  3.398515720053382*^9, 3.3985158039919558`*^9}, {3.400307193980983*^9, 
  3.4003071966372843`*^9}, {3.4028157093477087`*^9, 3.4028157138165445`*^9}}],\


Cell["In the 1 dim case, we compute the vol of vol by :", "Text",
 CellChangeTimes->{{3.3996092112309837`*^9, 3.399609248669203*^9}, {
   3.40030663131393*^9, 3.400306650361171*^9}, {3.400307216278286*^9, 
   3.400307219668976*^9}, 3.40030725712282*^9, {3.402815735988846*^9, 
   3.4028157608018217`*^9}}],

Cell[BoxData[
 RowBox[{"Q", "=", 
  SqrtBox[
   FractionBox[
    RowBox[{
     RowBox[{"-", "M"}], " ", 
     SubscriptBox["\[CapitalSigma]", "\[Infinity]"]}], "\[Beta]"]]}]], "Text",\

 CellChangeTimes->{{3.3996092778728886`*^9, 3.3996093050140343`*^9}, 
   3.3996095009396715`*^9, {3.4003072242315636`*^9, 3.4003072244503183`*^9}, 
   3.40030725971662*^9, 3.402815780661578*^9, {3.408677956290187*^9, 
   3.408677961540288*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Variance Process Parameters", "Subsubtitle",
 CellChangeTimes->{{3.3984938088020325`*^9, 3.398493819645644*^9}, {
  3.4028158063183208`*^9, 3.4028158401627207`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Initial", " ", "value", " ", "of", " ", "the", " ", 
   RowBox[{"variance", " ", ":", " ", 
    SubscriptBox["\[CapitalSigma]", "0"]}]}], "=", 
  RowBox[{"(", GridBox[{
     {
      SubscriptBox[
       RowBox[{"(", 
        SuperscriptBox["\[CapitalSigma]", "11"], ")"}], "0"], 
      SubscriptBox[
       RowBox[{"(", 
        SuperscriptBox["\[CapitalSigma]", "12"], ")"}], "0"]},
     {
      SubscriptBox[
       RowBox[{"(", 
        SuperscriptBox["\[CapitalSigma]", "21"], ")"}], "0"], 
      SubscriptBox[
       RowBox[{"(", 
        SuperscriptBox["\[CapitalSigma]", "22"], ")"}], "0"]}
    }], ")"}]}]], "Text",
 CellChangeTimes->{{3.398503640461096*^9, 3.3985037307436705`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Vol", " ", "of", " ", 
   RowBox[{"vol", " ", ":", " ", "Q"}]}], "=", 
  RowBox[{"(", GridBox[{
     {
      SubscriptBox["\[Nu]", "11"], 
      SubscriptBox["\[Nu]", "12"]},
     {
      SubscriptBox["\[Nu]", "21"], 
      SubscriptBox["\[Nu]", "22"]}
    }], ")"}]}]], "Text",
 CellChangeTimes->{{3.398493830301758*^9, 3.398493865113812*^9}, {
  3.3984940232211633`*^9, 3.3984940428146625`*^9}, {3.3984941030326414`*^9, 
  3.398494115579356*^9}, {3.3984987967381864`*^9, 3.398498809722395*^9}, {
  3.398503636117263*^9, 3.3985036383360553`*^9}, {3.402815820677972*^9, 
  3.402815821271733*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Mean", " ", "reverting", " ", 
   RowBox[{"speed", " ", ":", " ", "M"}]}], "=", 
  RowBox[{"(", GridBox[{
     {
      SubscriptBox["\[Kappa]", "11"], 
      SubscriptBox["\[Kappa]", "12"]},
     {
      SubscriptBox["\[Kappa]", "21"], 
      SubscriptBox["\[Kappa]", "22"]}
    }], ")"}]}]], "Text",
 CellChangeTimes->{{3.3984941286573133`*^9, 3.3984941804847755`*^9}, {
   3.398498818878528*^9, 3.3984988298002634`*^9}, 3.398498869206009*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Long", " ", "term", " ", 
   RowBox[{"variance", " ", ":", "  ", 
    SubscriptBox["\[CapitalSigma]", "\[Infinity]"]}]}], "=", 
  RowBox[{"(", GridBox[{
     {
      SubscriptBox["\[Theta]", "11"], 
      SubscriptBox["\[Theta]", "12"]},
     {
      SubscriptBox["\[Theta]", "21"], 
      SubscriptBox["\[Theta]", "22"]}
    }], ")"}]}]], "Text",
 CellChangeTimes->{{3.3984942461714344`*^9, 3.398494290202121*^9}, {
  3.398498856690544*^9, 3.3984988666904163`*^9}, {3.3985034158317833`*^9, 
  3.3985034200506144`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"M", " ", "definite", " ", "negative"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{" ", 
  RowBox[{"Q", "  ", "inversible"}]}], "\[IndentingNewLine]", 
 RowBox[{
  SubscriptBox["\[CapitalSigma]", "0"], " ", "definite", " ", 
  "positive"}], "\[IndentingNewLine]", 
 RowBox[{
  SubscriptBox["\[CapitalSigma]", "\[Infinity]"], " ", "definite", " ", 
  "positive"}]}], "Text",
 CellChangeTimes->{{3.3985033705965395`*^9, 3.398503385128069*^9}, {
  3.398503536193469*^9, 3.398503618632552*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[" Asset Returns", "Subsubtitle",
 CellChangeTimes->{{3.3984989088617516`*^9, 3.3984989219709587`*^9}, {
  3.398591771086778*^9, 3.3985917790869317`*^9}, {3.402815879600978*^9, 
  3.4028159025076675`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Vect", "[", 
   FractionBox[
    SubscriptBox["dS", 
     RowBox[{"i", ",", "t"}]], 
    SubscriptBox["S", 
     RowBox[{"i", ",", "t"}]]], "]"}], "=", 
  RowBox[{
   RowBox[{
    SqrtBox[
     SubscriptBox["\[CapitalSigma]", "t"]], 
    SubscriptBox["dZ", "t"]}], " ", "+", 
   RowBox[{"\[Mu]", " ", 
    SubscriptBox["\[CapitalSigma]", "t"], " ", "dt"}]}]}]], "Text",
 CellChangeTimes->{{3.3984989352520385`*^9, 3.398498968548487*^9}, {
  3.3985029207219324`*^9, 3.3985029667399135`*^9}, {3.3985917842745314`*^9, 
  3.398591784555787*^9}, {3.4048234952876873`*^9, 3.404823566509172*^9}, {
  3.4048242876149864`*^9, 3.4048242929120646`*^9}}],

Cell[TextData[{
 "\[Mu] here is useful for the normalisation process where we have E[S] with \
a certain process = ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"E", "[", 
     SuperscriptBox["S", "\[Alpha]"], "]"}], "  ", "with", " ", "a", " ", 
    "different", " ", "process", "  ", "and", " ", "a", " ", "drift", "  "}], 
   TraditionalForm]]]
}], "Text",
 CellChangeTimes->{{3.404824307678257*^9, 3.4048243888688745`*^9}, {
  3.4048255211623526`*^9, 3.404825550929121*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.4048235594932775`*^9, 3.404823560696449*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Covariance  asset - asset volatility", "Subsubtitle",
 CellChangeTimes->{{3.3984989734702992`*^9, 3.3984989943762817`*^9}, {
  3.402815852537958*^9, 3.4028158691164017`*^9}}],

Cell[BoxData[
 RowBox[{
  SubscriptBox["Z", 
   RowBox[{"i", ",", "t"}]], "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Tr", "[", 
     RowBox[{
      SubscriptBox["W", "t"], 
      SuperscriptBox[
       SubscriptBox["R", "i"], "*"]}], "]"}], "+", 
    RowBox[{
     SubscriptBox["B", 
      RowBox[{"i", ",", "t"}]], 
     SqrtBox[
      RowBox[{"1", "-", 
       RowBox[{"Tr", "[", 
        RowBox[{
         SubscriptBox["R", "i"], 
         SuperscriptBox[
          SubscriptBox["R", "i"], "*"]}], "]"}]}]], "   ", "i"}]}], 
   "\[Element]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}]}]}]], "Text",
 CellChangeTimes->{{3.398499276466421*^9, 3.3984993304501047`*^9}, {
  3.3985029999447384`*^9, 3.3985030331808147`*^9}, {3.398503075245253*^9, 
  3.398503082620442*^9}, {3.398503116793192*^9, 3.398503122512088*^9}, {
  3.398513963577774*^9, 3.398514000890752*^9}, {3.4009964740387316`*^9, 
  3.4009964742418604`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"such", " ", "that", "  ", 
   RowBox[{
   "\[LeftDoubleBracketingBar]", "R", "\[RightDoubleBracketingBar]"}]}], 
  "\[LessEqual]", 
  RowBox[{"1", "   ", "with", "  ", 
   SubscriptBox["W", "t"], " ", "et", " ", 
   SubscriptBox["B", "t"], "   ", "independant"}]}]], "Text",
 CellChangeTimes->{{3.3984993670590115`*^9, 3.3984994268863707`*^9}, {
  3.398499460651563*^9, 3.3984994810888014`*^9}, {3.402815910398444*^9, 
  3.4028159229143095`*^9}}],

Cell[BoxData[
 RowBox[{"we", " ", "show", " ", "that", " ", "affinity", " ", "of", " ", 
  "the", " ", "process", " ", "implies", " ", "that", " ", 
  RowBox[{"{", 
   RowBox[{
    SubscriptBox["\[Rho]", "1"], ",", 
    SubscriptBox["\[Rho]", "2"]}], "}"}]}]], "Text",
 CellChangeTimes->{{3.3985030517286396`*^9, 3.398503061526016*^9}, {
  3.3985031501534204`*^9, 3.3985031573723555`*^9}, {3.400306865552802*^9, 
  3.400306891522051*^9}, {3.402815929789441*^9, 3.4028159495398207`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"such", " ", "that", "  ", 
   SubscriptBox["R", "1"]}], "=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SubscriptBox["\[Rho]", "1"], 
        SubscriptBox["\[Rho]", "2"]},
       {"0", "0"}
      }], ")"}], "  ", "et", " ", 
    SubscriptBox["R", "2"]}], "=", 
   RowBox[{"(", GridBox[{
      {"0", "0"},
      {
       SubscriptBox["\[Rho]", "1"], 
       SubscriptBox["\[Rho]", "2"]}
     }], ")"}], " "}]}]], "Text",
 CellChangeTimes->{{3.3985030650105696`*^9, 3.3985030719639187`*^9}, {
  3.3985031357311764`*^9, 3.398503198139024*^9}, {3.402815955711814*^9, 
  3.402815959493137*^9}}],

Cell[" ", "Text",
 CellChangeTimes->{{3.3985176193745675`*^9, 3.3985176205933332`*^9}, {
  3.402815963727593*^9, 3.402815964165101*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Risk Geometry", "Subtitle",
 CellChangeTimes->{{3.400821408375242*^9, 3.400821422688017*^9}, {
  3.402816141074748*^9, 3.40281615499689*^9}}],

Cell["We use Einstein summation convenrtions", "Text",
 CellChangeTimes->{{3.40083829424632*^9, 3.4008383063090515`*^9}, {
  3.4028161622939053`*^9, 3.402816175028525*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"soit", " ", "\[Sigma]"}], "=", 
  SqrtBox["\[CapitalSigma]"]}]], "Text",
 CellChangeTimes->{{3.4008382280887995`*^9, 3.4008382450109997`*^9}}],

Cell[CellGroupData[{

Cell["Underlying 1 Variance : projector P1", "Subsubtitle",
 CellChangeTimes->{{3.4008214858454795`*^9, 3.4008214928612394`*^9}, {
  3.400821636129615*^9, 3.400821636176491*^9}, {3.4008226368519535`*^9, 
  3.4008226606961613`*^9}, {3.402816183825569*^9, 3.4028162337484026`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Var", "[", 
     SubscriptBox["Y", "1"], "]"}], "dt"}], "=", 
   RowBox[{"<", 
    RowBox[{
     SubscriptBox["\[Sigma]", 
      RowBox[{"1", "k"}]], 
     SubscriptBox["dZ", "k"]}]}]}], " ", ",", 
  RowBox[{
   RowBox[{
    SubscriptBox["\[Sigma]", 
     RowBox[{"1", "m"}]], 
    SubscriptBox["dZ", "m"]}], ">=", 
   RowBox[{
    SubscriptBox["\[Sigma]", 
     RowBox[{"1", "k"}]], 
    SubscriptBox["\[Sigma]", 
     RowBox[{"1", "m"}]]}], "<", 
   SubscriptBox["dZ", "k"]}], " ", ",", 
  RowBox[{
   RowBox[{
    SubscriptBox["dZ", "m"], ">=", 
    RowBox[{
     SubscriptBox["\[Sigma]", 
      RowBox[{"1", "k"}]], 
     SubscriptBox["\[Sigma]", 
      RowBox[{"1", "m"}]], 
     SubscriptBox["\[Delta]", "km"], "dt"}]}], "=", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[Sigma]", 
      RowBox[{"1", "k"}]], 
     SubscriptBox["\[Sigma]", 
      RowBox[{"1", "k"}]], "dt"}], "=", 
    RowBox[{
     SubscriptBox["\[CapitalSigma]", "11"], "dt"}]}]}]}]], "Text",
 CellChangeTimes->{{3.4008216126135387`*^9, 3.4008216484423513`*^9}, {
   3.4008217107560477`*^9, 3.4008218052734876`*^9}, {3.400821967651605*^9, 
   3.4008220279652634`*^9}, {3.4008223591434965`*^9, 
   3.4008223690343113`*^9}, {3.4008224633329973`*^9, 
   3.4008225028493805`*^9}, {3.400822642664565*^9, 3.400822666680651*^9}, {
   3.400822697556244*^9, 3.4008227054626455`*^9}, {3.400824017487836*^9, 
   3.4008242165697837`*^9}, {3.4008244561056323`*^9, 
   3.4008245602170067`*^9}, {3.400824601624051*^9, 3.4008246522968993`*^9}, {
   3.400824691766407*^9, 3.400824715876245*^9}, {3.4008343726554017`*^9, 
   3.400834382530591*^9}, 3.400838762458434*^9, 3.4008388049592505`*^9, 
   3.4008388735074415`*^9, {3.4008389065237*^9, 3.4008390316979785`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CoVar", "[", 
     RowBox[{
      SubscriptBox["Y", "1"], ",", 
      SubscriptBox["Y", "2"]}], "]"}], "dt"}], "=", 
   RowBox[{"<", 
    RowBox[{
     SubscriptBox["\[Sigma]", 
      RowBox[{"1", "k"}]], 
     SubscriptBox["dZ", "k"]}]}]}], " ", ",", 
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["\[Sigma]", 
      RowBox[{"2", "m"}]], 
     SubscriptBox["dZ", "m"]}], ">"}], " ", "=", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[Sigma]", 
      RowBox[{"1", "k"}]], 
     SubscriptBox["\[Sigma]", 
      RowBox[{"2", "m"}]], 
     SubscriptBox["\[Delta]", "km"], "dt"}], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Sigma]", 
       RowBox[{"1", "k"}]], 
      SubscriptBox["\[Sigma]", 
       RowBox[{"2", "k"}]], "dt"}], "=", 
     RowBox[{
      SubscriptBox["\[CapitalSigma]", "12"], "dt"}]}]}]}]}]], "Text",
 CellChangeTimes->{{3.400838796662216*^9, 3.4008388756949835`*^9}, {
  3.400839058120361*^9, 3.400839321531668*^9}, {3.4008393538447886`*^9, 
  3.400839374907693*^9}, {3.400842752066283*^9, 3.400842764254017*^9}, {
  3.400842799301565*^9, 3.4008428330990887`*^9}, {3.4053283309535832`*^9, 
  3.4053284812699313`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Variance of Underlying 1 Variance  : ", "Subsubtitle",
 CellChangeTimes->{{3.4008214858454795`*^9, 3.4008214928612394`*^9}, {
  3.400821636129615*^9, 3.400821636176491*^9}, {3.4008226368519535`*^9, 
  3.4008226606961613`*^9}, {3.400824250101677*^9, 3.4008242843210845`*^9}, {
  3.4028162426860743`*^9, 3.4028162533112783`*^9}}],

Cell[TextData[{
 "we see that it does not work if we do not symmetrize ",
 Cell[BoxData[
  SubscriptBox["\[CapitalSigma]", "ij"]],
  CellChangeTimes->{{3.400838249901718*^9, 3.4008382878868227`*^9}}],
 " dynamics : we can not get ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox["\[Sigma]", 
    RowBox[{"1", "m"}]], 
   SubscriptBox["\[Sigma]", 
    RowBox[{"1", "m"}]]}]],
  CellChangeTimes->{{3.4008396403346643`*^9, 3.4008397364458847`*^9}}],
 " in factor"
}], "Text",
 CellChangeTimes->{
  3.400839740180331*^9, {3.400839920277539*^9, 3.4008399380122547`*^9}, {
   3.400842547437354*^9, 3.4008425566719065`*^9}, {3.400842655595681*^9, 
   3.400842666611518*^9}, {3.400842698862137*^9, 3.400842710737365*^9}, {
   3.402816268655322*^9, 3.4028163264220567`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"on", " ", "a", " ", 
   SubscriptBox["\[CapitalSigma]", "ij"]}], "=", 
  RowBox[{
   SubscriptBox["\[Sigma]", "ik"], 
   SubscriptBox["\[Sigma]", "jk"]}]}]], "Text",
 CellChangeTimes->{{3.400838249901718*^9, 3.4008382878868227`*^9}}],

Cell[BoxData[
 RowBox[{
  SubscriptBox["dY", "i"], "=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", "..", ")"}], "dt"}], "+", 
   RowBox[{
    SubscriptBox["\[Sigma]", "ik"], 
    SubscriptBox["dZ", "k"]}]}]}]], "Text",
 CellChangeTimes->{{3.4008383135591908`*^9, 3.4008383586538067`*^9}}],

Cell[BoxData[
 RowBox[{
  SubscriptBox["d\[CapitalSigma]", "jk"], "=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", "..", ")"}], "dt"}], "+", 
   RowBox[{
    SubscriptBox["\[Sigma]", "jm"], 
    SubscriptBox["dW", "mn"], 
    SubscriptBox["Q", "nk"]}], "+", 
   RowBox[{
    SubscriptBox["Q", "mj"], 
    SubscriptBox["dW", "nm"], 
    SubscriptBox["\[Sigma]", "kn"]}]}]}]], "Text",
 CellChangeTimes->{{3.4008383660914493`*^9, 3.400838385763702*^9}, {
  3.4008384164205403`*^9, 3.4008385703766212`*^9}, {3.4008386054554195`*^9, 
  3.400838624174529*^9}, {3.4008400271858416`*^9, 3.4008400295765123`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"<", 
   SubscriptBox["dZ", "k"]}], " ", ",", 
  RowBox[{
   RowBox[{
    SubscriptBox["dW", "mn"], ">"}], " ", "=", 
   RowBox[{
    RowBox[{
     SubscriptBox["R", 
      RowBox[{"k", ",", "mn"}]], "dt"}], "=", 
    RowBox[{
     SubscriptBox["\[Delta]", "km"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[Delta]", 
         RowBox[{"n", " ", "1"}]], 
        SubscriptBox["\[Rho]", "1"]}], "+", 
       RowBox[{
        SubscriptBox["\[Delta]", "n2"], 
        SubscriptBox["\[Rho]", "2"]}]}], ")"}], " ", "dt"}]}]}]}]], "Text",
 CellChangeTimes->{{3.4008386772692986`*^9, 3.4008387323797317`*^9}, {
  3.4008388614290843`*^9, 3.4008388629447384`*^9}, {3.4008438065865297`*^9, 
  3.4008438838223877`*^9}, {3.400843925260683*^9, 3.4008439256981916`*^9}}],

Cell["donc ", "Text",
 CellChangeTimes->{{3.4008430980573015`*^9, 3.4008430991198215`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Var", "[", 
     SubscriptBox["\[CapitalSigma]", "11"], "]"}], "dt"}], "=", 
   RowBox[{"<", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Sigma]", 
       RowBox[{"1", "m"}]], 
      SubscriptBox["dW", "mn"], 
      SubscriptBox["Q", "n1"]}], "+", 
     RowBox[{
      SubscriptBox["Q", "m1"], 
      SubscriptBox["dW", "nm"], 
      SubscriptBox["\[Sigma]", 
       RowBox[{"1", "n"}]]}]}]}]}], " ", ",", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["\[Sigma]", 
       RowBox[{"1", "u"}]], 
      SubscriptBox["dW", "uv"], 
      SubscriptBox["Q", "v1"]}], "+", 
     RowBox[{
      SubscriptBox["Q", "u1"], 
      SubscriptBox["dW", "vu"], 
      SubscriptBox["\[Sigma]", 
       RowBox[{"1", "v"}]]}]}], ">"}], " ", "=", "\[IndentingNewLine]", 
   RowBox[{"<", 
    RowBox[{
     SubscriptBox["\[Sigma]", 
      RowBox[{"1", "m"}]], 
     SubscriptBox["dW", "mn"], 
     SubscriptBox["Q", "n1"]}]}]}], " ", ",", 
  RowBox[{
   RowBox[{
    SubscriptBox["\[Sigma]", 
     RowBox[{"1", "u"}]], 
    SubscriptBox["dW", "uv"], 
    SubscriptBox["Q", "v1"]}], ">", 
   RowBox[{"+", "\[IndentingNewLine]", 
    RowBox[{"<", 
     RowBox[{
      SubscriptBox["\[Sigma]", 
       RowBox[{"1", "m"}]], 
      SubscriptBox["dW", "mn"], 
      SubscriptBox["Q", "n1"]}]}]}]}], " ", ",", 
  RowBox[{
   RowBox[{
    SubscriptBox["Q", "u1"], 
    SubscriptBox["dW", "vu"], 
    SubscriptBox["\[Sigma]", 
     RowBox[{"1", "v"}]]}], ">", 
   RowBox[{"+", "\[IndentingNewLine]", 
    RowBox[{"<", 
     RowBox[{
      SubscriptBox["Q", "m1"], 
      SubscriptBox["dW", "nm"], 
      SubscriptBox["\[Sigma]", 
       RowBox[{"1", "n"}]]}]}]}]}], " ", ",", 
  RowBox[{
   RowBox[{
    SubscriptBox["\[Sigma]", 
     RowBox[{"1", "u"}]], 
    SubscriptBox["dW", "uv"], 
    SubscriptBox["Q", "v1"]}], ">", 
   RowBox[{"+", "\[IndentingNewLine]", 
    RowBox[{"<", 
     RowBox[{
      SubscriptBox["Q", "m1"], 
      SubscriptBox["dW", "nm"], 
      SubscriptBox["\[Sigma]", 
       RowBox[{"1", "n"}]]}]}]}]}], " ", ",", 
  RowBox[{
   RowBox[{
    SubscriptBox["Q", "u1"], 
    SubscriptBox["dW", "vu"], 
    SubscriptBox["\[Sigma]", 
     RowBox[{"1", "v"}]]}], ">"}]}]], "Text",
 CellChangeTimes->{{3.400838796662216*^9, 3.4008388756949835`*^9}, {
  3.400839058120361*^9, 3.400839321531668*^9}, {3.4008393538447886`*^9, 
  3.400839374907693*^9}, {3.400842752066283*^9, 3.400842764254017*^9}, {
  3.400842799301565*^9, 3.4008428330990887`*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"=", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Sigma]", 
       RowBox[{"1", "m"}]], 
      SubscriptBox["Q", "n1"], 
      SubscriptBox["\[Sigma]", 
       RowBox[{"1", "u"}]], 
      SubscriptBox["Q", "v1"]}], "<", 
     SubscriptBox["dW", "mn"]}]}], " ", ",", 
   RowBox[{
    SubscriptBox["dW", "uv"], ">", 
    RowBox[{
     RowBox[{"+", 
      SubscriptBox["\[Sigma]", 
       RowBox[{"1", "m"}]]}], 
     SubscriptBox["Q", "n1"], 
     SubscriptBox["Q", "u1"], 
     SubscriptBox["\[Sigma]", 
      RowBox[{"1", "v"}]]}], "<", 
    SubscriptBox["dW", "mn"]}], " ", ",", 
   RowBox[{
    SubscriptBox["dW", "vu"], ">", 
    RowBox[{
     RowBox[{"+", 
      SubscriptBox["Q", "m1"]}], 
     SubscriptBox["\[Sigma]", 
      RowBox[{"1", "n"}]], " ", 
     SubscriptBox["\[Sigma]", 
      RowBox[{"1", "u"}]], 
     SubscriptBox["Q", "v1"]}], "<", 
    SubscriptBox["dW", "nm"]}], ",", 
   RowBox[{
    SubscriptBox["dW", "uv"], ">", 
    RowBox[{
     RowBox[{"+", 
      SubscriptBox["Q", "m1"]}], 
     SubscriptBox["\[Sigma]", 
      RowBox[{"1", "n"}]], 
     SubscriptBox["Q", "u1"], 
     SubscriptBox["\[Sigma]", 
      RowBox[{"1", "v"}]]}], "<", 
    SubscriptBox["dW", "nm"]}], " ", ",", 
   RowBox[{
    SubscriptBox["dW", "vu"], ">"}]}]}]], "Text",
 CellChangeTimes->{{3.400839384282873*^9, 3.4008394962537727`*^9}, {
  3.400842579625472*^9, 3.4008425931413565`*^9}, {3.400842853255726*^9, 
  3.400842881115636*^9}}],

Cell[BoxData[
 RowBox[{"=", 
  RowBox[{
   RowBox[{
    SubscriptBox["\[Sigma]", 
     RowBox[{"1", "m"}]], 
    SubscriptBox["Q", "n1"], 
    SubscriptBox["\[Sigma]", 
     RowBox[{"1", "u"}]], 
    SubscriptBox["Q", "v1"], 
    SubscriptBox["\[Delta]", "mu"], 
    SubscriptBox["\[Delta]", "nv"]}], "+", "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["\[Sigma]", 
     RowBox[{"1", "m"}]], 
    SubscriptBox["Q", "n1"], 
    SubscriptBox["Q", "u1"], 
    SubscriptBox["\[Sigma]", 
     RowBox[{"1", "v"}]], 
    SubscriptBox["\[Delta]", "mv"], 
    SubscriptBox["\[Delta]", "nu"]}], "+", "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["Q", "m1"], 
    SubscriptBox["\[Sigma]", 
     RowBox[{"1", "n"}]], " ", 
    SubscriptBox["\[Sigma]", 
     RowBox[{"1", "u"}]], 
    SubscriptBox["Q", "v1"], 
    SubscriptBox["\[Delta]", "nu"], 
    SubscriptBox["\[Delta]", "mv"]}], "+", "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["Q", "m1"], 
    SubscriptBox["\[Sigma]", 
     RowBox[{"1", "n"}]], 
    SubscriptBox["Q", "u1"], 
    SubscriptBox["\[Sigma]", 
     RowBox[{"1", "v"}]], 
    SubscriptBox["\[Delta]", "nv"], 
    SubscriptBox["\[Delta]", "mu"]}]}]}]], "Text",
 CellChangeTimes->{{3.4008395005351048`*^9, 3.4008396326313915`*^9}, {
  3.400842906584875*^9, 3.4008429297103186`*^9}}],

Cell[BoxData[
 RowBox[{"=", 
  RowBox[{
   RowBox[{
    SubscriptBox["\[Sigma]", 
     RowBox[{"1", "m"}]], 
    SubscriptBox["Q", "n1"], 
    SubscriptBox["\[Sigma]", 
     RowBox[{"1", "m"}]], 
    SubscriptBox["Q", "n1"]}], "+", "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["\[Sigma]", 
     RowBox[{"1", "m"}]], 
    SubscriptBox["Q", "n1"], 
    SubscriptBox["Q", "n1"], 
    SubscriptBox["\[Sigma]", 
     RowBox[{"1", "m"}]]}], "+", "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["Q", "m1"], 
    SubscriptBox["\[Sigma]", 
     RowBox[{"1", "n"}]], " ", 
    SubscriptBox["\[Sigma]", 
     RowBox[{"1", "n"}]], 
    SubscriptBox["Q", "m1"]}], "+", "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["Q", "m1"], 
    SubscriptBox["\[Sigma]", 
     RowBox[{"1", "n"}]], 
    SubscriptBox["Q", "m1"], 
    SubscriptBox["\[Sigma]", 
     RowBox[{"1", "n"}]]}]}]}]], "Text",
 CellChangeTimes->{{3.4008396403346643`*^9, 3.4008397364458847`*^9}, {
  3.400842942101182*^9, 3.4008429652266254`*^9}}],

Cell[BoxData[
 RowBox[{"=", 
  RowBox[{
   RowBox[{
    SubscriptBox["\[Sigma]", 
     RowBox[{"1", "m"}]], 
    SubscriptBox["\[Sigma]", 
     RowBox[{"1", "m"}]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["Q", "n1"], 
       SubscriptBox["Q", "n1"]}], "+", 
      RowBox[{
       SubscriptBox["Q", "n1"], 
       SubscriptBox["Q", "n1"]}], "+", 
      RowBox[{
       SubscriptBox["Q", "m1"], 
       SubscriptBox["Q", "m1"]}], "+", 
      RowBox[{
       SubscriptBox["Q", "m1"], 
       SubscriptBox["Q", "m1"]}]}], ")"}]}], "=", 
   RowBox[{"4", 
    SubscriptBox["\[CapitalSigma]", "11"], 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       SubscriptBox["Q", "11"], "2"], "+", 
      SuperscriptBox[
       SubscriptBox["Q", "12"], "2"]}], ")"}]}]}]}]], "Text",
 CellChangeTimes->{{3.4008429708517337`*^9, 3.4008430327435474`*^9}, {
  3.4008431215890026`*^9, 3.400843163902315*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Covariance entre  l' underlying i  et la variance de  l' underlying 1 : \
\>", "Subsubtitle",
 CellChangeTimes->{{3.4008214858454795`*^9, 3.4008214928612394`*^9}, {
  3.400821636129615*^9, 3.400821636176491*^9}, {3.4008226368519535`*^9, 
  3.4008226606961613`*^9}, {3.400824250101677*^9, 3.4008242843210845`*^9}, {
  3.4008364576954336`*^9, 3.400836484742828*^9}, {3.4008446724283457`*^9, 
  3.40084468981975*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Covar", "[", 
     RowBox[{
      SubscriptBox["Y", "i"], ",", 
      SubscriptBox["\[CapitalSigma]", "11"]}], "]"}], " ", "dt"}], " ", "=", 
   RowBox[{"<", 
    RowBox[{
     SubscriptBox["\[Sigma]", "ik"], 
     SubscriptBox["dZ", "k"]}]}]}], " ", ",", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["\[Sigma]", 
       RowBox[{"1", "u"}]], 
      SubscriptBox["dW", "uv"], 
      SubscriptBox["Q", "v1"]}], "+", 
     RowBox[{
      SubscriptBox["Q", "u1"], 
      SubscriptBox["dW", "vu"], 
      SubscriptBox["\[Sigma]", 
       RowBox[{"1", "v"}]]}]}], ">"}], " ", "=", "\[IndentingNewLine]", 
   RowBox[{"<", 
    RowBox[{
     SubscriptBox["\[Sigma]", "ik"], 
     SubscriptBox["dZ", "k"]}]}]}], " ", ",", 
  RowBox[{
   RowBox[{
    SubscriptBox["\[Sigma]", 
     RowBox[{"1", "u"}]], 
    SubscriptBox["dW", "uv"], 
    SubscriptBox["Q", "v1"]}], ">", 
   RowBox[{"+", 
    RowBox[{"<", 
     RowBox[{
      SubscriptBox["\[Sigma]", "ik"], 
      SubscriptBox["dZ", "k"]}]}]}]}], " ", ",", 
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["Q", "u1"], 
     SubscriptBox["dW", "vu"], 
     SubscriptBox["\[Sigma]", 
      RowBox[{"1", "v"}]]}], ">"}], " ", "=", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[Sigma]", "ik"], 
     SubscriptBox["\[Sigma]", 
      RowBox[{"1", "u"}]], 
     SubscriptBox["Q", "v1"]}], "<", 
    SubscriptBox["dZ", "k"]}]}], " ", ",", 
  RowBox[{
   SubscriptBox["dW", "uv"], ">", 
   RowBox[{
    RowBox[{"+", 
     SubscriptBox["\[Sigma]", "ik"]}], 
    SubscriptBox["Q", "u1"], 
    SubscriptBox["\[Sigma]", 
     RowBox[{"1", "v"}]]}], "<", 
   SubscriptBox["dZ", "k"]}], " ", ",", 
  RowBox[{
   RowBox[{
    SubscriptBox["dW", "vu"], ">"}], " ", "=", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["\[Sigma]", "ik"], 
      SubscriptBox["\[Sigma]", 
       RowBox[{"1", "u"}]], 
      SubscriptBox["Q", "v1"], 
      SubscriptBox["R", 
       RowBox[{"k", ",", "uv"}]]}], "+", 
     RowBox[{
      SubscriptBox["\[Sigma]", "ik"], 
      SubscriptBox["Q", "u1"], 
      SubscriptBox["\[Sigma]", 
       RowBox[{"1", "v"}]], 
      SubscriptBox["R", 
       RowBox[{"k", ",", "v", ",", "u"}]]}]}], " ", "="}]}]}]], "Text",
 CellChangeTimes->{{3.400838822537713*^9, 3.4008388445381355`*^9}, 
   3.4008388776012697`*^9, {3.4008433348118467`*^9, 3.4008435129246416`*^9}, {
   3.4008444755914025`*^9, 3.4008444762945595`*^9}}],

Cell[CellGroupData[{

Cell["Affinit\[EAcute]", "Subsubsection",
 CellChangeTimes->{{3.4008214858454795`*^9, 3.4008214928612394`*^9}, {
  3.400821636129615*^9, 3.400821636176491*^9}, {3.4008226368519535`*^9, 
  3.4008226606961613`*^9}, {3.4015144647923794`*^9, 3.401514466839294*^9}}],

Cell[BoxData[
 RowBox[{"Il", " ", "est", " ", "necessaire", " ", "que", " ", "l", " ", 
  "covariance", " ", "entre", " ", 
  SubscriptBox["Y", "i"], " ", "et", " ", 
  SubscriptBox["\[CapitalSigma]", "11"], " ", "soit", " ", "lineaire", " ", 
  "en", " ", 
  SubscriptBox["\[CapitalSigma]", "11"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"et", " ", "ou", " ", 
     SubscriptBox["Y", "i"], " ", "mais", " ", "ici"}], " ", ",", " ", 
    RowBox[{"cela", " ", 
     RowBox[{"n", "'"}], "apparait", " ", "pas"}]}], ")"}]}]], "Text",
 CellChangeTimes->{{3.40151452862173*^9, 3.401514630139304*^9}}],

Cell["donc il faut que ", "Text",
 CellChangeTimes->{{3.401514650874077*^9, 3.4015146568116913`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["\[Sigma]", "ik"], 
   SubscriptBox["\[Sigma]", 
    RowBox[{"1", "u"}]], 
   SubscriptBox["Q", "v1"], 
   SubscriptBox["R", 
    RowBox[{"k", ",", "uv"}]]}], "+", 
  RowBox[{
   SubscriptBox["\[Sigma]", "ik"], 
   SubscriptBox["Q", "u1"], 
   SubscriptBox["\[Sigma]", 
    RowBox[{"1", "v"}]], 
   SubscriptBox["R", 
    RowBox[{"k", ",", "v", ",", "u"}]], "  ", "soit", " ", "une", " ", 
   "fonction", " ", "de", " ", 
   SubscriptBox["\[CapitalSigma]", 
    RowBox[{"1", "i"}]]}]}]], "Text",
 CellChangeTimes->{{3.401514676468319*^9, 3.401514691952991*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"c", "'"}], "est", " ", "a", " ", "dire", " ", 
   SubscriptBox["Q", "v1"], 
   SubscriptBox["R", 
    RowBox[{"k", ",", "uv"}]], " ", "doit", " ", "etre", " ", "null", " ", 
   "pour", " ", "k", " ", "et", " ", "u", " ", "different"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"et", " ", "en", " ", "plus", " ", "pour", " ", "k"}], " ", "=", 
   "u"}], " ", ",", " ", 
  RowBox[{
  "on", " ", "doit", " ", "avoir", " ", "le", " ", "meme", " ", "coefficient",
    " ", "quelque", " ", "soit", " ", "u"}], " ", ",", " ", 
  RowBox[{"appelons", " ", "le", " ", 
   SubscriptBox["\[Rho]", "k"]}]}]}], "Text",
 CellChangeTimes->{{3.401515070507134*^9, 3.401515159727597*^9}, {
   3.4015153214025764`*^9, 3.4015153468561897`*^9}, 3.4015154529988527`*^9, {
   3.4015155053748584`*^9, 3.4015155648134995`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Covariance", "Subsubsection",
 CellChangeTimes->{{3.4015156248146515`*^9, 3.4015156270490694`*^9}}],

Cell["donc ", "Text",
 CellChangeTimes->{{3.40084353237814*^9, 3.4008435332687817`*^9}}],

Cell[BoxData[
 RowBox[{"=", 
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["\[Sigma]", "ik"], 
     SubscriptBox["\[Sigma]", 
      RowBox[{"1", "u"}]], 
     SubscriptBox["Q", "v1"], 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["\[Delta]", "ku"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubscriptBox["\[Delta]", 
           RowBox[{"v", " ", "1"}]], 
          SubscriptBox["\[Rho]", "1"]}], "+", 
         RowBox[{
          SubscriptBox["\[Delta]", "v2"], 
          SubscriptBox["\[Rho]", "2"]}]}], ")"}]}], ")"}]}], "+", 
    RowBox[{
     SubscriptBox["\[Sigma]", "ik"], 
     SubscriptBox["Q", "u1"], 
     SubscriptBox["\[Sigma]", 
      RowBox[{"1", "v"}]], 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["\[Delta]", "kv"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubscriptBox["\[Delta]", 
           RowBox[{"u", " ", "1"}]], 
          SubscriptBox["\[Rho]", "1"]}], "+", 
         RowBox[{
          SubscriptBox["\[Delta]", "u2"], 
          SubscriptBox["\[Rho]", "2"]}]}], ")"}]}], ")"}]}]}], "=", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[Sigma]", "ik"], 
     SubscriptBox["\[Sigma]", 
      RowBox[{"1", "u"}]], 
     SubscriptBox["Q", "v1"], 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["\[Delta]", "ku"], 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["\[Delta]", 
          RowBox[{"v", " ", "1"}]], 
         SubscriptBox["\[Rho]", "1"]}], ")"}]}], ")"}]}], "+", 
    "\[IndentingNewLine]", 
    RowBox[{
     SubscriptBox["\[Sigma]", "ik"], 
     SubscriptBox["\[Sigma]", 
      RowBox[{"1", "u"}]], 
     SubscriptBox["Q", "v1"], 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["\[Delta]", "ku"], 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["\[Delta]", "v2"], 
         SubscriptBox["\[Rho]", "2"]}], ")"}]}], ")"}]}], "+", 
    "\[IndentingNewLine]", 
    RowBox[{
     SubscriptBox["\[Sigma]", "ik"], 
     SubscriptBox["Q", "u1"], 
     SubscriptBox["\[Sigma]", 
      RowBox[{"1", "v"}]], 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["\[Delta]", "kv"], 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["\[Delta]", 
          RowBox[{"u", " ", "1"}]], 
         SubscriptBox["\[Rho]", "1"]}], ")"}]}], ")"}]}], "+", 
    "\[IndentingNewLine]", 
    RowBox[{
     SubscriptBox["\[Sigma]", "ik"], 
     SubscriptBox["Q", "u1"], 
     SubscriptBox["\[Sigma]", 
      RowBox[{"1", "v"}]], 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["\[Delta]", "kv"], 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["\[Delta]", "u2"], 
         SubscriptBox["\[Rho]", "2"]}], ")"}]}], ")"}]}]}]}]}]], "Text",
 CellChangeTimes->{{3.400843933792097*^9, 3.400844022918808*^9}, {
  3.4008440574194703`*^9, 3.4008441309677577`*^9}}],

Cell[BoxData[
 RowBox[{"=", 
  RowBox[{
   RowBox[{
    SubscriptBox["\[Sigma]", "ik"], 
    SubscriptBox["\[Sigma]", 
     RowBox[{"1", "k"}]], 
    SubscriptBox["Q", "11"], 
    SubscriptBox["\[Rho]", "1"]}], "+", "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["\[Sigma]", "ik"], 
    SubscriptBox["\[Sigma]", 
     RowBox[{"1", "k"}]], 
    SubscriptBox["Q", "21"], 
    SubscriptBox["\[Rho]", "2"]}], "+", "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["\[Sigma]", "ik"], 
    SubscriptBox["Q", "11"], 
    SubscriptBox["\[Sigma]", 
     RowBox[{"1", "k"}]], 
    SubscriptBox["\[Rho]", "1"]}], "+", "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["\[Sigma]", "ik"], 
    SubscriptBox["Q", "21"], 
    SubscriptBox["\[Sigma]", 
     RowBox[{"1", "k"}]], 
    SubscriptBox["\[Rho]", "2"]}]}]}]], "Text",
 CellChangeTimes->{{3.4008441378741403`*^9, 3.400844286651869*^9}}],

Cell[BoxData[
 RowBox[{"=", 
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["\[CapitalSigma]", 
      RowBox[{"1", "i"}]], 
     SubscriptBox["Q", "11"], 
     SubscriptBox["\[Rho]", "1"]}], "+", 
    RowBox[{
     SubscriptBox["\[CapitalSigma]", 
      RowBox[{"1", "i"}]], 
     SubscriptBox["Q", "21"], 
     SubscriptBox["\[Rho]", "2"]}], "+", 
    RowBox[{
     SubscriptBox["\[CapitalSigma]", 
      RowBox[{"1", "i"}]], 
     SubscriptBox["Q", "11"], 
     SubscriptBox["\[Rho]", "1"]}], "+", 
    RowBox[{
     SubscriptBox["\[CapitalSigma]", 
      RowBox[{"1", "i"}]], 
     SubscriptBox["Q", "21"], 
     SubscriptBox["\[Rho]", "2"]}]}], "=", "\[IndentingNewLine]", 
   RowBox[{"2", 
    SubscriptBox["\[CapitalSigma]", 
     RowBox[{"1", "i"}]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["Q", "11"], 
       SubscriptBox["\[Rho]", "1"]}], "+", 
      RowBox[{
       SubscriptBox["Q", "21"], 
       SubscriptBox["\[Rho]", "2"]}]}], ")"}]}]}]}]], "Text",
 CellChangeTimes->{{3.400844306278753*^9, 3.400844430103139*^9}, {
  3.4008444876388173`*^9, 3.40084453145328*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Correspondance Heston / BiHeston (Risque)", "Subsubtitle",
 CellChangeTimes->{{3.4008465228470354`*^9, 3.400846541456767*^9}, {
  3.4008475314914007`*^9, 3.400847535272723*^9}}],

Cell[BoxData[
 RowBox[{
  SubscriptBox["dY", "1"], "=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", "..", ")"}], "dt"}], "+", 
   RowBox[{
    SqrtBox[
     SubscriptBox["\[CapitalSigma]", "1"]], 
    SubscriptBox["dP", "1"]}]}]}]], "Text",
 CellChangeTimes->{{3.400846684318885*^9, 3.4008467351323605`*^9}, {
  3.4008469414175715`*^9, 3.4008469503239927`*^9}}],

Cell[BoxData[
 RowBox[{
  SubscriptBox["d\[CapitalSigma]", "1"], " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"(", "..", ")"}], "dt"}], "+", 
   RowBox[{
    SubscriptBox["\[Nu]", "1"], 
    SqrtBox[
     SubscriptBox["\[CapitalSigma]", "1"]], 
    SubscriptBox["dQ", "1"]}]}]}]], "Text",
 CellChangeTimes->{{3.400846744148159*^9, 3.4008467834301634`*^9}}],

Cell["On a donc les equations suivantes : ", "Text",
 CellChangeTimes->{{3.400846648943206*^9, 3.400846658209009*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Var", "[", 
   SubscriptBox["dY", "1"], "]"}], "=", 
  RowBox[{
   SubscriptBox["\[CapitalSigma]", "1"], " ", "dt"}]}]], "Text",
 CellChangeTimes->{{3.4008467931491*^9, 3.4008468339780087`*^9}, 
   3.4008468925260077`*^9}],

Cell["donc c' est la meme normalization de la vol", "Text",
 CellChangeTimes->{{3.40084686007226*^9, 3.400846872650626*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Var", "[", 
   SubscriptBox["d\[CapitalSigma]", "1"], " ", "]"}], "=", 
  RowBox[{
   SuperscriptBox[
    SubscriptBox["\[Nu]", "1"], "2"], 
   SubscriptBox["\[CapitalSigma]", "1"], "dt"}]}]], "Text",
 CellChangeTimes->{{3.4008468775100946`*^9, 3.400846928261069*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Covar", "[", 
   RowBox[{
    SubscriptBox["dY", "1"], ",", 
    SubscriptBox["d\[CapitalSigma]", "1"]}], "]"}], "=", 
  RowBox[{
   SubscriptBox["\[Rho]", "s1"], 
   SubscriptBox["\[Nu]", "1"], 
   SubscriptBox["\[CapitalSigma]", "1"]}]}]], "Text",
 CellChangeTimes->{{3.400846931479881*^9, 3.4008470137783356`*^9}, 
   3.4008470771389275`*^9}],

Cell["on a donc ", "Text",
 CellChangeTimes->{{3.400847041513243*^9, 3.4008470461539574`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   SubscriptBox["\[Rho]", "s1"], 
   SubscriptBox["\[Nu]", "1"]}], "=", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["Q", "11"], 
     SubscriptBox["\[Rho]", "1"]}], "+", 
    RowBox[{
     SubscriptBox["Q", "21"], 
     SubscriptBox["\[Rho]", "2"]}]}], "2"]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["\[Rho]", "s2"], 
   SubscriptBox["\[Nu]", "2"]}], "=", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["Q", "12"], 
     SubscriptBox["\[Rho]", "1"]}], "+", 
    RowBox[{
     SubscriptBox["Q", "22"], 
     SubscriptBox["\[Rho]", "2"]}]}], "2"]}]}], "Text",
 CellChangeTimes->{{3.400847063576167*^9, 3.4008470868734894`*^9}, {
  3.400847303783904*^9, 3.4008473839573183`*^9}, {3.4008537798144913`*^9, 
  3.4008537854552245`*^9}}],

Cell[BoxData[{
 RowBox[{
  FractionBox[
   SuperscriptBox[
    SubscriptBox["\[Nu]", "1"], "2"], "4"], "=", 
  RowBox[{
   SuperscriptBox[
    SubscriptBox["Q", "11"], "2"], "+", 
   SuperscriptBox[
    SubscriptBox["Q", "21"], "2"]}]}], "\[IndentingNewLine]", 
 RowBox[{
  FractionBox[
   SuperscriptBox[
    SubscriptBox["\[Nu]", "2"], "2"], "4"], "=", 
  RowBox[{
   SuperscriptBox[
    SubscriptBox["Q", "12"], "2"], "+", 
   SuperscriptBox[
    SubscriptBox["Q", "22"], "2"]}]}]}], "Text",
 CellChangeTimes->{{3.40084745097423*^9, 3.4008474918968906`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Correspondance Heston / BiHeston (Drift)", "Subsubtitle",
 CellChangeTimes->{{3.4008465228470354`*^9, 3.400846541456767*^9}, {
  3.4008475314914007`*^9, 3.400847547288579*^9}}],

Cell["On a ", "Text",
 CellChangeTimes->{{3.4008480980491533`*^9, 3.400848099439805*^9}}],

Cell[CellGroupData[{

Cell["dans le cas ou on utilise \[Beta]", "Subsubsection",
 CellChangeTimes->{{3.4059436385207367`*^9, 3.405943650067833*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CapitalOmega]", " ", 
   SuperscriptBox["\[CapitalOmega]", "*"]}], "=", 
  RowBox[{
   RowBox[{"\[Beta]", " ", 
    SuperscriptBox["Q", "*"], "Q"}], "=", 
   RowBox[{"\[Beta]", " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       SubscriptBox["Q", "11"], "2"], "+", 
      SuperscriptBox[
       SubscriptBox["Q", "21"], "2"]}], ")"}]}]}]}]], "Text",
 CellChangeTimes->{{3.40084810490866*^9, 3.4008482031292963`*^9}}],

Cell[BoxData[
 RowBox[{"le", " ", "drift", " ", "de", " ", 
  SubscriptBox["d\[CapitalSigma]", "11"], " ", 
  RowBox[{"est", " ", ":", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[Beta]", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["Q", "11"], "2"], "+", 
         SuperscriptBox[
          SubscriptBox["Q", "21"], "2"]}], ")"}]}], " ", "+", 
      RowBox[{"2", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubscriptBox["M", "11"], 
          SubscriptBox["\[CapitalSigma]", "11"]}], "+", 
         RowBox[{
          SubscriptBox["M", "21"], 
          SubscriptBox["\[CapitalSigma]", "12"]}]}], ")"}]}]}], ")"}], 
    "dt"}]}]}]], "Text",
 CellChangeTimes->{{3.4008487810153913`*^9, 3.4008488733921647`*^9}, {
  3.4008493287915335`*^9, 3.400849330557192*^9}}],

Cell[BoxData[
 RowBox[{"celui", " ", "de", " ", 
  SubscriptBox["d\[CapitalSigma]", "1"], " ", "est", " ", 
  SubscriptBox["\[Lambda]", "1"], 
  RowBox[{"(", 
   RowBox[{
    SubscriptBox["\[CapitalSigma]", "\[Infinity]1"], "-", 
    SubscriptBox["\[CapitalSigma]", "1"]}], ")"}], "dt"}]], "Text",
 CellChangeTimes->{{3.4008493601358852`*^9, 3.4008494196682777`*^9}}],

Cell[BoxData[
 RowBox[{"le", " ", "drift", " ", "de", " ", 
  SubscriptBox["d\[CapitalSigma]", "22"], " ", 
  RowBox[{"est", " ", ":", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[Beta]", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["Q", "12"], "2"], "+", 
         SuperscriptBox[
          SubscriptBox["Q", "22"], "2"]}], ")"}]}], " ", "+", 
      RowBox[{"2", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubscriptBox["M", "22"], 
          SubscriptBox["\[CapitalSigma]", "22"]}], "+", 
         RowBox[{
          SubscriptBox["M", "12"], 
          SubscriptBox["\[CapitalSigma]", "21"]}]}], ")"}]}]}], ")"}], 
    "dt"}]}]}]], "Text",
 CellChangeTimes->{{3.4008487810153913`*^9, 3.4008488733921647`*^9}, {
  3.4008493287915335`*^9, 3.400849330557192*^9}, {3.4059435413626213`*^9, 
  3.405943579222723*^9}}],

Cell[BoxData[
 RowBox[{"celui", " ", "de", " ", 
  SubscriptBox["d\[CapitalSigma]", "2"], " ", "est", " ", 
  SubscriptBox["\[Lambda]", "2"], 
  RowBox[{"(", 
   RowBox[{
    SubscriptBox["\[CapitalSigma]", "\[Infinity]2"], "-", 
    SubscriptBox["\[CapitalSigma]", "2"]}], ")"}], "dt"}]], "Text",
 CellChangeTimes->{{3.4008493601358852`*^9, 3.4008494196682777`*^9}, {
  3.4059435846603274`*^9, 3.405943595566787*^9}}],

Cell["pour le dimension 1 on a donc  les equations :", "Text",
 CellChangeTimes->{{3.4008493471825113`*^9, 3.400849353041999*^9}, {
  3.4086810785063825`*^9, 3.408681099678664*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]", " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       SubscriptBox["Q", "11"], "2"], "+", 
      SuperscriptBox[
       SubscriptBox["Q", "21"], "2"]}], ")"}]}], " ", "+", 
   RowBox[{"2", 
    SubscriptBox["M", "21"], 
    SubscriptBox["\[CapitalSigma]", "12"]}]}], " ", "=", " ", 
  RowBox[{
   SubscriptBox["\[Lambda]", "1"], 
   SubscriptBox["\[CapitalSigma]", "\[Infinity]1"]}]}]], "Text",
 CellChangeTimes->{{3.4008494513251357`*^9, 3.400849475138093*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"2", 
   SubscriptBox["M", "11"]}], "=", 
  RowBox[{"-", 
   SubscriptBox["\[Lambda]", "1"]}]}]], "Text",
 CellChangeTimes->{{3.4008494919040403`*^9, 3.4008495101543903`*^9}, {
  3.40868103230237*^9, 3.40868105470905*^9}}],

Cell[BoxData["donc"], "Input",
 CellChangeTimes->{{3.4086810584122467`*^9, 3.40868105963102*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]", " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       SubscriptBox["Q", "12"], "2"], "+", 
      SuperscriptBox[
       SubscriptBox["Q", "22"], "2"]}], ")"}]}], " ", "+", 
   RowBox[{"2", 
    SubscriptBox["M", "12"], 
    SubscriptBox["\[CapitalSigma]", "21"]}]}], " ", "=", " ", 
  RowBox[{
   SubscriptBox["\[Lambda]", "2"], 
   SubscriptBox["\[CapitalSigma]", "\[Infinity]2"]}]}]], "Text",
 CellChangeTimes->{{3.4008494513251357`*^9, 3.400849475138093*^9}, {
  3.4008497638780117`*^9, 3.40084980650383*^9}}],

Cell[BoxData["donc"], "Input",
 CellChangeTimes->{{3.4086810427088203`*^9, 3.4086810491308184`*^9}}],

Cell[BoxData[
 RowBox[{
  SubscriptBox["M", "12"], "=", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["\[Lambda]", "2"], 
     SubscriptBox["\[CapitalSigma]", "\[Infinity]2"]}], "-", 
    RowBox[{"\[Beta]", " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["Q", "12"], "2"], "+", 
       SuperscriptBox[
        SubscriptBox["Q", "22"], "2"]}], ")"}], " "}]}], 
   RowBox[{"2", 
    SubscriptBox["\[CapitalSigma]", "12"]}]]}]], "Text",
 CellChangeTimes->{{3.400923828542737*^9, 3.400923862387137*^9}}],

Cell[BoxData[
 RowBox[{"de", " ", "meme"}]], "Input",
 CellChangeTimes->{{3.4086810662248964`*^9, 3.4086810672561665`*^9}}],

Cell[BoxData[
 RowBox[{
  SubscriptBox["M", "21"], "=", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["\[Lambda]", "1"], 
     SubscriptBox["\[CapitalSigma]", "\[Infinity]1"]}], "-", 
    RowBox[{"\[Beta]", " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["Q", "21"], "2"], "+", 
       SuperscriptBox[
        SubscriptBox["Q", "11"], "2"]}], ")"}], " "}]}], 
   RowBox[{"2", 
    SubscriptBox["\[CapitalSigma]", "12"]}]]}]], "Text",
 CellChangeTimes->{{3.400923888559514*^9, 3.400923920106995*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"2", 
   SubscriptBox["M", "22"]}], "=", 
  RowBox[{"-", 
   SubscriptBox["\[Lambda]", "2"]}]}]], "Text",
 CellChangeTimes->{{3.4008494919040403`*^9, 3.4008495101543903`*^9}, {
  3.4008498101914005`*^9, 3.4008498145977354`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mais", " ", "on", " ", 
   RowBox[{"n", "'"}], "oublie", " ", "pas", " ", "que", " ", 
   SubscriptBox["\[CapitalSigma]", "21"]}], "=", 
  SubscriptBox["\[CapitalSigma]", "12"]}]], "Text",
 CellChangeTimes->{{3.4008499990700274`*^9, 3.4008500173985043`*^9}}],

Cell["On a donc , au total :", "Text",
 CellChangeTimes->{{3.400923722478201*^9, 3.400923732697147*^9}}],

Cell[BoxData[
 RowBox[{"pour", " ", "les", " ", "courtes", " ", "maturit\[EAcute]s", " ", 
  "ou", " ", "bien", " ", "les", " ", "faibles", " ", 
  RowBox[{"\[Lambda]", " ", ":"}]}]], "Input",
 CellChangeTimes->{{3.4086812537597475`*^9, 3.408681277994588*^9}, 
   3.4086813191828785`*^9}],

Cell[BoxData[
 RowBox[{"M", "=", 
  RowBox[{"(", GridBox[{
     {
      FractionBox[
       RowBox[{"-", 
        SubscriptBox["\[Lambda]", "1"]}], "2"], 
      FractionBox[
       RowBox[{
        RowBox[{
         SubscriptBox["\[Lambda]", "2"], 
         SubscriptBox["\[CapitalSigma]", "\[Infinity]2"]}], "-", 
        RowBox[{"\[Beta]", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            SubscriptBox["Q", "12"], "2"], "+", 
           SuperscriptBox[
            SubscriptBox["Q", "22"], "2"]}], ")"}], " "}]}], 
       RowBox[{"2", 
        SubscriptBox["\[CapitalSigma]", "12"]}]]},
     {
      FractionBox[
       RowBox[{
        RowBox[{
         SubscriptBox["\[Lambda]", "1"], 
         SubscriptBox["\[CapitalSigma]", "\[Infinity]1"]}], "-", 
        RowBox[{"\[Beta]", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            SubscriptBox["Q", "21"], "2"], "+", 
           SuperscriptBox[
            SubscriptBox["Q", "11"], "2"]}], ")"}], " "}]}], 
       RowBox[{"2", 
        SubscriptBox["\[CapitalSigma]", "12"]}]], 
      FractionBox[
       RowBox[{"-", 
        SubscriptBox["\[Lambda]", "2"]}], "2"]}
    }], ")"}]}]], "Text",
 CellChangeTimes->{{3.4009237390410185`*^9, 3.4009238050110354`*^9}, 
   3.4009238719029446`*^9, 3.4009239313259606`*^9}],

Cell[BoxData[
 RowBox[{"pour", " ", "les", " ", "longue", " ", "matirit\[EAcute]", " ", 
  "ou", " ", "les", " ", "forts", " ", "\[Lambda]"}]], "Input",
 CellChangeTimes->{{3.408681290588579*^9, 3.4086813129483833`*^9}}],

Cell[BoxData[
 RowBox[{"on", " ", "a", " ", "une", " ", "seule", " ", "contrainte", " ", 
  "sur", " ", "la", " ", "quantit\[EAcute]", " ", "totale", " ", "de", " ", 
  RowBox[{"drift", ":", " "}]}]], "Input",
 CellChangeTimes->{{3.4086813235579624`*^9, 3.4086813245423565`*^9}, {
  3.408682025852696*^9, 3.40868203152468*^9}, {3.4086825789258146`*^9, 
  3.408682590222907*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]", " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       SubscriptBox["Q", "11"], "2"], "+", 
      SuperscriptBox[
       SubscriptBox["Q", "21"], "2"]}], ")"}]}], " ", "+", 
   RowBox[{"2", 
    SubscriptBox["M", "21"], 
    SubscriptBox["\[CapitalSigma]", "12"]}]}], " ", "=", " ", 
  RowBox[{
   SubscriptBox["\[Lambda]", "1"], 
   SubscriptBox["\[CapitalSigma]", "\[Infinity]1"]}]}]], "Text",
 CellChangeTimes->{{3.4008494513251357`*^9, 3.400849475138093*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "dans le cas ou on utilise Q et ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[CapitalSigma]", "\[Infinity]"], TraditionalForm]]],
 " : "
}], "Subsubsection",
 CellChangeTimes->{{3.4059436385207367`*^9, 3.405943747710333*^9}}],

Cell[BoxData[
 RowBox[{"le", " ", "drift", " ", "de", " ", 
  SubscriptBox["d\[CapitalSigma]", "11"], " ", 
  RowBox[{"est", " ", ":", " ", 
   RowBox[{"2", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["M", "11"], 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["\[CapitalSigma]", "11"], "-", 
         SubscriptBox["\[CapitalSigma]", 
          RowBox[{"\[Infinity]", " ", "11"}]]}], ")"}]}], "+", 
      RowBox[{
       SubscriptBox["M", "21"], 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["\[CapitalSigma]", "12"], "-", 
         SubscriptBox["\[CapitalSigma]", 
          RowBox[{"\[Infinity]", " ", "12"}]]}], ")"}]}]}], ")"}], 
    "dt"}]}]}]], "Text",
 CellChangeTimes->{{3.405943750866644*^9, 3.4059438229149017`*^9}}],

Cell[BoxData[
 RowBox[{"celui", " ", "de", " ", 
  SubscriptBox["d\[CapitalSigma]", "2"], " ", "est", " ", 
  SubscriptBox["\[Lambda]", "2"], 
  RowBox[{"(", 
   RowBox[{
    SubscriptBox["\[CapitalSigma]", "\[Infinity]2"], "-", 
    SubscriptBox["\[CapitalSigma]", "2"]}], ")"}], "dt"}]], "Text"],

Cell["donc ", "Text",
 CellChangeTimes->{{3.4059438383058224`*^9, 3.4059438391964645`*^9}}],

Cell[BoxData[
 RowBox[{
  SubscriptBox["\[Lambda]", "1"], "=", 
  RowBox[{
   RowBox[{"-", "2"}], 
   SubscriptBox["M", "11"]}]}]], "Text",
 CellChangeTimes->{
  3.4059438706658187`*^9, {3.4059440837949104`*^9, 3.4059441048109393`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["\[CapitalSigma]", "\[Infinity]1"], "=", 
   RowBox[{
    SubscriptBox["\[CapitalSigma]", 
     RowBox[{"\[Infinity]", " ", "11"}]], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["\[CapitalSigma]", 
        RowBox[{"\[Infinity]", " ", "12"}]], "-", 
       SubscriptBox["\[CapitalSigma]", "12"]}], ")"}], 
     FractionBox[
      SubscriptBox["M", "21"], 
      RowBox[{"2", 
       SubscriptBox["M", "11"]}]]}]}]}], ";"}]], "Text",
 CellChangeTimes->{{3.4059441180143175`*^9, 3.4059441974064665`*^9}}],

Cell["ansi que ", "Text",
 CellChangeTimes->{{3.405944241922947*^9, 3.40594424393861*^9}}],

Cell[BoxData[
 RowBox[{
  SubscriptBox["\[Lambda]", "2"], "=", 
  RowBox[{
   RowBox[{"-", "2"}], 
   SubscriptBox["M", "22"]}]}]], "Text",
 CellChangeTimes->{
  3.4059438706658187`*^9, {3.4059440837949104`*^9, 3.4059441048109393`*^9}, {
   3.4059442564857264`*^9, 3.405944261329569*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["\[CapitalSigma]", "\[Infinity]2"], "=", 
   RowBox[{
    SubscriptBox["\[CapitalSigma]", 
     RowBox[{"\[Infinity]", " ", "22"}]], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["\[CapitalSigma]", 
        RowBox[{"\[Infinity]", " ", "21"}]], "-", 
       SubscriptBox["\[CapitalSigma]", "21"]}], ")"}], 
     FractionBox[
      SubscriptBox["M", "12"], 
      RowBox[{"2", 
       SubscriptBox["M", "22"]}]]}]}]}], ";"}]], "Text",
 CellChangeTimes->{{3.4059441180143175`*^9, 3.4059441974064665`*^9}, {
  3.405944263923369*^9, 3.405944292048909*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Parametriser le  Modele", "Subtitle",
 CellChangeTimes->{{3.4086864220777273`*^9, 3.408686485516445*^9}}],

Cell["Deux choix sont possibles :", "Text",
 CellChangeTimes->{{3.4087046709437237`*^9, 3.408704699694276*^9}}],

Cell[CellGroupData[{

Cell["Gestion de la conservation du drift de chaque underlying", "Subsubtitle",
 CellChangeTimes->{{3.408704633099247*^9, 3.408704655740307*^9}}],

Cell["\<\
On part d' une matrice diagonale Q et d' une matrice diagonale M\
\>", "Text",
 CellChangeTimes->{{3.4086864956572647`*^9, 3.4086865432363033`*^9}}],

Cell["\<\

  1) L' introduction de la correlation entre les assets induit un correlation \
entre les vol long terme. ceci 
dediagonalise Q en introduisant la correlation long terme = correlation court \
terme  via l' equation\
\>", "Text",
 CellChangeTimes->{{3.4086880724062877`*^9, 3.408688091734784*^9}, {
  3.4086881319855566`*^9, 3.4086881610954905`*^9}, {3.40868820351818*^9, 
  3.4086882167371836`*^9}, {3.408688268597554*^9, 3.40868830637953*^9}, {
  3.4086884743983808`*^9, 3.4086884749452667`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Beta]", " ", 
   SuperscriptBox["Q", "*"], "Q"}], " ", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "M"}], " ", 
    SubscriptBox["\[CapitalSigma]", "\[Infinity]"]}], "-", 
   RowBox[{
    SubscriptBox["\[CapitalSigma]", "\[Infinity]"], 
    SuperscriptBox["M", "*"], " "}]}]}]], "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"En", " ", "resum\[EAcute]"}], ",", " ", 
  RowBox[{"on", " ", "part", " ", "du", "  ", 
   SubscriptBox["\[CapitalSigma]", "\[Infinity]"], " ", "diagonal", " ", 
   "implicit"}], ",", " ", 
  RowBox[{"on", " ", "dediagonalise"}], ",", " ", 
  RowBox[{
  "et", " ", "on", " ", "calcule", " ", "le", " ", "Q", " ", 
   "associ\[EAcute]"}]}]], "Text",
 CellChangeTimes->{{3.40868837981844*^9, 3.40868843191319*^9}, {
  3.4086884674763727`*^9, 3.40868847044518*^9}}],

Cell["\<\
2) on peut alors dediagonaliser Mais en essayant de conserver la valeur \
moyenne du drift soit : \
\>", "Text",
 CellChangeTimes->{{3.408688477851572*^9, 3.4086884786953382`*^9}, {
  3.4086885648532424`*^9, 3.4086886146354485`*^9}}],

Cell[BoxData[
 RowBox[{
  SubscriptBox["\[Mu]", "1"], "=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     SubscriptBox["M", "11"], 
     SubscriptBox["\[CapitalSigma]", "11"]}], "+", 
    RowBox[{
     SubscriptBox["M", "21"], 
     SubscriptBox["\[CapitalSigma]", "12"]}]}], ")"}]}]], "Text",
 CellChangeTimes->{{3.4086886201355543`*^9, 3.4086886403703175`*^9}, {
   3.4086886895743876`*^9, 3.4086886940275974`*^9}, 3.4086936842952843`*^9}],

Cell["et", "Text",
 CellChangeTimes->{{3.4086887443723145`*^9, 3.408688745809842*^9}}],

Cell[BoxData[
 RowBox[{
  SubscriptBox["\[Mu]", "2"], "=", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     SubscriptBox["M", "22"], 
     SubscriptBox["\[CapitalSigma]", "22"]}], "+", 
    RowBox[{
     SubscriptBox["M", "12"], 
     SubscriptBox["\[CapitalSigma]", "21"]}]}], ")"}]}]], "Text",
 CellChangeTimes->{{3.4086886201355543`*^9, 3.4086886403703175`*^9}, {
   3.4086886895743876`*^9, 3.4086886940275974`*^9}, {3.408688754935017*^9, 
   3.408688804889101*^9}, 3.4086937100301533`*^9}],

Cell["ainsi que la negativit\[EAcute] de M", "Text",
 CellChangeTimes->{{3.408689295742275*^9, 3.4086893124457207`*^9}}],

Cell[TextData[{
 "soit ",
 Cell[BoxData[
  SubscriptBox["\[Theta]", "1"]],
  CellChangeTimes->{{3.4086905335316653`*^9, 3.408690556766486*^9}}],
 " \[Element][0,1[ , constante definies par :"
}], "Text",
 CellChangeTimes->{{3.408688841608556*^9, 3.408688855421321*^9}, {
  3.4086907566765747`*^9, 3.408690788458435*^9}}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", GridBox[{
    {
     RowBox[{
      SubscriptBox["M", "21"], "=", 
      RowBox[{
       SubscriptBox["\[Theta]", "1"], 
       SuperscriptBox[
        SubscriptBox["M", "11"], "orig"], 
       FractionBox[
        SubscriptBox["\[CapitalSigma]", "11"], 
        SubscriptBox["\[CapitalSigma]", "12"]]}]}]},
    {
     RowBox[{
      SubscriptBox["M", "11"], "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["\[Theta]", "1"]}], ")"}], 
       SuperscriptBox[
        SubscriptBox["M", "11"], "orig"]}]}]}
   }]}]], "Text",
 CellChangeTimes->{{3.4086905335316653`*^9, 3.408690556766486*^9}, {
  3.408693760390495*^9, 3.408693772593854*^9}}],

Cell[BoxData[
 RowBox[{"ainsi", " ", 
  SubscriptBox["\[Mu]", "1"], " ", "est", " ", "conserv\[EAcute]"}]], "Text",
 CellChangeTimes->{{3.4086900555068626`*^9, 3.408690078772934*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"car", "  ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SubscriptBox["M", "11"], 
      SubscriptBox["\[CapitalSigma]", "11"]}], "+", 
     RowBox[{
      SubscriptBox["M", "21"], 
      SubscriptBox["\[CapitalSigma]", "12"]}]}], ")"}]}], "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", 
       SubscriptBox["\[Theta]", "1"]}], ")"}], 
     SuperscriptBox[
      SubscriptBox["M", "11"], "orig"], 
     SubscriptBox["\[CapitalSigma]", "11"]}], "+", 
    RowBox[{
     SubscriptBox["\[Theta]", "1"], 
     SuperscriptBox[
      SubscriptBox["M", "11"], "orig"], 
     FractionBox[
      SubscriptBox["\[CapitalSigma]", "11"], 
      SubscriptBox["\[CapitalSigma]", "12"]], 
     SubscriptBox["\[CapitalSigma]", "12"]}]}], "=", 
   RowBox[{
    SuperscriptBox[
     SubscriptBox["M", "11"], "orig"], 
    SubscriptBox["\[CapitalSigma]", "11"]}]}]}]], "Text",
 CellChangeTimes->{{3.4086901261644692`*^9, 3.4086901886812944`*^9}, 
   3.4086902345728006`*^9, {3.4086937934380045`*^9, 3.408693867798807*^9}}],

Cell[TextData[{
 "de meme on introduit ",
 Cell[BoxData[
  SubscriptBox["\[Theta]", "2"]],
  CellChangeTimes->{{3.4086905335316653`*^9, 3.408690556766486*^9}, {
   3.4086906070330763`*^9, 3.4086906529714584`*^9}}],
 "\[Element][0,1[ ,"
}], "Text",
 CellChangeTimes->{{3.408690254791939*^9, 3.408690257526366*^9}, {
  3.4086905891577334`*^9, 3.40869059445471*^9}, {3.4086907988961353`*^9, 
  3.4086908053493843`*^9}}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", GridBox[{
    {
     RowBox[{
      SubscriptBox["M", "12"], "=", 
      RowBox[{
       SubscriptBox["\[Theta]", "2"], 
       SuperscriptBox[
        SubscriptBox["M", "22"], "orig"], 
       FractionBox[
        SubscriptBox["\[CapitalSigma]", "22"], 
        SubscriptBox["\[CapitalSigma]", "12"]]}]}]},
    {
     RowBox[{
      SubscriptBox["M", "22"], "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["\[Theta]", "2"]}], ")"}], 
       SuperscriptBox[
        SubscriptBox["M", "22"], "orig"]}]}]}
   }]}]], "Text",
 CellChangeTimes->{{3.4086905335316653`*^9, 3.408690556766486*^9}, {
  3.4086906070330763`*^9, 3.4086906529714584`*^9}, {3.4086938834553576`*^9, 
  3.408693917034127*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Gestion de la negativit\[EAcute] de M", "Subsubtitle",
 CellChangeTimes->{{3.4087045990048423`*^9, 3.408704606067478*^9}}],

Cell["\<\

la negativit\[EAcute] peut etre complexe a gerer on perfere donc definir \
\>", "Text",
 CellChangeTimes->{{3.4087042234820075`*^9, 3.4087042902020383`*^9}}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", GridBox[{
    {
     RowBox[{
      SubscriptBox["M", "21"], "=", 
      RowBox[{
       SubscriptBox["\[Theta]", "1"], 
       SuperscriptBox[
        SubscriptBox["M", "11"], "orig"]}]}]},
    {
     RowBox[{
      SubscriptBox["M", "11"], "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["\[Theta]", "1"]}], ")"}], 
       SuperscriptBox[
        SubscriptBox["M", "11"], "orig"]}]}]}
   }]}]], "Text",
 CellChangeTimes->{3.4087043009678698`*^9}],

Cell["et ", "Text",
 CellChangeTimes->{{3.4087043068586082`*^9, 3.408704307624248*^9}}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", GridBox[{
    {
     RowBox[{
      SubscriptBox["M", "12"], "=", 
      RowBox[{
       SubscriptBox["\[Theta]", "2"], 
       SuperscriptBox[
        SubscriptBox["M", "22"], "orig"]}]}]},
    {
     RowBox[{
      SubscriptBox["M", "22"], "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["\[Theta]", "2"]}], ")"}], 
       SuperscriptBox[
        SubscriptBox["M", "22"], "orig"]}]}]}
   }]}]], "Text",
 CellChangeTimes->{3.4087043165306687`*^9}],

Cell["\<\
ce qui induit des contrainte de negativit\[EAcute] :\
\>", "Text",
 CellChangeTimes->{{3.4087043197963567`*^9, 3.408704334499764*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Trace", "[", "M", "]"}], " ", "=", " ", 
  RowBox[{
   RowBox[{
    SubscriptBox["M", "11"], "+", 
    SubscriptBox["M", "22"]}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        SubscriptBox["\[Theta]", "1"]}], ")"}], 
      SuperscriptBox[
       SubscriptBox["M", "11"], "orig"]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        SubscriptBox["\[Theta]", "2"]}], ")"}], 
      SuperscriptBox[
       SubscriptBox["M", "22"], "orig"]}]}], "<", 
    "0"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"il", " ", "est", " ", "suffisant", " ", "que", " ", 
   SubscriptBox["\[Theta]", "1"]}], "<", 
  RowBox[{"1", " ", "et", "  ", 
   SubscriptBox["\[Theta]", "2"]}], "<", "1"}]}], "Text",
 CellChangeTimes->{{3.408704345640603*^9, 3.40870443351729*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Det", "[", "M", "]"}], "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["M", "11"], 
     SubscriptBox["M", "22"]}], "-", 
    RowBox[{
     SubscriptBox["M", "12"], 
     SubscriptBox["M", "12"]}]}], "=", 
   RowBox[{
    RowBox[{
     SuperscriptBox[
      SubscriptBox["M", "11"], "orig"], 
     SuperscriptBox[
      SubscriptBox["M", "22"], "orig"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          SubscriptBox["\[Theta]", "1"]}], ")"}], 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          SubscriptBox["\[Theta]", "2"]}], ")"}]}], "-", 
       RowBox[{
        SubscriptBox["\[Theta]", "1"], 
        SubscriptBox["\[Theta]", "2"]}]}], ")"}]}], "=", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       SubscriptBox["M", "11"], "orig"], 
      SuperscriptBox[
       SubscriptBox["M", "22"], "orig"], 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        SubscriptBox["\[Theta]", "1"], "-", 
        SubscriptBox["\[Theta]", "2"]}], ")"}]}], " ", ">", 
     "0"}]}]}]}]], "Text",
 CellChangeTimes->{{3.4087044389705195`*^9, 3.408704544941304*^9}, {
  3.4087045829576592`*^9, 3.4087045863014736`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
   "il", " ", "sera", " ", "donc", " ", "suffisant", " ", "que", " ", 
    SubscriptBox["\[Theta]", "1"]}], "+", 
   SubscriptBox["\[Theta]", "2"]}], " ", "<", "1"}]], "Text",
 CellChangeTimes->{{3.408704549128885*^9, 3.4087045718324456`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Normalisation", "Subtitle",
 CellChangeTimes->{{3.404728849180297*^9, 3.404728852070922*^9}}],

Cell[BoxData[
 RowBox[{
  SubscriptBox["d\[CapitalSigma]", "t"], "=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"M", " ", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["\[CapitalSigma]", "t"], "-", 
         SubscriptBox["\[CapitalSigma]", "\[Infinity]"]}], ")"}]}], "+", " ", 
      
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["\[CapitalSigma]", "t"], "-", 
         SubscriptBox["\[CapitalSigma]", "\[Infinity]"]}], ")"}], 
       SuperscriptBox["M", "*"]}]}], ")"}], "dt"}], "+", 
   RowBox[{
    SqrtBox[
     SubscriptBox["\[CapitalSigma]", "t"]], 
    SubscriptBox["dW", "t"], "Q"}], " ", "+", 
   RowBox[{
    SuperscriptBox["Q", "*"], 
    SuperscriptBox[
     SubscriptBox["dW", "t"], "*"], 
    SuperscriptBox[
     RowBox[{"(", 
      SqrtBox[
       SubscriptBox["\[CapitalSigma]", "t"]], ")"}], "*"]}]}]}]], "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Vect", "[", 
   SubscriptBox["dS", 
    RowBox[{"i", ",", "t"}]], "]"}], "=", 
  RowBox[{
   SqrtBox[
    SubscriptBox["\[CapitalSigma]", "t"]], 
   SubscriptBox["dZ", "t"]}]}]], "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"les", " ", "equation", " ", "suivie", " ", "par", "  ", 
   SubscriptBox["L", "1"]}], "=", " ", 
  RowBox[{
   RowBox[{
    SuperscriptBox[
     SubscriptBox["S", "1"], "\[Alpha]"], "  ", "et", "  ", 
    SubscriptBox["L", "2"]}], "=", " ", 
   SuperscriptBox[
    SubscriptBox["S", "2"], "\[Beta]"]}]}]], "Text",
 CellChangeTimes->{{3.404726059633422*^9, 3.404726102711547*^9}, {
  3.404726308461547*^9, 3.404726311070922*^9}, {3.4048130122914057`*^9, 
  3.404813029885831*^9}}],

Cell["sont : ", "Text",
 CellChangeTimes->{{3.404726105008422*^9, 3.404726106664672*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Vect", "[", 
   FractionBox[
    SubscriptBox["dL", 
     RowBox[{"i", ",", "t"}]], "L"], "]"}], "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", GridBox[{
        {"\[Alpha]", "0"},
        {"0", "\[Beta]"}
       }], ")"}], 
     RowBox[{"(", 
      RowBox[{
       SqrtBox[
        SubscriptBox["\[CapitalSigma]", "t"]], 
       SubscriptBox["dZ", "t"]}], ")"}]}], "+", "drift"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", GridBox[{
        {"\[Alpha]", "0"},
        {"0", "\[Beta]"}
       }], ")"}], ".", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", GridBox[{
          {
           SubscriptBox["Q", "11"], 
           SubscriptBox["Q", "12"]},
          {
           SubscriptBox["Q", "21"], 
           SubscriptBox["Q", "22"]}
         }], ")"}], " ", ".", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["dZ", "1"], ",", 
         SubscriptBox["dZ", "2"]}], "}"}]}], ")"}]}], "+", 
    "drift"}]}]}]], "Text",
 CellChangeTimes->{
  3.404726120914672*^9, {3.404726180602172*^9, 3.404726193852172*^9}, {
   3.404726258836547*^9, 3.404726393805297*^9}, {3.4048130466833515`*^9, 
   3.40481304807403*^9}, {3.404813939623889*^9, 3.4048139471398025`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ou", "   ", "drift"}], "=", 
  RowBox[{
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         FractionBox[
          RowBox[{"(", 
           RowBox[{"\[Alpha]", "-", "1"}], ")"}], "\[Alpha]"], 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            SubscriptBox["Q", "11"], "2"], "+", 
           SuperscriptBox[
            SubscriptBox["Q", "12"], "2"]}], ")"}]}]},
       {
        RowBox[{
         FractionBox[
          RowBox[{"(", 
           RowBox[{"\[Beta]", "-", "1"}], ")"}], "\[Beta]"], 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            SubscriptBox["Q", "21"], "2"], "+", 
           SuperscriptBox[
            SubscriptBox["Q", "22"], "2"]}], ")"}]}]}
      }], ")"}], "dt"}], "=", 
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         FractionBox[
          RowBox[{"(", 
           RowBox[{"\[Alpha]", "-", "1"}], ")"}], 
          RowBox[{"2", "\[Alpha]"}]], 
         SubscriptBox["\[CapitalSigma]", "11"]}]},
       {
        RowBox[{
         FractionBox[
          RowBox[{"(", 
           RowBox[{"\[Beta]", "-", "1"}], ")"}], 
          RowBox[{"2", "\[Beta]"}]], 
         SubscriptBox["\[CapitalSigma]", "22"]}]}
      }], ")"}], "dt"}]}]}]], "Text",
 CellChangeTimes->{{3.404813952468132*^9, 3.40481396153098*^9}, {
  3.40481400450138*^9, 3.4048141628043337`*^9}, {3.4048143079349065`*^9, 
  3.404814321544804*^9}, {3.405090804665475*^9, 3.4050908451977625`*^9}}],

Cell["or ", "Text",
 CellChangeTimes->{{3.404726232258422*^9, 3.404726232602172*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", GridBox[{
      {"\[Alpha]", "0"},
      {"0", "\[Beta]"}
     }], ")"}], ".", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", GridBox[{
        {
         SubscriptBox["\[Sigma]", "11"], 
         SubscriptBox["\[Sigma]", "12"]},
        {
         SubscriptBox["\[Sigma]", "21"], 
         SubscriptBox["\[Sigma]", "22"]}
       }], ")"}], " ", ".", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["dZ", "1"], ",", 
       SubscriptBox["dZ", "2"]}], "}"}]}], ")"}]}], "==", 
  RowBox[{"(", GridBox[{
     {
      RowBox[{"\[Alpha]", " ", 
       SubscriptBox["\[Sigma]", "11"]}], 
      RowBox[{"\[Alpha]", " ", 
       SubscriptBox["\[Sigma]", "12"]}]},
     {
      RowBox[{"\[Beta]", " ", 
       SubscriptBox["\[Sigma]", "21"]}], 
      RowBox[{"\[Beta]", " ", 
       SubscriptBox["\[Sigma]", "22"]}]}
    }], ")"}]}]], "Text",
 CellChangeTimes->{{3.404726548930297*^9, 3.404726575242797*^9}, {
  3.404727555930297*^9, 3.404727590977172*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", GridBox[{
      {
       RowBox[{"\[Alpha]", " ", 
        SubscriptBox["\[Sigma]", "11"]}], 
       SubscriptBox["\[Alpha]\[Sigma]", "12"]},
      {
       RowBox[{"\[Beta]", " ", 
        SubscriptBox["\[Sigma]", "21"]}], 
       RowBox[{"\[Beta]", " ", 
        SubscriptBox["\[Sigma]", "22"]}]}
     }], ")"}], " ", ".", " ", 
   RowBox[{"(", GridBox[{
      {
       SubscriptBox["\[Alpha]\[Sigma]", "11"], 
       RowBox[{"\[Beta]", " ", 
        SubscriptBox["\[Sigma]", "21"]}]},
      {
       RowBox[{"\[Alpha]", " ", 
        SubscriptBox["\[Sigma]", "12"]}], 
       RowBox[{"\[Beta]", " ", 
        SubscriptBox["\[Sigma]", "22"]}]}
     }], ")"}]}], " ", "//", " ", "MatrixForm"}]], "Text",
 CellChangeTimes->{{3.404726667649047*^9, 3.404726705414672*^9}, {
  3.404727490477172*^9, 3.404727522320922*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"\[Alpha]", " ", 
        SubscriptBox["\[Alpha]\[Sigma]", "11"], " ", 
        SubscriptBox["\[Sigma]", "11"]}], "+", 
       RowBox[{"\[Alpha]", " ", 
        SubscriptBox["\[Alpha]\[Sigma]", "12"], " ", 
        SubscriptBox["\[Sigma]", "12"]}]}], 
      RowBox[{
       RowBox[{"\[Alpha]", " ", "\[Beta]", " ", 
        SubscriptBox["\[Sigma]", "11"], " ", 
        SubscriptBox["\[Sigma]", "21"]}], "+", 
       RowBox[{"\[Beta]", " ", 
        SubscriptBox["\[Alpha]\[Sigma]", "12"], " ", 
        SubscriptBox["\[Sigma]", "22"]}]}]},
     {
      RowBox[{
       RowBox[{"\[Beta]", " ", 
        SubscriptBox["\[Alpha]\[Sigma]", "11"], " ", 
        SubscriptBox["\[Sigma]", "21"]}], "+", 
       RowBox[{"\[Alpha]", " ", "\[Beta]", " ", 
        SubscriptBox["\[Sigma]", "12"], " ", 
        SubscriptBox["\[Sigma]", "22"]}]}], 
      RowBox[{
       RowBox[{
        SuperscriptBox["\[Beta]", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "21", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["\[Beta]", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "22", "2"]}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Text",
 CellChangeTimes->{{3.404726697477172*^9, 3.404726705977172*^9}, 
   3.404727525555297*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", GridBox[{
      {"\[Alpha]", "0"},
      {"0", "\[Beta]"}
     }], ")"}], ".", 
   RowBox[{"(", GridBox[{
      {
       SubscriptBox["\[Sigma]", "11"], 
       SubscriptBox["\[Sigma]", "12"]},
      {
       SubscriptBox["\[Sigma]", "21"], 
       SubscriptBox["\[Sigma]", "22"]}
     }], ")"}]}], " ", "//", " ", "MatrixForm"}]], "Text",
 CellChangeTimes->{{3.404726777320922*^9, 3.404726784727172*^9}, {
  3.404727530336547*^9, 3.404727544805297*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"\[Alpha]", " ", 
       SubscriptBox["\[Sigma]", "11"]}], 
      RowBox[{"\[Alpha]", " ", 
       SubscriptBox["\[Sigma]", "12"]}]},
     {
      RowBox[{"\[Beta]", " ", 
       SubscriptBox["\[Sigma]", "21"]}], 
      RowBox[{"\[Beta]", " ", 
       SubscriptBox["\[Sigma]", "22"]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Text",
 CellChangeTimes->{{3.404726778117797*^9, 3.404726785352172*^9}, 
   3.404727546555297*^9}],

Cell["\<\
la dynamique de dL est donn\[EAcute] par la matrice :\
\>", "Text",
 CellChangeTimes->{{3.404726973711547*^9, 3.404726990102172*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", GridBox[{
      {"\[Alpha]", "0"},
      {"0", "\[Beta]"}
     }], ")"}], ".", 
   RowBox[{"(", GridBox[{
      {
       SubscriptBox["\[CapitalSigma]", "11"], 
       SubscriptBox["\[CapitalSigma]", "12"]},
      {
       SubscriptBox["\[CapitalSigma]", "21"], 
       SubscriptBox["\[CapitalSigma]", "22"]}
     }], ")"}], ".", 
   RowBox[{"(", GridBox[{
      {"\[Alpha]", "0"},
      {"0", "\[Beta]"}
     }], ")"}]}], "//", " ", "MatrixForm"}]], "Text",
 CellChangeTimes->{{3.404726826586547*^9, 3.404726854742797*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       SuperscriptBox["\[Alpha]", "2"], " ", 
       SubscriptBox["\[CapitalSigma]", "11"]}], 
      RowBox[{"\[Alpha]", " ", "\[Beta]", " ", 
       SubscriptBox["\[CapitalSigma]", "12"]}]},
     {
      RowBox[{"\[Alpha]", " ", "\[Beta]", " ", 
       SubscriptBox["\[CapitalSigma]", "21"]}], 
      RowBox[{
       SuperscriptBox["\[Beta]", "2"], " ", 
       SubscriptBox["\[CapitalSigma]", "22"]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Text",
 CellChangeTimes->{{3.404726848758422*^9, 3.404726855586547*^9}}],

Cell["or cette matrice suit la dynamique : ", "Text",
 CellChangeTimes->{{3.404726994789672*^9, 3.404727007149047*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"d", 
   RowBox[{"(", GridBox[{
      {"\[Alpha]", "0"},
      {"0", "\[Beta]"}
     }], ")"}], 
   SubscriptBox["\[CapitalSigma]", "t"], 
   RowBox[{"(", GridBox[{
      {"\[Alpha]", "0"},
      {"0", "\[Beta]"}
     }], ")"}]}], "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Sym", "[", 
      RowBox[{
       RowBox[{"(", GridBox[{
          {"\[Alpha]", "0"},
          {"0", "\[Beta]"}
         }], ")"}], "M", " ", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["\[CapitalSigma]", "t"], "-", 
         SubscriptBox["\[CapitalSigma]", "\[Infinity]"]}], ")"}], 
       RowBox[{"(", GridBox[{
          {"\[Alpha]", "0"},
          {"0", "\[Beta]"}
         }], ")"}]}], "]"}], "dt"}], "+", 
    RowBox[{"Sym", "[", 
     RowBox[{
      RowBox[{"(", GridBox[{
         {"\[Alpha]", "0"},
         {"0", "\[Beta]"}
        }], ")"}], 
      SqrtBox[
       SubscriptBox["\[CapitalSigma]", "t"]], 
      SubscriptBox["dW", "t"], "Q", 
      RowBox[{"(", GridBox[{
         {"\[Alpha]", "0"},
         {"0", "\[Beta]"}
        }], ")"}]}], " ", "]"}]}], "=", "\[IndentingNewLine]"}]}]], "Text",
 CellChangeTimes->{{3.404726896039672*^9, 3.404726948945922*^9}, {
  3.404727020977172*^9, 3.404727081805297*^9}, {3.404727153461547*^9, 
  3.404727158242797*^9}}],

Cell["ou on definit", "Text",
 CellChangeTimes->{{3.404727122508422*^9, 3.404727125055297*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Sym", "[", "A", "]"}], "=", 
  RowBox[{"A", "+", 
   SuperscriptBox["A", "*"]}]}]], "Text",
 CellChangeTimes->{{3.404727103336547*^9, 3.404727119164672*^9}}],

Cell["on a :", "Text",
 CellChangeTimes->{{3.404727194039672*^9, 3.404727195742797*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"d", 
   RowBox[{"(", GridBox[{
      {"\[Alpha]", "0"},
      {"0", "\[Beta]"}
     }], ")"}], 
   SubscriptBox["\[CapitalSigma]", "t"], 
   RowBox[{"(", GridBox[{
      {"\[Alpha]", "0"},
      {"0", "\[Beta]"}
     }], ")"}]}], "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Sym", "[", 
      RowBox[{
       RowBox[{"(", GridBox[{
          {"\[Alpha]", "0"},
          {"0", "\[Beta]"}
         }], ")"}], "M", " ", 
       RowBox[{"(", GridBox[{
          {
           SuperscriptBox["\[Alpha]", 
            RowBox[{"-", "1"}]], "0"},
          {"0", 
           SuperscriptBox["\[Beta]", 
            RowBox[{"-", "1"}]]}
         }], ")"}], 
       RowBox[{"(", GridBox[{
          {"\[Alpha]", "0"},
          {"0", "\[Beta]"}
         }], ")"}], 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["\[CapitalSigma]", "t"], "-", 
         SubscriptBox["\[CapitalSigma]", "\[Infinity]"]}], ")"}], 
       RowBox[{"(", GridBox[{
          {"\[Alpha]", "0"},
          {"0", "\[Beta]"}
         }], ")"}]}], "]"}], "dt"}], "+", 
    RowBox[{"Sym", "[", 
     RowBox[{
      SqrtBox[
       RowBox[{
        RowBox[{"(", GridBox[{
           {"\[Alpha]", "0"},
           {"0", "\[Beta]"}
          }], ")"}], 
        SubscriptBox["\[CapitalSigma]", "t"], 
        RowBox[{"(", GridBox[{
           {"\[Alpha]", "0"},
           {"0", "\[Beta]"}
          }], ")"}]}]], 
      SubscriptBox["dW", "t"], "Q", 
      RowBox[{"(", GridBox[{
         {"\[Alpha]", "0"},
         {"0", "\[Beta]"}
        }], ")"}]}], " ", "]"}]}], "=", "\[IndentingNewLine]"}]}]], "Text",
 CellChangeTimes->{{3.404726896039672*^9, 3.404726948945922*^9}, {
  3.404727020977172*^9, 3.404727081805297*^9}, {3.404727153461547*^9, 
  3.404727158242797*^9}, {3.404727211227172*^9, 3.404727223789672*^9}, {
  3.404727285602172*^9, 3.404727293352172*^9}}],

Cell["\<\

donc la dynamique de L est donn\[EAcute] par \
\>", "Text",
 CellChangeTimes->{{3.404727309445922*^9, 3.404727330836547*^9}}],

Cell[BoxData[
 RowBox[{
  OverscriptBox[
   SubscriptBox["\[CapitalSigma]", "t"], "_"], "=", 
  RowBox[{
   RowBox[{"(", GridBox[{
      {"\[Alpha]", "0"},
      {"0", "\[Beta]"}
     }], ")"}], 
   SubscriptBox["\[CapitalSigma]", "t"], 
   RowBox[{"(", GridBox[{
      {"\[Alpha]", "0"},
      {"0", "\[Beta]"}
     }], ")"}]}]}]], "Text",
 CellChangeTimes->{{3.404727375617797*^9, 3.404727401570922*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"d", 
   OverscriptBox[
    SubscriptBox["\[CapitalSigma]", "t"], "_"]}], "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Sym", "[", 
     RowBox[{
      OverscriptBox["M", "_"], " ", 
      RowBox[{"(", 
       RowBox[{
        OverscriptBox[
         SubscriptBox["\[CapitalSigma]", "t"], "_"], "-", 
        OverscriptBox[
         SubscriptBox["\[CapitalSigma]", "\[Infinity]"], "_"]}], ")"}]}], 
     "]"}], "dt"}], "+", 
   RowBox[{"Sym", "[", 
    RowBox[{
     SqrtBox[
      OverscriptBox[
       SubscriptBox["\[CapitalSigma]", "t"], "_"]], 
     SubscriptBox["dW", "t"], 
     OverscriptBox[
      RowBox[{" ", "Q"}], "_"]}], "]"}], "+", 
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        FractionBox[
         RowBox[{
          SuperscriptBox["\[Alpha]", 
           RowBox[{"-", "1"}]], 
          RowBox[{"(", 
           RowBox[{"\[Alpha]", "-", "1"}], ")"}]}], "2"], "0"},
       {"0", 
        FractionBox[
         RowBox[{
          SuperscriptBox["\[Beta]", 
           RowBox[{"-", "1"}]], 
          RowBox[{"(", 
           RowBox[{"\[Beta]", "-", "1"}], ")"}]}], "2"]}
      }], ")"}], 
    RowBox[{"(", GridBox[{
       {
        SubscriptBox[
         OverscriptBox[
          SubscriptBox["\[CapitalSigma]", "t"], "_"], "11"]},
       {
        SubscriptBox[
         OverscriptBox[
          SubscriptBox["\[CapitalSigma]", "t"], "_"], "22"]}
      }], ")"}]}]}]}]], "Text",
 CellChangeTimes->{{3.404727409039672*^9, 3.404727475039672*^9}, {
  3.404727625711547*^9, 3.404727636805297*^9}, {3.40509060097276*^9, 
  3.405090769742706*^9}}],

Cell["ou : ", "Text",
 CellChangeTimes->{{3.404727618508422*^9, 3.404727620039672*^9}}],

Cell[BoxData[
 RowBox[{
  OverscriptBox["M", "_"], "=", 
  RowBox[{
   RowBox[{"(", GridBox[{
      {"\[Alpha]", "0"},
      {"0", "\[Beta]"}
     }], ")"}], "M", " ", 
   RowBox[{"(", GridBox[{
      {
       SuperscriptBox["\[Alpha]", 
        RowBox[{"-", "1"}]], "0"},
      {"0", 
       SuperscriptBox["\[Beta]", 
        RowBox[{"-", "1"}]]}
     }], ")"}]}]}]], "Text",
 CellChangeTimes->{{3.404727648805297*^9, 3.404727658414672*^9}}],

Cell[BoxData[
 RowBox[{
  OverscriptBox[
   SubscriptBox["\[CapitalSigma]", "\[Infinity]"], "_"], "=", 
  RowBox[{
   RowBox[{"(", GridBox[{
      {"\[Alpha]", "0"},
      {"0", "\[Beta]"}
     }], ")"}], 
   SubscriptBox["\[CapitalSigma]", "\[Infinity]"], 
   RowBox[{"(", GridBox[{
      {"\[Alpha]", "0"},
      {"0", "\[Beta]"}
     }], ")"}]}]}]], "Text",
 CellChangeTimes->{{3.404727673789672*^9, 3.404727691555297*^9}}],

Cell[BoxData[
 RowBox[{
  OverscriptBox[
   RowBox[{" ", "Q"}], "_"], "=", 
  RowBox[{"Q", 
   RowBox[{"(", GridBox[{
      {"\[Alpha]", "0"},
      {"0", "\[Beta]"}
     }], ")"}]}]}]], "Text",
 CellChangeTimes->{{3.404727707039672*^9, 3.404727712961547*^9}}],

Cell["\<\
reciproquement,
etant donn\[EAcute] une dynamique donn\[EAcute] par \
\>", "Text",
 CellChangeTimes->{{3.404727743852172*^9, 3.404727760742797*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"d", 
   OverscriptBox[
    SubscriptBox["\[CapitalSigma]", "t"], "_"]}], "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Sym", "[", 
       RowBox[{
        OverscriptBox["M", "_"], " ", 
        RowBox[{"(", 
         RowBox[{
          OverscriptBox[
           SubscriptBox["\[CapitalSigma]", "t"], "_"], "-", 
          OverscriptBox[
           SubscriptBox["\[CapitalSigma]", "\[Infinity]"], "_"]}], ")"}]}], 
       "]"}], "dt"}], "+", 
     RowBox[{
      RowBox[{"Sym", "[", 
       RowBox[{
        SqrtBox[
         OverscriptBox[
          SubscriptBox["\[CapitalSigma]", "t"], "_"]], 
        SubscriptBox["dW", "t"], 
        OverscriptBox[
         RowBox[{" ", "Q"}], "_"]}], "]"}], "   ", "et", "  ", 
      OverscriptBox[
       SubscriptBox["\[CapitalSigma]", "\[Infinity]"], "_"]}]}], 
    SubscriptBox["|", "0"]}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", GridBox[{
        {"\[Alpha]", "0"},
        {"0", "\[Beta]"}
       }], ")"}], 
     SubscriptBox["\[CapitalSigma]", "\[Infinity]"]}], 
    SubscriptBox["|", "0"], 
    RowBox[{"(", GridBox[{
       {"\[Alpha]", "0"},
       {"0", "\[Beta]"}
      }], ")"}]}]}]}]], "Text",
 CellChangeTimes->{{3.404727409039672*^9, 3.404727475039672*^9}, {
  3.404727625711547*^9, 3.404727636805297*^9}, {3.404727822649047*^9, 
  3.404727864680297*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"c", "'"}], "est", " ", "la", " ", "dynamique", " ", "de", " ", 
  RowBox[{"(", GridBox[{
     {
      RowBox[{"\[Alpha]", " ", 
       SubscriptBox["S", "1"]}]},
     {
      RowBox[{"\[Beta]", " ", 
       SubscriptBox["S", "2"]}]}
    }], ")"}]}]], "Text",
 CellChangeTimes->{{3.404727870570922*^9, 3.404727910836547*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"donc", " ", 
   RowBox[{"l", "'"}], "option", " ", 
   RowBox[{"E", "[", 
    RowBox[{
     RowBox[{
      SubscriptBox["a", "1"], 
      SubscriptBox["S", "1"]}], "-", 
     RowBox[{
      SubscriptBox["a", "2"], 
      SubscriptBox["S", "2"]}], "-", "K"}], "]"}]}], "=", 
  RowBox[{
   RowBox[{"E", "[", 
    RowBox[{
     RowBox[{
      FractionBox[
       SubscriptBox["a", "1"], "\[Alpha]"], 
      SubscriptBox["L", "1"]}], "-", 
     RowBox[{
      FractionBox[
       SubscriptBox["a", "2"], "\[Beta]"], 
      SubscriptBox["L", "2"]}], "-", "K"}], "]"}], "  ", "ou", " ", 
   RowBox[{"(", GridBox[{
      {
       SubscriptBox["L", "1"]},
      {
       SubscriptBox["L", "2"]}
     }], ")"}], " ", "suive", " ", "une", " ", "dynamique", " ", 
   "donn\[EAcute]e", " ", 
   RowBox[{"par", " ", ":"}]}]}]], "Text",
 CellChangeTimes->{{3.404727945055297*^9, 3.404728101070922*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"d", 
   OverscriptBox[
    SubscriptBox["\[CapitalSigma]", "t"], "_"]}], "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Sym", "[", 
       RowBox[{
        OverscriptBox["M", "_"], " ", 
        RowBox[{"(", 
         RowBox[{
          OverscriptBox[
           SubscriptBox["\[CapitalSigma]", "t"], "_"], "-", 
          OverscriptBox[
           SubscriptBox["\[CapitalSigma]", "\[Infinity]"], "_"]}], ")"}]}], 
       "]"}], "dt"}], "+", 
     RowBox[{
      RowBox[{"Sym", "[", 
       RowBox[{
        SqrtBox[
         OverscriptBox[
          SubscriptBox["\[CapitalSigma]", "t"], "_"]], 
        SubscriptBox["dW", "t"], 
        OverscriptBox[
         RowBox[{" ", "Q"}], "_"]}], "]"}], "   ", "et", "  ", 
      OverscriptBox[
       SubscriptBox["\[CapitalSigma]", "\[Infinity]"], "_"]}]}], 
    SubscriptBox["|", "0"]}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", GridBox[{
        {"\[Alpha]", "0"},
        {"0", "\[Beta]"}
       }], ")"}], 
     SubscriptBox["\[CapitalSigma]", "\[Infinity]"]}], 
    SubscriptBox["|", "0"], 
    RowBox[{"(", GridBox[{
       {"\[Alpha]", "0"},
       {"0", "\[Beta]"}
      }], ")"}]}]}]}]], "Text",
 CellChangeTimes->{{3.404727409039672*^9, 3.404727475039672*^9}, {
  3.404727625711547*^9, 3.404727636805297*^9}, {3.404727822649047*^9, 
  3.404727864680297*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "on", " ", "determine", " ", "\[Alpha]", " ", "et", " ", "\[Beta]", " ", 
   "en", " ", "normlisant", " ", "la", " ", "vol", " ", 
   RowBox[{"par", ":", " ", 
    RowBox[{
     SuperscriptBox["\[Alpha]", "2"], 
     RowBox[{"\[CapitalSigma]", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}]}], "=", 
  RowBox[{
   RowBox[{"1", "  ", "et", " ", 
    SuperscriptBox["\[Beta]", "2"], 
    RowBox[{"\[CapitalSigma]", "[", 
     RowBox[{"[", 
      RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "=", "1", "  "}]}]], "Text",
 CellChangeTimes->{{3.404728737586547*^9, 3.404728803820922*^9}}],

Cell["on calcule les nouveau parametres par ", "Text",
 CellChangeTimes->{{3.404728905789672*^9, 3.404728917289672*^9}}],

Cell[BoxData[
 RowBox[{
  OverscriptBox["M", "_"], "=", 
  RowBox[{
   RowBox[{"(", GridBox[{
      {"\[Alpha]", "0"},
      {"0", "\[Beta]"}
     }], ")"}], "M", " ", 
   RowBox[{"(", GridBox[{
      {
       SuperscriptBox["\[Alpha]", 
        RowBox[{"-", "1"}]], "0"},
      {"0", 
       SuperscriptBox["\[Beta]", 
        RowBox[{"-", "1"}]]}
     }], ")"}]}]}]], "Text",
 CellChangeTimes->{{3.404727648805297*^9, 3.404727658414672*^9}}],

Cell[BoxData[
 RowBox[{
  OverscriptBox[
   SubscriptBox["\[CapitalSigma]", "\[Infinity]"], "_"], "=", 
  RowBox[{
   RowBox[{"(", GridBox[{
      {"\[Alpha]", "0"},
      {"0", "\[Beta]"}
     }], ")"}], 
   SubscriptBox["\[CapitalSigma]", "\[Infinity]"], 
   RowBox[{"(", GridBox[{
      {"\[Alpha]", "0"},
      {"0", "\[Beta]"}
     }], ")"}]}]}]], "Text",
 CellChangeTimes->{{3.404727673789672*^9, 3.404727691555297*^9}}],

Cell[BoxData[
 RowBox[{
  OverscriptBox[
   RowBox[{" ", "Q"}], "_"], "=", 
  RowBox[{"Q", 
   RowBox[{"(", GridBox[{
      {"\[Alpha]", "0"},
      {"0", "\[Beta]"}
     }], ")"}]}]}]], "Text",
 CellChangeTimes->{{3.404727707039672*^9, 3.404727712961547*^9}}],

Cell[BoxData[
 RowBox[{
  OverscriptBox["\[CapitalSigma]", "_"], "=", 
  RowBox[{
   RowBox[{"(", GridBox[{
      {"\[Alpha]", "0"},
      {"0", "\[Beta]"}
     }], ")"}], "\[CapitalSigma]", 
   RowBox[{"(", GridBox[{
      {"\[Alpha]", "0"},
      {"0", "\[Beta]"}
     }], ")"}]}]}]], "Text",
 CellChangeTimes->{{3.404728946555297*^9, 3.404728949367797*^9}}],

Cell["d' autrepart", "Text",
 CellChangeTimes->{{3.404728961649047*^9, 3.404728962055297*^9}, {
  3.404729220383422*^9, 3.404729223274047*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["\[Beta]", "x"], " ", 
   SuperscriptBox["Q", "*"], "Q"}], "=", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "M"}], " ", 
    SubscriptBox["\[CapitalSigma]", "\[Infinity]"]}], "-", 
   RowBox[{
    SubscriptBox["\[CapitalSigma]", "\[Infinity]"], 
    SuperscriptBox["M", "*"]}]}]}]], "Text",
 CellChangeTimes->{{3.398746969101185*^9, 3.3987470046337996`*^9}, 
   3.404729123242797*^9, {3.404729161430297*^9, 3.404729164539672*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"determine", " ", "la", " ", "transformation", " ", "sur", " ", 
   SubscriptBox["\[Beta]", "x"], "  ", "est", " ", "donc", " ", "un", " ", 
   RowBox[{"scalaire", " ", ":", " ", 
    OverscriptBox[
     SubscriptBox["\[Beta]", "x"], "_"]}]}], "=", 
  SubscriptBox["\[Beta]", "x"]}]], "Text",
 CellChangeTimes->{{3.404729142758422*^9, 3.404729213383422*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "On", " ", "calcule", " ", "alors", " ", "le", " ", "prix", " ", "de", " ", 
   
   RowBox[{"l", "'"}], "option", "  ", "par", " ", "O"}], "=", 
  RowBox[{
   RowBox[{"E", "[", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["S", "1"], 
      SubscriptBox["a", "1"]], "-", 
     SuperscriptBox[
      SubscriptBox["S", "2"], 
      SubscriptBox["a", "2"]], "-", "K"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"E", "[", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["L", "1"], 
        FractionBox[
         SubscriptBox["a", "1"], "\[Alpha]"]], "-", 
       SuperscriptBox[
        SubscriptBox["L", "2"], 
        FractionBox[
         SubscriptBox["a", "2"], "\[Beta]"]], "-", "K"}], "]"}], "  ", "avec",
      " ", "un", " ", "drift", " ", "supplementaire", " ", "dans", " ", "le", 
     " ", "process", " ", "egal", " ", "a"}], " ", "-", 
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         FractionBox[
          RowBox[{"\[Alpha]", 
           RowBox[{"(", 
            RowBox[{"\[Alpha]", "-", "1"}], ")"}]}], "2"], 
         SubscriptBox["\[CapitalSigma]", "11"]}]},
       {
        RowBox[{
         FractionBox[
          RowBox[{"\[Beta]", 
           RowBox[{"(", 
            RowBox[{"\[Beta]", "-", "1"}], ")"}]}], "2"], 
         SubscriptBox["\[CapitalSigma]", "22"]}]}
      }], ")"}]}]}]}]], "Text",
 CellChangeTimes->{{3.404729232617797*^9, 3.404729294508422*^9}, {
   3.404812894255623*^9, 3.404812910693754*^9}, {3.404814206696644*^9, 
   3.404814294434388*^9}, 3.404814335810977*^9, 3.4048143686716137`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ceci", " ", "permet", " ", 
   RowBox[{"d", "'"}], "eliminer", " ", "de", " ", 
   RowBox[{"l", "'"}], "equation", "  ", 
   SubscriptBox["\[CapitalSigma]", "1"], " ", "et", " ", 
   SubscriptBox["\[CapitalSigma]", "2"], " ", "qui", " ", "sont", " ", 
   "toujours", " ", "suppos\[EAcute]"}], " ", "=", " ", 
  RowBox[{
  "1", "  ", "lors", " ", "de", " ", "la", " ", "calibration"}]}]], "Text",
 CellChangeTimes->{{3.404729410477172*^9, 3.404729469258422*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Propagators", "Subtitle",
 CellChangeTimes->{{3.404644267337777*^9, 3.4046442709472218`*^9}}],

Cell["\<\

Therefore we can write a first version of the propagator \
\>", "Text",
 CellChangeTimes->{{3.4028321906328936`*^9, 3.4028322130708246`*^9}, {
  3.403431063408727*^9, 3.4034310638306103`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SuperBiHestonLaplaceTransform", "[", 
   RowBox[{"M_", ",", "Q_", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Theta]11_", ",", "\[Theta]12_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Theta]12_", ",", "\[Theta]22_"}], "}"}]}], "}"}], ",", 
    "\[Rho]_", ",", "\[Mu]_", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[CapitalSigma]11_", ",", "\[CapitalSigma]12_"}], "}"}], ",", 
      
      RowBox[{"{", 
       RowBox[{"\[CapitalSigma]12_", ",", "\[CapitalSigma]22_"}], "}"}]}], 
     "}"}], ",", "\[Gamma]_", ",", "\[Beta]_", ",", "\[Tau]_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "H", ",", "EXPH", ",", "A11", ",", "A21", ",", "A", ",", "\[Nu]11", ",", 
      "\[Nu]12", ",", "\[Nu]21", ",", "\[Nu]22", ",", "c", ",", 
      RowBox[{"\[CapitalSigma]", "=", 
       RowBox[{"(", GridBox[{
          {"\[CapitalSigma]11", "\[CapitalSigma]12"},
          {"\[CapitalSigma]12", "\[CapitalSigma]22"}
         }], ")"}]}], ",", 
      RowBox[{"\[CapitalSigma]infM", "=", 
       RowBox[{"(", GridBox[{
          {"\[Theta]11", "\[Theta]12"},
          {"\[Theta]12", "\[Theta]22"}
         }], ")"}]}], ",", 
      RowBox[{"M\[Mu]", "=", 
       RowBox[{"DiagonalMatrix", "[", "\[Mu]", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Placement1", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ",", 
      
      RowBox[{"Placement2", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}]}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"H", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Transpose", "[", "Placement1", "]"}], " ", ".", 
        RowBox[{"(", 
         FractionBox[
          RowBox[{"-", 
           RowBox[{"(", " ", 
            RowBox[{"M", "+", 
             RowBox[{
              RowBox[{"Transpose", "[", "Q", "]"}], ".", 
              RowBox[{"Outer", "[", 
               RowBox[{"Times", ",", "\[Rho]", ",", "\[Gamma]"}], "]"}]}]}], 
            ")"}]}], "2"], ")"}], ".", "Placement1"}], "+", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Transpose", "[", "Placement1", "]"}], " ", ".", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{
            RowBox[{"Transpose", "[", "Q", "]"}], ".", " ", "Q"}]}], "/", 
          "2"}], ")"}], ".", "Placement2"}], "+", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Transpose", "[", "Placement2", "]"}], " ", ".", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], 
           RowBox[{"Outer", "[", 
            RowBox[{"Times", ",", "\[Gamma]", ",", "\[Gamma]"}], "]"}]}], "+",
           
          RowBox[{"DiagonalMatrix", "[", 
           RowBox[{
            RowBox[{"M\[Mu]", ".", "\[Gamma]"}], "-", 
            FractionBox["\[Gamma]", "2"]}], "]"}]}], " ", ")"}], ".", 
        "Placement1"}], "+", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Transpose", "[", "Placement2", "]"}], " ", ".", " ", 
        RowBox[{"(", 
         RowBox[{"Transpose", "[", 
          FractionBox[
           RowBox[{"M", "+", 
            RowBox[{
             RowBox[{"Transpose", "[", "Q", "]"}], ".", 
             RowBox[{"Outer", "[", 
              RowBox[{"Times", ",", "\[Rho]", ",", "\[Gamma]"}], "]"}]}]}], 
           "2"], "]"}], ")"}], ".", "Placement2"}]}]}], " ", ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"EXPH", "=", 
      RowBox[{"MatrixExp", "[", 
       RowBox[{"\[Tau]", " ", "H"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"A11", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"EXPH", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"EXPH", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"EXPH", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"EXPH", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"A21", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"EXPH", "[", 
           RowBox[{"[", 
            RowBox[{"3", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"EXPH", "[", 
           RowBox[{"[", 
            RowBox[{"3", ",", "2"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"EXPH", "[", 
           RowBox[{"[", 
            RowBox[{"4", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"EXPH", "[", 
           RowBox[{"[", 
            RowBox[{"4", ",", "2"}], "]"}], "]"}]}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"A", "=", 
      RowBox[{
       RowBox[{"Inverse", "[", "A11", "]"}], " ", ".", "A21"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{
       RowBox[{"-", "2"}], 
       SuperscriptBox["\[Beta]", "2"], 
       RowBox[{"(", 
        RowBox[{"Tr", "[", 
         RowBox[{
          RowBox[{"MatrixLog2", "[", "A11", "]"}], "+", 
          RowBox[{
           FractionBox["\[Tau]", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Transpose", "[", "M", "]"}], "+", 
             RowBox[{
              RowBox[{"Outer", "[", 
               RowBox[{"Times", ",", "\[Gamma]", ",", "\[Rho]"}], "]"}], ".", 
              "Q"}]}], ")"}]}]}], "]"}], ")"}]}]}], ";", " ", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"c", "=", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["\[Beta]", "2"]}], " ", 
         RowBox[{"Tr", "[", 
          RowBox[{
           RowBox[{"Log", "[", "A22", "]"}], "+", 
           RowBox[{"\[Tau]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Transpose", "[", "M", "]"}], "+", 
              RowBox[{
               RowBox[{"Outer", "[", 
                RowBox[{"Times", ",", "\[Gamma]", ",", "\[Rho]"}], "]"}], ".",
                "Q"}]}], ")"}]}]}], "]"}]}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"Tr", "[", 
        RowBox[{"A", " ", ".", " ", "\[CapitalSigma]"}], "]"}], "+", "c"}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.398689746086896*^9, 3.39868976571579*^9}, {
   3.398690925586488*^9, 3.3986910907286205`*^9}, {3.398691590593399*^9, 
   3.3986916004234734`*^9}, {3.398692032962397*^9, 3.39869209364631*^9}, {
   3.3986925101195464`*^9, 3.398692518433696*^9}, {3.3986951810712333`*^9, 
   3.398695325084175*^9}, {3.3986953610600605`*^9, 3.3986954393099575`*^9}, {
   3.3986965831453133`*^9, 3.3986966039671736`*^9}, {3.398696639308217*^9, 
   3.3986966879654016`*^9}, {3.3986967213097916`*^9, 
   3.3986967248567348`*^9}, {3.398696770904494*^9, 3.398696889344268*^9}, {
   3.3986970007620354`*^9, 3.3986970489713306`*^9}, {3.3986974823842573`*^9, 
   3.398697532752773*^9}, {3.3987529399727573`*^9, 3.39875299455193*^9}, {
   3.398753037990264*^9, 3.398753063678257*^9}, {3.3987531523205843`*^9, 
   3.3987532912763767`*^9}, {3.3987533420586023`*^9, 
   3.3987534255914555`*^9}, {3.3987534717642174`*^9, 
   3.3987535094368153`*^9}, {3.3987770283161182`*^9, 3.398777119911627*^9}, {
   3.398777173522031*^9, 3.398777249148483*^9}, {3.3990283070466003`*^9, 
   3.399028307655995*^9}, {3.399028744357469*^9, 3.399028747638824*^9}, {
   3.3993525960192556`*^9, 3.39935261708216*^9}, {3.3993530399027777`*^9, 
   3.399353055590579*^9}, 3.3993531000289326`*^9, {3.39935333325216*^9, 
   3.3993533979565277`*^9}, 3.3993534714110627`*^9, {3.399353504239818*^9, 
   3.399353526130863*^9}, 3.399353619663909*^9, {3.3993538043237047`*^9, 
   3.399353861434176*^9}, {3.3993540798758698`*^9, 3.399354117782848*^9}, {
   3.3993543213648815`*^9, 3.399354332724475*^9}, {3.3993544810085716`*^9, 
   3.399354488368088*^9}, 3.39935480565543*^9, 3.3993552721487613`*^9, {
   3.3993666542422934`*^9, 3.3993667471347017`*^9}, {3.39936684574597*^9, 
   3.399366860105621*^9}, {3.3993675282121983`*^9, 3.3993675314310102`*^9}, 
   3.399609417953703*^9, {3.3996423849276905`*^9, 3.399642397068549*^9}, {
   3.3996424279285164`*^9, 3.3996424822108088`*^9}, {3.399703313058091*^9, 
   3.3997033979815965`*^9}, {3.3997034597952833`*^9, 3.399703478998777*^9}, {
   3.3997101596895437`*^9, 3.399710194955846*^9}, {3.399710680543294*^9, 
   3.399710729044225*^9}, 3.3997107627323723`*^9, {3.3997108923442354`*^9, 
   3.3997108934692574`*^9}, {3.3997181401396403`*^9, 3.399718148483551*^9}, {
   3.3997182570481353`*^9, 3.399718312096067*^9}, {3.399718413160507*^9, 
   3.39971842398884*^9}, {3.3997185011465716`*^9, 3.3997185329909334`*^9}, {
   3.3997185745698566`*^9, 3.399718598664069*^9}, {3.39972065528168*^9, 
   3.39972071751725*^9}, {3.3997232187840233`*^9, 3.399723233643684*^9}, {
   3.3997234000531287`*^9, 3.3997234005687637`*^9}, {3.400407907714303*^9, 
   3.400407915261323*^9}, {3.4004155917680845`*^9, 3.400415629628186*^9}, {
   3.4005721179416647`*^9, 3.4005721419890013`*^9}, {3.4005721760052795`*^9, 
   3.4005721845835695`*^9}, {3.4005722273656406`*^9, 
   3.4005722379752197`*^9}, {3.400572305273387*^9, 3.400572337055247*^9}, {
   3.400816614783207*^9, 3.4008166155332212`*^9}, 3.402032114347872*^9, {
   3.4028353472559996`*^9, 3.4028353984913588`*^9}, {3.4047376446237235`*^9, 
   3.404737659686513*^9}, {3.404737751641403*^9, 3.404737757391514*^9}, {
   3.404737850565178*^9, 3.404737873237488*^9}, {3.404825612650241*^9, 
   3.40482561680665*^9}, {3.4048272033988233`*^9, 3.404827225243412*^9}, {
   3.404827269682618*^9, 3.4048272757766027`*^9}, {3.4048273120592456`*^9, 
   3.4048273161531525`*^9}, {3.4048274100161324`*^9, 
   3.4048275046916423`*^9}, {3.4064671235520844`*^9, 3.4064671239739704`*^9}}],\


Cell[BoxData[
 RowBox[{
  RowBox[{"SuperBiHestonLaplaceTransform", "[", 
   RowBox[{"M_", ",", "Q_", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Theta]11_", ",", "\[Theta]12_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Theta]12_", ",", "\[Theta]22_"}], "}"}]}], "}"}], ",", 
    "\[Rho]_", ",", "\[Mu]_", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[CapitalSigma]11_", ",", "\[CapitalSigma]12_"}], "}"}], ",", 
      
      RowBox[{"{", 
       RowBox[{"\[CapitalSigma]12_", ",", "\[CapitalSigma]22_"}], "}"}]}], 
     "}"}], ",", "\[Gamma]_", ",", "\[Beta]_", ",", "\[Tau]_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "H", ",", "EXPH", ",", "A11", ",", "A21", ",", "A", ",", "\[Nu]11", ",", 
      "\[Nu]12", ",", "\[Nu]21", ",", "\[Nu]22", ",", "c", ",", 
      RowBox[{"\[CapitalSigma]", "=", 
       RowBox[{"(", GridBox[{
          {"\[CapitalSigma]11", "\[CapitalSigma]12"},
          {"\[CapitalSigma]12", "\[CapitalSigma]22"}
         }], ")"}]}], ",", 
      RowBox[{"\[CapitalSigma]infM", "=", 
       RowBox[{"(", GridBox[{
          {"\[Theta]11", "\[Theta]12"},
          {"\[Theta]12", "\[Theta]22"}
         }], ")"}]}], ",", 
      RowBox[{"M\[Mu]", "=", 
       RowBox[{"DiagonalMatrix", "[", "\[Mu]", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Placement1", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ",", 
      
      RowBox[{"Placement2", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}]}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"H", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Transpose", "[", "Placement1", "]"}], " ", ".", 
        RowBox[{"(", 
         FractionBox[
          RowBox[{"-", 
           RowBox[{"(", " ", 
            RowBox[{"M", "+", 
             RowBox[{
              RowBox[{"Transpose", "[", "Q", "]"}], ".", 
              RowBox[{"Outer", "[", 
               RowBox[{"Times", ",", "\[Rho]", ",", "\[Gamma]"}], "]"}]}]}], 
            ")"}]}], "2"], ")"}], ".", "Placement1"}], "+", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Transpose", "[", "Placement1", "]"}], " ", ".", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{
            RowBox[{"Transpose", "[", "Q", "]"}], ".", " ", "Q"}]}], "/", 
          "2"}], ")"}], ".", "Placement2"}], "+", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Transpose", "[", "Placement2", "]"}], " ", ".", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], 
           RowBox[{"Outer", "[", 
            RowBox[{"Times", ",", "\[Gamma]", ",", "\[Gamma]"}], "]"}]}], "+",
           
          RowBox[{"DiagonalMatrix", "[", 
           RowBox[{
            RowBox[{"M\[Mu]", ".", "\[Gamma]"}], "-", 
            FractionBox["\[Gamma]", "2"]}], "]"}]}], " ", ")"}], ".", 
        "Placement1"}], "+", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Transpose", "[", "Placement2", "]"}], " ", ".", " ", 
        RowBox[{"(", 
         RowBox[{"Transpose", "[", 
          FractionBox[
           RowBox[{"M", "+", 
            RowBox[{
             RowBox[{"Transpose", "[", "Q", "]"}], ".", 
             RowBox[{"Outer", "[", 
              RowBox[{"Times", ",", "\[Rho]", ",", "\[Gamma]"}], "]"}]}]}], 
           "2"], "]"}], ")"}], ".", "Placement2"}]}]}], " ", ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"EXPH", "=", 
      RowBox[{"MatrixExp", "[", 
       RowBox[{"\[Tau]", " ", "H"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"A11", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"EXPH", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"EXPH", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"EXPH", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"EXPH", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"A21", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"EXPH", "[", 
           RowBox[{"[", 
            RowBox[{"3", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"EXPH", "[", 
           RowBox[{"[", 
            RowBox[{"3", ",", "2"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"EXPH", "[", 
           RowBox[{"[", 
            RowBox[{"4", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"EXPH", "[", 
           RowBox[{"[", 
            RowBox[{"4", ",", "2"}], "]"}], "]"}]}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"A", "=", 
      RowBox[{
       RowBox[{"Inverse", "[", "A11", "]"}], " ", ".", "A21"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{
       RowBox[{"-", "2"}], 
       SuperscriptBox["\[Beta]", "2"], 
       RowBox[{"(", 
        RowBox[{"Tr", "[", 
         RowBox[{
          RowBox[{"MatrixLog2", "[", "A11", "]"}], "+", 
          RowBox[{
           FractionBox["\[Tau]", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Transpose", "[", "M", "]"}], "+", 
             RowBox[{
              RowBox[{"Outer", "[", 
               RowBox[{"Times", ",", "\[Gamma]", ",", "\[Rho]"}], "]"}], ".", 
              "Q"}]}], ")"}]}]}], "]"}], ")"}]}]}], ";", " ", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"c", "=", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["\[Beta]", "2"]}], " ", 
         RowBox[{"Tr", "[", 
          RowBox[{
           RowBox[{"Log", "[", "A22", "]"}], "+", 
           RowBox[{"\[Tau]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Transpose", "[", "M", "]"}], "+", 
              RowBox[{
               RowBox[{"Outer", "[", 
                RowBox[{"Times", ",", "\[Gamma]", ",", "\[Rho]"}], "]"}], ".",
                "Q"}]}], ")"}]}]}], "]"}]}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"Tr", "[", 
        RowBox[{"A", " ", ".", " ", "\[CapitalSigma]"}], "]"}], "+", "c"}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.398689746086896*^9, 3.39868976571579*^9}, {
   3.398690925586488*^9, 3.3986910907286205`*^9}, {3.398691590593399*^9, 
   3.3986916004234734`*^9}, {3.398692032962397*^9, 3.39869209364631*^9}, {
   3.3986925101195464`*^9, 3.398692518433696*^9}, {3.3986951810712333`*^9, 
   3.398695325084175*^9}, {3.3986953610600605`*^9, 3.3986954393099575`*^9}, {
   3.3986965831453133`*^9, 3.3986966039671736`*^9}, {3.398696639308217*^9, 
   3.3986966879654016`*^9}, {3.3986967213097916`*^9, 
   3.3986967248567348`*^9}, {3.398696770904494*^9, 3.398696889344268*^9}, {
   3.3986970007620354`*^9, 3.3986970489713306`*^9}, {3.3986974823842573`*^9, 
   3.398697532752773*^9}, {3.3987529399727573`*^9, 3.39875299455193*^9}, {
   3.398753037990264*^9, 3.398753063678257*^9}, {3.3987531523205843`*^9, 
   3.3987532912763767`*^9}, {3.3987533420586023`*^9, 
   3.3987534255914555`*^9}, {3.3987534717642174`*^9, 
   3.3987535094368153`*^9}, {3.3987770283161182`*^9, 3.398777119911627*^9}, {
   3.398777173522031*^9, 3.398777249148483*^9}, {3.3990283070466003`*^9, 
   3.399028307655995*^9}, {3.399028744357469*^9, 3.399028747638824*^9}, {
   3.3993525960192556`*^9, 3.39935261708216*^9}, {3.3993530399027777`*^9, 
   3.399353055590579*^9}, 3.3993531000289326`*^9, {3.39935333325216*^9, 
   3.3993533979565277`*^9}, 3.3993534714110627`*^9, {3.399353504239818*^9, 
   3.399353526130863*^9}, 3.399353619663909*^9, {3.3993538043237047`*^9, 
   3.399353861434176*^9}, {3.3993540798758698`*^9, 3.399354117782848*^9}, {
   3.3993543213648815`*^9, 3.399354332724475*^9}, {3.3993544810085716`*^9, 
   3.399354488368088*^9}, 3.39935480565543*^9, 3.3993552721487613`*^9, {
   3.3993666542422934`*^9, 3.3993667471347017`*^9}, {3.39936684574597*^9, 
   3.399366860105621*^9}, {3.3993675282121983`*^9, 3.3993675314310102`*^9}, 
   3.399609417953703*^9, {3.3996423849276905`*^9, 3.399642397068549*^9}, {
   3.3996424279285164`*^9, 3.3996424822108088`*^9}, {3.399703313058091*^9, 
   3.3997033979815965`*^9}, {3.3997034597952833`*^9, 3.399703478998777*^9}, {
   3.3997101596895437`*^9, 3.399710194955846*^9}, {3.399710680543294*^9, 
   3.399710729044225*^9}, 3.3997107627323723`*^9, {3.3997108923442354`*^9, 
   3.3997108934692574`*^9}, {3.3997181401396403`*^9, 3.399718148483551*^9}, {
   3.3997182570481353`*^9, 3.399718312096067*^9}, {3.399718413160507*^9, 
   3.39971842398884*^9}, {3.3997185011465716`*^9, 3.3997185329909334`*^9}, {
   3.3997185745698566`*^9, 3.399718598664069*^9}, {3.39972065528168*^9, 
   3.39972071751725*^9}, {3.3997232187840233`*^9, 3.399723233643684*^9}, {
   3.3997234000531287`*^9, 3.3997234005687637`*^9}, {3.400407907714303*^9, 
   3.400407915261323*^9}, {3.4004155917680845`*^9, 3.400415629628186*^9}, {
   3.4005721179416647`*^9, 3.4005721419890013`*^9}, {3.4005721760052795`*^9, 
   3.4005721845835695`*^9}, {3.4005722273656406`*^9, 
   3.4005722379752197`*^9}, {3.400572305273387*^9, 3.400572337055247*^9}, {
   3.400816614783207*^9, 3.4008166155332212`*^9}, 3.402032114347872*^9, {
   3.4028353472559996`*^9, 3.4028353984913588`*^9}, {3.4047376446237235`*^9, 
   3.404737659686513*^9}, {3.404737751641403*^9, 3.404737757391514*^9}, {
   3.404737850565178*^9, 3.404737873237488*^9}, 3.4048256548862376`*^9, {
   3.4048275611313095`*^9, 3.4048275717879686`*^9}, {3.4050729197857585`*^9, 
   3.405072928489106*^9}, {3.4063852151946507`*^9, 3.406385215866792*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"BiHestonLaplaceQuickTransform", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"M11_", ",", "M12_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"M21_", ",", "M22_"}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Q11_", ",", "Q12_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Q21_", ",", "Q22_"}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Rho]1_", ",", "\[Rho]2_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Mu]1_", ",", "\[Mu]2_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[CapitalSigma]11_", ",", "\[CapitalSigma]12_"}], "}"}], ",", 
      
      RowBox[{"{", 
       RowBox[{"\[CapitalSigma]21_", ",", "\[CapitalSigma]22_"}], "}"}]}], 
     "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Gamma]1_", ",", "\[Gamma]2_"}], "}"}], ",", "\[Beta]_", ",", 
    "\[Tau]_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"EXPH", ",", 
      RowBox[{"X11", "=", 
       RowBox[{
        RowBox[{"Q11", " ", "\[Rho]1"}], "+", 
        RowBox[{"Q21", " ", "\[Rho]2"}]}]}], ",", 
      RowBox[{"X12", "=", 
       RowBox[{
        RowBox[{"Q12", "  ", "\[Rho]1"}], "+", 
        RowBox[{"Q22", "  ", "\[Rho]2"}]}]}], ",", "\[Delta]"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"EXPH", "=", 
      RowBox[{"MatrixExp", "[", 
       RowBox[{"\[Tau]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "M11"}], "-", 
               RowBox[{"X11", " ", "\[Gamma]1"}]}], " ", ")"}]}], ",", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "M12"}], "-", 
               RowBox[{"X11", " ", "\[Gamma]2"}]}], " ", ")"}]}], ",", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", 
                SuperscriptBox["Q11", "2"]}], "-", 
               SuperscriptBox["Q21", "2"]}], ")"}]}], ",", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "Q11"}], " ", "Q12"}], "-", 
               RowBox[{"Q21", " ", "Q22"}]}], ")"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "M21"}], "-", 
               RowBox[{"X12", " ", "\[Gamma]1"}]}], " ", ")"}]}], ",", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "M22"}], "-", 
               RowBox[{"X12", " ", "\[Gamma]2"}]}], " ", ")"}]}], ",", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "Q11"}], " ", "Q12"}], "-", 
               RowBox[{"Q21", " ", "Q22"}]}], ")"}]}], ",", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", 
                SuperscriptBox["Q12", "2"]}], "-", 
               SuperscriptBox["Q22", "2"]}], ")"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              FractionBox["\[Gamma]1", "2"]}], "+", 
             FractionBox[
              SuperscriptBox["\[Gamma]1", "2"], "2"], "+", 
             RowBox[{"\[Gamma]1", " ", "\[Mu]1"}]}], ",", 
            FractionBox[
             RowBox[{"\[Gamma]1", " ", "\[Gamma]2"}], "2"], ",", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"M11", "+", 
               RowBox[{"X11", " ", "\[Gamma]1"}]}], " ", ")"}]}], ",", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"M21", "+", 
               RowBox[{"X12", " ", "\[Gamma]1"}]}], ")"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            FractionBox[
             RowBox[{"\[Gamma]1", " ", "\[Gamma]2"}], "2"], ",", 
            RowBox[{
             RowBox[{"-", 
              FractionBox["\[Gamma]2", "2"]}], "+", 
             FractionBox[
              SuperscriptBox["\[Gamma]2", "2"], "2"], "+", 
             RowBox[{"\[Gamma]2", " ", "\[Mu]2"}]}], ",", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"M12", "+", 
               RowBox[{"X11", " ", "\[Gamma]2"}]}], " ", ")"}]}], ",", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"M22", "+", 
               RowBox[{"X12", " ", "\[Gamma]2"}]}], " ", ")"}]}]}], "}"}]}], 
         "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Delta]", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"EXPH", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}]}], " ", 
        RowBox[{"EXPH", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"EXPH", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
        RowBox[{"EXPH", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{
        FractionBox["1", "\[Delta]"], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", 
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"3", ",", "1"}], "]"}], "]"}], " ", 
           "\[CapitalSigma]11"}], "-", 
          RowBox[{
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", 
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"4", ",", "1"}], "]"}], "]"}], " ", 
           "\[CapitalSigma]11"}], "-", 
          RowBox[{
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", 
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"3", ",", "1"}], "]"}], "]"}], " ", 
           "\[CapitalSigma]12"}], "+", 
          RowBox[{
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", 
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"3", ",", "2"}], "]"}], "]"}], " ", 
           "\[CapitalSigma]12"}], "+", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"4", ",", "1"}], "]"}], "]"}], " ", 
           "\[CapitalSigma]12"}], "-", 
          RowBox[{
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", 
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"4", ",", "2"}], "]"}], "]"}], " ", 
           "\[CapitalSigma]12"}], "-", 
          RowBox[{
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", 
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"3", ",", "2"}], "]"}], "]"}], " ", 
           "\[CapitalSigma]22"}], "+", 
          RowBox[{
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"4", ",", "2"}], "]"}], "]"}], " ", 
           "\[CapitalSigma]22"}]}], ")"}]}], "-", 
       RowBox[{"2", 
        SuperscriptBox["\[Beta]", "2"], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Log", "[", "\[Delta]", "]"}], "+", 
          RowBox[{
           FractionBox["\[Tau]", "2"], 
           RowBox[{"(", " ", 
            RowBox[{"M11", "+", "M22", "+", 
             RowBox[{"Q11", " ", "\[Gamma]1", " ", "\[Rho]1"}], "+", 
             RowBox[{"Q12", " ", "\[Gamma]2", " ", "\[Rho]1"}], "+", 
             RowBox[{"Q21", " ", "\[Gamma]1", " ", "\[Rho]2"}], "+", 
             RowBox[{"Q22", " ", "\[Gamma]2", " ", "\[Rho]2"}]}], ")"}]}]}], 
         ")"}]}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.398689746086896*^9, 3.39868976571579*^9}, {
   3.398690925586488*^9, 3.3986910907286205`*^9}, {3.398691590593399*^9, 
   3.3986916004234734`*^9}, {3.398692032962397*^9, 3.39869209364631*^9}, {
   3.3986925101195464`*^9, 3.398692518433696*^9}, {3.3986951810712333`*^9, 
   3.398695325084175*^9}, {3.3986953610600605`*^9, 3.3986954393099575`*^9}, {
   3.3986965831453133`*^9, 3.3986966039671736`*^9}, {3.398696639308217*^9, 
   3.3986966879654016`*^9}, {3.3986967213097916`*^9, 
   3.3986967248567348`*^9}, {3.398696770904494*^9, 3.398696889344268*^9}, {
   3.3986970007620354`*^9, 3.3986970489713306`*^9}, {3.3986974823842573`*^9, 
   3.398697532752773*^9}, {3.3987529399727573`*^9, 3.39875299455193*^9}, {
   3.398753037990264*^9, 3.398753063678257*^9}, {3.3987531523205843`*^9, 
   3.3987532912763767`*^9}, {3.3987533420586023`*^9, 
   3.3987534255914555`*^9}, {3.3987534717642174`*^9, 
   3.3987535094368153`*^9}, {3.3987770283161182`*^9, 3.398777119911627*^9}, {
   3.398777173522031*^9, 3.398777249148483*^9}, {3.3990283070466003`*^9, 
   3.399028307655995*^9}, {3.399028744357469*^9, 3.399028747638824*^9}, {
   3.3993525960192556`*^9, 3.39935261708216*^9}, {3.3993530399027777`*^9, 
   3.399353055590579*^9}, 3.3993531000289326`*^9, {3.39935333325216*^9, 
   3.3993533979565277`*^9}, 3.3993534714110627`*^9, {3.399353504239818*^9, 
   3.399353526130863*^9}, 3.399353619663909*^9, {3.3993538043237047`*^9, 
   3.399353861434176*^9}, {3.3993540798758698`*^9, 3.399354117782848*^9}, {
   3.3993543213648815`*^9, 3.399354332724475*^9}, {3.3993544810085716`*^9, 
   3.399354488368088*^9}, 3.39935480565543*^9, 3.3993552721487613`*^9, {
   3.3993666542422934`*^9, 3.3993667471347017`*^9}, {3.39936684574597*^9, 
   3.399366860105621*^9}, {3.3993675282121983`*^9, 3.3993675314310102`*^9}, 
   3.399609417953703*^9, {3.3996423849276905`*^9, 3.399642397068549*^9}, {
   3.3996424279285164`*^9, 3.3996424822108088`*^9}, {3.399703313058091*^9, 
   3.3997033979815965`*^9}, {3.3997034597952833`*^9, 3.399703478998777*^9}, {
   3.3997101596895437`*^9, 3.399710194955846*^9}, {3.399710680543294*^9, 
   3.399710729044225*^9}, 3.3997107627323723`*^9, {3.3997108923442354`*^9, 
   3.3997108934692574`*^9}, {3.3997181401396403`*^9, 3.399718148483551*^9}, {
   3.3997182570481353`*^9, 3.399718312096067*^9}, {3.399718413160507*^9, 
   3.39971842398884*^9}, {3.3997185011465716`*^9, 3.3997185329909334`*^9}, {
   3.3997185745698566`*^9, 3.399718598664069*^9}, {3.39972065528168*^9, 
   3.39972071751725*^9}, {3.3997232187840233`*^9, 3.399723233643684*^9}, {
   3.3997234000531287`*^9, 3.3997234005687637`*^9}, {3.400407907714303*^9, 
   3.400407915261323*^9}, {3.4004155917680845`*^9, 3.400415629628186*^9}, {
   3.4005721179416647`*^9, 3.4005721419890013`*^9}, {3.4005721760052795`*^9, 
   3.4005721845835695`*^9}, {3.4005722273656406`*^9, 
   3.4005722379752197`*^9}, {3.400572305273387*^9, 3.400572337055247*^9}, {
   3.400816614783207*^9, 3.4008166155332212`*^9}, 3.402032114347872*^9, {
   3.402205513305629*^9, 3.402205553790781*^9}, {3.4022056337298155`*^9, 
   3.402205666777325*^9}, {3.402206142427082*^9, 3.4022061429427176`*^9}, 
   3.4022063420090394`*^9, {3.4022063922287536`*^9, 3.4022064283700724`*^9}, {
   3.4022066940001726`*^9, 3.40220669985966*^9}, {3.402206778392418*^9, 
   3.402206820533852*^9}, {3.4022072688549595`*^9, 3.402207376513276*^9}, {
   3.402207470921339*^9, 3.402207504265729*^9}, {3.4022075400945425`*^9, 
   3.4022077664113874`*^9}, {3.402208049729327*^9, 3.4022080663702717`*^9}, {
   3.402208128355837*^9, 3.402208177075522*^9}, {3.4022082700304317`*^9, 
   3.4022083228439455`*^9}, 3.402208385767029*^9, 3.4022084313304033`*^9, 
   3.4022084987535734`*^9, {3.4022085325667224`*^9, 3.402208610474468*^9}, {
   3.402208698179277*^9, 3.402208738242546*^9}, 3.4022087894622793`*^9, {
   3.4022088244473267`*^9, 3.4022088560729337`*^9}, {3.402208910808359*^9, 
   3.4022089956537385`*^9}, {3.4022091015151463`*^9, 
   3.4022091356720514`*^9}, {3.4022092062046556`*^9, 
   3.4022092880812283`*^9}, {3.4022093816924*^9, 3.4022094398497667`*^9}, {
   3.402212688302761*^9, 3.402212777616976*^9}, 3.402212812648898*^9, {
   3.402212853321554*^9, 3.402212883728388*^9}, {3.4022129482452517`*^9, 
   3.4022129494483995`*^9}, {3.402212981558391*^9, 3.4022129823396564`*^9}, {
   3.40221301534029*^9, 3.4022130161059294`*^9}, 3.4022130658881354`*^9, {
   3.4022133357214413`*^9, 3.4022133506904783`*^9}, {3.402213446504818*^9, 
   3.402213611226731*^9}, {3.402213647289923*^9, 3.402213649961849*^9}, 
   3.4022137912145615`*^9, {3.402213823012047*^9, 3.402213851200088*^9}, 
   3.4022139212326827`*^9, 3.402213972827423*^9, {3.402214042563137*^9, 
   3.4022140431412735`*^9}, {3.402214094486009*^9, 3.402214106033106*^9}, {
   3.4022141823158207`*^9, 3.4022141834720926`*^9}, {3.4022142135507956`*^9, 
   3.402214247520197*^9}, {3.4022143135839653`*^9, 3.40221432161537*^9}, {
   3.4022144793683987`*^9, 3.4022144914311304`*^9}, {3.40221462032423*^9, 
   3.4022146326525917`*^9}, {3.4022147606550493`*^9, 
   3.4022147826867228`*^9}, {3.402215189960167*^9, 3.4022152009447527`*^9}, {
   3.4022152632896996`*^9, 3.4022152646178503`*^9}, 3.4022153593227935`*^9, 
   3.4022154124956894`*^9, 3.4022154543558683`*^9, 3.402215741923889*^9, {
   3.402217172654484*^9, 3.402217224858611*^9}, {3.4022173617987404`*^9, 
   3.4022173701426506`*^9}, {3.4041931588011937`*^9, 
   3.4041931894736576`*^9}, {3.404825670418084*^9, 3.404825686137438*^9}, 
   3.404828040712225*^9, {3.4050729611618176`*^9, 3.4050729667088346`*^9}, {
   3.4050733722192154`*^9, 3.405073376609953*^9}, {3.4070745427411804`*^9, 
   3.407074578507492*^9}, {3.4070750488446474`*^9, 3.407075076173297*^9}, {
   3.4070762659903736`*^9, 3.407076334699854*^9}, {3.407076388248234*^9, 
   3.407076405925764*^9}, {3.4070765072078247`*^9, 3.407076663024642*^9}, {
   3.407077591691184*^9, 3.4070775987538652`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"BiHestonLaplaceQuickTransformReverse", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"M22_", ",", "M21_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"M12_", ",", "M11_"}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Q22_", ",", "Q21_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Q12_", ",", "Q11_"}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Rho]2_", ",", "\[Rho]1_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Mu]2_", ",", "\[Mu]1_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[CapitalSigma]22_", ",", "\[CapitalSigma]21_"}], "}"}], ",", 
      
      RowBox[{"{", 
       RowBox[{"\[CapitalSigma]12_", ",", "\[CapitalSigma]11_"}], "}"}]}], 
     "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Gamma]1_", ",", "\[Gamma]2_"}], "}"}], ",", "\[Beta]_", ",", 
    "\[Tau]_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"EXPH", ",", 
      RowBox[{"X11", "=", 
       RowBox[{
        RowBox[{"Q11", " ", "\[Rho]1"}], "+", 
        RowBox[{"Q21", " ", "\[Rho]2"}]}]}], ",", 
      RowBox[{"X12", "=", 
       RowBox[{
        RowBox[{"Q12", "  ", "\[Rho]1"}], "+", 
        RowBox[{"Q22", "  ", "\[Rho]2"}]}]}], ",", "\[Delta]"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"EXPH", "=", 
      RowBox[{"MatrixExp", "[", 
       RowBox[{"\[Tau]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "M11"}], "-", 
               RowBox[{"X11", " ", "\[Gamma]1"}]}], " ", ")"}]}], ",", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "M12"}], "-", 
               RowBox[{"X11", " ", "\[Gamma]2"}]}], " ", ")"}]}], ",", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", 
                SuperscriptBox["Q11", "2"]}], "-", 
               SuperscriptBox["Q21", "2"]}], ")"}]}], ",", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "Q11"}], " ", "Q12"}], "-", 
               RowBox[{"Q21", " ", "Q22"}]}], ")"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "M21"}], "-", 
               RowBox[{"X12", " ", "\[Gamma]1"}]}], " ", ")"}]}], ",", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "M22"}], "-", 
               RowBox[{"X12", " ", "\[Gamma]2"}]}], " ", ")"}]}], ",", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "Q11"}], " ", "Q12"}], "-", 
               RowBox[{"Q21", " ", "Q22"}]}], ")"}]}], ",", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", 
                SuperscriptBox["Q12", "2"]}], "-", 
               SuperscriptBox["Q22", "2"]}], ")"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              FractionBox["\[Gamma]1", "2"]}], "+", 
             FractionBox[
              SuperscriptBox["\[Gamma]1", "2"], "2"], "+", 
             RowBox[{"\[Gamma]1", " ", "\[Mu]1"}]}], ",", 
            FractionBox[
             RowBox[{"\[Gamma]1", " ", "\[Gamma]2"}], "2"], ",", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"M11", "+", 
               RowBox[{"X11", " ", "\[Gamma]1"}]}], " ", ")"}]}], ",", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"M21", "+", 
               RowBox[{"X12", " ", "\[Gamma]1"}]}], ")"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            FractionBox[
             RowBox[{"\[Gamma]1", " ", "\[Gamma]2"}], "2"], ",", 
            RowBox[{
             RowBox[{"-", 
              FractionBox["\[Gamma]2", "2"]}], "+", 
             FractionBox[
              SuperscriptBox["\[Gamma]2", "2"], "2"], "+", 
             RowBox[{"\[Gamma]2", " ", "\[Mu]2"}]}], ",", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"M12", "+", 
               RowBox[{"X11", " ", "\[Gamma]2"}]}], " ", ")"}]}], ",", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"M22", "+", 
               RowBox[{"X12", " ", "\[Gamma]2"}]}], " ", ")"}]}]}], "}"}]}], 
         "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Delta]", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"EXPH", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}]}], " ", 
        RowBox[{"EXPH", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"EXPH", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
        RowBox[{"EXPH", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{
        FractionBox["1", "\[Delta]"], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", 
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"3", ",", "1"}], "]"}], "]"}], " ", 
           "\[CapitalSigma]11"}], "-", 
          RowBox[{
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", 
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"4", ",", "1"}], "]"}], "]"}], " ", 
           "\[CapitalSigma]11"}], "-", 
          RowBox[{
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", 
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"3", ",", "1"}], "]"}], "]"}], " ", 
           "\[CapitalSigma]12"}], "+", 
          RowBox[{
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", 
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"3", ",", "2"}], "]"}], "]"}], " ", 
           "\[CapitalSigma]12"}], "+", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"4", ",", "1"}], "]"}], "]"}], " ", 
           "\[CapitalSigma]12"}], "-", 
          RowBox[{
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", 
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"4", ",", "2"}], "]"}], "]"}], " ", 
           "\[CapitalSigma]12"}], "-", 
          RowBox[{
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", 
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"3", ",", "2"}], "]"}], "]"}], " ", 
           "\[CapitalSigma]22"}], "+", 
          RowBox[{
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"4", ",", "2"}], "]"}], "]"}], " ", 
           "\[CapitalSigma]22"}]}], ")"}]}], "-", 
       RowBox[{"2", 
        SuperscriptBox["\[Beta]", "2"], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Log", "[", "\[Delta]", "]"}], "+", 
          RowBox[{
           FractionBox["\[Tau]", "2"], 
           RowBox[{"(", " ", 
            RowBox[{"M11", "+", "M22", "+", 
             RowBox[{"Q11", " ", "\[Gamma]1", " ", "\[Rho]1"}], "+", 
             RowBox[{"Q12", " ", "\[Gamma]2", " ", "\[Rho]1"}], "+", 
             RowBox[{"Q21", " ", "\[Gamma]1", " ", "\[Rho]2"}], "+", 
             RowBox[{"Q22", " ", "\[Gamma]2", " ", "\[Rho]2"}]}], ")"}]}]}], 
         ")"}]}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4023212887541575`*^9, 3.4023213706151047`*^9}, {
   3.404193196786298*^9, 3.404193201880146*^9}, {3.404825712419697*^9, 
   3.404825721013777*^9}, 3.4048286525158095`*^9, {3.405072973318379*^9, 
   3.4050729774434843`*^9}, {3.4050733481873503`*^9, 3.405073353968748*^9}, 
   3.4070776481768513`*^9}],

Cell[BoxData[
 RowBox[{"the", " ", "\[Beta]", " ", "matrix", " ", "represents", " ", "here",
   "  ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"M", " ", "\[CapitalSigma]inf"}], "+", 
    RowBox[{"\[CapitalSigma]inf", " ", "M"}]}], " ", ")"}], 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["Q", "*"], "Q"}], ")"}], 
   RowBox[{"-", "1"}]]}]], "Text",
 CellChangeTimes->{{3.4042164761082525`*^9, 3.4042164949523644`*^9}, {
  3.4042165794071107`*^9, 3.404216580391505*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"BiHestonLaplaceQuickTransform2", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"M11_", ",", "M12_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"M21_", ",", "M22_"}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Q11_", ",", "Q12_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Q21_", ",", "Q22_"}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Rho]1_", ",", "\[Rho]2_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Mu]1_", ",", "\[Mu]2_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[CapitalSigma]11_", ",", "\[CapitalSigma]12_"}], "}"}], ",", 
      
      RowBox[{"{", 
       RowBox[{"\[CapitalSigma]21_", ",", "\[CapitalSigma]22_"}], "}"}]}], 
     "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Gamma]1_", ",", "\[Gamma]2_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Beta]11_", ",", "\[Beta]12_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Beta]21_", ",", "\[Beta]22_"}], "}"}]}], "}"}], ",", 
    "\[Tau]_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"EXPH", "=", 
       RowBox[{"MatrixExp", "[", 
        RowBox[{"\[Tau]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              FractionBox["1", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "M11"}], "-", 
                RowBox[{"Q11", " ", "\[Gamma]1", " ", "\[Rho]1"}], "-", 
                RowBox[{"Q21", " ", "\[Gamma]1", " ", "\[Rho]2"}]}], ")"}]}], 
             ",", 
             RowBox[{
              FractionBox["1", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "M12"}], "-", 
                RowBox[{"Q11", " ", "\[Gamma]2", " ", "\[Rho]1"}], "-", 
                RowBox[{"Q21", " ", "\[Gamma]2", " ", "\[Rho]2"}]}], ")"}]}], 
             ",", 
             RowBox[{
              FractionBox["1", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", 
                 SuperscriptBox["Q11", "2"]}], "-", 
                SuperscriptBox["Q21", "2"]}], ")"}]}], ",", 
             RowBox[{
              FractionBox["1", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "Q11"}], " ", "Q12"}], "-", 
                RowBox[{"Q21", " ", "Q22"}]}], ")"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              FractionBox["1", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "M21"}], "-", 
                RowBox[{"Q12", " ", "\[Gamma]1", " ", "\[Rho]1"}], "-", 
                RowBox[{"Q22", " ", "\[Gamma]1", " ", "\[Rho]2"}]}], ")"}]}], 
             ",", 
             RowBox[{
              FractionBox["1", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "M22"}], "-", 
                RowBox[{"Q12", " ", "\[Gamma]2", " ", "\[Rho]1"}], "-", 
                RowBox[{"Q22", " ", "\[Gamma]2", " ", "\[Rho]2"}]}], ")"}]}], 
             ",", 
             RowBox[{
              FractionBox["1", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "Q11"}], " ", "Q12"}], "-", 
                RowBox[{"Q21", " ", "Q22"}]}], ")"}]}], ",", 
             RowBox[{
              FractionBox["1", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", 
                 SuperscriptBox["Q12", "2"]}], "-", 
                SuperscriptBox["Q22", "2"]}], ")"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               FractionBox["\[Gamma]1", "2"]}], "+", 
              FractionBox[
               SuperscriptBox["\[Gamma]1", "2"], "2"], "+", 
              RowBox[{"\[Gamma]1", " ", "\[Mu]1"}]}], ",", 
             FractionBox[
              RowBox[{"\[Gamma]1", " ", "\[Gamma]2"}], "2"], ",", 
             RowBox[{
              FractionBox["1", "2"], " ", 
              RowBox[{"(", 
               RowBox[{"M11", "+", 
                RowBox[{"Q11", " ", "\[Gamma]1", " ", "\[Rho]1"}], "+", 
                RowBox[{"Q21", " ", "\[Gamma]1", " ", "\[Rho]2"}]}], ")"}]}], 
             ",", 
             RowBox[{
              FractionBox["1", "2"], " ", 
              RowBox[{"(", 
               RowBox[{"M21", "+", 
                RowBox[{"Q12", " ", "\[Gamma]1", " ", "\[Rho]1"}], "+", 
                RowBox[{"Q22", " ", "\[Gamma]1", " ", "\[Rho]2"}]}], 
               ")"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             FractionBox[
              RowBox[{"\[Gamma]1", " ", "\[Gamma]2"}], "2"], ",", 
             RowBox[{
              RowBox[{"-", 
               FractionBox["\[Gamma]2", "2"]}], "+", 
              FractionBox[
               SuperscriptBox["\[Gamma]2", "2"], "2"], "+", 
              RowBox[{"\[Gamma]2", " ", "\[Mu]2"}]}], ",", 
             RowBox[{
              FractionBox["1", "2"], " ", 
              RowBox[{"(", 
               RowBox[{"M12", "+", 
                RowBox[{"Q11", " ", "\[Gamma]2", " ", "\[Rho]1"}], "+", 
                RowBox[{"Q21", " ", "\[Gamma]2", " ", "\[Rho]2"}]}], ")"}]}], 
             ",", 
             RowBox[{
              FractionBox["1", "2"], " ", 
              RowBox[{"(", 
               RowBox[{"M22", "+", 
                RowBox[{"Q12", " ", "\[Gamma]2", " ", "\[Rho]1"}], "+", 
                RowBox[{"Q22", " ", "\[Gamma]2", " ", "\[Rho]2"}]}], 
               ")"}]}]}], "}"}]}], "}"}]}], "]"}]}], ",", "\[Delta]", ",", 
      "LogA11"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Delta]", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"EXPH", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}]}], " ", 
        RowBox[{"EXPH", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"EXPH", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
        RowBox[{"EXPH", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"LogA11", "=", 
      RowBox[{"MatrixLog2", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "}"}]}], "}"}], "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{
        FractionBox["1", "\[Delta]"], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", 
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"3", ",", "1"}], "]"}], "]"}], " ", 
           "\[CapitalSigma]11"}], "-", 
          RowBox[{
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", 
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"4", ",", "1"}], "]"}], "]"}], " ", 
           "\[CapitalSigma]11"}], "-", 
          RowBox[{
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", 
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"3", ",", "1"}], "]"}], "]"}], " ", 
           "\[CapitalSigma]12"}], "+", 
          RowBox[{
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", 
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"3", ",", "2"}], "]"}], "]"}], " ", 
           "\[CapitalSigma]12"}], "+", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"4", ",", "1"}], "]"}], "]"}], " ", 
           "\[CapitalSigma]12"}], "-", 
          RowBox[{
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", 
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"4", ",", "2"}], "]"}], "]"}], " ", 
           "\[CapitalSigma]12"}], "-", 
          RowBox[{
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", 
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"3", ",", "2"}], "]"}], "]"}], " ", 
           "\[CapitalSigma]22"}], "+", 
          RowBox[{
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"4", ",", "2"}], "]"}], "]"}], " ", 
           "\[CapitalSigma]22"}]}], ")"}]}], "-", 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Beta]11", " ", 
           RowBox[{"LogA11", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "+", 
          RowBox[{"\[Beta]12", " ", 
           RowBox[{"LogA11", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "+", 
          RowBox[{"\[Beta]21", " ", 
           RowBox[{"LogA11", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "+", 
          RowBox[{"\[Beta]22", " ", 
           RowBox[{"LogA11", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[Beta]11", " ", 
              RowBox[{"(", 
               RowBox[{"M11", "+", 
                RowBox[{"Q11", " ", "\[Gamma]1", " ", "\[Rho]1"}], "+", 
                RowBox[{"Q21", " ", "\[Gamma]1", " ", "\[Rho]2"}]}], ")"}]}], 
             "+", 
             RowBox[{"\[Beta]21", " ", 
              RowBox[{"(", 
               RowBox[{"M21", "+", 
                RowBox[{"Q12", " ", "\[Gamma]1", " ", "\[Rho]1"}], "+", 
                RowBox[{"Q22", " ", "\[Gamma]1", " ", "\[Rho]2"}]}], ")"}]}], 
             "+", 
             RowBox[{"\[Beta]12", " ", 
              RowBox[{"(", 
               RowBox[{"M12", "+", 
                RowBox[{"Q11", " ", "\[Gamma]2", " ", "\[Rho]1"}], "+", 
                RowBox[{"Q21", " ", "\[Gamma]2", " ", "\[Rho]2"}]}], ")"}]}], 
             "+", 
             RowBox[{"\[Beta]22", " ", 
              RowBox[{"(", 
               RowBox[{"M22", "+", 
                RowBox[{"Q12", " ", "\[Gamma]2", " ", "\[Rho]1"}], "+", 
                RowBox[{"Q22", " ", "\[Gamma]2", " ", "\[Rho]2"}]}], 
               ")"}]}]}], ")"}], " ", "\[Tau]"}]}], ")"}]}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.398689746086896*^9, 3.39868976571579*^9}, {
   3.398690925586488*^9, 3.3986910907286205`*^9}, {3.398691590593399*^9, 
   3.3986916004234734`*^9}, {3.398692032962397*^9, 3.39869209364631*^9}, {
   3.3986925101195464`*^9, 3.398692518433696*^9}, {3.3986951810712333`*^9, 
   3.398695325084175*^9}, {3.3986953610600605`*^9, 3.3986954393099575`*^9}, {
   3.3986965831453133`*^9, 3.3986966039671736`*^9}, {3.398696639308217*^9, 
   3.3986966879654016`*^9}, {3.3986967213097916`*^9, 
   3.3986967248567348`*^9}, {3.398696770904494*^9, 3.398696889344268*^9}, {
   3.3986970007620354`*^9, 3.3986970489713306`*^9}, {3.3986974823842573`*^9, 
   3.398697532752773*^9}, {3.3987529399727573`*^9, 3.39875299455193*^9}, {
   3.398753037990264*^9, 3.398753063678257*^9}, {3.3987531523205843`*^9, 
   3.3987532912763767`*^9}, {3.3987533420586023`*^9, 
   3.3987534255914555`*^9}, {3.3987534717642174`*^9, 
   3.3987535094368153`*^9}, {3.3987770283161182`*^9, 3.398777119911627*^9}, {
   3.398777173522031*^9, 3.398777249148483*^9}, {3.3990283070466003`*^9, 
   3.399028307655995*^9}, {3.399028744357469*^9, 3.399028747638824*^9}, {
   3.3993525960192556`*^9, 3.39935261708216*^9}, {3.3993530399027777`*^9, 
   3.399353055590579*^9}, 3.3993531000289326`*^9, {3.39935333325216*^9, 
   3.3993533979565277`*^9}, 3.3993534714110627`*^9, {3.399353504239818*^9, 
   3.399353526130863*^9}, 3.399353619663909*^9, {3.3993538043237047`*^9, 
   3.399353861434176*^9}, {3.3993540798758698`*^9, 3.399354117782848*^9}, {
   3.3993543213648815`*^9, 3.399354332724475*^9}, {3.3993544810085716`*^9, 
   3.399354488368088*^9}, 3.39935480565543*^9, 3.3993552721487613`*^9, {
   3.3993666542422934`*^9, 3.3993667471347017`*^9}, {3.39936684574597*^9, 
   3.399366860105621*^9}, {3.3993675282121983`*^9, 3.3993675314310102`*^9}, 
   3.399609417953703*^9, {3.3996423849276905`*^9, 3.399642397068549*^9}, {
   3.3996424279285164`*^9, 3.3996424822108088`*^9}, {3.399703313058091*^9, 
   3.3997033979815965`*^9}, {3.3997034597952833`*^9, 3.399703478998777*^9}, {
   3.3997101596895437`*^9, 3.399710194955846*^9}, {3.399710680543294*^9, 
   3.399710729044225*^9}, 3.3997107627323723`*^9, {3.3997108923442354`*^9, 
   3.3997108934692574`*^9}, {3.3997181401396403`*^9, 3.399718148483551*^9}, {
   3.3997182570481353`*^9, 3.399718312096067*^9}, {3.399718413160507*^9, 
   3.39971842398884*^9}, {3.3997185011465716`*^9, 3.3997185329909334`*^9}, {
   3.3997185745698566`*^9, 3.399718598664069*^9}, {3.39972065528168*^9, 
   3.39972071751725*^9}, {3.3997232187840233`*^9, 3.399723233643684*^9}, {
   3.3997234000531287`*^9, 3.3997234005687637`*^9}, {3.400407907714303*^9, 
   3.400407915261323*^9}, {3.4004155917680845`*^9, 3.400415629628186*^9}, {
   3.4005721179416647`*^9, 3.4005721419890013`*^9}, {3.4005721760052795`*^9, 
   3.4005721845835695`*^9}, {3.4005722273656406`*^9, 
   3.4005722379752197`*^9}, {3.400572305273387*^9, 3.400572337055247*^9}, {
   3.400816614783207*^9, 3.4008166155332212`*^9}, 3.402032114347872*^9, {
   3.402205513305629*^9, 3.402205553790781*^9}, {3.4022056337298155`*^9, 
   3.402205666777325*^9}, {3.402206142427082*^9, 3.4022061429427176`*^9}, 
   3.4022063420090394`*^9, {3.4022063922287536`*^9, 3.4022064283700724`*^9}, {
   3.4022066940001726`*^9, 3.40220669985966*^9}, {3.402206778392418*^9, 
   3.402206820533852*^9}, {3.4022072688549595`*^9, 3.402207376513276*^9}, {
   3.402207470921339*^9, 3.402207504265729*^9}, {3.4022075400945425`*^9, 
   3.4022077664113874`*^9}, {3.402208049729327*^9, 3.4022080663702717`*^9}, {
   3.402208128355837*^9, 3.402208177075522*^9}, {3.4022082700304317`*^9, 
   3.4022083228439455`*^9}, 3.402208385767029*^9, 3.4022084313304033`*^9, 
   3.4022084987535734`*^9, {3.4022085325667224`*^9, 3.402208610474468*^9}, {
   3.402208698179277*^9, 3.402208738242546*^9}, 3.4022087894622793`*^9, {
   3.4022088244473267`*^9, 3.4022088560729337`*^9}, {3.402208910808359*^9, 
   3.4022089956537385`*^9}, {3.4022091015151463`*^9, 
   3.4022091356720514`*^9}, {3.4022092062046556`*^9, 
   3.4022092880812283`*^9}, {3.4022093816924*^9, 3.4022094398497667`*^9}, {
   3.402212688302761*^9, 3.402212777616976*^9}, 3.402212812648898*^9, {
   3.402212853321554*^9, 3.402212883728388*^9}, {3.4022129482452517`*^9, 
   3.4022129494483995`*^9}, {3.402212981558391*^9, 3.4022129823396564`*^9}, {
   3.40221301534029*^9, 3.4022130161059294`*^9}, 3.4022130658881354`*^9, {
   3.4022133357214413`*^9, 3.4022133506904783`*^9}, {3.402213446504818*^9, 
   3.402213611226731*^9}, {3.402213647289923*^9, 3.402213649961849*^9}, 
   3.4022137912145615`*^9, {3.402213823012047*^9, 3.402213851200088*^9}, 
   3.4022139212326827`*^9, 3.402213972827423*^9, {3.402214042563137*^9, 
   3.4022140431412735`*^9}, {3.402214094486009*^9, 3.402214106033106*^9}, {
   3.4022141823158207`*^9, 3.4022141834720926`*^9}, {3.4022142135507956`*^9, 
   3.402214247520197*^9}, {3.4022143135839653`*^9, 3.40221432161537*^9}, {
   3.4022144793683987`*^9, 3.4022144914311304`*^9}, {3.40221462032423*^9, 
   3.4022146326525917`*^9}, {3.4022147606550493`*^9, 
   3.4022147826867228`*^9}, {3.402215189960167*^9, 3.4022152009447527`*^9}, {
   3.4022152632896996`*^9, 3.4022152646178503`*^9}, 3.4022153593227935`*^9, 
   3.4022154124956894`*^9, 3.4022154543558683`*^9, 3.402215741923889*^9, {
   3.402217172654484*^9, 3.402217224858611*^9}, {3.4022173617987404`*^9, 
   3.4022173701426506`*^9}, {3.4041931588011937`*^9, 
   3.4041931894736576`*^9}, {3.404214076921564*^9, 3.4042140775153255`*^9}, 
   3.404214168142065*^9, {3.404214241862231*^9, 3.404214317269929*^9}, {
   3.404214351676839*^9, 3.4042144035840855`*^9}, {3.4042148344204826`*^9, 
   3.404214844608178*^9}, {3.4042157010621223`*^9, 3.404215733297116*^9}, {
   3.404215928207108*^9, 3.4042160022554045`*^9}, 3.4042167475509644`*^9, {
   3.4042183886762233`*^9, 3.4042183946294622`*^9}, 3.404825703809991*^9, 
   3.4048280570409765`*^9}],

Cell["\<\
the same procedure but where' underlying 1 is echanged with  underlying 2\
\>", "Text",
 CellChangeTimes->{{3.402321252784717*^9, 3.4023212767226768`*^9}, {
  3.4028325455303326`*^9, 3.4028325754527817`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"BiHestonLaplaceQuickTransformReverse2", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"M22_", ",", "M21_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"M12_", ",", "M11_"}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Q22_", ",", "Q21_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Q12_", ",", "Q11_"}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Rho]2_", ",", "\[Rho]1_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Mu]2_", ",", "\[Mu]1_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[CapitalSigma]22_", ",", "\[CapitalSigma]21_"}], "}"}], ",", 
      
      RowBox[{"{", 
       RowBox[{"\[CapitalSigma]12_", ",", "\[CapitalSigma]11_"}], "}"}]}], 
     "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Gamma]1_", ",", "\[Gamma]2_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Beta]11_", ",", "\[Beta]12_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Beta]21_", ",", "\[Beta]22_"}], "}"}]}], "}"}], ",", 
    "\[Tau]_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"EXPH", "=", 
       RowBox[{"MatrixExp", "[", 
        RowBox[{"\[Tau]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              FractionBox["1", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "M11"}], "-", 
                RowBox[{"Q11", " ", "\[Gamma]1", " ", "\[Rho]1"}], "-", 
                RowBox[{"Q21", " ", "\[Gamma]1", " ", "\[Rho]2"}]}], ")"}]}], 
             ",", 
             RowBox[{
              FractionBox["1", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "M12"}], "-", 
                RowBox[{"Q11", " ", "\[Gamma]2", " ", "\[Rho]1"}], "-", 
                RowBox[{"Q21", " ", "\[Gamma]2", " ", "\[Rho]2"}]}], ")"}]}], 
             ",", 
             RowBox[{
              FractionBox["1", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", 
                 SuperscriptBox["Q11", "2"]}], "-", 
                SuperscriptBox["Q21", "2"]}], ")"}]}], ",", 
             RowBox[{
              FractionBox["1", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "Q11"}], " ", "Q12"}], "-", 
                RowBox[{"Q21", " ", "Q22"}]}], ")"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              FractionBox["1", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "M21"}], "-", 
                RowBox[{"Q12", " ", "\[Gamma]1", " ", "\[Rho]1"}], "-", 
                RowBox[{"Q22", " ", "\[Gamma]1", " ", "\[Rho]2"}]}], ")"}]}], 
             ",", 
             RowBox[{
              FractionBox["1", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "M22"}], "-", 
                RowBox[{"Q12", " ", "\[Gamma]2", " ", "\[Rho]1"}], "-", 
                RowBox[{"Q22", " ", "\[Gamma]2", " ", "\[Rho]2"}]}], ")"}]}], 
             ",", 
             RowBox[{
              FractionBox["1", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "Q11"}], " ", "Q12"}], "-", 
                RowBox[{"Q21", " ", "Q22"}]}], ")"}]}], ",", 
             RowBox[{
              FractionBox["1", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", 
                 SuperscriptBox["Q12", "2"]}], "-", 
                SuperscriptBox["Q22", "2"]}], ")"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               FractionBox["\[Gamma]1", "2"]}], "+", 
              FractionBox[
               SuperscriptBox["\[Gamma]1", "2"], "2"], "+", 
              RowBox[{"\[Gamma]1", " ", "\[Mu]1"}]}], ",", 
             FractionBox[
              RowBox[{"\[Gamma]1", " ", "\[Gamma]2"}], "2"], ",", 
             RowBox[{
              FractionBox["1", "2"], " ", 
              RowBox[{"(", 
               RowBox[{"M11", "+", 
                RowBox[{"Q11", " ", "\[Gamma]1", " ", "\[Rho]1"}], "+", 
                RowBox[{"Q21", " ", "\[Gamma]1", " ", "\[Rho]2"}]}], ")"}]}], 
             ",", 
             RowBox[{
              FractionBox["1", "2"], " ", 
              RowBox[{"(", 
               RowBox[{"M21", "+", 
                RowBox[{"Q12", " ", "\[Gamma]1", " ", "\[Rho]1"}], "+", 
                RowBox[{"Q22", " ", "\[Gamma]1", " ", "\[Rho]2"}]}], 
               ")"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             FractionBox[
              RowBox[{"\[Gamma]1", " ", "\[Gamma]2"}], "2"], ",", 
             RowBox[{
              RowBox[{"-", 
               FractionBox["\[Gamma]2", "2"]}], "+", 
              FractionBox[
               SuperscriptBox["\[Gamma]2", "2"], "2"], "+", 
              RowBox[{"\[Gamma]2", " ", "\[Mu]2"}]}], ",", 
             RowBox[{
              FractionBox["1", "2"], " ", 
              RowBox[{"(", 
               RowBox[{"M12", "+", 
                RowBox[{"Q11", " ", "\[Gamma]2", " ", "\[Rho]1"}], "+", 
                RowBox[{"Q21", " ", "\[Gamma]2", " ", "\[Rho]2"}]}], ")"}]}], 
             ",", 
             RowBox[{
              FractionBox["1", "2"], " ", 
              RowBox[{"(", 
               RowBox[{"M22", "+", 
                RowBox[{"Q12", " ", "\[Gamma]2", " ", "\[Rho]1"}], "+", 
                RowBox[{"Q22", " ", "\[Gamma]2", " ", "\[Rho]2"}]}], 
               ")"}]}]}], "}"}]}], "}"}]}], "]"}]}], ",", "\[Delta]", ",", 
      "LogA11"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Delta]", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"EXPH", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}]}], " ", 
        RowBox[{"EXPH", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"EXPH", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
        RowBox[{"EXPH", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"LogA11", "=", 
      RowBox[{"MatrixLog2", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "}"}]}], "}"}], "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{
        FractionBox["1", "\[Delta]"], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", 
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"3", ",", "1"}], "]"}], "]"}], " ", 
           "\[CapitalSigma]11"}], "-", 
          RowBox[{
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", 
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"4", ",", "1"}], "]"}], "]"}], " ", 
           "\[CapitalSigma]11"}], "-", 
          RowBox[{
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", 
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"3", ",", "1"}], "]"}], "]"}], " ", 
           "\[CapitalSigma]12"}], "+", 
          RowBox[{
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", 
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"3", ",", "2"}], "]"}], "]"}], " ", 
           "\[CapitalSigma]12"}], "+", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"4", ",", "1"}], "]"}], "]"}], " ", 
           "\[CapitalSigma]12"}], "-", 
          RowBox[{
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", 
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"4", ",", "2"}], "]"}], "]"}], " ", 
           "\[CapitalSigma]12"}], "-", 
          RowBox[{
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", 
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"3", ",", "2"}], "]"}], "]"}], " ", 
           "\[CapitalSigma]22"}], "+", 
          RowBox[{
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"4", ",", "2"}], "]"}], "]"}], " ", 
           "\[CapitalSigma]22"}]}], ")"}]}], "-", 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Beta]11", " ", 
           RowBox[{"LogA11", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "+", 
          RowBox[{"\[Beta]12", " ", 
           RowBox[{"LogA11", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "+", 
          RowBox[{"\[Beta]21", " ", 
           RowBox[{"LogA11", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "+", 
          RowBox[{"\[Beta]22", " ", 
           RowBox[{"LogA11", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[Beta]11", " ", 
              RowBox[{"(", 
               RowBox[{"M11", "+", 
                RowBox[{"Q11", " ", "\[Gamma]1", " ", "\[Rho]1"}], "+", 
                RowBox[{"Q21", " ", "\[Gamma]1", " ", "\[Rho]2"}]}], ")"}]}], 
             "+", 
             RowBox[{"\[Beta]21", " ", 
              RowBox[{"(", 
               RowBox[{"M21", "+", 
                RowBox[{"Q12", " ", "\[Gamma]1", " ", "\[Rho]1"}], "+", 
                RowBox[{"Q22", " ", "\[Gamma]1", " ", "\[Rho]2"}]}], ")"}]}], 
             "+", 
             RowBox[{"\[Beta]12", " ", 
              RowBox[{"(", 
               RowBox[{"M12", "+", 
                RowBox[{"Q11", " ", "\[Gamma]2", " ", "\[Rho]1"}], "+", 
                RowBox[{"Q21", " ", "\[Gamma]2", " ", "\[Rho]2"}]}], ")"}]}], 
             "+", 
             RowBox[{"\[Beta]22", " ", 
              RowBox[{"(", 
               RowBox[{"M22", "+", 
                RowBox[{"Q12", " ", "\[Gamma]2", " ", "\[Rho]1"}], "+", 
                RowBox[{"Q22", " ", "\[Gamma]2", " ", "\[Rho]2"}]}], 
               ")"}]}]}], ")"}], " ", "\[Tau]"}]}], ")"}]}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4023212887541575`*^9, 3.4023213706151047`*^9}, {
   3.404193196786298*^9, 3.404193201880146*^9}, 3.404216316495813*^9, {
   3.404216386669035*^9, 3.4042163977786236`*^9}, 3.404216446451433*^9, 
   3.404216755988626*^9, {3.404825731232919*^9, 3.404825738670705*^9}, 
   3.404828710743884*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"S1", "=", "0.05"}], ",", 
     RowBox[{"S2", "=", "0.05"}], ",", 
     RowBox[{"M1", "=", 
      RowBox[{"-", "0.15"}]}], ",", 
     RowBox[{"M2", "=", 
      RowBox[{"-", "0.15"}]}], ",", 
     RowBox[{"\[Theta]1", "=", "0.03"}], ",", 
     RowBox[{"\[Theta]2", "=", "0.041"}], ",", 
     RowBox[{"\[Rho]s", "=", "0.6"}], ",", 
     RowBox[{"\[Rho]sinf", "=", "0.6"}], ",", 
     RowBox[{"\[Rho]m1", "=", "0.3"}], ",", 
     RowBox[{"\[Rho]m2", "=", 
      RowBox[{"-", "0.3"}]}], ",", 
     RowBox[{"\[Rho]1", "=", 
      RowBox[{"-", "0.5"}]}], ",", 
     RowBox[{"\[Rho]2", "=", 
      RowBox[{"-", "0.5"}]}], ",", " ", 
     RowBox[{"\[CapitalSigma]1", "=", "0.04"}], ",", 
     RowBox[{"\[CapitalSigma]2", "=", "0.04"}], ",", 
     RowBox[{"\[Beta]", "=", "5"}], ",", 
     RowBox[{"\[Tau]", "=", "5"}], ",", 
     RowBox[{"\[Nu]1", "=", "0.01"}], ",", 
     RowBox[{"\[Nu]2", "=", "0.01"}], ",", "M", ",", "\[CapitalSigma]inf", 
     ",", "\[CapitalSigma]", ",", "Q", ",", "\[Beta]m", ",", "S", ",", 
     "\[Rho]", ",", 
     RowBox[{"printflag", "=", "0"}], ",", "\[Gamma]", ",", 
     RowBox[{"Lcoefs", "=", 
      RowBox[{"LegendreCoeffs", "[", "40", "]"}]}], ",", 
     "\[IndentingNewLine]", "smile1", ",", "smile2", ",", "smile3", ",", 
     "inter1", ",", "inter2", ",", "inter3", ",", "smileLN", ",", "interLN", 
     ",", "prices", ",", 
     RowBox[{"\[Mu]", "=", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}]}], ",", 
     RowBox[{"\[Rho]s1", "=", "0.0"}], ",", 
     RowBox[{"\[Rho]s2", "=", "0.5"}], ",", 
     RowBox[{"\[Rho]s3", "=", "0.94"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"M", "=", 
     RowBox[{"(", GridBox[{
        {"M1", 
         RowBox[{"\[Rho]m1", 
          SqrtBox[
           RowBox[{"M1", " ", "M2"}]]}]},
        {
         RowBox[{"\[Rho]m2", 
          SqrtBox[
           RowBox[{"M1", " ", "M2"}]]}], "M2"}
       }], ")"}]}], ";", 
    RowBox[{"\[CapitalSigma]inf", "=", 
     RowBox[{"(", GridBox[{
        {"\[Theta]1", 
         RowBox[{
          SqrtBox[
           RowBox[{"\[Theta]1", " ", "\[Theta]2"}]], " ", "\[Rho]sinf"}]},
        {
         RowBox[{
          SqrtBox[
           RowBox[{"\[Theta]1", " ", "\[Theta]2"}]], " ", "\[Rho]sinf"}], 
         "\[Theta]2"}
       }], ")"}]}], ";", 
    RowBox[{"\[CapitalSigma]", "=", 
     RowBox[{"(", GridBox[{
        {"\[CapitalSigma]1", 
         RowBox[{
          SqrtBox[
           RowBox[{"\[CapitalSigma]1", " ", "\[CapitalSigma]2"}]], " ", 
          "\[Rho]s"}]},
        {
         RowBox[{
          SqrtBox[
           RowBox[{"\[CapitalSigma]1", " ", "\[CapitalSigma]2"}]], " ", 
          "\[Rho]s"}], "\[CapitalSigma]2"}
       }], ")"}]}], ";", 
    RowBox[{"S", "=", 
     RowBox[{"{", 
      RowBox[{"S1", ",", "S2"}], "}"}]}], ";", 
    RowBox[{"\[Rho]", "=", 
     RowBox[{"{", 
      RowBox[{"\[Rho]1", ",", "\[Rho]2"}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Q", "=", 
     RowBox[{
      RowBox[{"CholeskyDecomposition", "[", 
       RowBox[{"-", 
        RowBox[{"(", 
         FractionBox[
          RowBox[{
           RowBox[{"M", ".", "\[CapitalSigma]inf"}], "+", 
           RowBox[{"\[CapitalSigma]inf", ".", " ", 
            RowBox[{"Transpose", "[", "M", "]"}]}]}], "2"], ")"}]}], "]"}], 
      "/", "\[Beta]"}]}], ";", 
    RowBox[{"\[Gamma]", "=", 
     RowBox[{"{", 
      RowBox[{"0.1", ",", "0.3"}], "}"}]}], ";", 
    RowBox[{"\[Beta]m", "=", 
     RowBox[{"-", 
      RowBox[{
       RowBox[{"(", 
        FractionBox[
         RowBox[{
          RowBox[{"M", ".", "\[CapitalSigma]inf"}], "+", 
          RowBox[{"\[CapitalSigma]inf", ".", 
           RowBox[{"Transpose", "[", "M", "]"}]}]}], "2"], ")"}], ".", 
       RowBox[{"Inverse", "[", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Transpose", "[", "Q", "]"}], ".", "Q"}], ")"}], 
        "]"}]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"SuperBiHestonLaplaceTransform", "[", 
       RowBox[{
       "M", ",", "Q", ",", "\[CapitalSigma]inf", ",", "\[Rho]", ",", "\[Mu]", 
        ",", "\[CapitalSigma]", ",", "\[Gamma]", ",", "\[Beta]", ",", 
        "\[Tau]"}], "]"}], ",", 
      RowBox[{"BiHestonLaplaceQuickTransform", "[", 
       RowBox[{"M", ",", "Q", ",", 
        RowBox[{"{", 
         RowBox[{"\[Rho]1", ",", "\[Rho]2"}], "}"}], ",", "\[Mu]", ",", 
        "\[CapitalSigma]", ",", "\[Gamma]", ",", "\[Beta]", ",", "\[Tau]"}], 
       "]"}], ",", 
      RowBox[{"BiHestonLaplaceQuickTransform", "[", 
       RowBox[{
       "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", "\[CapitalSigma]", 
        ",", "\[Gamma]", ",", "\[Beta]", ",", "\[Tau]"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"BiHestonLaplaceQuickTransform2", "[", 
       RowBox[{
       "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", "\[CapitalSigma]", 
        ",", "\[Gamma]", ",", "\[Beta]m", ",", "\[Tau]"}], "]"}]}], "}"}]}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.4063845468301797`*^9, 3.406384565236783*^9}, {
  3.4063846556760197`*^9, 3.4063847358920484`*^9}, {3.406384773274277*^9, 
  3.4063849125426316`*^9}, {3.406385069636916*^9, 3.406385076733481*^9}, {
  3.40638511423273*^9, 3.406385144229003*^9}, {3.4063852513339853`*^9, 
  3.406385293515804*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.9733808644469569`", "\[InvisibleSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", "0.9733808644469516`", ",", 
   "0.9733808644469516`", ",", 
   RowBox[{"0.9733808644469587`", "\[InvisibleSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.406384724693021*^9, 3.4063847374405174`*^9}, {
   3.4063848146606283`*^9, 3.4063848277365875`*^9}, 3.406385079672147*^9, 
   3.4063851463392143`*^9, 3.406385296422556*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Matrix Exponential", "Section",
 CellChangeTimes->{{3.399384312217309*^9, 3.399384322514382*^9}, {
  3.402830469881106*^9, 3.4028304844438853`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", " ", "faut", " ", "montrer", " ", "que", " ", "F"}], " ", "=",
   " ", 
  RowBox[{"a11", "=", " ", 
   RowBox[{"(", 
    FractionBox[
     RowBox[{"2", " ", "\[Zeta]", " "}], 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[Zeta]", " ", 
         RowBox[{"\[Tau]", "/", "2"}]}]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"M", "+", " ", 
           RowBox[{"\[Rho]", " ", "Q", "  ", "\[Gamma]"}]}], ")"}], "+", 
         "\[Zeta]"}], ")"}]}], "-", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[Zeta]"}], " ", 
         RowBox[{"\[Tau]", "/", "2"}]}]], 
       RowBox[{"(", 
        RowBox[{"M", "+", " ", 
         RowBox[{"\[Rho]", " ", "Q", "  ", "\[Gamma]"}], "-", "\[Zeta]"}], 
        ")"}]}]}]], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.399640696051515*^9, 3.3996407329584737`*^9}, {
  3.3996422515657554`*^9, 3.399642252393896*^9}}],

Cell[BoxData[
 RowBox[{"mais", " ", "pour", " ", "obtenir", " ", "le", " ", "bon", " ", "A",
   " ", "on", " ", "doit", " ", "changer", " ", "en", " ", 
  RowBox[{"l", "'"}], 
  RowBox[{"oppos\[EAcute]", ":", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"peut", " ", "etre", " ", "t"}], "<"}], "\[Rule]", " ", 
     "\[Tau]"}], " ", ")"}], " "}]}]], "Input",
 CellChangeTimes->{{3.399636647051901*^9, 3.399636664130354*^9}, {
  3.3996389632838717`*^9, 3.3996389835498857`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"H", "=", 
   RowBox[{"(", GridBox[{
      {
       FractionBox[
        RowBox[{"(", 
         RowBox[{"M", "+", 
          RowBox[{"Q", " ", "\[Rho]", " ", "\[Gamma]"}]}], ")"}], "2"], 
       FractionBox[
        RowBox[{"Q", " ", "Q", " "}], "2"]},
      {
       FractionBox[
        RowBox[{" ", 
         RowBox[{
          RowBox[{"-", "\[Gamma]"}], " ", "\[Gamma]"}]}], "2"], 
       FractionBox[
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"M", "+", 
           RowBox[{"Q", " ", "\[Rho]", " ", "\[Gamma]"}]}], ")"}]}], "2"]}
     }], ")"}]}], ";", 
  RowBox[{"\[Zeta]1", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"-", "4"}], 
     RowBox[{"Det", "[", "H", "]"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{
  3.3993794956873336`*^9, {3.399381344285326*^9, 3.3993813575043297`*^9}, {
   3.3993831495856123`*^9, 3.3993831657421722`*^9}, {3.39938320235225*^9, 
   3.3993832340559835`*^9}, 3.399383299979124*^9, 3.399383374058672*^9, {
   3.3993835997661304`*^9, 3.399383606063126*^9}, {3.3993837051119027`*^9, 
   3.3993837157683573`*^9}, {3.3993842036214743`*^9, 
   3.3993842079340568`*^9}, {3.3996261439779615`*^9, 
   3.3996261470405207`*^9}, {3.3996261876194243`*^9, 
   3.3996261909788637`*^9}, {3.3996263553413944`*^9, 3.399626382873173*^9}, {
   3.399627023713602*^9, 3.3996270273699226`*^9}, {3.3996348856430826`*^9, 
   3.3996348920494556`*^9}, {3.3996352458374977`*^9, 
   3.3996352762755823`*^9}, {3.3996353487769747`*^9, 3.399635353870822*^9}, {
   3.3996357654881*^9, 3.3996357739101367`*^9}, {3.3996360256805954`*^9, 
   3.3996360278993883`*^9}, {3.399638930236362*^9, 3.399638932173899*^9}}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["M", "2"], "+", 
  RowBox[{"2", " ", "M", " ", "Q", " ", "\[Gamma]", " ", "\[Rho]"}], "+", 
  RowBox[{
   SuperscriptBox["Q", "2"], " ", 
   SuperscriptBox["\[Gamma]", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SuperscriptBox["\[Rho]", "2"]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.3993833004635086`*^9, 3.399383375105567*^9, 3.399383644641992*^9, {
   3.3993837056900387`*^9, 3.3993837165339975`*^9}, 3.3993842116841288`*^9, 
   3.399625880504153*^9, 3.399626150024953*^9, {3.399626192650771*^9, 
   3.3996261962758408`*^9}, {3.3996263562632875`*^9, 3.399626383654438*^9}, 
   3.399627031244997*^9, 3.3996348941588707`*^9, {3.399635249696947*^9, 
   3.3996352782131195`*^9}, 3.3996353553396006`*^9, 3.399635907209571*^9, 
   3.3996360309775724`*^9, 3.3996367323972893`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"F", " ", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"expM1", ".", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0"}], "}"}]}], " ", "/.", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a", "\[Rule]", 
          RowBox[{"H", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
         RowBox[{"b", "\[Rule]", 
          RowBox[{"H", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ",", 
         RowBox[{"c", "\[Rule]", 
          RowBox[{"H", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ",", 
         RowBox[{"d", "\[Rule]", 
          RowBox[{"H", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], "}"}]}], "]"}], " ", 
     "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}], "//.", 
   RowBox[{"{", 
    RowBox[{
     SqrtBox[
      RowBox[{
       SuperscriptBox["M", "2"], "+", 
       RowBox[{"2", " ", "M", " ", "Q", " ", "\[Gamma]", " ", "\[Rho]"}], "+",
        
       RowBox[{
        SuperscriptBox["Q", "2"], " ", 
        SuperscriptBox["\[Gamma]", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox["\[Rho]", "2"]}], ")"}]}]}]], "\[Rule]", "\[Zeta]"}],
     "}"}]}]}]], "Input",
 CellChangeTimes->{{3.399378980146185*^9, 3.3993789871463194`*^9}, {
   3.399379028443988*^9, 3.3993790374129095`*^9}, {3.3993790748823795`*^9, 
   3.3993791576808443`*^9}, {3.3993792282290735`*^9, 3.399379299402315*^9}, {
   3.399379353122096*^9, 3.399379393982256*^9}, 3.3993794399675136`*^9, {
   3.3993813716764765`*^9, 3.3993814024270673`*^9}, {3.399382150144548*^9, 
   3.3993822025049286`*^9}, {3.39938233671063*^9, 3.3993823449607887`*^9}, {
   3.3993830838343496`*^9, 3.399383123975745*^9}, {3.3996258962700806`*^9, 
   3.399625907582798*^9}, {3.399626205588519*^9, 3.3996262374016304`*^9}, {
   3.399626407092388*^9, 3.399626426749016*^9}, 3.3996353060886545`*^9, 
   3.3996353646679044`*^9, {3.3996411624510946`*^9, 3.3996411700918665`*^9}, {
   3.3996412612811174`*^9, 3.3996412642655497`*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"\[Zeta]", " ", "\[Tau]"}], "2"]}]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[Zeta]", " ", "\[Tau]"}]]}], ")"}], " ", "M"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[Zeta]", " ", "\[Tau]"}]]}], ")"}], " ", "\[Zeta]"}], "+", 
     
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[Zeta]", " ", "\[Tau]"}]]}], ")"}], " ", "Q", " ", 
      "\[Gamma]", " ", "\[Rho]"}]}], ")"}]}], 
  RowBox[{"2", " ", 
   SqrtBox[
    RowBox[{
     SuperscriptBox["M", "2"], "+", 
     RowBox[{"2", " ", "M", " ", "Q", " ", "\[Gamma]", " ", "\[Rho]"}], "+", 
     RowBox[{
      SuperscriptBox["Q", "2"], " ", 
      SuperscriptBox["\[Gamma]", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["\[Rho]", "2"]}], ")"}]}]}]]}]]], "Output",
 CellChangeTimes->{
  3.399379039147318*^9, 3.399379162743441*^9, 3.3993791968222203`*^9, {
   3.3993792334166727`*^9, 3.399379241323075*^9}, {3.399379277636272*^9, 
   3.399379302964883*^9}, 3.3993793599972286`*^9, 3.39937939549791*^9, 
   3.399379441233163*^9, 3.3993813835360794`*^9, 3.399382125019066*^9, {
   3.3993821751137776`*^9, 3.399382202973687*^9}, 3.3993823484608555`*^9, 
   3.399383132772789*^9, 3.399383171414156*^9, 3.399383649579587*^9, 
   3.3993842162310915`*^9, 3.399625909301581*^9, 3.3996261236494465`*^9, 
   3.399626163181455*^9, 3.399626198119626*^9, 3.3996262383391485`*^9, 
   3.3996263930452433`*^9, 3.399626429108436*^9, 3.399627035729458*^9, 
   3.3996348976120625`*^9, {3.3996352925415196`*^9, 3.39963530766681*^9}, 
   3.3996353663085613`*^9, 3.3996359092096095`*^9, 3.3996360358214154`*^9, 
   3.399641173826313*^9, 3.3996412664062157`*^9}]
}, Open  ]],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"\[Zeta]", " ", "\[Tau]"}], "2"]}]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[Zeta]", " ", "\[Tau]"}]]}], ")"}], " ", "M"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[Zeta]", " ", "\[Tau]"}]]}], ")"}], " ", "\[Zeta]"}], "+", 
     
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[Zeta]", " ", "\[Tau]"}]]}], ")"}], " ", "Q", " ", 
      "\[Gamma]", " ", "\[Rho]"}]}], ")"}]}], 
  RowBox[{"2", " ", "\[Zeta]"}]]], "Input",
 CellChangeTimes->{{3.399641346610881*^9, 3.399641346892136*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Si", " ", "on", " ", "diagonalise", " ", "cette", " ", "matrice"}],
   " ", ",", " ", 
  RowBox[{
  "attention", " ", "les", " ", "matrice", " ", "de", " ", "passage", " ", 
   "ne", " ", "sont", " ", "pas", " ", "orthogonale", " ", "car", " ", "la", 
   " ", "matrice", " ", 
   RowBox[{"n", "'"}], "est", " ", "pas", " ", 
   RowBox[{"symetrique", "."}]}]}]], "Input",
 CellChangeTimes->{{3.3993679742676373`*^9, 3.399367994924284*^9}, {
  3.399384623238906*^9, 3.3993846537551165`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Soit", " ", "une", " ", "matrice", " ", "h"}], "=", 
  RowBox[{
   RowBox[{"(", GridBox[{
      {"a", "b"},
      {"c", "d"}
     }], ")"}], "  ", "on", " ", "la", " ", "diagonalise", " ", 
   RowBox[{"en", " ", ":"}]}]}]], "Input",
 CellChangeTimes->{{3.399368916051344*^9, 3.3993689670991993`*^9}}],

Cell[BoxData[
 RowBox[{"h", "=", 
  RowBox[{
   RowBox[{
    FractionBox["1", 
     RowBox[{"1", "+", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox[
         RowBox[{
          RowBox[{"-", "a"}], "+", "d", "+", 
          SqrtBox["\[CapitalDelta]"]}], 
         RowBox[{"2", "b"}]], ")"}], "2"]}]], 
    RowBox[{"(", GridBox[{
       {"1", 
        FractionBox[
         RowBox[{
          RowBox[{"-", "a"}], "+", "d", "+", 
          SqrtBox["\[CapitalDelta]"]}], 
         RowBox[{"2", "b"}]]},
       {
        FractionBox[
         RowBox[{
          RowBox[{"-", "a"}], "+", "d", "+", 
          SqrtBox["\[CapitalDelta]"]}], 
         RowBox[{"2", "b"}]], 
        SuperscriptBox[
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"-", "a"}], "+", "d", "+", 
            SqrtBox["\[CapitalDelta]"]}], 
           RowBox[{"2", "b"}]], ")"}], "2"]}
      }], ")"}], 
    SubscriptBox["x", "1"]}], "+", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"1", "+", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox[
         RowBox[{
          RowBox[{"-", "a"}], "+", "d", "-", 
          SqrtBox["\[CapitalDelta]"]}], 
         RowBox[{"2", "b"}]], ")"}], "2"]}]], 
    RowBox[{"(", GridBox[{
       {"1", 
        FractionBox[
         RowBox[{
          RowBox[{"-", "a"}], "+", "d", "-", 
          SqrtBox["\[CapitalDelta]"]}], 
         RowBox[{"2", "b"}]]},
       {
        FractionBox[
         RowBox[{
          RowBox[{"-", "a"}], "+", "d", "-", 
          SqrtBox["\[CapitalDelta]"]}], 
         RowBox[{"2", "b"}]], 
        SuperscriptBox[
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"-", "a"}], "+", "d", "-", 
            SqrtBox["\[CapitalDelta]"]}], 
           RowBox[{"2", "b"}]], ")"}], "2"]}
      }], ")"}], 
    SubscriptBox["x", "2"]}]}]}]], "Input",
 CellChangeTimes->{{3.39936897338057*^9, 3.399369106570627*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ou", " ", 
    SubscriptBox["x", "1"]}], "=", 
   FractionBox[
    RowBox[{"a", "+", "d", "+", 
     SqrtBox["\[CapitalDelta]"]}], "2"]}], ";", 
  RowBox[{
   SubscriptBox["x", "2"], "=", 
   FractionBox[
    RowBox[{"a", "+", "d", "-", 
     SqrtBox["\[CapitalDelta]"]}], "2"]}], ";", 
  RowBox[{"\[CapitalDelta]", "=", 
   RowBox[{
    RowBox[{"a", " ", "d"}], "-", 
    RowBox[{"b", " ", "c"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.399369109914441*^9, 3.399369168978075*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"M1", "=", 
  RowBox[{"(", GridBox[{
     {"7.1", "2"},
     {"41", "3"}
    }], ")"}]}]], "Input",
 CellChangeTimes->{{3.3993727156040335`*^9, 3.399372741917039*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"7.1`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"41", ",", "3"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.3993730897205915`*^9, 3.3993769352319236`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"M1", "=", 
  RowBox[{"(", GridBox[{
     {"a", "b"},
     {"c", "d"}
    }], ")"}]}]], "Input",
 CellChangeTimes->{{3.3993729762340374`*^9, 3.3993729847185755`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"MatrixExp", "[", "M1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.3996282627373905`*^9, 3.3996282680656185`*^9}, 
   3.3996284228810906`*^9, {3.3996286551511755`*^9, 3.399628661135665*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"a", "+", "d", "-", 
           SqrtBox[
            RowBox[{
             SuperscriptBox["a", "2"], "+", 
             RowBox[{"4", " ", "b", " ", "c"}], "-", 
             RowBox[{"2", " ", "a", " ", "d"}], "+", 
             SuperscriptBox["d", "2"]}]]}], ")"}]}]], " ", 
       RowBox[{"(", 
        RowBox[{"d", "-", 
         RowBox[{"d", " ", 
          SuperscriptBox["\[ExponentialE]", 
           SqrtBox[
            RowBox[{
             SuperscriptBox["a", "2"], "+", 
             RowBox[{"4", " ", "b", " ", "c"}], "-", 
             RowBox[{"2", " ", "a", " ", "d"}], "+", 
             SuperscriptBox["d", "2"]}]]]}], "+", 
         RowBox[{"a", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            SuperscriptBox["\[ExponentialE]", 
             SqrtBox[
              RowBox[{
               SuperscriptBox["a", "2"], "+", 
               RowBox[{"4", " ", "b", " ", "c"}], "-", 
               RowBox[{"2", " ", "a", " ", "d"}], "+", 
               SuperscriptBox["d", "2"]}]]]}], ")"}]}], "+", 
         RowBox[{
          SqrtBox[
           RowBox[{
            SuperscriptBox["a", "2"], "+", 
            RowBox[{"4", " ", "b", " ", "c"}], "-", 
            RowBox[{"2", " ", "a", " ", "d"}], "+", 
            SuperscriptBox["d", "2"]}]], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            SuperscriptBox["\[ExponentialE]", 
             SqrtBox[
              RowBox[{
               SuperscriptBox["a", "2"], "+", 
               RowBox[{"4", " ", "b", " ", "c"}], "-", 
               RowBox[{"2", " ", "a", " ", "d"}], "+", 
               SuperscriptBox["d", "2"]}]]]}], ")"}]}]}], ")"}]}], 
      RowBox[{"2", " ", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["a", "2"], "+", 
         RowBox[{"4", " ", "b", " ", "c"}], "-", 
         RowBox[{"2", " ", "a", " ", "d"}], "+", 
         SuperscriptBox["d", "2"]}]]}]], ",", 
     FractionBox[
      RowBox[{"b", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"a", "+", "d", "-", 
           SqrtBox[
            RowBox[{
             SuperscriptBox["a", "2"], "+", 
             RowBox[{"4", " ", "b", " ", "c"}], "-", 
             RowBox[{"2", " ", "a", " ", "d"}], "+", 
             SuperscriptBox["d", "2"]}]]}], ")"}]}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SuperscriptBox["\[ExponentialE]", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["a", "2"], "+", 
            RowBox[{"4", " ", "b", " ", "c"}], "-", 
            RowBox[{"2", " ", "a", " ", "d"}], "+", 
            SuperscriptBox["d", "2"]}]]]}], ")"}]}], 
      SqrtBox[
       RowBox[{
        SuperscriptBox["a", "2"], "+", 
        RowBox[{"4", " ", "b", " ", "c"}], "-", 
        RowBox[{"2", " ", "a", " ", "d"}], "+", 
        SuperscriptBox["d", "2"]}]]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"c", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"a", "+", "d", "-", 
           SqrtBox[
            RowBox[{
             SuperscriptBox["a", "2"], "+", 
             RowBox[{"4", " ", "b", " ", "c"}], "-", 
             RowBox[{"2", " ", "a", " ", "d"}], "+", 
             SuperscriptBox["d", "2"]}]]}], ")"}]}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SuperscriptBox["\[ExponentialE]", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["a", "2"], "+", 
            RowBox[{"4", " ", "b", " ", "c"}], "-", 
            RowBox[{"2", " ", "a", " ", "d"}], "+", 
            SuperscriptBox["d", "2"]}]]]}], ")"}]}], 
      SqrtBox[
       RowBox[{
        SuperscriptBox["a", "2"], "+", 
        RowBox[{"4", " ", "b", " ", "c"}], "-", 
        RowBox[{"2", " ", "a", " ", "d"}], "+", 
        SuperscriptBox["d", "2"]}]]], ",", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"a", "+", "d", "-", 
           SqrtBox[
            RowBox[{
             SuperscriptBox["a", "2"], "+", 
             RowBox[{"4", " ", "b", " ", "c"}], "-", 
             RowBox[{"2", " ", "a", " ", "d"}], "+", 
             SuperscriptBox["d", "2"]}]]}], ")"}]}]], " ", 
       RowBox[{"(", 
        RowBox[{"a", "-", 
         RowBox[{"a", " ", 
          SuperscriptBox["\[ExponentialE]", 
           SqrtBox[
            RowBox[{
             SuperscriptBox["a", "2"], "+", 
             RowBox[{"4", " ", "b", " ", "c"}], "-", 
             RowBox[{"2", " ", "a", " ", "d"}], "+", 
             SuperscriptBox["d", "2"]}]]]}], "+", 
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            SuperscriptBox["\[ExponentialE]", 
             SqrtBox[
              RowBox[{
               SuperscriptBox["a", "2"], "+", 
               RowBox[{"4", " ", "b", " ", "c"}], "-", 
               RowBox[{"2", " ", "a", " ", "d"}], "+", 
               SuperscriptBox["d", "2"]}]]]}], ")"}]}], "+", 
         RowBox[{
          SqrtBox[
           RowBox[{
            SuperscriptBox["a", "2"], "+", 
            RowBox[{"4", " ", "b", " ", "c"}], "-", 
            RowBox[{"2", " ", "a", " ", "d"}], "+", 
            SuperscriptBox["d", "2"]}]], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            SuperscriptBox["\[ExponentialE]", 
             SqrtBox[
              RowBox[{
               SuperscriptBox["a", "2"], "+", 
               RowBox[{"4", " ", "b", " ", "c"}], "-", 
               RowBox[{"2", " ", "a", " ", "d"}], "+", 
               SuperscriptBox["d", "2"]}]]]}], ")"}]}]}], ")"}]}], 
      RowBox[{"2", " ", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["a", "2"], "+", 
         RowBox[{"4", " ", "b", " ", "c"}], "-", 
         RowBox[{"2", " ", "a", " ", "d"}], "+", 
         SuperscriptBox["d", "2"]}]]}]]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.3993727864491434`*^9, 3.3993729862967305`*^9, 
  3.399376609678798*^9, 3.399377954157737*^9, 3.399625925098759*^9, 
  3.3996282713625565`*^9, 3.3996284248342533`*^9, 3.3996286623075624`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"x1", ",", "x2"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"a", "+", "d", "+", 
       SqrtBox[
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"a", "+", "d"}], ")"}], "2"], "-", 
         RowBox[{"4", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a", " ", "d"}], "-", 
            RowBox[{"b", " ", "c"}]}], ")"}]}]}]]}], "2"], ",", 
     FractionBox[
      RowBox[{"a", "+", "d", "-", 
       SqrtBox[
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"a", "+", "d"}], ")"}], "2"], "-", 
         RowBox[{"4", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a", " ", "d"}], "-", 
            RowBox[{"b", " ", "c"}]}], ")"}]}]}]]}], "2"]}], "}"}]}], " ", 
  ";"}]], "Input",
 CellChangeTimes->{{3.3993728119965096`*^9, 3.3993729117171736`*^9}, {
  3.3993730466103888`*^9, 3.399373075907826*^9}, {3.399373160128193*^9, 
  3.399373175019104*^9}, {3.3993780701443386`*^9, 3.399378071738119*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"P1", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          RowBox[{"-", "a"}], "+", "d", "+", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["a", "2"], "+", 
            RowBox[{"4", " ", "b", " ", "c"}], "-", 
            RowBox[{"2", " ", "a", " ", "d"}], "+", 
            SuperscriptBox["d", "2"]}]]}], 
         RowBox[{"2", " ", "c"}]]}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          RowBox[{"-", "a"}], "+", "d", "-", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["a", "2"], "+", 
            RowBox[{"4", " ", "b", " ", "c"}], "-", 
            RowBox[{"2", " ", "a", " ", "d"}], "+", 
            SuperscriptBox["d", "2"]}]]}], 
         RowBox[{"2", " ", "c"}]]}], ",", "1"}], "}"}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.399376728571706*^9, 3.399376741087571*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"InvP1", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["c", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["a", "2"], "+", 
           RowBox[{"4", " ", "b", " ", "c"}], "-", 
           RowBox[{"2", " ", "a", " ", "d"}], "+", 
           SuperscriptBox["d", "2"]}]]]}], ",", 
       FractionBox["c", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["a", "2"], "+", 
          RowBox[{"4", " ", "b", " ", "c"}], "-", 
          RowBox[{"2", " ", "a", " ", "d"}], "+", 
          SuperscriptBox["d", "2"]}]]]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          RowBox[{"-", "a"}], "+", "d", "-", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["a", "2"], "+", 
            RowBox[{"4", " ", "b", " ", "c"}], "-", 
            RowBox[{"2", " ", "a", " ", "d"}], "+", 
            SuperscriptBox["d", "2"]}]]}], 
         RowBox[{"2", " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["a", "2"], "+", 
            RowBox[{"4", " ", "b", " ", "c"}], "-", 
            RowBox[{"2", " ", "a", " ", "d"}], "+", 
            SuperscriptBox["d", "2"]}]]}]]}], ",", 
       FractionBox[
        RowBox[{
         RowBox[{"-", "a"}], "+", "d", "+", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["a", "2"], "+", 
           RowBox[{"4", " ", "b", " ", "c"}], "-", 
           RowBox[{"2", " ", "a", " ", "d"}], "+", 
           SuperscriptBox["d", "2"]}]]}], 
        RowBox[{"2", " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["a", "2"], "+", 
           RowBox[{"4", " ", "b", " ", "c"}], "-", 
           RowBox[{"2", " ", "a", " ", "d"}], "+", 
           SuperscriptBox["d", "2"]}]]}]]}], "}"}]}], "}"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.399376745384529*^9, 3.39937675615036*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{"(", " ", "P1", ")"}], "]"}], ".", " ", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"{", 
     RowBox[{"x2", ",", "x1"}], "}"}], "]"}], " ", ".", 
   RowBox[{"Transpose", "[", 
    RowBox[{"(", "InvP1", "  ", ")"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.399376776494501*^9, 3.39937677852579*^9}, {
  3.3993768166515217`*^9, 3.3993768474021125`*^9}, {3.399376887918515*^9, 
  3.3993769066219997`*^9}, {3.399376965295001*^9, 3.3993770034988594`*^9}, {
  3.399377098453808*^9, 3.399377128079376*^9}, {3.3993771672520037`*^9, 
  3.399377171236455*^9}, {3.399377776841832*^9, 3.3993777847013583`*^9}, {
  3.3993779959085383`*^9, 3.3993780015336466`*^9}, {3.3996260718984528`*^9, 
  3.399626074836009*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"a", ",", "b"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", "d"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.39937781112374*^9, {3.399377981658265*^9, 3.399378002314911*^9}, 
   3.3993780769100933`*^9, 3.3996259381927605`*^9, 3.3996260766641693`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"expM1", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{"(", " ", "P1", ")"}], "]"}], ".", " ", 
    RowBox[{"DiagonalMatrix", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Exp", "[", 
        RowBox[{"\[Tau]", " ", "x2"}], "]"}], ",", 
       RowBox[{"Exp", "[", 
        RowBox[{"\[Tau]", " ", "x1"}], "]"}]}], "}"}], "]"}], " ", ".", 
    RowBox[{"Transpose", "[", 
     RowBox[{"(", "InvP1", "  ", ")"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.3993778545151987`*^9, 3.399377856687115*^9}, {
  3.3993781079419394`*^9, 3.3993781265360465`*^9}, {3.3993789947714663`*^9, 
  3.3993790008340826`*^9}, {3.3996260995396085`*^9, 3.399626104008444*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"a", "+", "d", "-", 
           SqrtBox[
            RowBox[{
             SuperscriptBox["a", "2"], "+", 
             RowBox[{"4", " ", "b", " ", "c"}], "-", 
             RowBox[{"2", " ", "a", " ", "d"}], "+", 
             SuperscriptBox["d", "2"]}]]}], ")"}], " ", "\[Tau]"}]], " ", 
       RowBox[{"(", 
        RowBox[{"d", "-", 
         RowBox[{"d", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            SqrtBox[
             RowBox[{
              SuperscriptBox["a", "2"], "+", 
              RowBox[{"4", " ", "b", " ", "c"}], "-", 
              RowBox[{"2", " ", "a", " ", "d"}], "+", 
              SuperscriptBox["d", "2"]}]], " ", "\[Tau]"}]]}], "+", 
         RowBox[{"a", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{
              SqrtBox[
               RowBox[{
                SuperscriptBox["a", "2"], "+", 
                RowBox[{"4", " ", "b", " ", "c"}], "-", 
                RowBox[{"2", " ", "a", " ", "d"}], "+", 
                SuperscriptBox["d", "2"]}]], " ", "\[Tau]"}]]}], ")"}]}], "+",
          
         RowBox[{
          SqrtBox[
           RowBox[{
            SuperscriptBox["a", "2"], "+", 
            RowBox[{"4", " ", "b", " ", "c"}], "-", 
            RowBox[{"2", " ", "a", " ", "d"}], "+", 
            SuperscriptBox["d", "2"]}]], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{
              SqrtBox[
               RowBox[{
                SuperscriptBox["a", "2"], "+", 
                RowBox[{"4", " ", "b", " ", "c"}], "-", 
                RowBox[{"2", " ", "a", " ", "d"}], "+", 
                SuperscriptBox["d", "2"]}]], " ", "\[Tau]"}]]}], ")"}]}]}], 
        ")"}]}], 
      RowBox[{"2", " ", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["a", "2"], "+", 
         RowBox[{"4", " ", "b", " ", "c"}], "-", 
         RowBox[{"2", " ", "a", " ", "d"}], "+", 
         SuperscriptBox["d", "2"]}]]}]], ",", 
     FractionBox[
      RowBox[{"b", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            FractionBox["1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"a", "+", "d", "-", 
              SqrtBox[
               RowBox[{
                SuperscriptBox["a", "2"], "+", 
                RowBox[{"4", " ", "b", " ", "c"}], "-", 
                RowBox[{"2", " ", "a", " ", "d"}], "+", 
                SuperscriptBox["d", "2"]}]]}], ")"}], " ", "\[Tau]"}]]}], "+",
          
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"a", "+", "d", "+", 
             SqrtBox[
              RowBox[{
               SuperscriptBox["a", "2"], "+", 
               RowBox[{"4", " ", "b", " ", "c"}], "-", 
               RowBox[{"2", " ", "a", " ", "d"}], "+", 
               SuperscriptBox["d", "2"]}]]}], ")"}], " ", "\[Tau]"}]]}], 
        ")"}]}], 
      SqrtBox[
       RowBox[{
        SuperscriptBox["a", "2"], "+", 
        RowBox[{"4", " ", "b", " ", "c"}], "-", 
        RowBox[{"2", " ", "a", " ", "d"}], "+", 
        SuperscriptBox["d", "2"]}]]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"c", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            FractionBox["1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"a", "+", "d", "-", 
              SqrtBox[
               RowBox[{
                SuperscriptBox["a", "2"], "+", 
                RowBox[{"4", " ", "b", " ", "c"}], "-", 
                RowBox[{"2", " ", "a", " ", "d"}], "+", 
                SuperscriptBox["d", "2"]}]]}], ")"}], " ", "\[Tau]"}]]}], "+",
          
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"a", "+", "d", "+", 
             SqrtBox[
              RowBox[{
               SuperscriptBox["a", "2"], "+", 
               RowBox[{"4", " ", "b", " ", "c"}], "-", 
               RowBox[{"2", " ", "a", " ", "d"}], "+", 
               SuperscriptBox["d", "2"]}]]}], ")"}], " ", "\[Tau]"}]]}], 
        ")"}]}], 
      SqrtBox[
       RowBox[{
        SuperscriptBox["a", "2"], "+", 
        RowBox[{"4", " ", "b", " ", "c"}], "-", 
        RowBox[{"2", " ", "a", " ", "d"}], "+", 
        SuperscriptBox["d", "2"]}]]], ",", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"a", "+", "d", "-", 
           SqrtBox[
            RowBox[{
             SuperscriptBox["a", "2"], "+", 
             RowBox[{"4", " ", "b", " ", "c"}], "-", 
             RowBox[{"2", " ", "a", " ", "d"}], "+", 
             SuperscriptBox["d", "2"]}]]}], ")"}], " ", "\[Tau]"}]], " ", 
       RowBox[{"(", 
        RowBox[{"a", "-", 
         RowBox[{"a", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            SqrtBox[
             RowBox[{
              SuperscriptBox["a", "2"], "+", 
              RowBox[{"4", " ", "b", " ", "c"}], "-", 
              RowBox[{"2", " ", "a", " ", "d"}], "+", 
              SuperscriptBox["d", "2"]}]], " ", "\[Tau]"}]]}], "+", 
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{
              SqrtBox[
               RowBox[{
                SuperscriptBox["a", "2"], "+", 
                RowBox[{"4", " ", "b", " ", "c"}], "-", 
                RowBox[{"2", " ", "a", " ", "d"}], "+", 
                SuperscriptBox["d", "2"]}]], " ", "\[Tau]"}]]}], ")"}]}], "+",
          
         RowBox[{
          SqrtBox[
           RowBox[{
            SuperscriptBox["a", "2"], "+", 
            RowBox[{"4", " ", "b", " ", "c"}], "-", 
            RowBox[{"2", " ", "a", " ", "d"}], "+", 
            SuperscriptBox["d", "2"]}]], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{
              SqrtBox[
               RowBox[{
                SuperscriptBox["a", "2"], "+", 
                RowBox[{"4", " ", "b", " ", "c"}], "-", 
                RowBox[{"2", " ", "a", " ", "d"}], "+", 
                SuperscriptBox["d", "2"]}]], " ", "\[Tau]"}]]}], ")"}]}]}], 
        ")"}]}], 
      RowBox[{"2", " ", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["a", "2"], "+", 
         RowBox[{"4", " ", "b", " ", "c"}], "-", 
         RowBox[{"2", " ", "a", " ", "d"}], "+", 
         SuperscriptBox["d", "2"]}]]}]]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.399378130973632*^9, 3.399379018006287*^9, 
  3.3996261096023016`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MatrixId", "[", "M_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ss", "=", 
        RowBox[{"Eigensystem", "[", "M", "]"}]}], ",", "P", ",", "InvP", ",", 
       "eigen"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"eigen", "=", 
       RowBox[{"ss", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"P", "=", 
       RowBox[{"ss", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"InvP", "=", 
       RowBox[{"Inverse", "[", "P", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Transpose", "[", "P", "]"}], ".", 
         RowBox[{"DiagonalMatrix", "[", "eigen", "]"}]}], ")"}], ".", 
       RowBox[{"Transpose", "[", "InvP", "]"}]}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.399694283737753*^9, 3.3996944256623526`*^9}, {
  3.3996944608974047`*^9, 3.3996944759289427`*^9}, {3.399694538680148*^9, 
  3.399694592415554*^9}, {3.399694639744588*^9, 3.3996947313088465`*^9}, {
  3.399694774262796*^9, 3.399694833779564*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MatrixExp2", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a_", ",", "b_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c_", ",", "d_"}], "}"}]}], "}"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"det", "=", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["a", "2"], "+", 
         RowBox[{"4", " ", "b", " ", "c"}], "-", 
         RowBox[{"2", " ", "a", " ", "d"}], "+", 
         SuperscriptBox["d", "2"]}]]}], ",", "expdet", ",", "expab"}], "}"}], 
    ",", 
    RowBox[{
     RowBox[{"expdet", "=", 
      SuperscriptBox["\[ExponentialE]", "det"]}], ";", 
     RowBox[{"expab", "=", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"a", "+", "d", "-", "det"}], ")"}]}]]}], ";", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         FractionBox[
          RowBox[{"expab", " ", 
           RowBox[{"(", 
            RowBox[{"d", "-", 
             RowBox[{"d", " ", "expdet"}], "+", 
             RowBox[{"a", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "expdet"}], ")"}]}], "+", 
             RowBox[{"det", " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", "expdet"}], ")"}]}]}], ")"}]}], 
          RowBox[{"2", " ", "det"}]], ",", 
         FractionBox[
          RowBox[{"b", " ", "expab", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "expdet"}], ")"}]}], "det"]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         FractionBox[
          RowBox[{"c", " ", "expab", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "expdet"}], ")"}]}], "det"], ",", 
         FractionBox[
          RowBox[{"expab", " ", 
           RowBox[{"(", 
            RowBox[{"a", "-", 
             RowBox[{"a", " ", "expdet"}], "+", 
             RowBox[{"d", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "expdet"}], ")"}]}], "+", 
             RowBox[{"det", " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", "expdet"}], ")"}]}]}], ")"}]}], 
          RowBox[{"2", " ", "det"}]]}], "}"}]}], "}"}]}]}], "]"}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.39962877049714*^9, 3.39962880566969*^9}, 
   3.39962978670415*^9, 3.399629890815524*^9, {3.399696736081712*^9, 
   3.399697002086819*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"N", "[", 
  RowBox[{
   RowBox[{"Log", "[", "4", "]"}], ",", "16"}], "]"}]], "Input",
 CellChangeTimes->{{3.407047352531638*^9, 3.407047373266412*^9}}],

Cell[BoxData["1.38629436111989061880317083975`15.999999999999998"], "Output",
 CellChangeTimes->{{3.4070473605630426`*^9, 3.4070473746570635`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Matrix Logarithm", "Section",
 CellChangeTimes->{{3.4028304966472445`*^9, 3.4028305022098513`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MatrixLog2", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a_", ",", "b_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c_", ",", "d_"}], "}"}]}], "}"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "logdetm", ",", "adm", ",", "adp", ",", "logdetp", ",", "log4", ",", "P",
       ",", "InvP", ",", 
      RowBox[{"det", "=", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["a", "2"], "+", 
         RowBox[{"4", " ", "b", " ", "c"}], "-", 
         RowBox[{"2", " ", "a", " ", "d"}], "+", 
         SuperscriptBox["d", "2"]}]]}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"det", "\[Equal]", "0"}], ",", " ", 
       RowBox[{"det", "=", " ", 
        RowBox[{"10", "^", 
         RowBox[{"(", 
          RowBox[{"-", "30"}], ")"}]}]}]}], "]"}], ";", "\[IndentingNewLine]",
      
     RowBox[{"adm", "=", 
      RowBox[{"a", "+", "d", "-", "det"}]}], ";", 
     RowBox[{"adp", "=", 
      RowBox[{"a", "+", "d", "+", "det"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Re", "[", "adm", "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{"adm", "+=", 
        RowBox[{"10", "^", 
         RowBox[{"(", 
          RowBox[{"-", "30"}], ")"}]}]}]}], "]"}], ";", "\[IndentingNewLine]",
      
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Re", "[", "adp", "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{"adp", "+=", 
        RowBox[{"10", "^", 
         RowBox[{"(", 
          RowBox[{"-", "30"}], ")"}]}]}]}], "]"}], ";", "\[IndentingNewLine]",
      
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Im", "[", "adm", "]"}], "==", "0"}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Re", "[", "adm", "]"}], "\[LessEqual]", "0"}], ")"}]}], 
       ",", 
       RowBox[{"logdetm", "=", "0"}], ",", 
       RowBox[{"logdetm", "=", 
        RowBox[{"Log", "[", "adm", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Im", "[", "adp", "]"}], "==", "0"}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Re", "[", "adp", "]"}], "\[LessEqual]", "0"}], ")"}]}], 
       ",", 
       RowBox[{"logdetp", "=", "0"}], ",", 
       RowBox[{"logdetp", "=", 
        RowBox[{"Log", "[", "adp", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"log4", "=", 
      RowBox[{"Log", "[", "4", "]"}]}], ";", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{
            RowBox[{"-", "det"}], " ", "log4"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "a"}], "+", "d", "+", "det"}], ")"}], " ", 
            "logdetm"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"a", "-", "d", "+", "det"}], ")"}], " ", "logdetp"}]}], 
          RowBox[{"2", " ", "det"}]], ",", 
         FractionBox[
          RowBox[{
           RowBox[{"-", "b"}], " ", 
           RowBox[{"(", 
            RowBox[{"logdetm", "-", "logdetp"}], ")"}]}], 
          RowBox[{" ", "det"}]]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         FractionBox[
          RowBox[{"c", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "logdetm"}], "+", "logdetp"}], ")"}]}], "det"], ",",
          
         FractionBox[
          RowBox[{
           RowBox[{
            RowBox[{"-", "det"}], " ", "log4"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"a", "-", "d", "+", "det"}], ")"}], " ", "logdetm"}], 
           "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "a"}], "+", "d", "+", "det"}], ")"}], 
            "logdetp"}]}], 
          RowBox[{"2", " ", "det"}]]}], "}"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.3996948532799377`*^9, 3.399694888702493*^9}, {
   3.3996950443461065`*^9, 3.399695096159601*^9}, {3.399695161363978*^9, 
   3.399695247818763*^9}, {3.3996965140618243`*^9, 3.3996966732367554`*^9}, {
   3.39969704247822*^9, 3.399697106760704*^9}, {3.3996973387505913`*^9, 
   3.399697492985297*^9}, {3.3996975299459906`*^9, 3.3996975612634*^9}, {
   3.399719032953657*^9, 3.3997192510672197`*^9}, {3.399719447383489*^9, 
   3.399719559104384*^9}, 3.3997196321995373`*^9, {3.399719691341298*^9, 
   3.3997197434516735`*^9}, {3.399720303587428*^9, 3.399720310821942*^9}, {
   3.399720416417719*^9, 3.3997204241209917`*^9}, 3.399720490434765*^9, {
   3.399720561107997*^9, 3.3997205617017584`*^9}, {3.4065480418432894`*^9, 
   3.40654807587541*^9}, {3.4065505182465315`*^9, 3.406550534684452*^9}, {
   3.4065506017017927`*^9, 3.4065507155015807`*^9}, {3.406551189669969*^9, 
   3.4065511951388593`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mm", "=", 
  RowBox[{"MatrixExp2", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"11", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1.2", ",", "4.2"}], "}"}]}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.3996289052341013`*^9, 3.3996289404691534`*^9}, {
   3.3996290464711885`*^9, 3.3996290872688465`*^9}, 3.399629904722041*^9, {
   3.399697120839099*^9, 3.39969715890233*^9}, {3.3997205049662943`*^9, 
   3.3997205312792997`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"80040.29709657488`", ",", "22418.497744644403`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"13451.09864678664`", ",", "3817.404764783928`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.3996289205468955`*^9, 3.399628942031683*^9}, 
   3.399629048064969*^9, 3.3996290789093113`*^9, 3.3996295022611895`*^9, 
   3.3996297906729765`*^9, {3.3996298948624773`*^9, 3.3996299073470917`*^9}, 
   3.3996968500213995`*^9, 3.399696939945001*^9, 3.3996970099463453`*^9, {
   3.39969714012072*^9, 3.3996971606836147`*^9}, 3.3997192632237034`*^9, 
   3.3997204028393335`*^9, {3.3997204717156563`*^9, 3.3997205327324524`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixLog2", "[", "mm", "]"}]], "Input",
 CellChangeTimes->{{3.3996971681837587`*^9, 3.399697180605872*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"10.999999999999993`", ",", "2.0000000000000444`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.2000000000000266`", ",", "4.199999999999843`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.399697181699643*^9, 3.3996975689359136`*^9, 3.3997192652706175`*^9, 
   3.3997197853118525`*^9, {3.399720405839391*^9, 3.399720419683407*^9}, {
   3.3997204735281906`*^9, 3.3997205647799425`*^9}}]
}, Open  ]],

Cell["la trace du log est tres simple a calculer :", "Text",
 CellChangeTimes->{{3.4022176163973784`*^9, 3.4022176287413654`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TrMatrixLog2", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a_", ",", "b_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c_", ",", "d_"}], "}"}]}], "}"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Log", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"-", " ", "b"}], " ", "c"}], "+", 
      RowBox[{"a", " ", "d"}]}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.402214721373045*^9, 3.402214735435815*^9}, {
   3.4022148645789194`*^9, 3.4022148650945544`*^9}, {3.4022148968139133`*^9, 
   3.402214926955117*^9}, {3.402214970268449*^9, 3.402214998659619*^9}, {
   3.4022150426760893`*^9, 3.4022150659109097`*^9}, {3.4022151151149797`*^9, 
   3.4022151216619806`*^9}, 3.4022172945786996`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"When", " ", "det"}], " ", "\[Equal]", " ", "0"}], ",", " ", 
  RowBox[{
  "we", " ", "just", " ", "replace", " ", "with", " ", "a", " ", "small", " ",
    "number"}]}]], "Input",
 CellChangeTimes->{{3.406547983357417*^9, 3.40654802801481*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Computation of the \[Beta] optimal", "Section",
 CellChangeTimes->{{3.402829042244321*^9, 3.402829050885112*^9}}],

Cell["\<\
Mais il faut que les valeur propres de M soient negatives, c' est equivalent \
a une trace negative et un determinant positif, c' est a dire\
\>", "Text",
 CellChangeTimes->{{3.4009239482325354`*^9, 3.400924004608618*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Det", "[", 
   RowBox[{"(", GridBox[{
      {
       FractionBox[
        RowBox[{"-", 
         SubscriptBox["\[Lambda]", "1"]}], "2"], 
       FractionBox[
        RowBox[{
         RowBox[{
          SubscriptBox["\[Lambda]", "2"], 
          SubscriptBox["\[CapitalSigma]", "\[Infinity]2"]}], "-", 
         RowBox[{"\[Beta]", " ", 
          RowBox[{"(", 
           FractionBox[
            SuperscriptBox[
             SubscriptBox["\[Nu]", "2"], "2"], "4"], ")"}], " "}]}], 
        RowBox[{"2", 
         SubscriptBox["\[CapitalSigma]", "12"]}]]},
      {
       FractionBox[
        RowBox[{
         RowBox[{
          SubscriptBox["\[Lambda]", "1"], 
          SubscriptBox["\[CapitalSigma]", "\[Infinity]1"]}], "-", 
         RowBox[{"\[Beta]", " ", 
          RowBox[{"(", 
           FractionBox[
            SuperscriptBox[
             SubscriptBox["\[Nu]", "1"], "2"], "4"], ")"}], " "}]}], 
        RowBox[{"2", 
         SubscriptBox["\[CapitalSigma]", "12"]}]], 
       FractionBox[
        RowBox[{"-", 
         SubscriptBox["\[Lambda]", "2"]}], "2"]}
     }], ")"}], "]"}], ">", "0"}]], "Input",
 CellChangeTimes->{{3.40092403026536*^9, 3.400924049484479*^9}, {
  3.4009241065480747`*^9, 3.400924109313753*^9}, {3.4009241840808134`*^9, 
  3.400924204924964*^9}}],

Cell["Soit encore ", "Text",
 CellChangeTimes->{{3.4009241347517414`*^9, 3.4009241391737013`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"Det", "[", 
   RowBox[{"(", GridBox[{
      {
       FractionBox[
        RowBox[{"-", 
         SubscriptBox["\[Lambda]", "1"]}], "2"], 
       FractionBox[
        RowBox[{
         RowBox[{
          SubscriptBox["\[Lambda]", "2"], 
          SubscriptBox["\[CapitalSigma]", "\[Infinity]2"]}], "-", 
         RowBox[{"\[Beta]", " ", 
          RowBox[{"(", 
           FractionBox[
            SuperscriptBox[
             SubscriptBox["\[Nu]", "2"], "2"], "4"], ")"}], " "}]}], 
        RowBox[{"2", 
         SubscriptBox["\[CapitalSigma]", "12"]}]]},
      {
       FractionBox[
        RowBox[{
         RowBox[{
          SubscriptBox["\[Lambda]", "1"], 
          SubscriptBox["\[CapitalSigma]", "\[Infinity]1"]}], "-", 
         RowBox[{"\[Beta]", " ", 
          RowBox[{"(", 
           FractionBox[
            SuperscriptBox[
             SubscriptBox["\[Nu]", "1"], "2"], "4"], ")"}], " "}]}], 
        RowBox[{"2", 
         SubscriptBox["\[CapitalSigma]", "12"]}]], 
       FractionBox[
        RowBox[{"-", 
         SubscriptBox["\[Lambda]", "2"]}], "2"]}
     }], ")"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{
  3.4009241665961027`*^9, {3.400924235941184*^9, 3.4009242504258375`*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"\[Beta]", " ", 
    SubsuperscriptBox["\[Nu]", "1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "\[Beta]"}], " ", 
       SubsuperscriptBox["\[Nu]", "2", "2"]}], "+", 
      RowBox[{"4", " ", 
       SubscriptBox["\[Lambda]", "2"], " ", 
       SubscriptBox["\[CapitalSigma]", "\[Infinity]2"]}]}], ")"}]}], "+", 
   RowBox[{"4", " ", 
    SubscriptBox["\[Lambda]", "1"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[Beta]", " ", 
       SubsuperscriptBox["\[Nu]", "2", "2"], " ", 
       SubscriptBox["\[CapitalSigma]", "\[Infinity]1"]}], "+", 
      RowBox[{"4", " ", 
       SubscriptBox["\[Lambda]", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         SubsuperscriptBox["\[CapitalSigma]", "12", "2"], "-", 
         RowBox[{
          SubscriptBox["\[CapitalSigma]", "\[Infinity]1"], " ", 
          SubscriptBox["\[CapitalSigma]", "\[Infinity]2"]}]}], ")"}]}]}], 
     ")"}]}]}], 
  RowBox[{"64", " ", 
   SubsuperscriptBox["\[CapitalSigma]", "12", "2"]}]]], "Output",
 CellChangeTimes->{{3.400924237191208*^9, 3.400924251316479*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "la", " ", "question", " ", "est", " ", "quant", " ", "pour", " ", 
   "\[Beta]"}], ">", 
  RowBox[{
   RowBox[{"1", " ", "on", " ", "peut", " ", "avoir", " ", "\[Beta]", " ", 
    SubsuperscriptBox["\[Nu]", "1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "\[Beta]"}], " ", 
       SubsuperscriptBox["\[Nu]", "2", "2"]}], "+", 
      RowBox[{"4", " ", 
       SubscriptBox["\[Lambda]", "2"], " ", 
       SubscriptBox["\[CapitalSigma]", "\[Infinity]2"]}]}], ")"}]}], "+", 
   RowBox[{"4", " ", 
    SubscriptBox["\[Lambda]", "1"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[Beta]", " ", 
       SubsuperscriptBox["\[Nu]", "2", "2"], " ", 
       SubscriptBox["\[CapitalSigma]", "\[Infinity]1"]}], "+", 
      RowBox[{"4", " ", 
       SubscriptBox["\[Lambda]", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         SubsuperscriptBox["\[CapitalSigma]", "12", "2"], "-", 
         RowBox[{
          SubscriptBox["\[CapitalSigma]", "\[Infinity]1"], " ", 
          SubscriptBox["\[CapitalSigma]", "\[Infinity]2"]}]}], ")"}]}]}], 
     ")"}]}]}], ">", "0"}]], "Text",
 CellChangeTimes->{{3.4009249937213583`*^9, 3.400925028315772*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Collect", "[", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Beta]", " ", 
     SubsuperscriptBox["\[Nu]", "1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[Beta]"}], " ", 
        SubsuperscriptBox["\[Nu]", "2", "2"]}], "+", 
       RowBox[{"4", " ", 
        SubscriptBox["\[Lambda]", "2"], " ", 
        SubscriptBox["\[CapitalSigma]", "\[Infinity]2"]}]}], ")"}]}], "+", 
    RowBox[{"4", " ", 
     SubscriptBox["\[Lambda]", "1"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Beta]", " ", 
        SubsuperscriptBox["\[Nu]", "2", "2"], " ", 
        SubscriptBox["\[CapitalSigma]", "\[Infinity]1"]}], "+", 
       RowBox[{"4", " ", 
        SubscriptBox["\[Lambda]", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          SubsuperscriptBox["\[CapitalSigma]", "12", "2"], "-", 
          RowBox[{
           SubscriptBox["\[CapitalSigma]", "\[Infinity]1"], " ", 
           SubscriptBox["\[CapitalSigma]", "\[Infinity]2"]}]}], ")"}]}]}], 
      ")"}]}]}], ",", "\[Beta]"}], "]"}]], "Input",
 CellChangeTimes->{{3.400925043191058*^9, 3.400925052566238*^9}, {
  3.4009250876450367`*^9, 3.4009250890356884`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Sum", "::", "\<\"sumwarn\"\>"}], ":", 
  " ", "\<\"Warning: \\!\\(\[CapitalSigma]\\_12\\%2\\) contains a capital \
sigma; use \[EscapeKey]sum\[EscapeKey] to enter a summation sign. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/Sum/sumwarn\\\", \
ButtonNote -> \\\"Sum::sumwarn\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.400925053863138*^9, 3.4009250897388268`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    SuperscriptBox["\[Beta]", "2"]}], " ", 
   SubsuperscriptBox["\[Nu]", "1", "2"], " ", 
   SubsuperscriptBox["\[Nu]", "2", "2"]}], "+", 
  RowBox[{"\[Beta]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"4", " ", 
      SubscriptBox["\[Lambda]", "1"], " ", 
      SubsuperscriptBox["\[Nu]", "2", "2"], " ", 
      SubscriptBox["\[CapitalSigma]", "\[Infinity]1"]}], "+", 
     RowBox[{"4", " ", 
      SubscriptBox["\[Lambda]", "2"], " ", 
      SubsuperscriptBox["\[Nu]", "1", "2"], " ", 
      SubscriptBox["\[CapitalSigma]", "\[Infinity]2"]}]}], ")"}]}], "+", 
  RowBox[{"16", " ", 
   SubscriptBox["\[Lambda]", "1"], " ", 
   SubscriptBox["\[Lambda]", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     SubsuperscriptBox["\[CapitalSigma]", "12", "2"], "-", 
     RowBox[{
      SubscriptBox["\[CapitalSigma]", "\[Infinity]1"], " ", 
      SubscriptBox["\[CapitalSigma]", "\[Infinity]2"]}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{3.400925054160019*^9, 3.4009250897388268`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"F", "[", "\[Beta]_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     SuperscriptBox["\[Beta]", "2"]}], " ", 
    SubsuperscriptBox["\[Nu]", "1", "2"], " ", 
    SubsuperscriptBox["\[Nu]", "2", "2"]}], "+", 
   RowBox[{"\[Beta]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"4", " ", 
       SubscriptBox["\[Lambda]", "1"], " ", 
       SubsuperscriptBox["\[Nu]", "2", "2"], " ", 
       SubscriptBox["\[CapitalSigma]", "\[Infinity]1"]}], "+", 
      RowBox[{"4", " ", 
       SubscriptBox["\[Lambda]", "2"], " ", 
       SubsuperscriptBox["\[Nu]", "1", "2"], " ", 
       SubscriptBox["\[CapitalSigma]", "\[Infinity]2"]}]}], ")"}]}], "+", 
   RowBox[{"16", " ", 
    SubscriptBox["\[Lambda]", "1"], " ", 
    SubscriptBox["\[Lambda]", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      SubsuperscriptBox["\[CapitalSigma]", "12", "2"], "-", 
      RowBox[{
       SubscriptBox["\[CapitalSigma]", "\[Infinity]1"], " ", 
       SubscriptBox["\[CapitalSigma]", "\[Infinity]2"]}]}], 
     ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.4009251543338165`*^9, 3.400925175693602*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Sum", "::", "\<\"sumwarn\"\>"}], ":", 
  " ", "\<\"Warning: \\!\\(\[CapitalSigma]\\_12\\%2\\) contains a capital \
sigma; use \[EscapeKey]sum\[EscapeKey] to enter a summation sign. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/Sum/sumwarn\\\", \
ButtonNote -> \\\"Sum::sumwarn\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.4009251788499126`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"F", "[", "\[Beta]", "]"}], ",", "\[Beta]"}], "]"}], " ", 
    "\[Equal]", "0"}], ",", "\[Beta]"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"\[Beta]", "\[Rule]", 
    FractionBox[
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[Lambda]", "1"], " ", 
         SubsuperscriptBox["\[Nu]", "2", "2"], " ", 
         SubscriptBox["\[CapitalSigma]", "\[Infinity]1"]}], "+", 
        RowBox[{
         SubscriptBox["\[Lambda]", "2"], " ", 
         SubsuperscriptBox["\[Nu]", "1", "2"], " ", 
         SubscriptBox["\[CapitalSigma]", "\[Infinity]2"]}]}], ")"}]}], 
     RowBox[{
      SubsuperscriptBox["\[Nu]", "1", "2"], " ", 
      SubsuperscriptBox["\[Nu]", "2", "2"]}]]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.400925400401041*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"let", " ", "define", " ", 
   SubscriptBox["\[Beta]", "1"]}], "=", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{"2", 
      SubscriptBox["\[Lambda]", "1"], 
      SubscriptBox["\[CapitalSigma]", "\[Infinity]1"]}], 
     SubsuperscriptBox["\[Nu]", "1", "2"]], " ", "and", " ", 
    SubscriptBox["\[Beta]", "2"]}], "=", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"2", 
       SubscriptBox["\[Lambda]", "2"], 
       SubscriptBox["\[CapitalSigma]", "\[Infinity]2"]}], 
      SubsuperscriptBox["\[Nu]", "2", "2"]], "  ", "on", " ", "naturellement",
      " ", 
     SubscriptBox["\[Beta]", "1"]}], ">", 
    RowBox[{"1", " ", "et", " ", 
     SubscriptBox["\[Beta]", "2"]}], ">", "1"}]}]}]], "Text",
 CellChangeTimes->{{3.4009296114975176`*^9, 3.400929623013364*^9}, {
  3.4009296557952433`*^9, 3.4009296654360533`*^9}, {3.400929697342916*^9, 
  3.4009297174058013`*^9}, {3.4009298055481186`*^9, 3.400929830314219*^9}, {
  3.400929874986952*^9, 3.4009298803776803`*^9}}],

Cell["et ", "Text",
 CellChangeTimes->{{3.4009298402050343`*^9, 3.400929840580041*^9}}],

Cell[BoxData[
 RowBox[{
  SubscriptBox["\[Beta]", "optimal"], "=", 
  RowBox[{
   SubscriptBox["\[Beta]", "1"], "+", 
   SubscriptBox["\[Beta]", "2"]}]}]], "Text",
 CellChangeTimes->{{3.4009298493614597`*^9, 3.4009298570647326`*^9}, {
  3.400929905784418*^9, 3.4009299127845526`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"F", "[", "\[Beta]", "]"}], "/.", " ", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"F", "[", "\[Beta]", "]"}], ",", "\[Beta]"}], "]"}], " ", 
      "\[Equal]", "0"}], ",", "\[Beta]"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.400925187943837*^9, 3.4009252406167235`*^9}, {
  3.4009252940239987`*^9, 3.4009253171338177`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"4", " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{
       SubsuperscriptBox["\[Lambda]", "1", "2"], " ", 
       SubsuperscriptBox["\[Nu]", "2", "2"], " ", 
       SubsuperscriptBox["\[CapitalSigma]", "\[Infinity]1", "2"]}], 
      SubsuperscriptBox["\[Nu]", "1", "2"]], "+", 
     FractionBox[
      RowBox[{
       SubsuperscriptBox["\[Lambda]", "2", "2"], " ", 
       SubsuperscriptBox["\[Nu]", "1", "2"], " ", 
       SubsuperscriptBox["\[CapitalSigma]", "\[Infinity]2", "2"]}], 
      SubsuperscriptBox["\[Nu]", "2", "2"]], "+", 
     RowBox[{"2", " ", 
      SubscriptBox["\[Lambda]", "1"], " ", 
      SubscriptBox["\[Lambda]", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         SubsuperscriptBox["\[CapitalSigma]", "12", "2"]}], "-", 
        RowBox[{
         SubscriptBox["\[CapitalSigma]", "\[Infinity]1"], " ", 
         SubscriptBox["\[CapitalSigma]", "\[Infinity]2"]}]}], ")"}]}]}], 
    ")"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.4009251981471577`*^9, 3.4009252221319933`*^9}, {
  3.400925297039682*^9, 3.400925317899457*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{
      SubsuperscriptBox["\[Lambda]", "1", "2"], " ", 
      SubsuperscriptBox["\[Nu]", "2", "2"], " ", 
      SubsuperscriptBox["\[CapitalSigma]", "\[Infinity]1", "2"]}], 
     SubsuperscriptBox["\[Nu]", "1", "2"]], "+", 
    FractionBox[
     RowBox[{
      SubsuperscriptBox["\[Lambda]", "2", "2"], " ", 
      SubsuperscriptBox["\[Nu]", "1", "2"], " ", 
      SubsuperscriptBox["\[CapitalSigma]", "\[Infinity]2", "2"]}], 
     SubsuperscriptBox["\[Nu]", "2", "2"]]}], " ", "/.", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[CapitalSigma]", "\[Infinity]1"], "->", " ", 
      FractionBox[
       RowBox[{
        SubscriptBox["\[Beta]", "1"], 
        SubsuperscriptBox["\[Nu]", "1", "2"]}], 
       RowBox[{"2", 
        SubscriptBox["\[Lambda]", "1"]}]]}], ",", 
     RowBox[{
      SubscriptBox["\[CapitalSigma]", "\[Infinity]2"], "->", " ", 
      FractionBox[
       RowBox[{
        SubscriptBox["\[Beta]", "2"], 
        SubsuperscriptBox["\[Nu]", "2", "2"]}], 
       RowBox[{"2", 
        SubscriptBox["\[Lambda]", "2"]}]]}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.400997886659603*^9, 3.4009978886596413`*^9}, {
  3.4009979408637686`*^9, 3.400997989145946*^9}, {3.4009980490689716`*^9, 
  3.400998054709705*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Sum", "::", "\<\"sumwarn\"\>"}], ":", 
  " ", "\<\"Warning: \\!\\(\[CapitalSigma]\\_\[Infinity]1\\%2\\) contains a \
capital sigma; use \[EscapeKey]sum\[EscapeKey] to enter a summation sign. \\!\
\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/Sum/sumwarn\\\", \
ButtonNote -> \\\"Sum::sumwarn\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.4009979915053663`*^9, 3.4009980555378456`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Sum", "::", "\<\"sumwarn\"\>"}], ":", 
  " ", "\<\"Warning: \\!\\(\[CapitalSigma]\\_\[Infinity]2\\%2\\) contains a \
capital sigma; use \[EscapeKey]sum\[EscapeKey] to enter a summation sign. \\!\
\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/Sum/sumwarn\\\", \
ButtonNote -> \\\"Sum::sumwarn\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.4009979915053663`*^9, 3.4009980555378456`*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "4"], " ", 
  RowBox[{"(", 
   RowBox[{
    SubsuperscriptBox["\[Beta]", "1", "2"], "+", 
    SubsuperscriptBox["\[Beta]", "2", "2"]}], ")"}], " ", 
  SubsuperscriptBox["\[Nu]", "1", "2"], " ", 
  SubsuperscriptBox["\[Nu]", "2", "2"]}]], "Output",
 CellChangeTimes->{3.4009979915209913`*^9, 3.4009980555378456`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"F", "[", 
   SubscriptBox["\[Beta]", "optimal"], "]"}], "=", 
  RowBox[{
   RowBox[{"4", " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{
        SubsuperscriptBox["\[Lambda]", "1", "2"], " ", 
        SubsuperscriptBox["\[Nu]", "2", "2"], " ", 
        SubsuperscriptBox["\[CapitalSigma]", "\[Infinity]1", "2"]}], 
       SubsuperscriptBox["\[Nu]", "1", "2"]], "+", 
      FractionBox[
       RowBox[{
        SubsuperscriptBox["\[Lambda]", "2", "2"], " ", 
        SubsuperscriptBox["\[Nu]", "1", "2"], " ", 
        SubsuperscriptBox["\[CapitalSigma]", "\[Infinity]2", "2"]}], 
       SubsuperscriptBox["\[Nu]", "2", "2"]], "+", 
      RowBox[{"2", " ", 
       SubscriptBox["\[Lambda]", "1"], " ", 
       SubscriptBox["\[Lambda]", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          SubsuperscriptBox["\[CapitalSigma]", "12", "2"]}], "-", 
         RowBox[{
          SubscriptBox["\[CapitalSigma]", "\[Infinity]1"], " ", 
          SubscriptBox["\[CapitalSigma]", "\[Infinity]2"]}]}], ")"}]}]}], 
     ")"}]}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      FractionBox["1", "4"], " ", 
      RowBox[{"(", 
       RowBox[{
        SubsuperscriptBox["\[Beta]", "1", "2"], "+", 
        SubsuperscriptBox["\[Beta]", "2", "2"], "-", 
        RowBox[{"2", 
         SubscriptBox["\[Beta]", "1"], 
         SubscriptBox["\[Beta]", "2"]}]}], ")"}], " ", 
      SubsuperscriptBox["\[Nu]", "1", "2"], " ", 
      SubsuperscriptBox["\[Nu]", "2", "2"]}], "+", 
     RowBox[{"16", " ", 
      SubscriptBox["\[Lambda]", "1"], " ", 
      SubscriptBox["\[Lambda]", "2"], "  ", 
      SubsuperscriptBox["\[CapitalSigma]", "12", "2"]}]}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       FractionBox["1", "4"], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["\[Beta]", "1"], "+", 
          SubscriptBox["\[Beta]", "2"]}], ")"}], "2"]}], "+", 
      RowBox[{"16", " ", 
       SubscriptBox["\[Lambda]", "1"], " ", 
       SubscriptBox["\[Lambda]", "2"], "  ", 
       SubsuperscriptBox["\[CapitalSigma]", "12", "2"]}]}], "=", 
     RowBox[{
      RowBox[{
       FractionBox["1", "4"], 
       SuperscriptBox[
        RowBox[{"(", 
         SubscriptBox["\[Beta]", "optimal"], ")"}], "2"]}], "+", 
      RowBox[{"16", " ", 
       SubscriptBox["\[Lambda]", "1"], " ", 
       SubscriptBox["\[Lambda]", "2"], "  ", 
       SubsuperscriptBox["\[CapitalSigma]", "12", "2"]}]}]}]}]}]}]], "Text",
 CellChangeTimes->{{3.400929960551094*^9, 3.4009299678481092`*^9}, {
  3.4009300251304593`*^9, 3.400930027614882*^9}, {3.400930066537504*^9, 
  3.400930104460108*^9}, {3.4009305483748803`*^9, 3.4009305575156813`*^9}, {
  3.400930613594883*^9, 3.400930683768105*^9}, {3.4009978206895866`*^9, 
  3.4009978210489683`*^9}, {3.4009980660849233`*^9, 3.4009980795539317`*^9}, {
  3.4009981284142447`*^9, 3.400998181696518*^9}, {3.4009982853235073`*^9, 
  3.4009983001519175`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Donc", "  ", 
   SubscriptBox["\[Beta]", "optimal"]}], " ", ">", 
  RowBox[{"1", " ", "et", "  ", 
   RowBox[{"F", "[", 
    SubscriptBox["\[Beta]", "optimal"], "]"}]}], " ", ">", "0"}]], "Text",
 CellChangeTimes->{{3.400998303886364*^9, 3.400998325261774*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "pour", " ", "que", " ", "les", " ", "valeur", " ", "propre", " ", "de", 
   " ", "M", " ", "soient", " ", "reelle"}], ",", " ", 
  RowBox[{
   RowBox[{
   "il", " ", "faut", " ", "aussi", " ", "que", " ", "le", " ", 
    "discriminant"}], " ", ">", "0"}]}]], "Input",
 CellChangeTimes->{{3.4009991729499245`*^9, 3.4009992040130205`*^9}}],

Cell[BoxData[
 RowBox[{"discriminant", "=", 
  RowBox[{
   SuperscriptBox["trace", "2"], "-", 
   RowBox[{"4", "determinant"}]}]}]], "Input",
 CellChangeTimes->{{3.4009992074349613`*^9, 3.4009992445606747`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{
    SuperscriptBox[
     RowBox[{"Tr", "[", 
      RowBox[{"(", GridBox[{
         {
          FractionBox[
           RowBox[{"-", 
            SubscriptBox["\[Lambda]", "1"]}], "2"], 
          FractionBox[
           RowBox[{
            RowBox[{
             SubscriptBox["\[Lambda]", "2"], 
             SubscriptBox["\[CapitalSigma]", "\[Infinity]2"]}], "-", 
            RowBox[{"\[Beta]", " ", 
             RowBox[{"(", 
              FractionBox[
               SuperscriptBox[
                SubscriptBox["\[Nu]", "2"], "2"], "4"], ")"}], " "}]}], 
           RowBox[{"2", 
            SubscriptBox["\[CapitalSigma]", "12"]}]]},
         {
          FractionBox[
           RowBox[{
            RowBox[{
             SubscriptBox["\[Lambda]", "1"], 
             SubscriptBox["\[CapitalSigma]", "\[Infinity]1"]}], "-", 
            RowBox[{"\[Beta]", " ", 
             RowBox[{"(", 
              FractionBox[
               SuperscriptBox[
                SubscriptBox["\[Nu]", "1"], "2"], "4"], ")"}], " "}]}], 
           RowBox[{"2", 
            SubscriptBox["\[CapitalSigma]", "12"]}]], 
          FractionBox[
           RowBox[{"-", 
            SubscriptBox["\[Lambda]", "2"]}], "2"]}
        }], ")"}], "]"}], "2"], "-", 
    RowBox[{"4", 
     RowBox[{"Det", "[", 
      RowBox[{"(", GridBox[{
         {
          FractionBox[
           RowBox[{"-", 
            SubscriptBox["\[Lambda]", "1"]}], "2"], 
          FractionBox[
           RowBox[{
            RowBox[{
             SubscriptBox["\[Lambda]", "2"], 
             SubscriptBox["\[CapitalSigma]", "\[Infinity]2"]}], "-", 
            RowBox[{"\[Beta]", " ", 
             RowBox[{"(", 
              FractionBox[
               SuperscriptBox[
                SubscriptBox["\[Nu]", "2"], "2"], "4"], ")"}], " "}]}], 
           RowBox[{"2", 
            SubscriptBox["\[CapitalSigma]", "12"]}]]},
         {
          FractionBox[
           RowBox[{
            RowBox[{
             SubscriptBox["\[Lambda]", "1"], 
             SubscriptBox["\[CapitalSigma]", "\[Infinity]1"]}], "-", 
            RowBox[{"\[Beta]", " ", 
             RowBox[{"(", 
              FractionBox[
               SuperscriptBox[
                SubscriptBox["\[Nu]", "1"], "2"], "4"], ")"}], " "}]}], 
           RowBox[{"2", 
            SubscriptBox["\[CapitalSigma]", "12"]}]], 
          FractionBox[
           RowBox[{"-", 
            SubscriptBox["\[Lambda]", "2"]}], "2"]}
        }], ")"}], "]"}]}]}], " ", "//.", "  ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[CapitalSigma]", "\[Infinity]1"], "->", " ", 
      FractionBox[
       RowBox[{
        SubscriptBox["\[Beta]", "1"], 
        SubsuperscriptBox["\[Nu]", "1", "2"]}], 
       RowBox[{"2", 
        SubscriptBox["\[Lambda]", "1"]}]]}], ",", 
     RowBox[{
      SubscriptBox["\[CapitalSigma]", "\[Infinity]2"], "->", " ", 
      FractionBox[
       RowBox[{
        SubscriptBox["\[Beta]", "2"], 
        SubsuperscriptBox["\[Nu]", "2", "2"]}], 
       RowBox[{"2", 
        SubscriptBox["\[Lambda]", "2"]}]]}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.400999294389756*^9, 3.4009993358593025`*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"\[Beta]", "-", 
      RowBox[{"2", " ", 
       SubscriptBox["\[Beta]", "1"]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"\[Beta]", "-", 
      RowBox[{"2", " ", 
       SubscriptBox["\[Beta]", "2"]}]}], ")"}], " ", 
    SubsuperscriptBox["\[Nu]", "1", "2"], " ", 
    SubsuperscriptBox["\[Nu]", "2", "2"]}], "+", 
   RowBox[{"4", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["\[Lambda]", "1"], "-", 
       SubscriptBox["\[Lambda]", "2"]}], ")"}], "2"], " ", 
    SubsuperscriptBox["\[CapitalSigma]", "12", "2"]}]}], 
  RowBox[{"16", " ", 
   SubsuperscriptBox["\[CapitalSigma]", "12", "2"]}]]], "Output",
 CellChangeTimes->{{3.400999308561903*^9, 3.4009993371562023`*^9}}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.400999320468382*^9, 3.4009993225309215`*^9}}],

Cell[BoxData[
 RowBox[{"donc", " ", "si", " ", "\[Beta]", " ", "est", " ", "plus", " ", 
  "grand", " ", "que", " ", "2", 
  SubscriptBox["\[Beta]", "1"], "et", " ", "2", 
  SubscriptBox["\[Beta]", "2"], " ", "ce", " ", "sera", " ", 
  "positif"}]], "Input",
 CellChangeTimes->{{3.401006431495536*^9, 3.40100647729329*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Beta]Optimal", "[", 
   RowBox[{
   "\[Nu]1_", ",", "\[Chi]1_", ",", "\[CapitalSigma]inf1_", ",", "\[Nu]2_", 
    ",", "\[Chi]2_", ",", "\[CapitalSigma]inf2_"}], "]"}], ":=", 
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[Chi]1", " ", 
       SuperscriptBox["\[Nu]2", "2"], " ", "\[CapitalSigma]inf1"}], "+", 
      RowBox[{"\[Chi]2", " ", 
       SuperscriptBox["\[Nu]1", "2"], " ", "\[CapitalSigma]inf2"}]}], ")"}]}],
    
   RowBox[{
    SuperscriptBox["\[Nu]1", "2"], " ", 
    SuperscriptBox["\[Nu]2", "2"]}]]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4009314720332394`*^9, 3.4009316046920366`*^9}, {
  3.4011156400091333`*^9, 3.401115648556173*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Beta]Optimal2", "[", 
   RowBox[{
   "\[Nu]1_", ",", "\[Chi]1_", ",", "\[CapitalSigma]inf1_", ",", "\[Nu]2_", 
    ",", "\[Chi]2_", ",", "\[CapitalSigma]inf2_"}], "]"}], ":=", 
  FractionBox[
   RowBox[{"4", " ", 
    RowBox[{"(", 
     RowBox[{"Max", "[", 
      RowBox[{
       RowBox[{"\[Chi]1", " ", 
        SuperscriptBox["\[Nu]2", "2"], " ", "\[CapitalSigma]inf1"}], ",", 
       RowBox[{"\[Chi]2", " ", 
        SuperscriptBox["\[Nu]1", "2"], " ", "\[CapitalSigma]inf2"}]}], "]"}], 
     ")"}]}], 
   RowBox[{
    SuperscriptBox["\[Nu]1", "2"], " ", 
    SuperscriptBox["\[Nu]2", "2"]}]]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4009314720332394`*^9, 3.4009316046920366`*^9}, {
  3.40100663953078*^9, 3.40100665878115*^9}, {3.4010066889536037`*^9, 
  3.401006700516326*^9}, {3.401115652931257*^9, 3.401115661337668*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MDeterminant", "[", 
   RowBox[{
   "\[Nu]1_", ",", "\[Chi]1_", ",", "\[CapitalSigma]inf1_", ",", "\[Nu]2_", 
    ",", "\[Chi]2_", ",", "\[CapitalSigma]inf2_", ",", "\[CapitalSigma]12_", 
    ",", "\[Beta]_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     SuperscriptBox["\[Beta]", "2"]}], " ", 
    SuperscriptBox["\[Nu]1", "2"], " ", 
    SuperscriptBox["\[Nu]2", "2"]}], "+", 
   RowBox[{"\[Beta]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"4", " ", "\[Chi]1", "  ", 
       SuperscriptBox["\[Nu]2", "2"], " ", "\[CapitalSigma]inf1"}], "+", 
      RowBox[{"4", " ", "\[Chi]2", " ", 
       SuperscriptBox["\[Nu]1", "2"], " ", "\[CapitalSigma]inf2"}]}], ")"}]}],
    "+", 
   RowBox[{"16", " ", "\[Chi]1", " ", "\[Chi]2", " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["\[CapitalSigma]12", "2"], "-", 
      RowBox[{"\[CapitalSigma]inf1", " ", "\[CapitalSigma]inf2"}]}], 
     ")"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4009346530474386`*^9, 3.4009346593600597`*^9}, {
  3.400934699673334*^9, 3.4009348120348663`*^9}, {3.401115665447122*^9, 
  3.4011156815568066`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["geometrie du risque : rapprochement avec Heston", "Subsubtitle",
 CellChangeTimes->{{3.4005932246350393`*^9, 3.400593238838437*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{"Q11", ",", "Q12", ",", "Q21", ",", "Q22"}], "]"}]], "Input",
 CellChangeTimes->{{3.4005930558974247`*^9, 3.4005930665851297`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         SuperscriptBox["Q11", "2"], "+", 
         SuperscriptBox["Q21", "2"]}], "\[Equal]", 
        RowBox[{
         SuperscriptBox["\[Nu]1", "2"], "/", "4"}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"Q11", " ", "\[Rho]1"}], "+", 
         RowBox[{"Q21", " ", "\[Rho]2"}]}], " ", "\[Equal]", 
        RowBox[{
         FractionBox["\[Nu]1", "2"], " ", "\[Rho]s1"}]}], ",", 
       RowBox[{
        RowBox[{
         SuperscriptBox["Q12", "2"], "+", 
         SuperscriptBox["Q22", "2"]}], "\[Equal]", 
        RowBox[{
         SuperscriptBox["\[Nu]2", "2"], "/", "4"}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"Q12", " ", "\[Rho]1"}], "+", 
         RowBox[{"Q22", " ", "\[Rho]2"}]}], " ", "\[Equal]", 
        RowBox[{
         FractionBox["\[Nu]2", "2"], " ", "\[Rho]s2"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Q11", ",", "Q21", ",", "Q12", ",", "Q22"}], "}"}]}], "]"}], 
   ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"\[Nu]1", ">", "0"}], ")"}], "&&", 
    RowBox[{"(", 
     RowBox[{"\[Nu]2", ">", "0"}], ")"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.400592706234462*^9, 3.4005927394851*^9}, {
  3.400592924723031*^9, 3.4005929937868576`*^9}, {3.4005930352407784`*^9, 
  3.400593048881665*^9}, {3.400593085460492*^9, 3.4005931693058524`*^9}, {
  3.400852766685664*^9, 3.400852781498449*^9}, {3.400853502777922*^9, 
  3.400853505106092*^9}, {3.4008535372629595`*^9, 3.4008535512788534`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Q11", "\[Rule]", 
      FractionBox[
       RowBox[{"\[Nu]1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["\[Rho]1", "2"], " ", "\[Rho]s1"}], "-", 
          RowBox[{"\[Rho]2", " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox["\[Rho]1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["\[Rho]1", "2"], "+", 
               SuperscriptBox["\[Rho]2", "2"], "-", 
               SuperscriptBox["\[Rho]s1", "2"]}], ")"}]}]]}]}], ")"}]}], 
       RowBox[{"2", " ", "\[Rho]1", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["\[Rho]1", "2"], "+", 
          SuperscriptBox["\[Rho]2", "2"]}], ")"}]}]]}], ",", 
     RowBox[{"Q21", "\[Rule]", 
      FractionBox[
       RowBox[{"\[Nu]1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Rho]2", " ", "\[Rho]s1"}], "+", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["\[Rho]1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["\[Rho]1", "2"], "+", 
              SuperscriptBox["\[Rho]2", "2"], "-", 
              SuperscriptBox["\[Rho]s1", "2"]}], ")"}]}]]}], ")"}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["\[Rho]1", "2"], "+", 
          SuperscriptBox["\[Rho]2", "2"]}], ")"}]}]]}], ",", 
     RowBox[{"Q12", "\[Rule]", 
      FractionBox[
       RowBox[{"\[Nu]2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["\[Rho]1", "2"], " ", "\[Rho]s2"}], "-", 
          RowBox[{"\[Rho]2", " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox["\[Rho]1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["\[Rho]1", "2"], "+", 
               SuperscriptBox["\[Rho]2", "2"], "-", 
               SuperscriptBox["\[Rho]s2", "2"]}], ")"}]}]]}]}], ")"}]}], 
       RowBox[{"2", " ", "\[Rho]1", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["\[Rho]1", "2"], "+", 
          SuperscriptBox["\[Rho]2", "2"]}], ")"}]}]]}], ",", 
     RowBox[{"Q22", "\[Rule]", 
      FractionBox[
       RowBox[{"\[Nu]2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Rho]2", " ", "\[Rho]s2"}], "+", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["\[Rho]1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["\[Rho]1", "2"], "+", 
              SuperscriptBox["\[Rho]2", "2"], "-", 
              SuperscriptBox["\[Rho]s2", "2"]}], ")"}]}]]}], ")"}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["\[Rho]1", "2"], "+", 
          SuperscriptBox["\[Rho]2", "2"]}], ")"}]}]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Q11", "\[Rule]", 
      FractionBox[
       RowBox[{"\[Nu]1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["\[Rho]1", "2"], " ", "\[Rho]s1"}], "-", 
          RowBox[{"\[Rho]2", " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox["\[Rho]1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["\[Rho]1", "2"], "+", 
               SuperscriptBox["\[Rho]2", "2"], "-", 
               SuperscriptBox["\[Rho]s1", "2"]}], ")"}]}]]}]}], ")"}]}], 
       RowBox[{"2", " ", "\[Rho]1", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["\[Rho]1", "2"], "+", 
          SuperscriptBox["\[Rho]2", "2"]}], ")"}]}]]}], ",", 
     RowBox[{"Q21", "\[Rule]", 
      FractionBox[
       RowBox[{"\[Nu]1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Rho]2", " ", "\[Rho]s1"}], "+", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["\[Rho]1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["\[Rho]1", "2"], "+", 
              SuperscriptBox["\[Rho]2", "2"], "-", 
              SuperscriptBox["\[Rho]s1", "2"]}], ")"}]}]]}], ")"}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["\[Rho]1", "2"], "+", 
          SuperscriptBox["\[Rho]2", "2"]}], ")"}]}]]}], ",", 
     RowBox[{"Q12", "\[Rule]", 
      FractionBox[
       RowBox[{"\[Nu]2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["\[Rho]1", "2"], " ", "\[Rho]s2"}], "+", 
          RowBox[{"\[Rho]2", " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox["\[Rho]1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["\[Rho]1", "2"], "+", 
               SuperscriptBox["\[Rho]2", "2"], "-", 
               SuperscriptBox["\[Rho]s2", "2"]}], ")"}]}]]}]}], ")"}]}], 
       RowBox[{"2", " ", "\[Rho]1", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["\[Rho]1", "2"], "+", 
          SuperscriptBox["\[Rho]2", "2"]}], ")"}]}]]}], ",", 
     RowBox[{"Q22", "\[Rule]", 
      FractionBox[
       RowBox[{
        RowBox[{"\[Nu]2", " ", "\[Rho]2", " ", "\[Rho]s2"}], "-", 
        RowBox[{"\[Nu]2", " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["\[Rho]1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["\[Rho]1", "2"], "+", 
             SuperscriptBox["\[Rho]2", "2"], "-", 
             SuperscriptBox["\[Rho]s2", "2"]}], ")"}]}]]}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["\[Rho]1", "2"], "+", 
          SuperscriptBox["\[Rho]2", "2"]}], ")"}]}]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Q11", "\[Rule]", 
      FractionBox[
       RowBox[{"\[Nu]1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["\[Rho]1", "2"], " ", "\[Rho]s1"}], "+", 
          RowBox[{"\[Rho]2", " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox["\[Rho]1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["\[Rho]1", "2"], "+", 
               SuperscriptBox["\[Rho]2", "2"], "-", 
               SuperscriptBox["\[Rho]s1", "2"]}], ")"}]}]]}]}], ")"}]}], 
       RowBox[{"2", " ", "\[Rho]1", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["\[Rho]1", "2"], "+", 
          SuperscriptBox["\[Rho]2", "2"]}], ")"}]}]]}], ",", 
     RowBox[{"Q21", "\[Rule]", 
      FractionBox[
       RowBox[{
        RowBox[{"\[Nu]1", " ", "\[Rho]2", " ", "\[Rho]s1"}], "-", 
        RowBox[{"\[Nu]1", " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["\[Rho]1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["\[Rho]1", "2"], "+", 
             SuperscriptBox["\[Rho]2", "2"], "-", 
             SuperscriptBox["\[Rho]s1", "2"]}], ")"}]}]]}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["\[Rho]1", "2"], "+", 
          SuperscriptBox["\[Rho]2", "2"]}], ")"}]}]]}], ",", 
     RowBox[{"Q12", "\[Rule]", 
      FractionBox[
       RowBox[{"\[Nu]2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["\[Rho]1", "2"], " ", "\[Rho]s2"}], "-", 
          RowBox[{"\[Rho]2", " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox["\[Rho]1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["\[Rho]1", "2"], "+", 
               SuperscriptBox["\[Rho]2", "2"], "-", 
               SuperscriptBox["\[Rho]s2", "2"]}], ")"}]}]]}]}], ")"}]}], 
       RowBox[{"2", " ", "\[Rho]1", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["\[Rho]1", "2"], "+", 
          SuperscriptBox["\[Rho]2", "2"]}], ")"}]}]]}], ",", 
     RowBox[{"Q22", "\[Rule]", 
      FractionBox[
       RowBox[{"\[Nu]2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Rho]2", " ", "\[Rho]s2"}], "+", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["\[Rho]1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["\[Rho]1", "2"], "+", 
              SuperscriptBox["\[Rho]2", "2"], "-", 
              SuperscriptBox["\[Rho]s2", "2"]}], ")"}]}]]}], ")"}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["\[Rho]1", "2"], "+", 
          SuperscriptBox["\[Rho]2", "2"]}], ")"}]}]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Q11", "\[Rule]", 
      FractionBox[
       RowBox[{"\[Nu]1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["\[Rho]1", "2"], " ", "\[Rho]s1"}], "+", 
          RowBox[{"\[Rho]2", " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox["\[Rho]1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["\[Rho]1", "2"], "+", 
               SuperscriptBox["\[Rho]2", "2"], "-", 
               SuperscriptBox["\[Rho]s1", "2"]}], ")"}]}]]}]}], ")"}]}], 
       RowBox[{"2", " ", "\[Rho]1", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["\[Rho]1", "2"], "+", 
          SuperscriptBox["\[Rho]2", "2"]}], ")"}]}]]}], ",", 
     RowBox[{"Q21", "\[Rule]", 
      FractionBox[
       RowBox[{
        RowBox[{"\[Nu]1", " ", "\[Rho]2", " ", "\[Rho]s1"}], "-", 
        RowBox[{"\[Nu]1", " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["\[Rho]1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["\[Rho]1", "2"], "+", 
             SuperscriptBox["\[Rho]2", "2"], "-", 
             SuperscriptBox["\[Rho]s1", "2"]}], ")"}]}]]}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["\[Rho]1", "2"], "+", 
          SuperscriptBox["\[Rho]2", "2"]}], ")"}]}]]}], ",", 
     RowBox[{"Q12", "\[Rule]", 
      FractionBox[
       RowBox[{"\[Nu]2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["\[Rho]1", "2"], " ", "\[Rho]s2"}], "+", 
          RowBox[{"\[Rho]2", " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox["\[Rho]1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["\[Rho]1", "2"], "+", 
               SuperscriptBox["\[Rho]2", "2"], "-", 
               SuperscriptBox["\[Rho]s2", "2"]}], ")"}]}]]}]}], ")"}]}], 
       RowBox[{"2", " ", "\[Rho]1", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["\[Rho]1", "2"], "+", 
          SuperscriptBox["\[Rho]2", "2"]}], ")"}]}]]}], ",", 
     RowBox[{"Q22", "\[Rule]", 
      FractionBox[
       RowBox[{
        RowBox[{"\[Nu]2", " ", "\[Rho]2", " ", "\[Rho]s2"}], "-", 
        RowBox[{"\[Nu]2", " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["\[Rho]1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["\[Rho]1", "2"], "+", 
             SuperscriptBox["\[Rho]2", "2"], "-", 
             SuperscriptBox["\[Rho]s2", "2"]}], ")"}]}]]}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["\[Rho]1", "2"], "+", 
          SuperscriptBox["\[Rho]2", "2"]}], ")"}]}]]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.4005929960681515`*^9, 3.4005931042733536`*^9, 
  3.4005931722902846`*^9, 3.4008527357944465`*^9, 3.40085278624854*^9, 
  3.400853509809307*^9, 3.4008535534038944`*^9}]
}, Open  ]],

Cell["\<\
Les quatre solution sont equivalente car redonne les meme observables\
\>", "Text",
 CellChangeTimes->{{3.4005934316077633`*^9, 3.400593451936279*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DetermineQ", "[", 
    RowBox[{
    "\[Rho]1_", ",", "\[Rho]2_", ",", "\[Nu]1_", ",", "\[Nu]2_", ",", 
     "\[Rho]s1_", ",", "\[Rho]s2_", ",", "printflag_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Q11", ",", "Q21", ",", "Q12", ",", "Q22"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Rho]1", "\[NotEqual]", "0"}], ")"}], "||", 
         RowBox[{"(", 
          RowBox[{"\[Rho]2", "\[NotEqual]", "0"}], ")"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Q11", "=", 
          FractionBox[
           RowBox[{"\[Nu]1", " ", 
            RowBox[{"(", " ", 
             RowBox[{
              RowBox[{"\[Rho]1", " ", "\[Rho]s1"}], "-", 
              RowBox[{"\[Rho]2", " ", 
               SqrtBox[
                RowBox[{" ", 
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox["\[Rho]1", "2"], "+", 
                   SuperscriptBox["\[Rho]2", "2"], "-", " ", 
                   SuperscriptBox["\[Rho]s1", "2"]}], ")"}]}]]}]}], ")"}]}], 
           RowBox[{"2", "  ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["\[Rho]1", "2"], "+", 
              SuperscriptBox["\[Rho]2", "2"]}], ")"}]}]]}], ";", 
         RowBox[{"Q21", "=", 
          FractionBox[
           RowBox[{"\[Nu]1", " ", 
            RowBox[{"(", " ", 
             RowBox[{
              RowBox[{"\[Rho]2", " ", "\[Rho]s1"}], "+", 
              SqrtBox[
               RowBox[{
                SuperscriptBox["\[Rho]1", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["\[Rho]1", "2"], "+", 
                  SuperscriptBox["\[Rho]2", "2"], "-", " ", 
                  SuperscriptBox["\[Rho]s1", "2"]}], ")"}]}]]}], ")"}]}], 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["\[Rho]1", "2"], "+", 
              SuperscriptBox["\[Rho]2", "2"]}], ")"}]}]]}], ";", 
         RowBox[{"Q12", "=", 
          FractionBox[
           RowBox[{"\[Nu]2", " ", 
            RowBox[{"(", " ", 
             RowBox[{
              RowBox[{"\[Rho]1", " ", "\[Rho]s2"}], "-", 
              RowBox[{"\[Rho]2", " ", 
               SqrtBox[
                RowBox[{" ", 
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox["\[Rho]1", "2"], "+", 
                   SuperscriptBox["\[Rho]2", "2"], "-", " ", 
                   SuperscriptBox["\[Rho]s2", "2"]}], ")"}]}]]}]}], ")"}]}], 
           RowBox[{"2", "  ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["\[Rho]1", "2"], "+", 
              SuperscriptBox["\[Rho]2", "2"]}], ")"}]}]]}], ";", 
         RowBox[{"Q22", "=", 
          FractionBox[
           RowBox[{"\[Nu]2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[Rho]2", " ", "\[Rho]s2"}], "+", 
              SqrtBox[
               RowBox[{
                SuperscriptBox["\[Rho]1", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["\[Rho]1", "2"], "+", 
                  SuperscriptBox["\[Rho]2", "2"], "-", " ", 
                  SuperscriptBox["\[Rho]s2", "2"]}], ")"}]}]]}], ")"}]}], 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["\[Rho]1", "2"], "+", 
              SuperscriptBox["\[Rho]2", "2"]}], ")"}]}]]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Q11", "==", "0"}], ")"}], "&&", 
              RowBox[{"(", 
               RowBox[{"Q12", "==", "0"}], ")"}]}], ")"}], "||", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Q21", "==", "0"}], ")"}], "&&", 
              RowBox[{"(", 
               RowBox[{"Q22", "==", "0"}], ")"}]}], ")"}]}], ",", 
           RowBox[{
            RowBox[{"Q11", "=", 
             FractionBox[
              RowBox[{"\[Nu]1", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox["\[Rho]1", "2"], " ", "\[Rho]s1"}], "-", 
                 RowBox[{"\[Rho]2", " ", 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox["\[Rho]1", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["\[Rho]1", "2"], "+", 
                    SuperscriptBox["\[Rho]2", "2"], "-", 
                    SuperscriptBox["\[Rho]s1", "2"]}], ")"}]}]]}]}], ")"}]}], 
              
              RowBox[{"2", " ", "\[Rho]1", " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["\[Rho]1", "2"], "+", 
                 SuperscriptBox["\[Rho]2", "2"]}], ")"}]}]]}], ";", 
            RowBox[{"Q21", "=", 
             FractionBox[
              RowBox[{"\[Nu]1", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"\[Rho]2", " ", "\[Rho]s1"}], "+", 
                 SqrtBox[
                  RowBox[{
                   SuperscriptBox["\[Rho]1", "2"], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["\[Rho]1", "2"], "+", 
                    SuperscriptBox["\[Rho]2", "2"], "-", 
                    SuperscriptBox["\[Rho]s1", "2"]}], ")"}]}]]}], ")"}]}], 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["\[Rho]1", "2"], "+", 
                 SuperscriptBox["\[Rho]2", "2"]}], ")"}]}]]}], ";", 
            RowBox[{"Q12", "=", 
             FractionBox[
              RowBox[{"\[Nu]2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox["\[Rho]1", "2"], " ", "\[Rho]s2"}], "+", 
                 RowBox[{"\[Rho]2", " ", 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox["\[Rho]1", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["\[Rho]1", "2"], "+", 
                    SuperscriptBox["\[Rho]2", "2"], "-", 
                    SuperscriptBox["\[Rho]s2", "2"]}], ")"}]}]]}]}], ")"}]}], 
              
              RowBox[{"2", " ", "\[Rho]1", " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["\[Rho]1", "2"], "+", 
                 SuperscriptBox["\[Rho]2", "2"]}], ")"}]}]]}], ";", 
            RowBox[{"Q22", "=", 
             FractionBox[
              RowBox[{
               RowBox[{"\[Nu]2", " ", "\[Rho]2", " ", "\[Rho]s2"}], "-", 
               RowBox[{"\[Nu]2", " ", 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox["\[Rho]1", "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    SuperscriptBox["\[Rho]1", "2"], "+", 
                    SuperscriptBox["\[Rho]2", "2"], "-", 
                    SuperscriptBox["\[Rho]s2", "2"]}], ")"}]}]]}]}], 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["\[Rho]1", "2"], "+", 
                 SuperscriptBox["\[Rho]2", "2"]}], ")"}]}]]}]}]}], "]"}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Q11", "==", "0"}], ")"}], "&&", 
              RowBox[{"(", 
               RowBox[{"Q12", "==", "0"}], ")"}]}], ")"}], "||", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Q21", "==", "0"}], ")"}], "&&", 
              RowBox[{"(", 
               RowBox[{"Q22", "==", "0"}], ")"}]}], ")"}]}], ",", 
           RowBox[{
            RowBox[{"Q11", "=", 
             FractionBox[
              RowBox[{"\[Nu]1", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox["\[Rho]1", "2"], " ", "\[Rho]s1"}], "+", 
                 RowBox[{"\[Rho]2", " ", 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox["\[Rho]1", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["\[Rho]1", "2"], "+", 
                    SuperscriptBox["\[Rho]2", "2"], "-", 
                    SuperscriptBox["\[Rho]s1", "2"]}], ")"}]}]]}]}], ")"}]}], 
              
              RowBox[{"2", " ", "\[Rho]1", " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["\[Rho]1", "2"], "+", 
                 SuperscriptBox["\[Rho]2", "2"]}], ")"}]}]]}], ";", 
            RowBox[{"Q21", "=", 
             FractionBox[
              RowBox[{
               RowBox[{"\[Nu]1", " ", "\[Rho]2", " ", "\[Rho]s1"}], "-", 
               RowBox[{"\[Nu]1", " ", 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox["\[Rho]1", "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    SuperscriptBox["\[Rho]1", "2"], "+", 
                    SuperscriptBox["\[Rho]2", "2"], "-", 
                    SuperscriptBox["\[Rho]s1", "2"]}], ")"}]}]]}]}], 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["\[Rho]1", "2"], "+", 
                 SuperscriptBox["\[Rho]2", "2"]}], ")"}]}]]}], ";", 
            RowBox[{"Q12", "=", 
             FractionBox[
              RowBox[{"\[Nu]2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox["\[Rho]1", "2"], " ", "\[Rho]s2"}], "-", 
                 RowBox[{"\[Rho]2", " ", 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox["\[Rho]1", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["\[Rho]1", "2"], "+", 
                    SuperscriptBox["\[Rho]2", "2"], "-", 
                    SuperscriptBox["\[Rho]s2", "2"]}], ")"}]}]]}]}], ")"}]}], 
              
              RowBox[{"2", " ", "\[Rho]1", " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["\[Rho]1", "2"], "+", 
                 SuperscriptBox["\[Rho]2", "2"]}], ")"}]}]]}], ";", 
            RowBox[{"Q22", "=", 
             FractionBox[
              RowBox[{"\[Nu]2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"\[Rho]2", " ", "\[Rho]s2"}], "+", 
                 SqrtBox[
                  RowBox[{
                   SuperscriptBox["\[Rho]1", "2"], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["\[Rho]1", "2"], "+", 
                    SuperscriptBox["\[Rho]2", "2"], "-", 
                    SuperscriptBox["\[Rho]s2", "2"]}], ")"}]}]]}], ")"}]}], 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["\[Rho]1", "2"], "+", 
                 SuperscriptBox["\[Rho]2", "2"]}], ")"}]}]]}]}]}], "]"}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Q11", "==", "0"}], ")"}], "&&", 
              RowBox[{"(", 
               RowBox[{"Q12", "==", "0"}], ")"}]}], ")"}], "||", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Q21", "==", "0"}], ")"}], "&&", 
              RowBox[{"(", 
               RowBox[{"Q22", "==", "0"}], ")"}]}], ")"}]}], ",", 
           RowBox[{
            RowBox[{"Q11", "=", 
             FractionBox[
              RowBox[{"\[Nu]1", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox["\[Rho]1", "2"], " ", "\[Rho]s1"}], "+", 
                 RowBox[{"\[Rho]2", " ", 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox["\[Rho]1", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["\[Rho]1", "2"], "+", 
                    SuperscriptBox["\[Rho]2", "2"], "-", 
                    SuperscriptBox["\[Rho]s1", "2"]}], ")"}]}]]}]}], ")"}]}], 
              
              RowBox[{"2", " ", "\[Rho]1", " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["\[Rho]1", "2"], "+", 
                 SuperscriptBox["\[Rho]2", "2"]}], ")"}]}]]}], ";", 
            RowBox[{"Q21", "=", 
             FractionBox[
              RowBox[{
               RowBox[{"\[Nu]1", " ", "\[Rho]2", " ", "\[Rho]s1"}], "-", 
               RowBox[{"\[Nu]1", " ", 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox["\[Rho]1", "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    SuperscriptBox["\[Rho]1", "2"], "+", 
                    SuperscriptBox["\[Rho]2", "2"], "-", 
                    SuperscriptBox["\[Rho]s1", "2"]}], ")"}]}]]}]}], 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["\[Rho]1", "2"], "+", 
                 SuperscriptBox["\[Rho]2", "2"]}], ")"}]}]]}], ";", 
            RowBox[{"Q12", "=", 
             FractionBox[
              RowBox[{"\[Nu]2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox["\[Rho]1", "2"], " ", "\[Rho]s2"}], "+", 
                 RowBox[{"\[Rho]2", " ", 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox["\[Rho]1", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["\[Rho]1", "2"], "+", 
                    SuperscriptBox["\[Rho]2", "2"], "-", 
                    SuperscriptBox["\[Rho]s2", "2"]}], ")"}]}]]}]}], ")"}]}], 
              
              RowBox[{"2", " ", "\[Rho]1", " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["\[Rho]1", "2"], "+", 
                 SuperscriptBox["\[Rho]2", "2"]}], ")"}]}]]}], ";", 
            RowBox[{"Q22", "=", 
             FractionBox[
              RowBox[{
               RowBox[{"\[Nu]2", " ", "\[Rho]2", " ", "\[Rho]s2"}], "-", 
               RowBox[{"\[Nu]2", " ", 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox["\[Rho]1", "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    SuperscriptBox["\[Rho]1", "2"], "+", 
                    SuperscriptBox["\[Rho]2", "2"], "-", 
                    SuperscriptBox["\[Rho]s2", "2"]}], ")"}]}]]}]}], 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["\[Rho]1", "2"], "+", 
                 SuperscriptBox["\[Rho]2", "2"]}], ")"}]}]]}]}]}], "]"}], 
         ";"}], "\[IndentingNewLine]", ",", 
        RowBox[{
        "Print", "[", "\"\<error: \[Rho]1==0 and \[Rho]2==0\>\"", "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"printflag", ">", "0"}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<{\[Rho]1,\[Rho]2,\[Nu]1,\[Nu]2,\[Rho]s1,\[Rho]s2}=\>\"", ",", 
          RowBox[{"{", 
           RowBox[{
           "\[Rho]1", ",", "\[Rho]2", ",", "\[Nu]1", ",", "\[Nu]2", ",", 
            "\[Rho]s1", ",", "\[Rho]s2"}], "}"}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"printflag", ">", "0"}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Autres sol=\>\"", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              FractionBox[
               RowBox[{"\[Nu]1", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox["\[Rho]1", "2"], " ", "\[Rho]s1"}], "-", 
                  RowBox[{"\[Rho]2", " ", 
                   SqrtBox[
                    RowBox[{
                    SuperscriptBox["\[Rho]1", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["\[Rho]1", "2"], "+", 
                    SuperscriptBox["\[Rho]2", "2"], "-", 
                    SuperscriptBox["\[Rho]s1", "2"]}], ")"}]}]]}]}], ")"}]}], 
               
               RowBox[{"2", " ", "\[Rho]1", " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["\[Rho]1", "2"], "+", 
                  SuperscriptBox["\[Rho]2", "2"]}], ")"}]}]], ",", 
              FractionBox[
               RowBox[{"\[Nu]1", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Rho]2", " ", "\[Rho]s1"}], "+", 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox["\[Rho]1", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["\[Rho]1", "2"], "+", 
                    SuperscriptBox["\[Rho]2", "2"], "-", 
                    SuperscriptBox["\[Rho]s1", "2"]}], ")"}]}]]}], ")"}]}], 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["\[Rho]1", "2"], "+", 
                  SuperscriptBox["\[Rho]2", "2"]}], ")"}]}]], ",", 
              FractionBox[
               RowBox[{"\[Nu]2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Rho]1", " ", "\[Rho]s2"}], "+", 
                  RowBox[{"\[Rho]2", " ", 
                   SqrtBox[
                    RowBox[{" ", 
                    RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["\[Rho]1", "2"], "+", 
                    SuperscriptBox["\[Rho]2", "2"], "-", 
                    SuperscriptBox["\[Rho]s2", "2"]}], ")"}]}]]}]}], ")"}]}], 
               
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["\[Rho]1", "2"], "+", 
                  SuperscriptBox["\[Rho]2", "2"]}], ")"}]}]], ",", 
              FractionBox[
               RowBox[{
                RowBox[{"\[Nu]2", " ", "\[Rho]2", " ", "\[Rho]s2"}], "-", 
                RowBox[{"\[Nu]2", " ", 
                 SqrtBox[
                  RowBox[{
                   SuperscriptBox["\[Rho]1", "2"], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["\[Rho]1", "2"], "+", 
                    SuperscriptBox["\[Rho]2", "2"], "-", 
                    SuperscriptBox["\[Rho]s2", "2"]}], ")"}]}]]}]}], 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["\[Rho]1", "2"], "+", 
                  SuperscriptBox["\[Rho]2", "2"]}], ")"}]}]]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              FractionBox[
               RowBox[{"\[Nu]1", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Rho]1", " ", "\[Rho]s1"}], "+", 
                  RowBox[{"\[Rho]2", " ", 
                   SqrtBox[
                    RowBox[{" ", 
                    RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["\[Rho]1", "2"], "+", 
                    SuperscriptBox["\[Rho]2", "2"], "-", 
                    SuperscriptBox["\[Rho]s1", "2"]}], ")"}]}]]}]}], ")"}]}], 
               
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["\[Rho]1", "2"], "+", 
                  SuperscriptBox["\[Rho]2", "2"]}], ")"}]}]], ",", 
              FractionBox[
               RowBox[{
                RowBox[{"\[Nu]1", " ", "\[Rho]2", " ", "\[Rho]s1"}], "-", 
                RowBox[{"\[Nu]1", " ", 
                 SqrtBox[
                  RowBox[{
                   SuperscriptBox["\[Rho]1", "2"], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["\[Rho]1", "2"], "+", 
                    SuperscriptBox["\[Rho]2", "2"], "-", 
                    SuperscriptBox["\[Rho]s1", "2"]}], ")"}]}]]}]}], 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["\[Rho]1", "2"], "+", 
                  SuperscriptBox["\[Rho]2", "2"]}], ")"}]}]], ",", 
              FractionBox[
               RowBox[{"\[Nu]2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Rho]1", " ", "\[Rho]s2"}], "-", 
                  RowBox[{"\[Rho]2", " ", 
                   SqrtBox[
                    RowBox[{" ", 
                    RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["\[Rho]1", "2"], "+", 
                    SuperscriptBox["\[Rho]2", "2"], "-", 
                    SuperscriptBox["\[Rho]s2", "2"]}], ")"}]}]]}]}], ")"}]}], 
               
               RowBox[{"2", "  ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["\[Rho]1", "2"], "+", 
                  SuperscriptBox["\[Rho]2", "2"]}], ")"}]}]], ",", 
              FractionBox[
               RowBox[{"\[Nu]2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Rho]2", " ", "\[Rho]s2"}], "+", 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox["\[Rho]1", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["\[Rho]1", "2"], "+", 
                    SuperscriptBox["\[Rho]2", "2"], "-", 
                    SuperscriptBox["\[Rho]s2", "2"]}], ")"}]}]]}], ")"}]}], 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["\[Rho]1", "2"], "+", 
                  SuperscriptBox["\[Rho]2", "2"]}], ")"}]}]]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              FractionBox[
               RowBox[{"\[Nu]1", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Rho]1", " ", "\[Rho]s1"}], "+", 
                  RowBox[{"\[Rho]2", " ", 
                   SqrtBox[
                    RowBox[{" ", 
                    RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["\[Rho]1", "2"], "+", 
                    SuperscriptBox["\[Rho]2", "2"], "-", 
                    SuperscriptBox["\[Rho]s1", "2"]}], ")"}]}]]}]}], ")"}]}], 
               
               RowBox[{"2", "  ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["\[Rho]1", "2"], "+", 
                  SuperscriptBox["\[Rho]2", "2"]}], ")"}]}]], ",", 
              FractionBox[
               RowBox[{
                RowBox[{"\[Nu]1", " ", "\[Rho]2", " ", "\[Rho]s1"}], "-", 
                RowBox[{"\[Nu]1", " ", 
                 SqrtBox[
                  RowBox[{
                   SuperscriptBox["\[Rho]1", "2"], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["\[Rho]1", "2"], "+", 
                    SuperscriptBox["\[Rho]2", "2"], "-", 
                    SuperscriptBox["\[Rho]s1", "2"]}], ")"}]}]]}]}], 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["\[Rho]1", "2"], "+", 
                  SuperscriptBox["\[Rho]2", "2"]}], ")"}]}]], ",", 
              FractionBox[
               RowBox[{"\[Nu]2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Rho]1", " ", "\[Rho]s2"}], "+", 
                  RowBox[{"\[Rho]2", " ", 
                   SqrtBox[
                    RowBox[{" ", 
                    RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["\[Rho]1", "2"], "+", 
                    SuperscriptBox["\[Rho]2", "2"], "-", 
                    SuperscriptBox["\[Rho]s2", "2"]}], ")"}]}]]}]}], ")"}]}], 
               
               RowBox[{"2", "  ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["\[Rho]1", "2"], "+", 
                  SuperscriptBox["\[Rho]2", "2"]}], ")"}]}]], ",", 
              FractionBox[
               RowBox[{
                RowBox[{"\[Nu]2", " ", "\[Rho]2", " ", "\[Rho]s2"}], "-", 
                RowBox[{"\[Nu]2", " ", 
                 SqrtBox[
                  RowBox[{
                   SuperscriptBox["\[Rho]1", "2"], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["\[Rho]1", "2"], "+", 
                    SuperscriptBox["\[Rho]2", "2"], "-", 
                    SuperscriptBox["\[Rho]s2", "2"]}], ")"}]}]]}]}], 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["\[Rho]1", "2"], "+", 
                  SuperscriptBox["\[Rho]2", "2"]}], ")"}]}]]}], "}"}]}], 
           "}"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Q11", ",", "Q12"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Q21", ",", "Q22"}], "}"}]}], "}"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4005924607766237`*^9, 3.4005925236840816`*^9}, {
   3.4005934737491975`*^9, 3.4005935286252513`*^9}, {3.4008528058582916`*^9, 
   3.400852850327895*^9}, {3.4008535583571143`*^9, 3.4008535888264494`*^9}, {
   3.402311045686802*^9, 3.4023111253914576`*^9}, {3.4023114276472607`*^9, 
   3.402311480835782*^9}, {3.402311990189311*^9, 3.4023120649251213`*^9}, {
   3.4023120981288834`*^9, 3.4023121458798003`*^9}, {3.4023127512039223`*^9, 
   3.4023128265178685`*^9}, {3.4023129386918974`*^9, 
   3.4023129975211515`*^9}, {3.4023130512721834`*^9, 
   3.4023131203360095`*^9}, {3.4023131539147797`*^9, 
   3.4023132000562906`*^9}, {3.4023132636356363`*^9, 3.402313323480535*^9}, {
   3.4023133545592566`*^9, 3.40231339118496*^9}, 3.4046471692766933`*^9, {
   3.40464731873646*^9, 3.404647324908533*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Nu]1", "=", "0.2"}], ",", 
     RowBox[{"\[Nu]2", "=", "0.2"}], ",", 
     RowBox[{"\[Rho]1", "=", "0.5"}], ",", 
     RowBox[{"\[Rho]2", "=", "0.5"}], ",", 
     RowBox[{"\[Rho]s1", "=", 
      RowBox[{"-", "0.5"}]}], ",", 
     RowBox[{"\[Rho]s2", "=", 
      RowBox[{"-", "0.5"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Q", "=", 
    RowBox[{"DetermineQ", "[", 
     RowBox[{
     "\[Rho]1", ",", "\[Rho]2", ",", "\[Nu]1", ",", "\[Nu]2", ",", "\[Rho]s1",
       ",", "\[Rho]s2", ",", "1"}], "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.402312517793191*^9, 3.402312557997088*^9}, {
  3.4023126167169657`*^9, 3.4023126810932016`*^9}, {3.402312838377471*^9, 
  3.4023128388149796`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"{\[Rho]1,\[Rho]2,\[Nu]1,\[Nu]2,\[Rho]s1,\[Rho]s2}=\"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.5`", ",", "0.5`", ",", "0.2`", ",", "0.2`", ",", 
     RowBox[{"-", "0.5`"}], ",", 
     RowBox[{"-", "0.5`"}]}], "}"}]}],
  SequenceForm[
  "{\[Rho]1,\[Rho]2,\[Nu]1,\[Nu]2,\[Rho]s1,\[Rho]s2}=", {0.5, 0.5, 0.2, 
   0.2, -0.5, -0.5}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.4023128400025024`*^9, {3.4023133376683073`*^9, 3.402313340777742*^9}, 
   3.4023133977319603`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Autres sol=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.1`"}], ",", "0.`", ",", "0.`", ",", 
       RowBox[{"-", "0.1`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.`", ",", 
       RowBox[{"-", "0.1`"}], ",", 
       RowBox[{"-", "0.1`"}], ",", "0.`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.`", ",", 
       RowBox[{"-", "0.1`"}], ",", "0.`", ",", 
       RowBox[{"-", "0.1`"}]}], "}"}]}], "}"}]}],
  SequenceForm[
  "Autres sol=", {{-0.1, 0., 0., -0.1}, {0., -0.1, -0.1, 0.}, {0., -0.1, 
   0., -0.1}}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.4023128400025024`*^9, {3.4023133376683073`*^9, 3.402313340777742*^9}, 
   3.4023133977319603`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.1`"}], ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", 
     RowBox[{"-", "0.1`"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.4023125190119643`*^9, {3.402312549293796*^9, 3.402312559450241*^9}, {
   3.402312644248744*^9, 3.402312681811965*^9}, 3.4023128400025024`*^9, {
   3.402313337683933*^9, 3.402313340777742*^9}, 3.4023133977319603`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Determination du secteur du drift : rapprochement avec les hestons \
monodimentionnels\
\>", "Subsubtitle",
 CellChangeTimes->{{3.400593671643622*^9, 3.400593714925703*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[CapitalSigma]t", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[CapitalSigma]11", ",", "\[CapitalSigma]12"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[CapitalSigma]12", ",", "\[CapitalSigma]22"}], "}"}]}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.4005896707386813`*^9, 3.4005897068174987`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[CapitalSigma]11", ",", "\[CapitalSigma]12"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[CapitalSigma]12", ",", "\[CapitalSigma]22"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.4005897092394204`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"M", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"M11", ",", "M12"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"M21", ",", "M22"}], "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.400589721520906*^9, 3.4005897346149073`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"M11", ",", "M12"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"M21", ",", "M22"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.400589736177438*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"\[CapitalSigma]t", ".", "M"}], "+", 
   RowBox[{
    RowBox[{"Transpose", "[", "M", "]"}], ".", "\[CapitalSigma]t"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.4005897474120283`*^9, 3.4005897611622925`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"M11", " ", "\[CapitalSigma]11"}], "+", 
        RowBox[{"M21", " ", "\[CapitalSigma]12"}]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"M12", " ", "\[CapitalSigma]11"}], "+", 
      RowBox[{"M11", " ", "\[CapitalSigma]12"}], "+", 
      RowBox[{"M22", " ", "\[CapitalSigma]12"}], "+", 
      RowBox[{"M21", " ", "\[CapitalSigma]22"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"M12", " ", "\[CapitalSigma]11"}], "+", 
      RowBox[{"M11", " ", "\[CapitalSigma]12"}], "+", 
      RowBox[{"M22", " ", "\[CapitalSigma]12"}], "+", 
      RowBox[{"M21", " ", "\[CapitalSigma]22"}]}], ",", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"M12", " ", "\[CapitalSigma]12"}], "+", 
        RowBox[{"M22", " ", "\[CapitalSigma]22"}]}], ")"}]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.400589752115244*^9, 3.400589762146686*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Q", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Q11", ",", "Q12"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Q21", ",", "Q22"}], "}"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.400590467535229*^9, 3.4005904831761546`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Transpose", "[", "Q", "]"}], ".", "Q"}]], "Input",
 CellChangeTimes->{{3.4005904861293364`*^9, 3.4005904978170605`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SuperscriptBox["Q11", "2"], "+", 
      SuperscriptBox["Q21", "2"]}], ",", 
     RowBox[{
      RowBox[{"Q11", " ", "Q12"}], "+", 
      RowBox[{"Q21", " ", "Q22"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Q11", " ", "Q12"}], "+", 
      RowBox[{"Q21", " ", "Q22"}]}], ",", 
     RowBox[{
      SuperscriptBox["Q12", "2"], "+", 
      SuperscriptBox["Q22", "2"]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.400590499020209*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"DetermineM", "[", 
   RowBox[{
   "Q_", ",", "\[Beta]_", ",", "\[CapitalSigma]inf1_", ",", 
    "\[CapitalSigma]inf2_", ",", "\[Chi]1_", ",", "\[Chi]2_", ",", 
    "\[CapitalSigma]012_", ",", "flag_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"M11", "=", 
       RowBox[{
        RowBox[{"-", "\[Chi]1"}], "/", "2"}]}], ",", 
      RowBox[{"M22", "=", 
       RowBox[{
        RowBox[{"-", "\[Chi]2"}], "/", "2"}]}], ",", "M21", ",", "M12", ",", 
      "M", ",", "\[Nu]1", ",", "\[Nu]2"}], "}"}], ",", "\[IndentingNewLine]", 
    
    RowBox[{
     RowBox[{"\[Nu]1", "=", 
      SqrtBox[
       RowBox[{"4", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"Q", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"Q", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "1"}], "]"}], "]"}], "2"]}], ")"}]}]]}], ";", 
     RowBox[{"\[Nu]2", "=", 
      SqrtBox[
       RowBox[{"4", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"Q", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"Q", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "2"}], "]"}], "]"}], "2"]}], ")"}]}]]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"M21", "=", 
      FractionBox[
       RowBox[{
        RowBox[{"\[Beta]", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"Q", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"Q", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "1"}], "]"}], "]"}], "2"]}], ")"}]}], "-", 
        RowBox[{"\[Chi]1", " ", "\[CapitalSigma]inf1"}]}], 
       RowBox[{"2", "\[CapitalSigma]012"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"M12", "=", 
      FractionBox[
       RowBox[{
        RowBox[{"\[Beta]", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"Q", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"Q", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "2"}], "]"}], "]"}], "2"]}], ")"}]}], "-", 
        RowBox[{"\[Chi]2", " ", "\[CapitalSigma]inf2"}]}], 
       RowBox[{"2", "\[CapitalSigma]012"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"M", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"M11", ",", "M12"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"M21", ",", "M22"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"flag", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<Q_,\[Beta],\[CapitalSigma]inf1,\[CapitalSigma]inf2,\[Chi]1,\
\[Chi]2,\[CapitalSigma]012=\>\"", ",", 
          RowBox[{"{", 
           RowBox[{
           "Q", ",", "\[Beta]", ",", "\[CapitalSigma]inf1", ",", 
            "\[CapitalSigma]inf2", ",", "\[Chi]1", ",", "\[Chi]2", ",", 
            "\[CapitalSigma]012"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<\!\(\*SuperscriptBox[\(\[Nu]1\), \(2\)]\)/2-\[Chi]1 \
\[CapitalSigma]inf1 doit etre negatif 1 : \>\"", ",", 
          RowBox[{
           RowBox[{
            SuperscriptBox["\[Nu]1", "2"], "/", "2"}], "-", 
           RowBox[{"\[Chi]1", " ", "\[CapitalSigma]inf1"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<\!\(\*SuperscriptBox[\(\[Nu]2\), \(2\)]\)/2-\[Chi]2 \
\[CapitalSigma]inf2 doit etre negatif 2 : \>\"", ",", 
          RowBox[{
           RowBox[{
            SuperscriptBox["\[Nu]2", "2"], "/", "2"}], "-", 
           RowBox[{"\[Chi]2", " ", "\[CapitalSigma]inf2"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<eigenvalues[M]=\>\"", ",", 
          RowBox[{"Eigenvalues", "[", "M", "]"}]}], "]"}], ";"}]}], "]"}], 
     ";", "\[IndentingNewLine]", "M"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4005937703486423`*^9, 3.4005937929897017`*^9}, {
   3.400593894757281*^9, 3.400593945633258*^9}, {3.400593996384232*^9, 
   3.4005940307442665`*^9}, {3.4005940629792604`*^9, 
   3.4005941189334598`*^9}, {3.4005942578267517`*^9, 3.4005944700027*^9}, {
   3.400594698069579*^9, 3.4005947468517656`*^9}, 3.4005950367635818`*^9, {
   3.4005951062649164`*^9, 3.400595360988557*^9}, {3.4008501285100126`*^9, 
   3.400850161666899*^9}, {3.4011161653785954`*^9, 3.4011161951760426`*^9}, {
   3.402310908543544*^9, 3.4023109439192233`*^9}, 3.4023110200144343`*^9}],

Cell["\<\
  il faut verifier que (Tr[M] < 0 et Det[M] > 0)
\
\>", "Text",
 CellChangeTimes->{{3.4005832538029785`*^9, 3.4005833291169243`*^9}, {
  3.400594517691116*^9, 3.400594535253953*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Nu]1", "=", "0.2"}], ",", 
     RowBox[{"\[Nu]2", "=", "0.2"}], ",", 
     RowBox[{"\[Chi]1", "=", "0.15"}], ",", 
     RowBox[{"\[Chi]2", "=", "0.15"}], ",", 
     RowBox[{"\[CapitalSigma]inf1", "=", "0.15"}], ",", 
     RowBox[{"\[CapitalSigma]inf2", "=", "0.15"}], ",", 
     RowBox[{"\[CapitalSigma]012", "=", "0.12"}], ",", 
     RowBox[{"\[Rho]1", "=", "0.5"}], ",", 
     RowBox[{"\[Rho]2", "=", "0.5"}], ",", 
     RowBox[{"\[Rho]s1", "=", 
      RowBox[{"-", "0.6"}]}], ",", 
     RowBox[{"\[Rho]s2", "=", 
      RowBox[{"-", "0.6"}]}], ",", 
     RowBox[{"\[Beta]", "=", "3"}], ",", "Q", ",", "M"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Q", "=", 
     RowBox[{"DetermineQ", "[", 
      RowBox[{
      "\[Rho]1", ",", "\[Rho]2", ",", "\[Nu]1", ",", "\[Nu]2", ",", 
       "\[Rho]s1", ",", "\[Rho]s2", ",", "0"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"M", "=", 
     RowBox[{"DetermineM", "[", 
      RowBox[{
      "Q", ",", "\[Beta]", ",", "\[CapitalSigma]inf1", ",", 
       "\[CapitalSigma]inf2", ",", "\[Chi]1", ",", "\[Chi]2", ",", 
       "\[CapitalSigma]012", ",", "1"}], "]"}]}], ";"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.4005947816961846`*^9, 3.400594863807136*^9}, {
   3.400594897807789*^9, 3.400595007403643*^9}, {3.4005953948642073`*^9, 
   3.400595442677625*^9}, 3.4005954763657722`*^9, {3.4005955673831444`*^9, 
   3.400595582836566*^9}, {3.4005956435721073`*^9, 3.400595658509894*^9}, {
   3.4005957214486027`*^9, 3.4005957278237247`*^9}, {3.4008502057614956`*^9, 
   3.4008502251837435`*^9}, {3.4008504042653065`*^9, 3.40085041379674*^9}, {
   3.401116215754563*^9, 3.401116288959093*^9}, {3.4011163336005754`*^9, 
   3.4011163733044624`*^9}, {3.4023111484700255`*^9, 3.4023111491106625`*^9}}],\


Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SuperscriptBox[\\(\[Nu]1\\), \\(2\\)]\\)/2-\[Chi]1 \
\[CapitalSigma]inf1 doit etre negatif 1 : \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "0.0024999999999999953`"}]}],
  SequenceForm[
  "\!\(\*SuperscriptBox[\(\[Nu]1\), \(2\)]\)/2-\[Chi]1 \[CapitalSigma]inf1 \
doit etre negatif 1 : ", -0.0024999999999999953`],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.4008502254962497`*^9, 3.400852860921849*^9, 3.4008535967484765`*^9, 
   3.4009067759691114`*^9, {3.401116223535962*^9, 3.401116248895824*^9}, 
   3.4011162913653893`*^9, {3.4011163430851326`*^9, 3.401116374116978*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SuperscriptBox[\\(\[Nu]2\\), \\(2\\)]\\)/2-\[Chi]2 \
\[CapitalSigma]inf2 doit etre negatif 2 : \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "0.0024999999999999953`"}]}],
  SequenceForm[
  "\!\(\*SuperscriptBox[\(\[Nu]2\), \(2\)]\)/2-\[Chi]2 \[CapitalSigma]inf2 \
doit etre negatif 2 : ", -0.0024999999999999953`],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.4008502254962497`*^9, 3.400852860921849*^9, 3.4008535967484765`*^9, 
   3.4009067759691114`*^9, {3.401116223535962*^9, 3.401116248895824*^9}, 
   3.4011162913653893`*^9, {3.4011163430851326`*^9, 3.401116374116978*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"eigenvalues[M]=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.10625`"}], ",", 
     RowBox[{"-", "0.043750000000000004`"}]}], "}"}]}],
  SequenceForm["eigenvalues[M]=", {-0.10625, -0.043750000000000004`}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.4008502254962497`*^9, 3.400852860921849*^9, 3.4008535967484765`*^9, 
   3.4009067759691114`*^9, {3.401116223535962*^9, 3.401116248895824*^9}, 
   3.4011162913653893`*^9, {3.4011163430851326`*^9, 3.401116374116978*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Laplace transform of the propagator of the process", "Subtitle",
 CellChangeTimes->{{3.4028291080268335`*^9, 3.4028291329023113`*^9}, {
  3.4028322187896843`*^9, 3.402832220242837*^9}}],

Cell["by Feynman Kac the differential operator is: ", "Text",
 CellChangeTimes->{{3.399029553555238*^9, 3.3990295585553975`*^9}, {
  3.402829225341586*^9, 3.4028292258259706`*^9}, {3.404823447629607*^9, 
  3.4048234613957605`*^9}}],

Cell[BoxData[
 RowBox[{"L", "=", 
  RowBox[{
   RowBox[{"Tr", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[CapitalOmega]", " ", 
         SuperscriptBox["\[CapitalOmega]", "*"]}], "+", 
        RowBox[{"M", " ", "\[CapitalSigma]"}], " ", "+", 
        RowBox[{"\[CapitalSigma]", " ", "M"}]}], ")"}], "D"}], " ", "+", 
     FractionBox[
      RowBox[{"\[CapitalSigma]", " ", "D", " ", 
       SuperscriptBox["Q", "*"], " ", "Q", " ", "D"}], "2"]}], "]"}], "+", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{
     SubscriptBox["\[Del]", "Y"], "\[CapitalSigma]"}], "  ", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["\[Del]", "Y"], "*"], 
     RowBox[{"+", 
      RowBox[{"Tr", "[", 
       RowBox[{"D", " ", 
        SuperscriptBox["Q", "*"], "\[Rho]", " ", 
        RowBox[{
         SubscriptBox["\[Del]", "Y"], " ", "\[CapitalSigma]"}]}], "]"}]}]}]}],
    "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"\[Mu]", "-", 
      FractionBox["1", "2"]}], ")"}], 
    RowBox[{"Vec", "[", 
     SubscriptBox["\[CapitalSigma]", "ii"], "]"}], 
    SubscriptBox["\[Del]", "Y"]}]}]}]], "Text",
 CellChangeTimes->{{3.399029579290436*^9, 3.3990297199980636`*^9}, {
   3.3990297906409492`*^9, 3.399029921082623*^9}, 3.3990299539743004`*^9, {
   3.399030017226324*^9, 3.399030045180344*^9}, {3.399030601916909*^9, 
   3.399030661293809*^9}, {3.4042084462665825`*^9, 3.404208453141714*^9}, {
   3.4048262044854665`*^9, 3.40482621434522*^9}}],

Cell["the  security price  verifies :", "Text",
 CellChangeTimes->{{3.399030918567666*^9, 3.399030929021126*^9}, {
  3.4028292020598893`*^9, 3.4028292112475653`*^9}}],

Cell[BoxData[
 StyleBox[
  TagBox[
   StyleBox[
    RowBox[{"{", 
     StyleBox[GridBox[{
        {
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"\[PartialD]", " ", "P"}], 
            RowBox[{
             RowBox[{"\[PartialD]", "t"}], " "}]]}], "=", 
          RowBox[{"L", " ", "p"}]}]},
        {
         RowBox[{
          RowBox[{"p", "[", "0", "]"}], "=", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SubscriptBox["S", "1"], 
              SuperscriptBox["\[ExponentialE]", 
               SubscriptBox["Y", "1"]]}], "-", 
             RowBox[{
              SubscriptBox["S", "2"], 
              SuperscriptBox["\[ExponentialE]", 
               SubscriptBox["Y", "2"]]}], "-", "K"}], ")"}], "+"]}]}
       }],
      ShowAutoStyles->True]}],
    ShowAutoStyles->False],
   #& ],
  FontSize->16]], "Text",
 CellChangeTimes->{{3.399030950896826*^9, 3.39903102678988*^9}, {
  3.399031110589436*^9, 3.399031120730386*^9}, {3.399032177717333*^9, 
  3.3990321824831104`*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"then", " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"E", "[", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["S", "1"], 
         SuperscriptBox["\[ExponentialE]", 
          SubscriptBox["Y", 
           RowBox[{"1", ",", "T"}]]]}], "-", 
        RowBox[{
         SubscriptBox["S", "2"], 
         SuperscriptBox["\[ExponentialE]", 
          SubscriptBox["Y", 
           RowBox[{"2", ",", "T"}]]]}], "-", "K"}], ")"}], "+"], "]"}], "=", 
    RowBox[{
     FractionBox[
      RowBox[{
       SubscriptBox["S", "1"], 
       SubscriptBox["S", "2"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"2", "\[Pi]"}], ")"}], "2"]], 
     RowBox[{
      SubsuperscriptBox["\[Integral]", 
       RowBox[{
        RowBox[{"\[ImaginaryI]", " ", "\[Gamma]"}], "-", "\[Infinity]"}], 
       RowBox[{
        RowBox[{"\[ImaginaryI]", " ", "\[Gamma]"}], "+", "\[Infinity]"}]], 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "2"}], "\[ImaginaryI]", " ", 
         RowBox[{"(", " ", 
          RowBox[{
           RowBox[{
            SubscriptBox["Y", "1"], " ", 
            SubscriptBox["\[Gamma]", "1"]}], "+", 
           RowBox[{
            SubscriptBox["Y", "2"], " ", 
            SubscriptBox["\[Gamma]", "2"]}]}], ")"}]}]], 
       RowBox[{"q", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", 
          SubscriptBox["\[Gamma]", "1"]}], ",", 
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", 
          SubscriptBox["\[Gamma]", "2"]}]}], "]"}], 
       RowBox[{"\[DifferentialD]", 
        SubscriptBox["\[Gamma]", "1"]}], 
       RowBox[{"\[DifferentialD]", 
        SubscriptBox["\[Gamma]", "2"]}]}]}]}]}]}]}]], "Text",
 CellChangeTimes->{{3.3990310399778013`*^9, 3.399031087776206*^9}, {
  3.399031126746203*^9, 3.3990311343870726`*^9}, {3.3990321849519396`*^9, 
  3.3990322795174656`*^9}, {3.39903233262854*^9, 3.3990324145999126`*^9}, {
  3.399032502368346*^9, 3.399032508196658*^9}, {3.402829214528878*^9, 
  3.4028292151070147`*^9}, {3.402831497947719*^9, 3.4028315107135897`*^9}, {
  3.402831561589566*^9, 3.402831583464986*^9}, {3.4028320564740677`*^9, 
  3.4028320749119215`*^9}, {3.402832264774942*^9, 3.4028322665874767`*^9}}],

Cell["we assume for non explosion purposes (see Bru 1987)", "Text",
 CellChangeTimes->{{3.4028292569046917`*^9, 3.402829281358287*^9}}],

Cell[BoxData[
 RowBox[{"  ", 
  RowBox[{
   RowBox[{"Q", " ", 
    SuperscriptBox["Q", "*"]}], "=", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "2"}], " ", "M", " ", "\[CapitalSigma]inf"}], 
    SuperscriptBox["\[Beta]", "2"]]}]}]], "Text",
 CellChangeTimes->{{3.39902697294141*^9, 3.399026996770298*^9}, {
  3.399027048146942*^9, 3.399027136962284*^9}, {3.3993560647889795`*^9, 
  3.3993560707578444`*^9}, {3.404209723962989*^9, 3.4042097243223705`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"we", " ", 
   RowBox[{"have", ":", 
    RowBox[{"\[CapitalOmega]", " ", 
     SuperscriptBox["\[CapitalOmega]", "*"]}]}]}], "=", " ", 
  RowBox[{
   RowBox[{"M", " ", "\[CapitalSigma]inf"}], "+", 
   RowBox[{"\[CapitalSigma]inf", " ", "M", " "}]}]}]], "Text",
 CellChangeTimes->{{3.404208245356475*^9, 3.4042082819353027`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"we", " ", "may", " ", "assume", " ", "\[CapitalOmega]", " ", 
   SuperscriptBox["\[CapitalOmega]", "*"]}], " ", "=", 
  RowBox[{
   RowBox[{"-", 
    SuperscriptBox["\[Beta]", "2"]}], "  ", "Q", " ", 
   SuperscriptBox["Q", "*"]}]}]], "Text",
 CellChangeTimes->{{3.4042083156859503`*^9, 3.4042083542960668`*^9}, 
   3.404208387984214*^9, {3.404209706681407*^9, 3.404209706947037*^9}}],

Cell[TextData[{
 "The laplace transform of the  probability transition is affine with \
coefficients A and c  ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"q", "[", 
     RowBox[{
      SubscriptBox["\[Gamma]", "1"], ",", 
      SubscriptBox["\[Gamma]", "2"]}], "]"}], "==", 
    RowBox[{"E", "[", 
     RowBox[{"exp", "[", 
      RowBox[{
       RowBox[{"<", "\[Gamma]"}], ",", 
       RowBox[{"Y", ">"}]}], "]"}], "]"}], "==", 
    RowBox[{"exp", "[", 
     RowBox[{
      RowBox[{"Tr", "[", 
       RowBox[{"A", ".", "\[CapitalSigma]"}], "]"}], "+", 
      RowBox[{
       SuperscriptBox["\[Gamma]", "T"], ".", "Y"}]}]}]}], TraditionalForm]]],
 "+c]"
}], "Text",
 CellChangeTimes->{{3.402829329343583*^9, 3.4028293672505608`*^9}, {
  3.4028294482364902`*^9, 3.402829474283866*^9}, {3.40282967895967*^9, 
  3.402829681365967*^9}, {3.4028297781490746`*^9, 3.402829869885211*^9}, {
  3.402829911557886*^9, 3.4028299121828985`*^9}, {3.4028316036372485`*^9, 
  3.402831606465428*^9}, {3.4028320837245913`*^9, 3.402832085318372*^9}}],

Cell["we can show (see Fonseca 2007)", "Text",
 CellChangeTimes->{{3.4028293808914475`*^9, 3.402829401360591*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{
   StyleBox["{",
    ShowAutoStyles->False], 
   StyleBox[GridBox[{
      {
       RowBox[{
        FractionBox[
         RowBox[{"\[PartialD]", 
          RowBox[{"c", "[", "\[Tau]", "]"}], " "}], 
         RowBox[{
          RowBox[{"\[PartialD]", "\[Tau]"}], " "}]], "=", 
        RowBox[{"M", " ", "\[Theta]", " ", 
         RowBox[{"A", "[", "\[Tau]", "]"}]}]}]},
      {
       RowBox[{
        FractionBox[
         RowBox[{"\[PartialD]", 
          RowBox[{"A", "[", "\[Tau]", "]"}], " "}], 
         RowBox[{
          RowBox[{"\[PartialD]", "\[Tau]"}], " "}]], "=", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{" ", 
            RowBox[{"Q", " ", 
             SuperscriptBox["Q", "*"], " "}]}], "2"], 
          SuperscriptBox[
           RowBox[{"A", "[", "\[Tau]", "]"}], "2"]}], " ", "+", 
         RowBox[{
          RowBox[{"A", "[", "\[Tau]", "]"}], " ", "M"}], "+", 
         RowBox[{
          SuperscriptBox["M", "*"], " ", 
          RowBox[{"A", "[", "\[Tau]", "]"}]}], "+", "  ", 
         RowBox[{"\[Gamma]", " ", 
          SuperscriptBox["\[Rho]", "*"], " ", "Q", " ", 
          RowBox[{"A", "[", "\[Tau]", "]"}]}], "+", "  ", 
         RowBox[{
          RowBox[{"A", "[", "\[Tau]", "]"}], 
          SuperscriptBox["Q", "*"], " ", "\[Rho]", " ", 
          SuperscriptBox["\[Gamma]", "*"]}], " ", "+", 
         FractionBox[
          RowBox[{" ", 
           RowBox[{"\[Gamma]", " ", 
            SuperscriptBox["\[Gamma]", "*"]}]}], "2"]}]}]}
     }],
    ShowAutoStyles->True,
    FontSize->18]}],
  #& ]], "Text",
 CellChangeTimes->{{3.399010699878111*^9, 3.399010713503373*^9}, {
   3.3990123648489666`*^9, 3.39901242105389*^9}, {3.3993561872600813`*^9, 
   3.399356215244993*^9}, 3.3993562478549943`*^9, {3.399356286371359*^9, 
   3.399356392482771*^9}}],

Cell["\<\
that we can solve by linearizing the flow when we double the space dimension.\
\
\>", "Text",
 CellChangeTimes->{{3.4028305920084505`*^9, 3.4028306261184807`*^9}}],

Cell[CellGroupData[{

Cell["Solution of a Riccati", "Section",
 CellChangeTimes->{{3.4028299411678295`*^9, 3.402829965058913*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"We", " ", "want", " ", "to", " ", 
   RowBox[{"solve", ":", "         ", "dA"}]}], "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"A", " ", "a2", " ", "A"}], "+", 
     RowBox[{"a1", " ", "A"}], " ", "+", 
     RowBox[{"A", " ", "a1s"}], " ", "+", " ", "a0"}], ")"}], "dt", 
   "     "}]}]], "Text",
 CellChangeTimes->{{3.3993568802108855`*^9, 3.399356945977773*^9}, {
  3.3993623438626604`*^9, 3.399362352222196*^9}, {3.3996324373106585`*^9, 
  3.3996324718430133`*^9}, {3.399633375707842*^9, 3.3996333791141577`*^9}, {
  3.4028301342340364`*^9, 3.4028301457186317`*^9}}],

Cell[BoxData[
 RowBox[{"where", " "}]], "Input",
 CellChangeTimes->{{3.4042086457079115`*^9, 3.4042086466454296`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"let", "  ", 
   RowBox[{"A", "[", "\[Tau]", "]"}]}], " ", "=", " ", 
  RowBox[{
   RowBox[{
    SuperscriptBox["F", 
     RowBox[{"-", "1"}]], "G", "   ", "soit", " ", "G"}], "=", 
   RowBox[{"F", " ", "A"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Then", "  ", 
   RowBox[{"d", "[", 
    RowBox[{"F", " ", "A"}], "]"}]}], "=", 
  RowBox[{
   RowBox[{
    RowBox[{"dF", " ", "A"}], " ", "+", 
    RowBox[{"F", " ", "dA"}]}], "=", "dG"}]}]}], "Text",
 CellChangeTimes->{{3.3993566965979853`*^9, 3.3993567928185825`*^9}, {
  3.3993568231941657`*^9, 3.399356825975469*^9}, {3.399364369620304*^9, 
  3.3993643894800606`*^9}, {3.3993653051695166`*^9, 3.3993653264199247`*^9}, {
  3.3993653952181206`*^9, 3.399365397030655*^9}, {3.399365470078933*^9, 
  3.3993654727196083`*^9}, {3.3996324784682255`*^9, 3.399632480796425*^9}, {
  3.3996328469941444`*^9, 3.399632859791347*^9}, {3.402830150109341*^9, 
  3.4028301566407166`*^9}}],

Cell["dA = (A a2 A + a1 A + A a1s + a0) dt", "Text",
 CellChangeTimes->{{3.3993568802108855`*^9, 3.399356945977773*^9}, {
   3.3993623438626604`*^9, 3.399362352222196*^9}, {3.3996333623950863`*^9, 
   3.399633368363951*^9}, 3.4028301621876984`*^9}],

Cell["\<\
 dG = F  dA + dF A = (F A a2 A + F a1 A + F A a1s + F a0) dt + dF  A\
\>", "Text",
 CellChangeTimes->{{3.3993568594761124`*^9, 3.399356871523219*^9}, {
   3.399356976665862*^9, 3.39935702863561*^9}, {3.3993571239343147`*^9, 
   3.399357152325485*^9}, {3.3993623605192304`*^9, 3.3993623853790827`*^9}, {
   3.3993643960895624`*^9, 3.399364419980646*^9}, {3.399365358529916*^9, 
   3.3993653653112965`*^9}, {3.399365433500106*^9, 3.3993655068140135`*^9}, {
   3.399632546423525*^9, 3.3996325808308754`*^9}, {3.3996326328949137`*^9, 
   3.3996326485984406`*^9}, {3.3996361954182296`*^9, 3.3996362197780724`*^9}, 
   3.4028301653127584`*^9}],

Cell["dG = (G a2 A + F a1 A + G a1s + F a0) dt + dF  A", "Text",
 CellChangeTimes->{
  3.399633130953143*^9, {3.399633387504944*^9, 3.3996333984895296`*^9}, {
   3.3996361875118275`*^9, 3.399636191308776*^9}}],

Cell["We split:", "Text",
 CellChangeTimes->{{3.399357591052658*^9, 3.3993575962715087`*^9}, {
   3.399357765931016*^9, 3.3993578115256414`*^9}, {3.399363287818284*^9, 
   3.3993632889276805`*^9}, {3.3993644464030285`*^9, 3.399364466059656*^9}, {
   3.399365604800269*^9, 3.3993656209099536`*^9}, 3.3996334725534515`*^9, {
   3.4028301705472336`*^9, 3.402830173312912*^9}}],

Cell["\<\
( G a1s + F a0) dt = dG
(G a2 + F a1  ) dt + dF  = 0\
\>", "Text",
 CellChangeTimes->{{3.399633146109684*^9, 3.3996332101577888`*^9}, {
  3.39963342402127*^9, 3.399633428286977*^9}}],

Cell["then dF = ( -  F a1 - G a2) dt  et dG = ( G a1s  +  F a0) dt", "Text",
 CellChangeTimes->{{3.3993578589484267`*^9, 3.3993578963553953`*^9}, {
  3.3993633344910555`*^9, 3.39936334488188*^9}, {3.3993644911382627`*^9, 
  3.399364510185503*^9}, {3.399633500163357*^9, 3.3996335212575116`*^9}, {
  3.399633554539401*^9, 3.399633569539689*^9}, {3.3996362585600667`*^9, 
  3.399636261091366*^9}, {3.4028301772036114`*^9, 3.402830177734872*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"therefore", "   ", "d", 
   RowBox[{"(", 
    RowBox[{"F", ",", "G"}], ")"}]}], " ", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"F", ",", "G"}], ")"}], " ", ".", " ", 
    RowBox[{"(", GridBox[{
       {
        RowBox[{"-", "a1"}], "a0"},
       {
        RowBox[{"-", "a2"}], "a1s"}
      }], ")"}]}], "dt"}]}]], "Text",
 CellChangeTimes->{{3.3993579048243074`*^9, 3.39935800704502*^9}, {
   3.3993633899139943`*^9, 3.399363401461091*^9}, {3.3993645252951684`*^9, 
   3.3993645436236453`*^9}, {3.3996335857274995`*^9, 
   3.3996335920869966`*^9}, {3.399633792106462*^9, 3.399633812669357*^9}, {
   3.399636309326667*^9, 3.3996363216706533`*^9}, 3.399636353718144*^9, {
   3.4028301804849243`*^9, 3.4028301846412544`*^9}}],

Cell["\<\
and we can use matrix exponentiation to deduce the solution of the system\
\>", "Text",
 CellChangeTimes->{{3.4028301919070187`*^9, 3.4028302134543076`*^9}}],

Cell[CellGroupData[{

Cell["Computation of   A", "Subsection",
 CellChangeTimes->{{3.3997975717744646`*^9, 3.3997975755714126`*^9}, {
  3.402830270502278*^9, 3.402830278846188*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"F", ",", "G"}], "}"}], " ", ".", " ", 
  RowBox[{"(", GridBox[{
     {
      RowBox[{"-", "a1"}], "a0"},
     {
      RowBox[{"-", "a2"}], "a1s"}
    }], ")"}]}]], "Text",
 CellChangeTimes->{{3.3996338840769777`*^9, 3.3996338977647405`*^9}, {
  3.399633984719535*^9, 3.399634029548521*^9}}],

Cell["{-a1 F - a2 G, a0 F + a1s G}", "Text",
 CellChangeTimes->{{3.3996338990147643`*^9, 3.3996339367186136`*^9}, {
  3.399634016767025*^9, 3.399634031939192*^9}}],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{"a2", "=", 
    FractionBox[
     RowBox[{" ", 
      RowBox[{"Q", " ", 
       SuperscriptBox["Q", "*"], " "}]}], "2"]}], ";", 
   RowBox[{"a1", "=", 
    RowBox[{
     SuperscriptBox["M", "*"], "+", " ", 
     RowBox[{"\[Gamma]", " ", 
      SuperscriptBox["\[Rho]", "*"], " ", "Q"}]}]}], ";", 
   RowBox[{"a1s", "=", 
    RowBox[{"M", "+", 
     RowBox[{
      SuperscriptBox["Q", "*"], " ", "\[Rho]", " ", 
      SuperscriptBox["\[Gamma]", "*"]}]}]}], ";", 
   RowBox[{"a0", "=", 
    FractionBox[
     RowBox[{" ", 
      RowBox[{"\[Gamma]", " ", 
       SuperscriptBox["\[Gamma]", "*"]}]}], "2"]}]}]}]], "Text",
 CellChangeTimes->{{3.399366274109995*^9, 3.399366350627089*^9}, {
   3.3993663905028543`*^9, 3.399366419612788*^9}, 3.4028302824868827`*^9}],

Cell["initial condition  A[0] = 0  soit F = 1 et G = 0", "Text",
 CellChangeTimes->{{3.3993646135781136`*^9, 3.399364646375618*^9}, {
  3.4028302868932176`*^9, 3.40283029144018*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"then", "   ", 
   RowBox[{"{", 
    RowBox[{"F", ",", "G"}], "}"}]}], " ", "=", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0"}], "}"}], "  ", ".", " ", 
   RowBox[{"Exp", "[", 
    RowBox[{"(", GridBox[{
       {
        RowBox[{"-", "a1"}], "a0"},
       {
        RowBox[{"-", "a2"}], "a1s"}
      }], ")"}], "]"}]}]}]], "Text",
 CellChangeTimes->{{3.3996341944423113`*^9, 3.3996342244741383`*^9}, 
   3.3996344039150834`*^9, {3.402830294315235*^9, 3.4028302951590014`*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"then", " ", 
    RowBox[{"(", GridBox[{
       {"F"},
       {"G"}
      }], ")"}]}], "=", 
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{"Exp", "[", 
      RowBox[{"(", GridBox[{
         {
          RowBox[{"-", "a1"}], "a0"},
         {
          RowBox[{"-", "a2"}], "a1s"}
        }], ")"}], "]"}], "]"}], " ", ".", " ", 
    RowBox[{"(", GridBox[{
       {"1"},
       {"0"}
      }], ")"}]}]}]}]], "Text",
 CellChangeTimes->{{3.399634231552399*^9, 3.3996342898972692`*^9}, 
   3.399634413680896*^9, {3.4028302972215405`*^9, 3.4028302980653067`*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"then", " ", 
    RowBox[{"(", GridBox[{
       {"F"},
       {"G"}
      }], ")"}]}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Exp", "[", 
      RowBox[{"Transpose", "[", 
       RowBox[{"(", GridBox[{
          {
           RowBox[{"-", "a1"}], "a0"},
          {
           RowBox[{"-", "a2"}], "a1s"}
         }], ")"}], "]"}], "]"}], " ", ".", " ", 
     RowBox[{"(", GridBox[{
        {"1"},
        {"0"}
       }], ")"}]}], "=", 
    RowBox[{
     RowBox[{"Exp", "[", 
      RowBox[{"(", GridBox[{
         {
          RowBox[{"-", "a1"}], 
          RowBox[{"-", "a2"}]},
         {"a0", "a1s"}
        }], ")"}], "]"}], " ", ".", " ", 
     RowBox[{"(", GridBox[{
        {"1"},
        {"0"}
       }], ")"}]}]}]}]}]], "Text",
 CellChangeTimes->{{3.399634231552399*^9, 3.3996343438045545`*^9}, {
   3.3996344247748585`*^9, 3.3996344710882483`*^9}, 3.3996347326713953`*^9, {
   3.4028303012684937`*^9, 3.402830302174761*^9}}],

Cell["{{a11, a12}, {a21, a22}} . {1, 0}", "Text",
 CellChangeTimes->{{3.3993649900228405`*^9, 3.3993650204765506`*^9}}],

Cell["{a11, a21}", "Text",
 CellChangeTimes->{3.399365022648467*^9}],

Cell[BoxData[
 RowBox[{"A", "=", 
  RowBox[{
   SuperscriptBox["a11", 
    RowBox[{"-", "1"}]], "a21"}]}]], "Text",
 CellChangeTimes->{{3.3993650395081663`*^9, 3.3993650505865035`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Computation of  c ", "Subsection",
 CellChangeTimes->{{3.399384559300178*^9, 3.399384569456623*^9}, {
  3.3996372626262197`*^9, 3.399637274985832*^9}, {3.4028303095967784`*^9, 
  3.4028303175656815`*^9}}],

Cell[BoxData[
 RowBox[{"dc", " ", "=", 
  RowBox[{
   RowBox[{"Tr", "[", 
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["\[Beta]", "2"]}], " ", 
     SuperscriptBox["QQ", "*"], "A"}], "]"}], "dt"}]}]], "Text",
 CellChangeTimes->{{3.399637317924156*^9, 3.399637343330894*^9}, {
  3.3996401204467134`*^9, 3.399640124071783*^9}}],

Cell["but", "Text",
 CellChangeTimes->{{3.3996374184885874`*^9, 3.399637422598041*^9}, {
  3.40283032139388*^9, 3.402830323440794*^9}}],

Cell[BoxData[
 RowBox[{"dG", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", " ", 
     RowBox[{
      RowBox[{"G", " ", "a1s"}], "  ", "+", "  ", 
      RowBox[{"F", " ", "a0"}]}], ")"}], " ", "dt"}], "=", 
   RowBox[{
    RowBox[{"(", " ", 
     RowBox[{
      RowBox[{"F", 
       FractionBox[
        RowBox[{"\[Gamma]", " ", "\[Gamma]"}], "2"]}], " ", "+", " ", 
      RowBox[{"G", " ", 
       RowBox[{"(", 
        FractionBox[
         RowBox[{"M", "+", 
          RowBox[{
           SuperscriptBox["Q", "*"], " ", "\[Rho]", " ", 
           SuperscriptBox["\[Gamma]", "*"]}]}], "2"], ")"}]}]}], " ", ")"}], 
    "dt"}]}]}]], "Text",
 CellChangeTimes->{{3.399637427707514*^9, 3.399637463067568*^9}, {
  3.3996378807318373`*^9, 3.399637880872465*^9}, {3.3996379985622244`*^9, 
  3.399637999952876*^9}, {3.399638042203687*^9, 3.3996380517976217`*^9}, {
  3.3996416076471424`*^9, 3.3996416082721543`*^9}}],

Cell[BoxData[
 RowBox[{"dF", " ", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "  ", "F"}], " ", "a1"}], " ", "-", " ", 
      RowBox[{"G", " ", "a2"}]}], ")"}], " ", "dt"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "F"}], " ", 
     RowBox[{"(", 
      FractionBox[
       RowBox[{
        SuperscriptBox["M", "*"], "+", 
        RowBox[{"\[Gamma]", " ", "R", " ", "Q"}]}], "2"], ")"}]}], "-", 
    RowBox[{"G", " ", 
     FractionBox[
      RowBox[{
       SuperscriptBox["Q", "*"], "Q"}], "2"]}]}]}]}]], "Text",
 CellChangeTimes->{{3.3996376927907286`*^9, 3.399637801714695*^9}, {
  3.399637873466072*^9, 3.3996378736692014`*^9}, {3.3996379446393137`*^9, 
  3.399637966733488*^9}, {3.399641614084766*^9, 3.3996416147722793`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"where", "  ", "a2"}], "=", 
   FractionBox[
    RowBox[{" ", 
     RowBox[{"Q", " ", 
      SuperscriptBox["Q", "*"], " "}]}], "2"]}], ";", 
  RowBox[{"a1", "=", 
   RowBox[{
    SuperscriptBox["M", "*"], "+", " ", 
    RowBox[{"\[Gamma]", " ", 
     SuperscriptBox["\[Rho]", "*"], " ", "Q"}]}]}], ";", 
  RowBox[{"a1s", "=", 
   RowBox[{"M", "+", 
    RowBox[{
     SuperscriptBox["Q", "*"], " ", "\[Rho]", " ", 
     SuperscriptBox["\[Gamma]", "*"]}]}]}], ";", 
  RowBox[{"a0", "=", 
   FractionBox[
    RowBox[{" ", 
     RowBox[{"\[Gamma]", " ", 
      SuperscriptBox["\[Gamma]", "*"]}]}], "2"]}]}]], "Text",
 CellChangeTimes->{{3.3996378901538925`*^9, 3.399637918591939*^9}, {
  3.4028303295815372`*^9, 3.402830331050315*^9}}],

Cell["we get: ", "Text",
 CellChangeTimes->{{3.399638086032654*^9, 3.3996380887983317`*^9}, {
  3.402830335628528*^9, 3.4028303366597977`*^9}}],

Cell[BoxData[
 RowBox[{"G", "=", 
  RowBox[{
   RowBox[{"-", "2"}], 
   RowBox[{"(", 
    RowBox[{
     FractionBox["dF", "dt"], "+", 
     RowBox[{"F", " ", 
      RowBox[{"(", 
       FractionBox[
        RowBox[{
         SuperscriptBox["M", "*"], "+", 
         RowBox[{"\[Gamma]", " ", "R", " ", "Q"}]}], "2"], ")"}]}]}], ")"}], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["Q", "*"], "Q"}], ")"}], 
    RowBox[{"-", "1"}]]}]}]], "Text",
 CellChangeTimes->{{3.3996380932202916`*^9, 3.399638196409773*^9}, {
  3.399641621881791*^9, 3.399641622475552*^9}}],

Cell["we multiplies by F", "Text",
 CellChangeTimes->{{3.3996382377699423`*^9, 3.399638244738826*^9}, {
  3.402830342784916*^9, 3.4028303473787537`*^9}}],

Cell[BoxData[
 RowBox[{"A", "=", 
  RowBox[{
   RowBox[{
    SuperscriptBox["F", 
     RowBox[{"-", "1"}]], "G"}], "=", 
   RowBox[{
    RowBox[{"-", "2"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["F", 
        RowBox[{"-", "1"}]], 
       FractionBox["dF", "dt"]}], "+", " ", 
      RowBox[{"(", 
       FractionBox[
        RowBox[{
         SuperscriptBox["M", "*"], "+", 
         RowBox[{"\[Gamma]", " ", "R", " ", "Q"}]}], "2"], ")"}]}], ")"}], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["Q", "*"], "Q"}], ")"}], 
     RowBox[{"-", "1"}]]}]}]}]], "Text",
 CellChangeTimes->{{3.3996380932202916`*^9, 3.399638196409773*^9}, {
  3.399638263770441*^9, 3.3996382877240257`*^9}, {3.3996416294288106`*^9, 
  3.3996416301006985`*^9}}],

Cell["then ", "Text",
 CellChangeTimes->{{3.399638291489723*^9, 3.399638292567869*^9}, {
  3.402830350410062*^9, 3.4028303512694535`*^9}}],

Cell[BoxData[
 RowBox[{"dc", " ", "=", 
  RowBox[{
   RowBox[{"-", "2"}], 
   SuperscriptBox["\[Beta]", "2"], " ", 
   RowBox[{"Tr", "[", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["F", 
        RowBox[{"-", "1"}]], 
       FractionBox["dF", "d\[Tau]"]}], "+", " ", 
      RowBox[{"(", 
       FractionBox[
        RowBox[{
         SuperscriptBox["M", "*"], "+", 
         RowBox[{"\[Gamma]", " ", "R", " ", "Q"}]}], "2"], ")"}]}], ")"}], 
    "]"}], "d\[Tau]"}]}]], "Text",
 CellChangeTimes->{{3.399638317521473*^9, 3.399638336896845*^9}, {
  3.399638423711012*^9, 3.399638429351745*^9}, {3.399640150322287*^9, 
  3.3996401506504183`*^9}, {3.3996416376164675`*^9, 3.3996416382258544`*^9}}],\


Cell["Using trace properties", "Text",
 CellChangeTimes->{{3.3996383510221167`*^9, 3.3996383610223083`*^9}, {
  3.402830357691452*^9, 3.402830363019679*^9}}],

Cell[BoxData[
 RowBox[{"c", "=", 
  RowBox[{
   RowBox[{"-", "2"}], 
   SuperscriptBox["\[Beta]", "2"], " ", 
   RowBox[{"Tr", "[", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Log", "[", "F", "]"}], "+", " ", 
      RowBox[{
       RowBox[{"(", 
        FractionBox[
         RowBox[{
          SuperscriptBox["M", "*"], "+", 
          RowBox[{"\[Gamma]", " ", "R", " ", "Q"}]}], "2"], ")"}], 
       "\[Tau]"}]}], ")"}], "]"}]}]}]], "Text",
 CellChangeTimes->{{3.399638375460086*^9, 3.3996384156483574`*^9}, {
  3.399640156088023*^9, 3.399640156494281*^9}, {3.3996416494291945`*^9, 
  3.399641650069832*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["More general Computation of  c ", "Subsection",
 CellChangeTimes->{{3.399384559300178*^9, 3.399384569456623*^9}, {
  3.3996372626262197`*^9, 3.399637274985832*^9}, {3.4028303095967784`*^9, 
  3.4028303175656815`*^9}, {3.4042120904771748`*^9, 3.4042120929615974`*^9}}],\


Cell[BoxData[
 RowBox[{"dc", " ", "=", 
  RowBox[{
   RowBox[{"Tr", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"M", " ", "\[CapitalSigma]inf"}], "+", 
       RowBox[{"\[CapitalSigma]inf", " ", "M"}]}], " ", ")"}], "A"}], "]"}], 
   "dt"}]}]], "Text",
 CellChangeTimes->{{3.399637317924156*^9, 3.399637343330894*^9}, {
  3.3996401204467134`*^9, 3.399640124071783*^9}, {3.4042107115757008`*^9, 
  3.4042107281385183`*^9}, {3.4042121807289076`*^9, 3.4042121826820707`*^9}}],\


Cell[BoxData[
 RowBox[{"A", "=", 
  RowBox[{
   RowBox[{
    SuperscriptBox["F", 
     RowBox[{"-", "1"}]], "G"}], "=", 
   RowBox[{
    RowBox[{"-", "2"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["F", 
        RowBox[{"-", "1"}]], 
       FractionBox["dF", "dt"]}], "+", " ", 
      RowBox[{"(", 
       FractionBox[
        RowBox[{
         SuperscriptBox["M", "*"], "+", 
         RowBox[{"\[Gamma]", " ", "R", " ", "Q"}]}], "2"], ")"}]}], ")"}], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["Q", "*"], "Q"}], ")"}], 
     RowBox[{"-", "1"}]]}]}]}]], "Text",
 CellChangeTimes->{{3.3996380932202916`*^9, 3.399638196409773*^9}, {
  3.399638263770441*^9, 3.3996382877240257`*^9}, {3.3996416294288106`*^9, 
  3.3996416301006985`*^9}}],

Cell[BoxData[
 RowBox[{"dc", " ", "=", " ", 
  RowBox[{"2", 
   RowBox[{"Tr", "[", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["F", 
         RowBox[{"-", "1"}]], 
        FractionBox["dF", "d\[Tau]"]}], "+", " ", 
       RowBox[{"(", 
        FractionBox[
         RowBox[{
          SuperscriptBox["M", "*"], "+", 
          RowBox[{"\[Gamma]", " ", "R", " ", "Q"}]}], "2"], ")"}]}], " ", 
      ")"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"M", " ", "\[CapitalSigma]inf"}], "+", 
       RowBox[{"\[CapitalSigma]inf", " ", "M"}]}], " ", ")"}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["Q", "*"], "Q"}], ")"}], 
      RowBox[{"-", "1"}]]}], "]"}], "d\[Tau]"}]}]], "Text",
 CellChangeTimes->{{3.399638317521473*^9, 3.399638336896845*^9}, {
   3.399638423711012*^9, 3.399638429351745*^9}, {3.399640150322287*^9, 
   3.3996401506504183`*^9}, {3.3996416376164675`*^9, 
   3.3996416382258544`*^9}, {3.404210820609044*^9, 3.404210854656573*^9}, {
   3.404212187775918*^9, 3.4042121893696985`*^9}, 3.404212227401679*^9}],

Cell["that we can integrate ", "Text",
 CellChangeTimes->{{3.4042117668459616`*^9, 3.4042117755648785`*^9}}],

Cell[BoxData[
 RowBox[{"c", "=", 
  RowBox[{"2", " ", 
   RowBox[{"Tr", "[", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Log", "[", "F", "]"}], "+", " ", 
       RowBox[{
        RowBox[{"(", 
         FractionBox[
          RowBox[{
           SuperscriptBox["M", "*"], "+", 
           RowBox[{"\[Gamma]", " ", "R", " ", "Q"}]}], "2"], ")"}], 
        "\[Tau]"}]}], ")"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"M", " ", "\[CapitalSigma]inf"}], "+", 
       RowBox[{"\[CapitalSigma]inf", " ", "M"}]}], " ", ")"}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["Q", "*"], "Q"}], ")"}], 
      RowBox[{"-", "1"}]]}], "]"}]}]}]], "Text",
 CellChangeTimes->{{3.404211884848227*^9, 3.404211914317543*^9}, {
  3.4042121955885677`*^9, 3.4042121971510983`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Determination of the quick Laplace transform", "Section",
 CellChangeTimes->{{3.404828742396487*^9, 3.4048287561761494`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"M", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"M11", ",", "M12"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"M21", ",", "M22"}], "}"}]}], "}"}]}], ";", 
  RowBox[{"Q", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Q11", ",", "Q12"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Q21", ",", "Q22"}], "}"}]}], "}"}]}], ";", 
  RowBox[{"\[Rho]", "=", 
   RowBox[{"{", 
    RowBox[{"\[Rho]1", ",", "\[Rho]2"}], "}"}]}], ";", 
  RowBox[{"\[Mu]", "=", 
   RowBox[{"{", 
    RowBox[{"\[Mu]1", ",", "\[Mu]2"}], "}"}]}], ";", 
  RowBox[{"\[CapitalSigma]", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[CapitalSigma]11", ",", "\[CapitalSigma]12"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[CapitalSigma]21", ",", "\[CapitalSigma]22"}], "}"}]}], 
    "}"}]}], ";", 
  RowBox[{"\[Gamma]", "=", 
   RowBox[{"{", 
    RowBox[{"\[Gamma]1", ",", "\[Gamma]2"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4048277510604773`*^9, 3.4048278526893797`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Placement1", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
  RowBox[{"Placement2", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
  RowBox[{"M\[Mu]", "=", 
   RowBox[{"DiagonalMatrix", "[", "\[Mu]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"H", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Transpose", "[", "Placement1", "]"}], " ", ".", 
    RowBox[{"(", 
     FractionBox[
      RowBox[{"-", 
       RowBox[{"(", " ", 
        RowBox[{"M", "+", 
         RowBox[{
          RowBox[{"Transpose", "[", "Q", "]"}], ".", 
          RowBox[{"Outer", "[", 
           RowBox[{"Times", ",", "\[Rho]", ",", "\[Gamma]"}], "]"}]}]}], 
        ")"}]}], "2"], ")"}], ".", "Placement1"}], "+", "\[IndentingNewLine]",
    
   RowBox[{
    RowBox[{"Transpose", "[", "Placement1", "]"}], " ", ".", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{
        RowBox[{"Transpose", "[", "Q", "]"}], ".", " ", "Q"}]}], "/", "2"}], 
     ")"}], ".", "Placement2"}], "+", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Transpose", "[", "Placement2", "]"}], " ", ".", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"Outer", "[", 
        RowBox[{"Times", ",", "\[Gamma]", ",", "\[Gamma]"}], "]"}]}], "+", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{
        RowBox[{"M\[Mu]", ".", "\[Gamma]"}], "-", 
        FractionBox["\[Gamma]", "2"]}], "]"}]}], " ", ")"}], ".", 
    "Placement1"}], "+", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Transpose", "[", "Placement2", "]"}], " ", ".", " ", 
    RowBox[{"(", 
     RowBox[{"Transpose", "[", 
      FractionBox[
       RowBox[{"M", "+", 
        RowBox[{
         RowBox[{"Transpose", "[", "Q", "]"}], ".", 
         RowBox[{"Outer", "[", 
          RowBox[{"Times", ",", "\[Rho]", ",", "\[Gamma]"}], "]"}]}]}], "2"], 
      "]"}], ")"}], ".", "Placement2", " "}]}]}]}], "Input",
 CellChangeTimes->{{3.4048277033555207`*^9, 3.4048277200436616`*^9}, {
  3.40482787026818*^9, 3.404827902378788*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "M11"}], "-", 
        RowBox[{"Q11", " ", "\[Gamma]1", " ", "\[Rho]1"}], "-", 
        RowBox[{"Q21", " ", "\[Gamma]1", " ", "\[Rho]2"}]}], ")"}]}], ",", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "M12"}], "-", 
        RowBox[{"Q11", " ", "\[Gamma]2", " ", "\[Rho]1"}], "-", 
        RowBox[{"Q21", " ", "\[Gamma]2", " ", "\[Rho]2"}]}], ")"}]}], ",", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["Q11", "2"]}], "-", 
        SuperscriptBox["Q21", "2"]}], ")"}]}], ",", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "Q11"}], " ", "Q12"}], "-", 
        RowBox[{"Q21", " ", "Q22"}]}], ")"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "M21"}], "-", 
        RowBox[{"Q12", " ", "\[Gamma]1", " ", "\[Rho]1"}], "-", 
        RowBox[{"Q22", " ", "\[Gamma]1", " ", "\[Rho]2"}]}], ")"}]}], ",", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "M22"}], "-", 
        RowBox[{"Q12", " ", "\[Gamma]2", " ", "\[Rho]1"}], "-", 
        RowBox[{"Q22", " ", "\[Gamma]2", " ", "\[Rho]2"}]}], ")"}]}], ",", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "Q11"}], " ", "Q12"}], "-", 
        RowBox[{"Q21", " ", "Q22"}]}], ")"}]}], ",", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["Q12", "2"]}], "-", 
        SuperscriptBox["Q22", "2"]}], ")"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox["\[Gamma]1", "2"]}], "+", 
      FractionBox[
       SuperscriptBox["\[Gamma]1", "2"], "2"], "+", 
      RowBox[{"\[Gamma]1", " ", "\[Mu]1"}]}], ",", 
     FractionBox[
      RowBox[{"\[Gamma]1", " ", "\[Gamma]2"}], "2"], ",", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"M11", "+", 
        RowBox[{"Q11", " ", "\[Gamma]1", " ", "\[Rho]1"}], "+", 
        RowBox[{"Q21", " ", "\[Gamma]1", " ", "\[Rho]2"}]}], ")"}]}], ",", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"M21", "+", 
        RowBox[{"Q12", " ", "\[Gamma]1", " ", "\[Rho]1"}], "+", 
        RowBox[{"Q22", " ", "\[Gamma]1", " ", "\[Rho]2"}]}], ")"}]}]}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"\[Gamma]1", " ", "\[Gamma]2"}], "2"], ",", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["\[Gamma]2", "2"]}], "+", 
      FractionBox[
       SuperscriptBox["\[Gamma]2", "2"], "2"], "+", 
      RowBox[{"\[Gamma]2", " ", "\[Mu]2"}]}], ",", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"M12", "+", 
        RowBox[{"Q11", " ", "\[Gamma]2", " ", "\[Rho]1"}], "+", 
        RowBox[{"Q21", " ", "\[Gamma]2", " ", "\[Rho]2"}]}], ")"}]}], ",", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"M22", "+", 
        RowBox[{"Q12", " ", "\[Gamma]2", " ", "\[Rho]1"}], "+", 
        RowBox[{"Q22", " ", "\[Gamma]2", " ", "\[Rho]2"}]}], ")"}]}]}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.404827873846442*^9, 3.404827906128932*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"A11", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"EXPH11", ",", "EXPH12"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"EXPH21", ",", "EXPH22"}], "}"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.406376706429647*^9, 3.4063767457741528`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"A21", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"EXPH31", ",", "EXPH32"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"EXPH41", ",", "EXPH42"}], "}"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4063767541649384`*^9, 3.4063768017127266`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"A", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"Inverse", "[", "A11", "]"}], " ", ".", "A21"}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.406376835338372*^9, 3.406376841869747*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"EXPH22", " ", "EXPH31"}], "-", 
       RowBox[{"EXPH12", " ", "EXPH41"}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", "EXPH12"}], " ", "EXPH21"}], "+", 
       RowBox[{"EXPH11", " ", "EXPH22"}]}]], ",", 
     FractionBox[
      RowBox[{
       RowBox[{"EXPH22", " ", "EXPH32"}], "-", 
       RowBox[{"EXPH12", " ", "EXPH42"}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", "EXPH12"}], " ", "EXPH21"}], "+", 
       RowBox[{"EXPH11", " ", "EXPH22"}]}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"EXPH21", " ", "EXPH31"}], "-", 
       RowBox[{"EXPH11", " ", "EXPH41"}]}], 
      RowBox[{
       RowBox[{"EXPH12", " ", "EXPH21"}], "-", 
       RowBox[{"EXPH11", " ", "EXPH22"}]}]], ",", 
     FractionBox[
      RowBox[{
       RowBox[{"EXPH21", " ", "EXPH32"}], "-", 
       RowBox[{"EXPH11", " ", "EXPH42"}]}], 
      RowBox[{
       RowBox[{"EXPH12", " ", "EXPH21"}], "-", 
       RowBox[{"EXPH11", " ", "EXPH22"}]}]]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.4063768232443895`*^9, 3.406376842682263*^9}}]
}, Open  ]]
}, Open  ]],

Cell["Lognormal Heston Formula and 1 dim Wishart case", "Section",
 CellChangeTimes->{{3.402832902115304*^9, 3.4028329388660097`*^9}, {
  3.402833323639022*^9, 3.4028333263578243`*^9}}],

Cell[CellGroupData[{

Cell["Explicitation of the matrix method", "Subsubtitle",
 CellChangeTimes->{{3.402744679167895*^9, 3.40274468932434*^9}, {
  3.4028334006092496`*^9, 3.402833408843783*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Placement1", "=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"1", ",", "0"}], "}"}], "}"}]}], ";", 
  RowBox[{"Placement2", "=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1"}], "}"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4027292435434113`*^9, 3.4027292463559656`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"H", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", " ", 
        FractionBox[
         RowBox[{"M", "-", 
          RowBox[{
          "\[ImaginaryI]", " ", "Q", " ", "\[Rho]", " ", "\[Gamma]"}]}], "2"],
         ")"}]}], 
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{"Transpose", "[", "Placement1", "]"}], " ", ".", 
        "Placement1"}], ")"}]}], "+", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "Q"}], "  ", 
        RowBox[{"Q", "/", "2"}]}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Transpose", "[", "Placement1", "]"}], " ", ".", 
        "Placement2"}], ")"}]}], "+", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[Gamma]"}], " ", 
         RowBox[{"\[Gamma]", " ", "/", "2"}]}], "+", 
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"\[Gamma]", "/", "2"}]}]}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Transpose", "[", "Placement2", "]"}], "  ", ".", 
        "Placement1"}], ")"}]}], "+", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       FractionBox[
        RowBox[{"M", "-", 
         RowBox[{
         "\[ImaginaryI]", " ", "Q", " ", "\[Rho]", " ", "\[Gamma]"}]}], "2"], 
       ")"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Transpose", "[", "Placement2", "]"}], "  ", ".", 
        "Placement2"}], ")"}]}]}]}], " ", ";"}], " "}]], "Input",
 CellChangeTimes->{{3.402730076856286*^9, 3.4027300922315807`*^9}, 
   3.4027360989875336`*^9, {3.402740866563444*^9, 3.4027408692509956`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"E11", ",", "E12"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"E21", ",", "E22"}], "}"}]}], "}"}], "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"MatrixExp2", "[", 
     RowBox[{"\[Tau]", " ", "H"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.4027292251524334`*^9, {3.402729374405299*^9, 3.4027294675008364`*^9}, 
   3.402737404246969*^9, {3.4027381281983685`*^9, 3.402738129042135*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Zeta]exp", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "2"}], 
    RowBox[{"Simplify", "[", 
     RowBox[{"E11", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "2"}], "]"}], "]"}], "]"}]}], " ", "/.", " ", 
   RowBox[{"\[Tau]", "\[Rule]", "1"}]}]}]], "Input",
 CellChangeTimes->{{3.4027374324975114`*^9, 3.4027375377026567`*^9}, {
  3.402738154089491*^9, 3.402738194012132*^9}}],

Cell[BoxData[
 SqrtBox[
  RowBox[{
   SuperscriptBox["M", "2"], "-", 
   RowBox[{
   "2", " ", "\[ImaginaryI]", " ", "M", " ", "Q", " ", "\[Gamma]", " ", 
    "\[Rho]"}], "+", 
   RowBox[{
    SuperscriptBox["Q", "2"], " ", "\[Gamma]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "\[ImaginaryI]"}], "+", "\[Gamma]", "-", 
      RowBox[{"\[Gamma]", " ", 
       SuperscriptBox["\[Rho]", "2"]}]}], ")"}]}]}]]], "Output",
 CellChangeTimes->{{3.4027374596855335`*^9, 3.4027375390308065`*^9}, {
   3.40273813557351*^9, 3.402738195777791*^9}, 3.402740881594983*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Zeta]exp", "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["M", "2"], "-", 
  RowBox[{
  "2", " ", "\[ImaginaryI]", " ", "M", " ", "Q", " ", "\[Gamma]", " ", 
   "\[Rho]"}], "+", 
  RowBox[{
   SuperscriptBox["Q", "2"], " ", "\[Gamma]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "\[ImaginaryI]"}], "+", "\[Gamma]", "-", 
     RowBox[{"\[Gamma]", " ", 
      SuperscriptBox["\[Rho]", "2"]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.402743688930133*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"ExtractCarr\[EAcute]", "[", 
   RowBox[{"exp_", ",", "var_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", 
      RowBox[{"exp1", "=", 
       RowBox[{"Coefficient", "[", 
        RowBox[{"exp", ",", "var", ",", "1"}], "]"}]}], ",", 
      RowBox[{"exp2", "=", 
       RowBox[{"Coefficient", "[", 
        RowBox[{"exp", ",", "var", ",", "2"}], "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"a", "=", 
      RowBox[{"exp1", "/", 
       RowBox[{"(", 
        RowBox[{"2", "  ", "exp2"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"exp2", 
       SuperscriptBox[
        RowBox[{"(", " ", 
         RowBox[{"var", "+", "a"}], ")"}], "2"]}], "+", 
      RowBox[{"Simplify", "[", 
       RowBox[{
        RowBox[{"exp", "-", 
         RowBox[{"exp2", 
          SuperscriptBox[
           RowBox[{"(", " ", 
            RowBox[{"var", "+", "a"}], ")"}], "2"]}]}], ",", 
        RowBox[{
         RowBox[{"Evaluate", "[", "var", "]"}], ">", "0"}]}], "]"}]}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.402742486657049*^9, 3.4027425205795755`*^9}, {
  3.402743332798295*^9, 3.4027434258000803`*^9}, {3.4027435212706633`*^9, 
  3.4027436366635036`*^9}, {3.4027436977740526`*^9, 3.4027437302746763`*^9}, {
  3.4027438482300663`*^9, 3.4027438638553658`*^9}, {3.4027440013111305`*^9, 
  3.4027440515933456`*^9}, {3.4027441280010624`*^9, 3.402744153235922*^9}, {
  3.4027442672068605`*^9, 3.402744300957508*^9}, {3.402744333223753*^9, 
  3.4027443369738245`*^9}, {3.4027444668669434`*^9, 3.4027445101333995`*^9}}],\


Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ExtractCarr\[EAcute]", "[", 
  RowBox[{
   RowBox[{"\[Zeta]exp", "[", 
    RowBox[{"[", "1", "]"}], "]"}], ",", "M"}], "]"}]], "Input",
 CellChangeTimes->{{3.4027375661250772`*^9, 3.4027375735314693`*^9}, {
   3.4027424486563196`*^9, 3.4027424656566463`*^9}, 3.402744345161482*^9, 
   3.4027445168991547`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["Q", "2"], " ", "\[Gamma]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "\[ImaginaryI]"}], "+", "\[Gamma]"}], ")"}]}], "+", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"M", "-", 
     RowBox[{"\[ImaginaryI]", " ", "Q", " ", "\[Gamma]", " ", "\[Rho]"}]}], 
    ")"}], "2"]}]], "Output",
 CellChangeTimes->{{3.402737568656376*^9, 3.4027375739533525`*^9}, 
   3.4027382037779446`*^9, 3.4027408862044463`*^9, 3.4027424146400414`*^9, 
   3.402743649960634*^9, {3.4027437346341352`*^9, 3.402743737946699*^9}, {
   3.402743869058591*^9, 3.4027438735899277`*^9}, 3.4027440584528522`*^9, {
   3.402744136360598*^9, 3.4027441580953903`*^9}, {3.4027442845040674`*^9, 
   3.40274430573885*^9}, 3.4027443465990095`*^9, {3.4027444703513856`*^9, 
   3.4027445183991833`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   SuperscriptBox["M", "2"], "-", 
   RowBox[{
   "2", " ", "\[ImaginaryI]", " ", "M", " ", "Q", " ", "\[Gamma]", " ", 
    "\[Rho]"}], "-", 
   RowBox[{
    SuperscriptBox["Q", "2"], " ", 
    SuperscriptBox["\[Gamma]", "2"], " ", 
    RowBox[{"(", 
     SuperscriptBox["\[Rho]", "2"], ")"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.4027303279861073`*^9, 3.402730344845806*^9}}],

Cell[BoxData[
 SuperscriptBox[
  RowBox[{"(", 
   RowBox[{"M", "-", 
    RowBox[{"\[ImaginaryI]", " ", "Q", " ", "\[Gamma]", " ", "\[Rho]"}]}], 
   ")"}], "2"]], "Output",
 CellChangeTimes->{{3.402730335455001*^9, 3.4027303475177326`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"XX", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{"\[Zeta]", " ", "\[Tau]"}], "2"]}]], 
      RowBox[{"Simplify", "[", 
       RowBox[{"E11", ",", 
        RowBox[{"\[Tau]", ">", "0"}]}], "]"}]}], " ", "/.", 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"\[Zeta]exp", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ")"}], "n_"], "\[Rule]", 
       SuperscriptBox["\[Zeta]", 
        RowBox[{"2", "n"}]]}], "}"}]}], ",", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[Zeta]", " ", "\[Tau]"}]]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.4027395110686693`*^9, 3.4027395510381866`*^9}, 
   3.402739651946374*^9, {3.4027396897595997`*^9, 3.4027396901189823`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "\[Zeta]"}], " ", "\[Tau]"}]], " ", 
    RowBox[{"(", 
     RowBox[{"M", "+", "\[Zeta]", "-", 
      RowBox[{"\[ImaginaryI]", " ", "Q", " ", "\[Gamma]", " ", "\[Rho]"}]}], 
     ")"}]}], 
   RowBox[{"2", " ", "\[Zeta]"}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"-", "M"}], "+", "\[Zeta]", "+", 
    RowBox[{"\[ImaginaryI]", " ", "Q", " ", "\[Gamma]", " ", "\[Rho]"}]}], 
   RowBox[{"2", " ", "\[Zeta]"}]]}]], "Output",
 CellChangeTimes->{
  3.4027395234907827`*^9, 3.402739564069687*^9, {3.402739663290342*^9, 
   3.402739691478383*^9}, 3.402740897235908*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Log", "[", "XX", "]"}], "+", 
  RowBox[{
   FractionBox["\[Tau]", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"M", "-", 
     RowBox[{"\[ImaginaryI]", " ", "\[Gamma]", " ", "\[Rho]", " ", "Q"}], "+",
      "\[Zeta]"}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.4027397027754745`*^9, 3.4027397219477177`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"M", "+", "\[Zeta]", "-", 
     RowBox[{"\[ImaginaryI]", " ", "Q", " ", "\[Gamma]", " ", "\[Rho]"}]}], 
    ")"}], " ", "\[Tau]"}], "+", 
  RowBox[{"Log", "[", 
   RowBox[{
    FractionBox[
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[Zeta]"}], " ", "\[Tau]"}]], " ", 
      RowBox[{"(", 
       RowBox[{"M", "+", "\[Zeta]", "-", 
        RowBox[{"\[ImaginaryI]", " ", "Q", " ", "\[Gamma]", " ", "\[Rho]"}]}],
        ")"}]}], 
     RowBox[{"2", " ", "\[Zeta]"}]], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"-", "M"}], "+", "\[Zeta]", "+", 
      RowBox[{"\[ImaginaryI]", " ", "Q", " ", "\[Gamma]", " ", "\[Rho]"}]}], 
     RowBox[{"2", " ", "\[Zeta]"}]]}], "]"}]}]], "Output",
 CellChangeTimes->{3.402739740651202*^9, 3.4027409043297944`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"B", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], "\[Psi]p", " ", "\[Tau]"}], "+", " ", 
     RowBox[{"Log", "[", 
      FractionBox[
       RowBox[{"\[Psi]m", "+", 
        RowBox[{"\[Psi]p", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "\[Zeta]"}], "  ", "\[Tau]"}]]}]}], 
       RowBox[{"2", " ", "\[Zeta]"}]], "]"}]}], " ", "/.", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Psi]p", "\[Rule]", " ", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"M", "+", 
           RowBox[{"I", " ", "z", " ", "\[Rho]", " ", "Q"}]}], ")"}]}], "+", 
        "\[Zeta]"}]}], ",", 
      RowBox[{"\[Psi]m", "\[Rule]", " ", 
       RowBox[{
        RowBox[{"(", " ", 
         RowBox[{"M", "+", 
          RowBox[{"I", " ", "z", " ", "\[Rho]", " ", "Q"}]}], ")"}], "+", 
        "\[Zeta]"}]}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.4027380011803045`*^9, 3.4027380302589884`*^9}, {
  3.402738073462943*^9, 3.4027380880725985`*^9}, {3.402738989136773*^9, 
  3.402739059841256*^9}, {3.402740529135091*^9, 3.402740533463299*^9}, {
  3.402741174850613*^9, 3.402741175256871*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", "2"]}], " ", 
   RowBox[{"(", 
    RowBox[{"M", "-", "\[Zeta]", "+", 
     RowBox[{"\[ImaginaryI]", " ", "Q", " ", "z", " ", "\[Rho]"}]}], ")"}], 
   " ", "\[Tau]"}], "+", 
  RowBox[{"Log", "[", 
   FractionBox[
    RowBox[{"M", "+", "\[Zeta]", "+", 
     RowBox[{"\[ImaginaryI]", " ", "Q", " ", "z", " ", "\[Rho]"}], "+", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[Zeta]"}], " ", "\[Tau]"}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "M"}], "+", "\[Zeta]", "-", 
        RowBox[{"\[ImaginaryI]", " ", "Q", " ", "z", " ", "\[Rho]"}]}], 
       ")"}]}]}], 
    RowBox[{"2", " ", "\[Zeta]"}]], "]"}]}]], "Output",
 CellChangeTimes->{3.402738043743622*^9, 3.402738093010193*^9, 
  3.402738994793132*^9, 3.4027390274656343`*^9, 3.4027390607631483`*^9, 
  3.402740534416442*^9, 3.4027411772100334`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"YY", "=", 
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{"E21", ",", 
     RowBox[{"\[Tau]", ">", "0"}]}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"\[Zeta]exp", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ")"}], "n_"], "\[Rule]", 
     SuperscriptBox["\[Zeta]", 
      RowBox[{"2", "n"}]]}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.4027407044822073`*^9, 3.4027407052947226`*^9}, {
  3.4027407463736362`*^9, 3.4027407624208193`*^9}, {3.4027409935346317`*^9, 
  3.40274099423777*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"\[Zeta]", " ", "\[Tau]"}], "2"]}]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[Zeta]", " ", "\[Tau]"}]]}], ")"}], " ", "\[Gamma]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "\[ImaginaryI]"}], "+", "\[Gamma]"}], ")"}]}], 
   RowBox[{"2", " ", "\[Zeta]"}]]}]], "Output",
 CellChangeTimes->{
  3.4027407058884845`*^9, {3.402740750248711*^9, 3.4027407644833593`*^9}, 
   3.402740911798688*^9, 3.402740995409668*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"A", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "\[Zeta]"}], " ", "\[Tau]"}], "2"]], 
    RowBox[{"YY", "/", "XX"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.402740997972217*^9, 3.4027410086755476`*^9}, {
   3.4027410665047827`*^9, 3.4027410746611896`*^9}, 3.402741128177842*^9, {
   3.402741163647273*^9, 3.4027411641472826`*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[Zeta]", " ", "\[Tau]"}]]}], ")"}], " ", "\[Gamma]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "\[ImaginaryI]"}], "+", "\[Gamma]"}], ")"}]}], 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[Zeta]", " ", "\[Tau]"}]]}], ")"}], " ", "M"}], "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[Zeta]", " ", "\[Tau]"}]]}], ")"}], " ", "\[Zeta]"}], "-", 
   RowBox[{"\[ImaginaryI]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[Zeta]", " ", "\[Tau]"}]]}], ")"}], " ", "Q", " ", 
    "\[Gamma]", " ", "\[Rho]"}]}]]], "Output",
 CellChangeTimes->{3.402741009503689*^9, 3.4027410761612186`*^9, 
  3.4027411291153603`*^9, 3.402741165725438*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Implementation", "Subsubtitle",
 CellChangeTimes->{{3.402744719856176*^9, 3.4027447350908437`*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{
  "LNHestonVanillaCall", ",", "LNHestonVanillaCallIntegrand", ",", 
   "HestonPropagator"}], "]"}]], "Input",
 CellChangeTimes->{{3.4026742220354853`*^9, 3.402674263239402*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"HestonPropagator", "[", 
   RowBox[{
   "V_", ",", "\[Tau]_", ",", "\[Lambda]_", ",", "\[Theta]_", ",", "\[Nu]_", 
    ",", "\[Rho]_", ",", "z_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[Psi]p", ",", "\[Psi]m", ",", "\[Zeta]", ",", "X"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Zeta]", "=", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", " ", 
          RowBox[{"\[Lambda]", "+", 
           RowBox[{"I", " ", "z", " ", "\[Rho]", " ", "\[Nu]"}]}], ")"}], "^",
          "2"}], "+", 
        RowBox[{
         RowBox[{"\[Nu]", "^", "2"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "I"}], " ", "z"}], "+", 
           RowBox[{"z", "^", "2"}]}], ")"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Psi]p", "=", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{"\[Lambda]", "+", 
          RowBox[{"I", " ", "z", " ", "\[Rho]", " ", "\[Nu]"}]}], ")"}]}], 
       "+", "\[Zeta]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Psi]m", "=", 
      RowBox[{
       RowBox[{"(", " ", 
        RowBox[{"\[Lambda]", "+", 
         RowBox[{"I", " ", "z", " ", "\[Rho]", " ", "\[Nu]"}]}], ")"}], "+", 
       "\[Zeta]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"A", "=", 
      RowBox[{
       RowBox[{"-", "\[Theta]"}], " ", 
       RowBox[{"\[Lambda]", "/", 
        RowBox[{"\[Nu]", "^", "2"}]}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Psi]p", " ", "\[Tau]"}], "+", 
         RowBox[{"2", " ", 
          RowBox[{"Log", "[", 
           FractionBox[
            RowBox[{"\[Psi]m", "+", 
             RowBox[{"\[Psi]p", " ", 
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{
                RowBox[{"-", "\[Zeta]"}], "  ", "\[Tau]"}]]}]}], 
            RowBox[{"2", " ", "\[Zeta]"}]], "]"}]}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"B", "=", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "I"}], " ", "z"}], "+", 
          RowBox[{"z", "^", "2"}]}], ")"}]}], 
       FractionBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "\[Zeta]"}], "  ", "\[Tau]"}]]}], ")"}], 
        RowBox[{"\[Psi]m", "+", 
         RowBox[{"\[Psi]p", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "\[Zeta]"}], "  ", "\[Tau]"}]]}]}]]}]}], ";", 
     "\[IndentingNewLine]", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"A", "+", 
       RowBox[{"B", "  ", "V"}]}]]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.402671173039446*^9, 3.4026712844322095`*^9}, {
   3.402673902451225*^9, 3.4026739101544976`*^9}, {3.4026853844291506`*^9, 
   3.4026854175947504`*^9}, {3.4026855548435507`*^9, 3.4026855694607506`*^9}, 
   3.402685898870351*^9, {3.402728244867987*^9, 3.4027282746654344`*^9}, {
   3.40272935335802*^9, 3.402729354404915*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FourierPayOffLNSepp", "[", 
   RowBox[{"z_", ",", "k_"}], "]"}], ":=", 
  FractionBox[
   SuperscriptBox["k", 
    RowBox[{
     RowBox[{"\[ImaginaryI]", " ", "z"}], "+", "1"}]], 
   RowBox[{
    SuperscriptBox["z", "2"], "-", 
    RowBox[{"\[ImaginaryI]", " ", "z"}]}]]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.402672806555184*^9, 3.4026728151178484`*^9}, 
   3.402685866203951*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Max", "[", 
    RowBox[{
     RowBox[{"F", "-", "K"}], ",", "0"}], "]"}], "-", "F"}], "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"F", "-", "K"}], ")"}], 
     SubscriptBox["1", 
      RowBox[{"F", ">", "K"}]]}], "-", 
    RowBox[{"F", 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["1", 
        RowBox[{"F", ">", "K"}]], "+", 
       SubscriptBox["1", 
        RowBox[{"F", "<", "K"}]]}], ")"}]}]}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"-", "K"}], " ", 
      SubscriptBox["1", 
       RowBox[{"F", ">", "K"}]]}], "-", 
     RowBox[{"F", " ", 
      SubscriptBox["1", 
       RowBox[{"F", "<", "K"}]]}]}], " ", "=", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"K", " ", 
         SubscriptBox["1", 
          RowBox[{"F", ">", "K"}]]}], "+", 
        RowBox[{"F", " ", 
         SubscriptBox["1", 
          RowBox[{"F", "<", "K"}]]}]}], ")"}]}], "=", 
     RowBox[{"-", 
      RowBox[{"Min", "[", 
       RowBox[{"F", ",", "K"}], "]"}]}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.4026745989177217`*^9, 3.4026747959527545`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"on", " ", "montre", "  ", 
   RowBox[{"FourierTransform", "[", 
    RowBox[{
     RowBox[{"Min", "[", 
      RowBox[{"x", ",", "K"}], "]"}], ",", "x", ",", "z"}], "]"}]}], " ", 
  "\[Equal]", " ", 
  FractionBox[
   SuperscriptBox["K", 
    RowBox[{
     RowBox[{"\[ImaginaryI]", " ", "z"}], "+", "1"}]], 
   RowBox[{
    SuperscriptBox["z", "2"], "-", 
    RowBox[{"\[ImaginaryI]", " ", "z"}]}]]}]], "Text",
 CellChangeTimes->{{3.4026749002828827`*^9, 3.402674910142447*^9}, {
  3.402674969612339*^9, 3.4026749699092197`*^9}, {3.4026849069287505`*^9, 
  3.4026849307343507`*^9}}],

Cell["\<\
On passe par Min car le call n' est pas born\[EAcute] donc la theorie ne s' \
aaplique pas.D' allieurs on trouve une pole pour passer du call au min\
\>", "Text",
 CellChangeTimes->{{3.402744873765381*^9, 3.4027449395635195`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"LNHestonVanillaCallIntegrand", "[", 
   RowBox[{
   "F_", ",", "K_", ",", "z_", ",", "V_", ",", "\[Tau]_", ",", "\[Theta]_", 
    ",", "\[Lambda]_", ",", "\[Nu]_", ",", "\[Rho]_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[Psi]p", ",", "\[Psi]m", ",", "\[Zeta]", ",", "X"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"Re", "[", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Log", "[", "F", "]"}]}], " ", "I", " ", "z"}]], 
      RowBox[{"HestonPropagator", "[", 
       RowBox[{
       "V", ",", "\[Tau]", ",", "\[Lambda]", ",", "\[Theta]", ",", "\[Nu]", 
        ",", "\[Rho]", ",", "z"}], "]"}], 
      RowBox[{"FourierPayOffLNSepp", "[", 
       RowBox[{"z", ",", "K"}], "]"}]}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.399720772330803*^9, 3.3997207755027385`*^9}, {
   3.402654245683197*^9, 3.4026544320148993`*^9}, {3.402654758052409*^9, 
   3.4026547634900136`*^9}, {3.4026550631832676`*^9, 
   3.4026550728553286`*^9}, {3.402655262093337*^9, 3.402655270781004*^9}, {
   3.4026561175785117`*^9, 3.4026562107990513`*^9}, {3.4026568132637434`*^9, 
   3.4026568144825172`*^9}, {3.4026589345075955`*^9, 
   3.4026589564767675`*^9}, {3.4026600657636905`*^9, 3.402660083248401*^9}, {
   3.402660117670937*^9, 3.402660127936759*^9}, {3.40266022145418*^9, 
   3.40266022876682*^9}, {3.402660262470592*^9, 3.4026603225498705`*^9}, {
   3.4026634912044573`*^9, 3.4026634914700875`*^9}, {3.4026733197056613`*^9, 
   3.4026733756598606`*^9}, {3.4026734227232637`*^9, 3.402673438645445*^9}, {
   3.40267347642742*^9, 3.4026735850857563`*^9}, {3.4026736471963243`*^9, 
   3.402673741620012*^9}, {3.4026737909803343`*^9, 3.402673791183463*^9}, {
   3.402673828965439*^9, 3.402673845965765*^9}, {3.40267396078047*^9, 
   3.4026739761557646`*^9}, {3.402674013078349*^9, 3.402674014047117*^9}, 
   3.4026743266624947`*^9, {3.4026744761341143`*^9, 3.402674483040497*^9}, {
   3.4026745222287493`*^9, 3.402674522572506*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"LNHestonVanillaCall", "[", 
   RowBox[{
   "F_", ",", "K_", ",", "V0_", ",", "\[Tau]_", ",", "\[Lambda]_", ",", 
    "\[Theta]_", ",", "\[Nu]_", ",", "\[Rho]_", ",", "limsup_"}], "]"}], ":=",
   "\[IndentingNewLine]", 
  RowBox[{"F", "+", 
   RowBox[{
    RowBox[{"1", "/", "Pi"}], " ", 
    RowBox[{"NIntegrate", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"LNHestonVanillaCallIntegrand", "[", 
       RowBox[{"F", ",", "K", ",", 
        RowBox[{"k1", "+", 
         RowBox[{"I", "/", "2"}]}], ",", "V0", ",", "\[Tau]", ",", "\[Theta]",
         ",", "\[Lambda]", ",", "\[Nu]", ",", "\[Rho]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"k1", ",", "0", ",", "limsup"}], "}"}], ",", 
      RowBox[{"MaxRecursion", "\[Rule]", "20"}]}], "]"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4026544802502003`*^9, 3.4026545110164165`*^9}, {
   3.4026546910198727`*^9, 3.402654692941784*^9}, 3.402655908324494*^9, {
   3.4026562340338726`*^9, 3.4026562456903467`*^9}, {3.4026562789253597`*^9, 
   3.402656279784751*^9}, {3.4026634802667475`*^9, 3.4026634875637627`*^9}, {
   3.402673718557069*^9, 3.402673733776111*^9}, {3.4026737970117006`*^9, 
   3.4026737987929845`*^9}, 3.402674316318546*^9, {3.4026744933063188`*^9, 
   3.402674500353329*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"LNHestonRiccatiVanillaCallIntegrand", "[", 
   RowBox[{
   "F_", ",", "K_", ",", "z_", ",", "V_", ",", "\[Tau]_", ",", "\[Theta]_", 
    ",", "\[Lambda]_", ",", "\[Nu]_", ",", "\[Rho]_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[Psi]p", ",", "\[Psi]m", ",", "\[Zeta]", ",", "X"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"Re", "[", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Log", "[", "F", "]"}]}], " ", "I", " ", "z"}]], 
      RowBox[{"HestonLaplaceTransform4", "[", 
       RowBox[{
        RowBox[{"-", "\[Lambda]"}], ",", "\[Theta]", ",", "\[Rho]", ",", " ", 
        "V", ",", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "z"}], ",", "\[Nu]", ",", 
        "\[Tau]"}], "]"}], 
      RowBox[{"FourierPayOffLNSepp", "[", 
       RowBox[{"z", ",", "K"}], "]"}]}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.399720772330803*^9, 3.3997207755027385`*^9}, {
   3.402654245683197*^9, 3.4026544320148993`*^9}, {3.402654758052409*^9, 
   3.4026547634900136`*^9}, {3.4026550631832676`*^9, 
   3.4026550728553286`*^9}, {3.402655262093337*^9, 3.402655270781004*^9}, {
   3.4026561175785117`*^9, 3.4026562107990513`*^9}, {3.4026568132637434`*^9, 
   3.4026568144825172`*^9}, {3.4026589345075955`*^9, 
   3.4026589564767675`*^9}, {3.4026600657636905`*^9, 3.402660083248401*^9}, {
   3.402660117670937*^9, 3.402660127936759*^9}, {3.40266022145418*^9, 
   3.40266022876682*^9}, {3.402660262470592*^9, 3.4026603225498705`*^9}, {
   3.4026634912044573`*^9, 3.4026634914700875`*^9}, {3.4026733197056613`*^9, 
   3.4026733756598606`*^9}, {3.4026734227232637`*^9, 3.402673438645445*^9}, {
   3.40267347642742*^9, 3.4026735850857563`*^9}, {3.4026736471963243`*^9, 
   3.402673741620012*^9}, {3.4026737909803343`*^9, 3.402673791183463*^9}, {
   3.402673828965439*^9, 3.402673845965765*^9}, {3.40267396078047*^9, 
   3.4026739761557646`*^9}, {3.402674013078349*^9, 3.402674014047117*^9}, 
   3.4026743266624947`*^9, {3.4026744761341143`*^9, 3.402674483040497*^9}, {
   3.4026745222287493`*^9, 3.402674522572506*^9}, {3.4027455046524935`*^9, 
   3.4027455282466965`*^9}, {3.4027455654661617`*^9, 
   3.4027455681380873`*^9}, {3.4027456052325497`*^9, 3.402745661530506*^9}, {
   3.4027457063126154`*^9, 3.402745719094111*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"LNHestonRiccatiVanillaCall", "[", 
   RowBox[{
   "F_", ",", "K_", ",", "V0_", ",", "\[Tau]_", ",", "\[Lambda]_", ",", 
    "\[Theta]_", ",", "\[Nu]_", ",", "\[Rho]_", ",", "limsup_"}], "]"}], ":=",
   "\[IndentingNewLine]", 
  RowBox[{"F", "+", 
   RowBox[{
    RowBox[{"1", "/", "Pi"}], " ", 
    RowBox[{"NIntegrate", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"LNHestonRiccatiVanillaCallIntegrand", "[", 
       RowBox[{"F", ",", "K", ",", 
        RowBox[{"k1", "+", 
         RowBox[{"I", "/", "2"}]}], ",", "V0", ",", "\[Tau]", ",", "\[Theta]",
         ",", "\[Lambda]", ",", "\[Nu]", ",", "\[Rho]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"k1", ",", "0", ",", "limsup"}], "}"}], ",", 
      RowBox[{"MaxRecursion", "\[Rule]", "20"}]}], "]"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4026544802502003`*^9, 3.4026545110164165`*^9}, {
   3.4026546910198727`*^9, 3.402654692941784*^9}, 3.402655908324494*^9, {
   3.4026562340338726`*^9, 3.4026562456903467`*^9}, {3.4026562789253597`*^9, 
   3.402656279784751*^9}, {3.4026634802667475`*^9, 3.4026634875637627`*^9}, {
   3.402673718557069*^9, 3.402673733776111*^9}, {3.4026737970117006`*^9, 
   3.4026737987929845`*^9}, 3.402674316318546*^9, {3.4026744933063188`*^9, 
   3.402674500353329*^9}, 3.4027455025430784`*^9, {3.402745533981182*^9, 
   3.4027455763101196`*^9}}],

Cell["\<\
Si on inclue le drift venant du fait que l' underlying est un log d' asset\
\>", "Text",
 CellChangeTimes->{{3.400415840991619*^9, 3.4004158739297514`*^9}, 
   3.4027449843143787`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"HestonLaplaceTransform4", "[", 
   RowBox[{
   "M_", ",", "\[Theta]_", ",", "\[Rho]_", ",", " ", "\[CapitalSigma]_", ",", 
    "\[Gamma]_", ",", "Q_", ",", "\[Tau]_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "H", ",", "EXPH", ",", "A11", ",", "A1", ",", "A21", ",", "A", ",", 
      "\[Beta]", ",", "\[Nu]11", ",", "\[Nu]12", ",", "\[Nu]21", ",", 
      "\[Nu]22", ",", "c", ",", "\[IndentingNewLine]", 
      RowBox[{"Placement1", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0"}], "}"}], "}"}]}], ",", 
      RowBox[{"Placement2", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}], "}"}]}], ",", "\[Zeta]"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Beta]", "=", 
      RowBox[{
       SqrtBox[
        RowBox[{
         RowBox[{"-", "M"}], " ", "\[Theta]"}]], "/", "Q"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"H", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", " ", 
          FractionBox[
           RowBox[{"M", "+", 
            RowBox[{"Q", " ", "\[Rho]", " ", "\[Gamma]"}]}], "2"], ")"}]}], 
        RowBox[{"(", " ", 
         RowBox[{
          RowBox[{"Transpose", "[", "Placement1", "]"}], " ", ".", 
          "Placement1"}], ")"}]}], "+", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "Q"}], "  ", 
          RowBox[{"Q", "/", "2"}]}], ")"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Transpose", "[", "Placement1", "]"}], " ", ".", 
          "Placement2"}], ")"}]}], "+", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Gamma]", " ", 
           RowBox[{"\[Gamma]", " ", "/", "2"}]}], "-", 
          RowBox[{"\[Gamma]", "/", "2"}]}], ")"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Transpose", "[", "Placement2", "]"}], "  ", ".", 
          "Placement1"}], ")"}]}], "+", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         FractionBox[
          RowBox[{"M", "+", 
           RowBox[{"Q", " ", "\[Rho]", " ", "\[Gamma]"}]}], "2"], ")"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Transpose", "[", "Placement2", "]"}], "  ", ".", 
          "Placement2"}], ")"}]}]}]}], " ", ";", " ", "\[IndentingNewLine]", 
     RowBox[{"EXPH", "=", 
      RowBox[{"MatrixExp2", "[", 
       RowBox[{"\[Tau]", " ", "H"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"A11", "=", 
      RowBox[{"EXPH", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"A21", "=", 
      RowBox[{"EXPH", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"A", "=", " ", 
      FractionBox["A21", "A11"]}], ";", "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{
       RowBox[{"-", "2"}], 
       SuperscriptBox["\[Beta]", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Log", "[", "A11", "]"}], "+", 
         RowBox[{
          FractionBox["\[Tau]", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"M", "+", 
            RowBox[{"\[Gamma]", " ", "\[Rho]", " ", "Q"}]}], ")"}]}]}], 
        ")"}]}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"A", "  ", "\[CapitalSigma]"}], "+", "c"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.3996091780740976`*^9, 3.399609188527423*^9}, 
   3.3996094717203608`*^9, {3.3996100812164373`*^9, 3.3996101282173395`*^9}, {
   3.399610163327389*^9, 3.399610191265425*^9}, {3.3996102800796304`*^9, 
   3.3996102933298845`*^9}, {3.3996103301430917`*^9, 3.399610364487501*^9}, {
   3.3996103960193567`*^9, 3.399610527443755*^9}, {3.399613442827854*^9, 
   3.3996134889537396`*^9}, {3.3996135455485764`*^9, 3.399613579111721*^9}, {
   3.3996136276907787`*^9, 3.3996137026765933`*^9}, {3.3996141716074715`*^9, 
   3.399614178779484*^9}, {3.3996143602985945`*^9, 3.3996144034244223`*^9}, {
   3.399614588365473*^9, 3.399614675929654*^9}, {3.3996147127897367`*^9, 
   3.399614728430662*^9}, {3.3996159558448534`*^9, 3.3996159765952516`*^9}, {
   3.39961642913519*^9, 3.3996164487605667`*^9}, {3.3996165351216*^9, 
   3.3996165711535416`*^9}, {3.39961764295537*^9, 3.399617656940014*^9}, {
   3.399617708425377*^9, 3.3996177391134663`*^9}, {3.3996178116304836`*^9, 
   3.399617813208639*^9}, {3.399617917132509*^9, 3.3996179446174116`*^9}, {
   3.3996230503560653`*^9, 3.3996230611375217`*^9}, 3.3996231179511127`*^9, {
   3.3996231515142574`*^9, 3.399623204390272*^9}, {3.3996234935676994`*^9, 
   3.39962349516148*^9}, {3.3996238989348574`*^9, 3.3996239284979253`*^9}, {
   3.3996239651548786`*^9, 3.399623997249245*^9}, {3.3996242593011513`*^9, 
   3.39962430664581*^9}, {3.39962457590098*^9, 3.3996245819010954`*^9}, {
   3.3996246644495554`*^9, 3.3996246731528473`*^9}, 3.399624756904455*^9, {
   3.3996248195619082`*^9, 3.3996248209369345`*^9}, {3.399624853140678*^9, 
   3.3996249654084587`*^9}, {3.3996250105186996`*^9, 3.399625071441744*^9}, {
   3.3996251927721987`*^9, 3.399625212460077*^9}, {3.3996264825157113`*^9, 
   3.399626484468874*^9}, 3.399628177423253*^9, 3.3996284526160364`*^9, 
   3.3996288302482867`*^9, {3.3996290041891265`*^9, 3.399629014861206*^9}, {
   3.399629553246543*^9, 3.3996295718250246`*^9}, {3.3996296199821997`*^9, 
   3.399629627982353*^9}, {3.3996299377383003`*^9, 3.3996299586293263`*^9}, {
   3.399630651845761*^9, 3.399630652267644*^9}, {3.399630683424492*^9, 
   3.399630732581686*^9}, {3.3996368382743225`*^9, 3.399636862696666*^9}, {
   3.3996369403544073`*^9, 3.3996370155902267`*^9}, {3.399638511993957*^9, 
   3.3996385145252557`*^9}, {3.399638662512472*^9, 3.3996387308419085`*^9}, {
   3.399639873270093*^9, 3.399639911755207*^9}, {3.3996399476308956`*^9, 
   3.399639949130924*^9}, {3.399640206870248*^9, 3.39964020722963*^9}, {
   3.3996403065284114`*^9, 3.399640370670268*^9}, {3.3996404343121147`*^9, 
   3.3996404655627146`*^9}, {3.399640569111578*^9, 3.3996406146124516`*^9}, 
   3.3996419118873587`*^9, {3.3996977702651625`*^9, 3.3996977800784793`*^9}, {
   3.3996978357862387`*^9, 3.39969785814712*^9}, {3.3997021850051827`*^9, 
   3.3997021878646126`*^9}, {3.3997022383187065`*^9, 
   3.3997022393812265`*^9}, {3.3997024471977167`*^9, 3.399702479870219*^9}, {
   3.3997025249023333`*^9, 3.399702579872139*^9}, {3.399702632310646*^9, 
   3.399702696077495*^9}, {3.399708684192465*^9, 3.3997086974583445`*^9}, {
   3.399709114325723*^9, 3.399709115419494*^9}, {3.3997093280798273`*^9, 
   3.3997093300954905`*^9}, {3.3997093998624554`*^9, 3.399709435738144*^9}, {
   3.3997094670043697`*^9, 3.399709470363809*^9}, {3.3997095033956933`*^9, 
   3.399709515770931*^9}, {3.3997095796627827`*^9, 3.3997095887410817`*^9}, {
   3.399709623116742*^9, 3.399709626460556*^9}, {3.399709680680347*^9, 
   3.3997097419940243`*^9}, {3.399709809651573*^9, 3.399709960966978*^9}, 
   3.3997100379059553`*^9, {3.399710080828655*^9, 3.3997101116729965`*^9}, {
   3.399710264597808*^9, 3.3997103284896593`*^9}, 3.3997109266573944`*^9, {
   3.399710968830079*^9, 3.3997109708457427`*^9}, {3.399718101248269*^9, 
   3.399718127295644*^9}, {3.3997182049690104`*^9, 3.3997182063440366`*^9}, {
   3.3997183227368965`*^9, 3.39971833359648*^9}, {3.3997184310202255`*^9, 
   3.399718438176613*^9}, {3.399720748611597*^9, 3.3997207837841473`*^9}, {
   3.4004157423178496`*^9, 3.400415747427323*^9}, 3.4027276466065006`*^9, {
   3.4027278911580715`*^9, 3.4027279114397106`*^9}, {3.4027281536787367`*^9, 
   3.4027282165549436`*^9}, {3.402728322056969*^9, 3.4027283334790635`*^9}, {
   3.402729302653921*^9, 3.4027293031383057`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"HestonFourierTransform4", "[", 
   RowBox[{
   "M_", ",", "\[Theta]_", ",", "\[Rho]_", ",", " ", "\[CapitalSigma]_", ",", 
    "\[Gamma]_", ",", "\[Beta]_", ",", "\[Tau]_"}], "]"}], ":=", 
  RowBox[{"HestonLaplaceTransform4", "[", 
   RowBox[{
   "M", ",", "\[Theta]", ",", "\[Rho]", ",", " ", "\[CapitalSigma]", ",", 
    RowBox[{
     RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Gamma]"}], ",", "\[Beta]", ",", 
    "\[Tau]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.399613844866823*^9, 3.3996138769143133`*^9}, {
   3.3996144538628902`*^9, 3.399614456237936*^9}, 3.3997099958270226`*^9, {
   3.400415780834214*^9, 3.400415797381407*^9}, {3.402727671606981*^9, 
   3.4027276798258886`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Lambda]", "=", "0.05"}], ",", 
     RowBox[{"\[Nu]", "=", "0.2"}], ",", 
     RowBox[{"\[Rho]", "=", 
      RowBox[{"-", "0.5"}]}], ",", 
     RowBox[{"\[CapitalSigma]", "=", "0.04"}], ",", 
     RowBox[{"\[CapitalSigma]inf", "=", "0.05"}], ",", 
     RowBox[{"\[Tau]", "=", "5"}], ",", 
     RowBox[{"z", "=", "1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"HestonFourierTransform4", "[", 
      RowBox[{
       RowBox[{"-", "\[Lambda]"}], ",", "\[CapitalSigma]inf", ",", "\[Rho]", 
       ",", " ", "\[CapitalSigma]", ",", "z", ",", "\[Nu]", ",", "\[Tau]"}], 
      "]"}], ",", 
     RowBox[{"HestonPropagator", "[", 
      RowBox[{
      "\[CapitalSigma]", ",", "\[Tau]", ",", "\[Lambda]", ",", 
       "\[CapitalSigma]inf", ",", "\[Nu]", ",", "\[Rho]", ",", "z"}], "]"}]}],
     "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.4026850142099504`*^9, 3.402685223218751*^9}, 
   3.4026856734191504`*^9, 3.4026857069435506`*^9, 3.4027250317281713`*^9, {
   3.4027277945312157`*^9, 3.402727800578207*^9}, 3.4027446555111904`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.8887909571829467`", "\[InvisibleSpace]", "+", 
    RowBox[{"0.05816484973236061`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0.8887909571829465`", "\[InvisibleSpace]", "+", 
    RowBox[{"0.058164849732360614`", " ", "\[ImaginaryI]"}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.4026852246851506`*^9, 3.4026854325863504`*^9, 3.402685576761551*^9, {
   3.4026856761647506`*^9, 3.402685709111951*^9}, 3.4027250334469543`*^9, 
   3.402727806890828*^9, 3.40272793979963*^9, 3.4027281571006775`*^9, 
   3.4027282807280507`*^9, 3.4027283382135296`*^9, 3.4027284616065235`*^9, {
   3.402728492294613*^9, 3.4027285171388397`*^9}, {3.4027293137478848`*^9, 
   3.4027293588893757`*^9}, {3.4027446456672516`*^9, 3.402744657104971*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"S", "=", "0.05"}], ",", 
     RowBox[{"K", "=", "0.06"}], ",", 
     RowBox[{"T", "=", "5"}], ",", 
     RowBox[{"V", "=", "0.04"}], ",", 
     RowBox[{"Vinf", "=", "0.04"}], ",", 
     RowBox[{"\[Rho]", "=", 
      RowBox[{"-", "0.5"}]}], ",", 
     RowBox[{"\[Lambda]", "=", "0.05"}], ",", 
     RowBox[{"\[Nu]", "=", "0.2"}], ",", 
     RowBox[{"limsup", "=", "3000"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"LNHestonRiccatiVanillaCall", "[", 
      RowBox[{
      "S", ",", "K", ",", "V", ",", "T", ",", "\[Lambda]", ",", "Vinf", ",", 
       "\[Nu]", ",", "\[Rho]", ",", "limsup"}], "]"}], ",", 
     RowBox[{"LNHestonVanillaCall", "[", 
      RowBox[{
      "S", ",", "K", ",", "V", ",", "T", ",", "\[Lambda]", ",", "Vinf", ",", 
       "\[Nu]", ",", "\[Rho]", ",", "limsup"}], "]"}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.4026583136519256`*^9, 3.402658415763261*^9}, {
   3.402663509095426*^9, 3.4026635093766813`*^9}, {3.402671423653633*^9, 
   3.402671424919282*^9}, 3.402672523127867*^9, {3.402745780626542*^9, 
   3.4027458395964246`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.0032484449512331995`", ",", "0.0032484449512331995`"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.4026583944972277`*^9, 3.4026584169351587`*^9}, 
   3.4026589658363223`*^9, 3.402660094842374*^9, 3.402660134280631*^9, 
   3.4026602333450327`*^9, 3.4026603040651407`*^9, 3.4026634266250925`*^9, {
   3.402663505532858*^9, 3.402663510704832*^9}, 3.402663571581001*^9, {
   3.402664014105122*^9, 3.4026640186833353`*^9}, 3.402664120013406*^9, 
   3.402671148132718*^9, {3.402671320479777*^9, 3.4026713578242435`*^9}, {
   3.4026714005125637`*^9, 3.4026714264036856`*^9}, 3.4026715143897495`*^9, 
   3.4026716185948753`*^9, {3.4026716612050686`*^9, 3.402671709362243*^9}, {
   3.4026725178465157`*^9, 3.4026725245966454`*^9}, 3.4026726003793507`*^9, 
   3.402672793539309*^9, 3.402672862696887*^9, 3.4026729423859167`*^9, 
   3.4026730198249035`*^9, 3.4026731696871557`*^9, {3.4026732022502813`*^9, 
   3.4026732246569614`*^9}, 3.402673267079651*^9, {3.4026733066429105`*^9, 
   3.40267332356511*^9}, {3.4026733812224674`*^9, 3.4026733830350018`*^9}, 
   3.4026734474268637`*^9, 3.4026735239908333`*^9, 3.402673590538986*^9, {
   3.402673698103551*^9, 3.4026738017774167`*^9}, 3.4026738496845865`*^9, {
   3.4026739871716013`*^9, 3.402673988593504*^9}, {3.4026740204691153`*^9, 
   3.4026740216722636`*^9}, 3.4026742094727445`*^9, 3.402674273958358*^9, {
   3.4026743334751253`*^9, 3.4026743352251587`*^9}, {3.4026745059003105`*^9, 
   3.402674526838213*^9}, 3.4027225056952972`*^9, 3.4027458414402103`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Normal Heston case", "Section",
 CellChangeTimes->{{3.4028333335454617`*^9, 3.402833338061174*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"HestonLaplaceTransform", "[", 
   RowBox[{
   "M_", ",", "\[Theta]_", ",", "\[Rho]_", ",", " ", "\[CapitalSigma]_", ",", 
    "\[Gamma]_", ",", "Q_", ",", "\[Tau]_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "H", ",", "EXPH", ",", "A11", ",", "A1", ",", "A21", ",", "A", ",", 
      "\[Nu]11", ",", "\[Nu]12", ",", "\[Nu]21", ",", "\[Nu]22", ",", "c", 
      ",", "\[IndentingNewLine]", 
      RowBox[{"Placement1", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0"}], "}"}], "}"}]}], ",", 
      RowBox[{"Placement2", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}], "}"}]}], ",", "\[Zeta]", ",", 
      RowBox[{"\[Beta]", "=", 
       FractionBox[
        SqrtBox[
         RowBox[{
          RowBox[{"-", "M"}], " ", "\[Theta]"}]], "Q"]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"H", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", " ", 
          FractionBox[
           RowBox[{"M", "+", 
            RowBox[{"Q", " ", "\[Rho]", " ", "\[Gamma]"}]}], "2"], ")"}]}], 
        RowBox[{"(", " ", 
         RowBox[{
          RowBox[{"Transpose", "[", "Placement1", "]"}], " ", ".", 
          "Placement1"}], ")"}]}], "+", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "Q"}], "  ", 
          RowBox[{"Q", "/", "2"}]}], ")"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Transpose", "[", "Placement1", "]"}], " ", ".", 
          "Placement2"}], ")"}]}], "+", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"\[Gamma]", " ", 
          RowBox[{"\[Gamma]", " ", "/", "2"}]}], ")"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Transpose", "[", "Placement2", "]"}], "  ", ".", 
          "Placement1"}], ")"}]}], "+", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         FractionBox[
          RowBox[{"M", "+", 
           RowBox[{"Q", " ", "\[Rho]", " ", "\[Gamma]"}]}], "2"], ")"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Transpose", "[", "Placement2", "]"}], "  ", ".", 
          "Placement2"}], ")"}]}]}]}], " ", ";", " ", "\[IndentingNewLine]", 
     RowBox[{"EXPH", "=", 
      RowBox[{"MatrixExp2", "[", 
       RowBox[{"\[Tau]", " ", "H"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"A11", "=", 
      RowBox[{"EXPH", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"A21", "=", 
      RowBox[{"EXPH", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"A", "=", " ", 
      FractionBox["A21", "A11"]}], ";", "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{
       RowBox[{"-", "2"}], 
       SuperscriptBox["\[Beta]", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Log", "[", "A11", "]"}], "+", 
         RowBox[{
          FractionBox["\[Tau]", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"M", "+", 
            RowBox[{"\[Gamma]", " ", "\[Rho]", " ", "Q"}]}], ")"}]}]}], 
        ")"}]}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"A", "  ", "\[CapitalSigma]"}], "+", "c"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.3996091780740976`*^9, 3.399609188527423*^9}, 
   3.3996094717203608`*^9, {3.3996100812164373`*^9, 3.3996101282173395`*^9}, {
   3.399610163327389*^9, 3.399610191265425*^9}, {3.3996102800796304`*^9, 
   3.3996102933298845`*^9}, {3.3996103301430917`*^9, 3.399610364487501*^9}, {
   3.3996103960193567`*^9, 3.399610527443755*^9}, {3.399613442827854*^9, 
   3.3996134889537396`*^9}, {3.3996135455485764`*^9, 3.399613579111721*^9}, {
   3.3996136276907787`*^9, 3.3996137026765933`*^9}, {3.3996141716074715`*^9, 
   3.399614178779484*^9}, {3.3996143602985945`*^9, 3.3996144034244223`*^9}, {
   3.399614588365473*^9, 3.399614675929654*^9}, {3.3996147127897367`*^9, 
   3.399614728430662*^9}, {3.3996159558448534`*^9, 3.3996159765952516`*^9}, {
   3.39961642913519*^9, 3.3996164487605667`*^9}, {3.3996165351216*^9, 
   3.3996165711535416`*^9}, {3.39961764295537*^9, 3.399617656940014*^9}, {
   3.399617708425377*^9, 3.3996177391134663`*^9}, {3.3996178116304836`*^9, 
   3.399617813208639*^9}, {3.399617917132509*^9, 3.3996179446174116`*^9}, {
   3.3996230503560653`*^9, 3.3996230611375217`*^9}, 3.3996231179511127`*^9, {
   3.3996231515142574`*^9, 3.399623204390272*^9}, {3.3996234935676994`*^9, 
   3.39962349516148*^9}, {3.3996238989348574`*^9, 3.3996239284979253`*^9}, {
   3.3996239651548786`*^9, 3.399623997249245*^9}, {3.3996242593011513`*^9, 
   3.39962430664581*^9}, {3.39962457590098*^9, 3.3996245819010954`*^9}, {
   3.3996246644495554`*^9, 3.3996246731528473`*^9}, 3.399624756904455*^9, {
   3.3996248195619082`*^9, 3.3996248209369345`*^9}, {3.399624853140678*^9, 
   3.3996249654084587`*^9}, {3.3996250105186996`*^9, 3.399625071441744*^9}, {
   3.3996251927721987`*^9, 3.399625212460077*^9}, {3.3996264825157113`*^9, 
   3.399626484468874*^9}, 3.399628177423253*^9, 3.3996284526160364`*^9, 
   3.3996288302482867`*^9, {3.3996290041891265`*^9, 3.399629014861206*^9}, {
   3.399629553246543*^9, 3.3996295718250246`*^9}, {3.3996296199821997`*^9, 
   3.399629627982353*^9}, {3.3996299377383003`*^9, 3.3996299586293263`*^9}, {
   3.399630651845761*^9, 3.399630652267644*^9}, {3.399630683424492*^9, 
   3.399630732581686*^9}, {3.3996368382743225`*^9, 3.399636862696666*^9}, {
   3.3996369403544073`*^9, 3.3996370155902267`*^9}, {3.399638511993957*^9, 
   3.3996385145252557`*^9}, {3.399638662512472*^9, 3.3996387308419085`*^9}, {
   3.399639873270093*^9, 3.399639911755207*^9}, {3.3996399476308956`*^9, 
   3.399639949130924*^9}, {3.399640206870248*^9, 3.39964020722963*^9}, {
   3.3996403065284114`*^9, 3.399640370670268*^9}, {3.3996404343121147`*^9, 
   3.3996404655627146`*^9}, {3.399640569111578*^9, 3.3996406146124516`*^9}, 
   3.3996419118873587`*^9, {3.3996977702651625`*^9, 3.3996977800784793`*^9}, {
   3.3996978357862387`*^9, 3.39969785814712*^9}, {3.3997021850051827`*^9, 
   3.3997021878646126`*^9}, {3.3997022383187065`*^9, 
   3.3997022393812265`*^9}, {3.3997024471977167`*^9, 3.399702479870219*^9}, {
   3.3997025249023333`*^9, 3.399702579872139*^9}, {3.399702632310646*^9, 
   3.399702696077495*^9}, {3.399708684192465*^9, 3.3997086974583445`*^9}, {
   3.399709114325723*^9, 3.399709115419494*^9}, {3.3997093280798273`*^9, 
   3.3997093300954905`*^9}, {3.3997093998624554`*^9, 3.399709435738144*^9}, {
   3.3997094670043697`*^9, 3.399709470363809*^9}, {3.3997095033956933`*^9, 
   3.399709515770931*^9}, {3.3997095796627827`*^9, 3.3997095887410817`*^9}, {
   3.399709623116742*^9, 3.399709626460556*^9}, {3.399709680680347*^9, 
   3.3997097419940243`*^9}, {3.399709809651573*^9, 3.399709960966978*^9}, 
   3.3997100379059553`*^9, {3.399710080828655*^9, 3.3997101116729965`*^9}, {
   3.399710264597808*^9, 3.3997103284896593`*^9}, 3.3997109266573944`*^9, {
   3.399710968830079*^9, 3.3997109708457427`*^9}, {3.399718101248269*^9, 
   3.399718127295644*^9}, {3.3997182049690104`*^9, 3.3997182063440366`*^9}, {
   3.3997183227368965`*^9, 3.39971833359648*^9}, {3.3997184310202255`*^9, 
   3.399718438176613*^9}, {3.399720748611597*^9, 3.3997207837841473`*^9}, {
   3.4004157423178496`*^9, 3.4004157846155367`*^9}, {3.4027248177709384`*^9, 
   3.402724855256033*^9}, {3.402724923272964*^9, 3.402724923741723*^9}, {
   3.40272894424079*^9, 3.4027289580848055`*^9}, 3.402729284512948*^9, 
   3.404738442201537*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"HestonFourierTransform", "[", 
   RowBox[{
   "M_", ",", "\[Theta]_", ",", "\[Rho]_", ",", " ", "\[CapitalSigma]_", ",", 
    "\[Gamma]_", ",", "\[Beta]_", ",", "\[Tau]_"}], "]"}], ":=", 
  RowBox[{"HestonLaplaceTransform", "[", 
   RowBox[{
   "M", ",", "\[Theta]", ",", "\[Rho]", ",", " ", "\[CapitalSigma]", ",", 
    RowBox[{
     RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Gamma]"}], ",", "\[Beta]", ",", 
    "\[Tau]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.399613844866823*^9, 3.3996138769143133`*^9}, {
   3.3996144538628902`*^9, 3.399614456237936*^9}, 3.3997099958270226`*^9, {
   3.400415780834214*^9, 3.400415823100651*^9}, {3.4027248892254353`*^9, 
   3.4027248938974*^9}, {3.4047384345295143`*^9, 3.4047384374670706`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"GaussianHestonFondamentalTransform", "[", 
   RowBox[{
   "\[Rho]_", ",", "M_", ",", "\[CapitalSigma]inf_", ",", "Q_", ",", "V_", 
    ",", "\[Gamma]_", ",", "\[Tau]_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\[Zeta]", ",", "\[Psi]p", " ", ",", "\[Psi]m", ",", "A", ",", "B", ",", 
      "arg\[Zeta]"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"arg\[Zeta]", "=", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"M", "+", 
          RowBox[{
          "\[ImaginaryI]", " ", "\[Rho]", " ", "Q", " ", "\[Gamma]"}]}], 
         ")"}], "2"], "+", 
       RowBox[{
        SuperscriptBox["Q", "2"], 
        RowBox[{"(", " ", 
         SuperscriptBox["\[Gamma]", "2"], ")"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "[", "arg\[Zeta]", "]"}], "\[LessEqual]", 
        RowBox[{"10", "^", 
         RowBox[{"(", 
          RowBox[{"-", "200"}], ")"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"B", 
         StyleBox["=",
          FontWeight->"Plain"], 
         RowBox[{
          FractionBox[
           RowBox[{"(", " ", 
            RowBox[{"M", "+", 
             RowBox[{
             "\[ImaginaryI]", " ", "\[Rho]", " ", "\[Gamma]", " ", "Q"}]}], 
            ")"}], 
           SuperscriptBox["Q", "2"]], "-", 
          FractionBox[
           RowBox[{
            RowBox[{"(", " ", 
             RowBox[{"M", "-", 
              RowBox[{
              "\[ImaginaryI]", " ", "\[Rho]", " ", "\[Gamma]", " ", "Q"}]}], 
             ")"}], 
            SuperscriptBox["Q", "2"]}], 
           RowBox[{" ", 
            RowBox[{
             RowBox[{"\[Tau]", " ", 
              RowBox[{"(", " ", 
               RowBox[{"M", "+", 
                RowBox[{
                "\[ImaginaryI]", "  ", "\[Rho]", " ", "\[Gamma]", " ", 
                 "Q"}]}], ")"}]}], "+", 
             SuperscriptBox["Q", "4"]}]}]]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"A", "=", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"2", " ", 
            SuperscriptBox["Q", "2"]}]], 
          RowBox[{"(", 
           RowBox[{"\[CapitalSigma]inf", " ", "M", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "M", " ", "\[Tau]"}], "+", 
              RowBox[{
              "2", " ", "\[ImaginaryI]", " ", "Q", " ", "\[Rho]", " ", 
               "\[Tau]", " ", "\[Gamma]"}], "-", 
              RowBox[{"2", " ", "\[ImaginaryI]", " ", 
               SuperscriptBox["Q", "4"], " ", 
               RowBox[{"ArcTan", "[", 
                FractionBox[
                 RowBox[{"Q", " ", "\[Rho]", " ", "\[Tau]", " ", "\[Gamma]"}],
                  
                 RowBox[{
                  SuperscriptBox["Q", "4"], "+", 
                  RowBox[{"M", " ", "\[Tau]"}]}]], "]"}]}], "+", 
              RowBox[{
               SuperscriptBox["Q", "4"], " ", 
               RowBox[{"Log", "[", 
                FractionBox[
                 SuperscriptBox["Q", "8"], 
                 RowBox[{
                  SuperscriptBox["Q", "8"], "+", 
                  RowBox[{"2", " ", 
                   SuperscriptBox["Q", "4"], " ", "M", " ", "\[Tau]"}], "+", 
                  RowBox[{
                   SuperscriptBox["M", "2"], " ", 
                   SuperscriptBox["\[Tau]", "2"]}], "+", 
                  RowBox[{
                   SuperscriptBox["Q", "2"], " ", 
                   SuperscriptBox["\[Rho]", "2"], " ", 
                   SuperscriptBox["\[Tau]", "2"], " ", 
                   SuperscriptBox["\[Gamma]", "2"]}]}]], "]"}]}]}], ")"}]}], 
           ")"}]}]}], ";", "\[IndentingNewLine]", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"A", "+", 
          RowBox[{"B", " ", "V"}]}]]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Zeta]", "=", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"M", "+", 
              RowBox[{
              "\[ImaginaryI]", " ", "\[Rho]", " ", "Q", " ", "\[Gamma]"}]}], 
             ")"}], "2"], "+", 
           RowBox[{
            SuperscriptBox["Q", "2"], 
            RowBox[{"(", " ", 
             SuperscriptBox["\[Gamma]", "2"], ")"}]}]}]]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Psi]p", " ", "=", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{"M", "+", 
             RowBox[{
             "\[ImaginaryI]", " ", "\[Rho]", " ", "Q", "  ", "\[Gamma]"}]}], 
            ")"}]}], "+", "\[Zeta]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Psi]m", " ", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"M", "+", 
            RowBox[{
            "\[ImaginaryI]", " ", "\[Rho]", " ", "Q", "  ", "\[Gamma]"}]}], 
           ")"}], "+", "\[Zeta]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"A", "=", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{" ", 
            RowBox[{"\[CapitalSigma]inf", " ", "M", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[Tau]", " ", "\[Psi]p"}], "+", 
               RowBox[{"2", " ", 
                RowBox[{"Log", "[", 
                 FractionBox[
                  RowBox[{"\[Psi]m", "+", 
                   RowBox[{
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    RowBox[{"-", "\[Zeta]"}], " ", "\[Tau]"}]], " ", 
                    "\[Psi]p"}]}], 
                  RowBox[{"2", "\[Zeta]"}]], "]"}]}]}], ")"}]}]}], 
           RowBox[{" ", 
            SuperscriptBox["Q", "2"], "   "}]]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"B", "=", 
         FractionBox[
          RowBox[{" ", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", " ", 
              SuperscriptBox["\[Gamma]", "2"], ")"}]}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{
                RowBox[{"-", "\[Zeta]"}], "  ", "\[Tau]"}]]}], ")"}]}]}], 
          RowBox[{"\[Psi]m", "+", 
           RowBox[{"\[Psi]p", " ", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{
              RowBox[{"-", "\[Zeta]"}], "  ", "\[Tau]"}]]}]}]]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Re", "[", 
            RowBox[{"A", "+", 
             RowBox[{"B", " ", "V"}]}], "]"}], "<", 
           RowBox[{"-", "100"}]}], ",", "0", ",", "\[IndentingNewLine]", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"A", "+", 
            RowBox[{"B", " ", "V"}]}]]}], "]"}]}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.3990257101510024`*^9, 3.3990261225391984`*^9}, 
   3.399026344280669*^9, {3.3993508067036514`*^9, 3.399350814781932*^9}, {
   3.399613918461986*^9, 3.3996139412280483`*^9}, {3.399614412205841*^9, 
   3.399614425331093*^9}, {3.399616003502018*^9, 3.3996160115646725`*^9}, {
   3.3996226698956356`*^9, 3.399622709302642*^9}, {3.399622880915312*^9, 
   3.399622968495118*^9}, {3.399623004011425*^9, 3.399623040324622*^9}, {
   3.3996230706845803`*^9, 3.3996230721533585`*^9}, {3.3996979405258102`*^9, 
   3.39969794565104*^9}, 3.3997018868119574`*^9, 3.3997019499225445`*^9, {
   3.3997023179139843`*^9, 3.399702365008639*^9}, 3.399702716343509*^9, {
   3.3997090660122957`*^9, 3.3997090882939734`*^9}, {3.3997100996727667`*^9, 
   3.399710100282153*^9}, {3.4026611570033917`*^9, 3.4026611757850027`*^9}, 
   3.4027257338041506`*^9, {3.402728980163355*^9, 3.4027289869447346`*^9}, 
   3.402729291684961*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"M", "=", 
      RowBox[{"-", "0.01"}]}], ",", 
     RowBox[{"\[Theta]", "=", "0.1"}], ",", 
     RowBox[{"\[Rho]", "=", "0.5"}], ",", " ", 
     RowBox[{"\[CapitalSigma]", "=", "0.15"}], ",", 
     RowBox[{"\[Gamma]", "=", "1"}], ",", 
     RowBox[{"Q", "=", "2"}], ",", 
     RowBox[{"\[Tau]", "=", "10"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"HestonFourierTransform", "[", 
      RowBox[{
      "M", ",", "\[Theta]", ",", "\[Rho]", ",", " ", "\[CapitalSigma]", ",", 
       "\[Gamma]", ",", "Q", ",", "\[Tau]"}], "]"}], ",", 
     RowBox[{"GaussianHestonFondamentalTransform", "[", 
      RowBox[{"\[Rho]", ",", 
       RowBox[{"-", "M"}], ",", "\[Theta]", ",", " ", "Q", ",", 
       "\[CapitalSigma]", ",", "\[Gamma]", ",", "\[Tau]"}], "]"}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.3996139796975365`*^9, 3.399614149653925*^9}, {
   3.3996142037955894`*^9, 3.399614208701934*^9}, {3.399614241624441*^9, 
   3.3996142421557007`*^9}, {3.399614274859454*^9, 3.3996142761407285`*^9}, {
   3.3996144390188556`*^9, 3.399614444659589*^9}, {3.3997035627191343`*^9, 
   3.3997035732505865`*^9}, {3.399709023620857*^9, 3.399709029683473*^9}, 
   3.400415800318963*^9, {3.402724696581112*^9, 3.4027247227378635`*^9}, {
   3.4027248662093687`*^9, 3.4027248698188124`*^9}, 3.40473845043607*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.9329604483499689`", "\[InvisibleSpace]", "+", 
    RowBox[{"0.0368794634801369`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0.9329604483499689`", "\[InvisibleSpace]", "+", 
    RowBox[{"0.03687946348013688`", " ", "\[ImaginaryI]"}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.399614122950287*^9, {3.399614158060336*^9, 3.399614183967084*^9}, 
   3.399614279781423*^9, {3.3996144459877396`*^9, 3.3996144599098816`*^9}, {
   3.3996146892736607`*^9, 3.399614731743226*^9}, 3.3996159833141303`*^9, 
   3.399616025814946*^9, 3.399616473229787*^9, 3.399616582388132*^9, 
   3.399617663080756*^9, {3.3996177174411755`*^9, 3.3996177474730015`*^9}, 
   3.3996178181774845`*^9, 3.3996179223669844`*^9, 3.3996179591801915`*^9, {
   3.3996227190528293`*^9, 3.399622797163704*^9}, 3.399622978526561*^9, 
   3.3996230293869123`*^9, 3.3996230777159653`*^9, {3.399623127654424*^9, 
   3.39962318498365*^9}, 3.3996232211718445`*^9, 3.399623501661605*^9, 
   3.399623934529291*^9, 3.3996239812020617`*^9, 3.3997020654403872`*^9, 
   3.3997027366563993`*^9, {3.399703563953533*^9, 3.3997035742506056`*^9}, 
   3.3997087039115934`*^9, 3.3997090340273066`*^9, {3.3997090756531057`*^9, 
   3.3997091266384597`*^9}, 3.3997103520526123`*^9, 3.399710929251194*^9, {
   3.399799908616206*^9, 3.3997999124444046`*^9}, 3.400415758693164*^9, {
   3.40041580667846*^9, 3.400415826553842*^9}, 3.4027245445469427`*^9, 
   3.4027245927197423`*^9, 3.4027247239722624`*^9, 3.4027248985537395`*^9, 
   3.402724932257511*^9, 3.402728991944831*^9, 3.4047384524829845`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Log normale spreadoption (pour comparaison)", "Section",
 CellChangeTimes->{{3.40040597105212*^9, 3.4004059836148615`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"phi", "[", "x_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Exp", "[", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"x", "^", "2"}]}], "/", "2"}], "]"}], "/", 
   RowBox[{"Sqrt", "[", 
    RowBox[{"2", "Pi"}], "]"}]}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"Nd", "[", "x_", "]"}], ":=", 
  FractionBox[
   RowBox[{
    RowBox[{"Erf", "[", 
     FractionBox["x", 
      SqrtBox["2"]], "]"}], "+", "1"}], "2"]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"LogNormalSpreadDigitaleCall", "[", 
   RowBox[{
   "S1_", ",", "S2_", ",", "sig1_", ",", "sig2_", ",", "rho_", ",", "k_", ",",
     "t_"}], "]"}], ":=", 
  RowBox[{"NIntegrate", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"phi", "[", "x", "]"}], 
     RowBox[{"Nd", "[", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Log", "[", 
           FractionBox[
            RowBox[{"(", 
             RowBox[{"k", "+", 
              RowBox[{"S2", " ", 
               SuperscriptBox["E", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "1"}], "/", "2"}], " ", 
                  RowBox[{"sig2", "^", "2"}], " ", "t"}], "+", 
                 RowBox[{"sig2", " ", 
                  RowBox[{"Sqrt", "[", "t", "]"}], " ", "x"}]}]]}]}], ")"}], 
            RowBox[{"(", 
             RowBox[{"S1", " ", 
              SuperscriptBox["E", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "1"}], "/", "2"}], " ", 
                RowBox[{"sig1", "^", "2"}], " ", "t"}]]}], ")"}]], "]"}], "-",
           
          RowBox[{"rho", " ", "sig1", " ", 
           RowBox[{"Sqrt", "[", "t", "]"}], " ", "x"}]}], ")"}]}], "/", 
       RowBox[{"(", 
        RowBox[{
         SqrtBox[
          RowBox[{"1", "-", 
           SuperscriptBox["rho", "2"]}]], " ", "sig1", " ", 
         SqrtBox["t"]}], ")"}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"-", "Infinity"}], ",", 
      RowBox[{"-", "1"}], ",", 
      RowBox[{"+", "Infinity"}]}], "}"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4003357420318737`*^9, 3.4003357427975135`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MesureQTLogNormalSpreadDigitale", "[", 
   RowBox[{
   "S1_", ",", "S2_", ",", "sig1_", ",", "sig2_", ",", "rho_", ",", "k_", ",",
     "t_"}], "]"}], ":=", 
  RowBox[{"LogNormalSpreadDigitaleCall", "[", 
   RowBox[{
   "S1", " ", ",", "S2", " ", ",", "sig1", ",", "sig2", ",", "rho", ",", "k", 
    ",", "t"}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"MesureQ1LogNormalSpreadDigitale", "[", 
   RowBox[{
   "S1_", ",", "S2_", ",", "sig1_", ",", "sig2_", ",", "rho_", ",", "k_", ",",
     "t_"}], "]"}], ":=", 
  RowBox[{"LogNormalSpreadDigitaleCall", "[", 
   RowBox[{
    RowBox[{"S1", " ", 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"sig1", "^", "2"}], " ", "t"}], "]"}]}], ",", 
    RowBox[{"S2", " ", 
     RowBox[{"Exp", "[", 
      RowBox[{"rho", " ", "sig1", " ", "sig2", " ", "t"}], "]"}]}], ",", 
    "sig1", ",", "sig2", ",", "rho", ",", "k", ",", "t"}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"MesureQ2LogNormalSpreadDigitale", "[", 
   RowBox[{
   "S1_", ",", "S2_", ",", "sig1_", ",", "sig2_", ",", "rho_", ",", "k_", ",",
     "t_"}], "]"}], ":=", 
  RowBox[{"LogNormalSpreadDigitaleCall", "[", 
   RowBox[{
    RowBox[{"S1", " ", 
     RowBox[{"Exp", "[", 
      RowBox[{"rho", " ", "sig1", " ", "sig2", " ", "t"}], "]"}]}], ",", 
    RowBox[{"S2", " ", 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"sig2", "^", "2"}], " ", "t"}], "]"}]}], ",", "sig1", ",", 
    "sig2", ",", "rho", ",", "k", ",", "t"}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"LogNormalSpreadOptionAux", "[", 
   RowBox[{
   "S1_", ",", "S2_", ",", "sig1_", ",", "sig2_", ",", "rho_", ",", "k_", ",",
     "t_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"S1", " ", 
    RowBox[{"MesureQ1LogNormalSpreadDigitale", "[", 
     RowBox[{
     "S1", ",", "S2", ",", "sig1", ",", "sig2", ",", "rho", ",", "k", ",", 
      "t"}], "]"}]}], "-", 
   RowBox[{"S2", " ", 
    RowBox[{"MesureQ2LogNormalSpreadDigitale", "[", 
     RowBox[{
     "S1", ",", "S2", ",", "sig1", ",", "sig2", ",", "rho", ",", "k", ",", 
      "t"}], "]"}]}], "-", 
   RowBox[{"k", " ", 
    RowBox[{"MesureQTLogNormalSpreadDigitale", "[", 
     RowBox[{
     "S1", ",", "S2", ",", "sig1", ",", "sig2", ",", "rho", ",", "k", ",", 
      "t"}], "]"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4011115678997006`*^9, 3.4011115691966004`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"LogNormalSpreadOption", "[", 
   RowBox[{
   "S1_", ",", "S2_", ",", "sig1_", ",", "sig2_", ",", "rho_", ",", "k_", ",",
     "t_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"LogNormalSpreadOptionAux", "[", 
    RowBox[{
    "S1", ",", "S2", ",", "sig1", ",", "sig2", ",", "rho", ",", "k", ",", 
     "t"}], "]"}], " ", "/;", " ", 
   RowBox[{"k", "\[GreaterEqual]", "0"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.40111158322812*^9, 3.4011116234632673`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"LogNormalSpreadOption", "[", 
   RowBox[{
   "S1_", ",", "S2_", ",", "sig1_", ",", "sig2_", ",", "rho_", ",", "k_", ",",
     "t_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"S1", "-", "S2", "-", "k", "+", 
    RowBox[{"LogNormalSpreadOptionAux", "[", 
     RowBox[{"S2", ",", "S1", ",", "sig2", ",", "sig1", ",", "rho", ",", 
      RowBox[{"-", "k"}], ",", "t"}], "]"}]}], " ", "/;", " ", 
   RowBox[{"k", "<", "0"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4011116369791517`*^9, 3.4011116628858995`*^9}, {
  3.4011117218401566`*^9, 3.401111725699605*^9}, {3.4020601988731766`*^9, 
  3.4020602020451126`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"S1", "=", "0.05"}], ",", 
     RowBox[{"S2", "=", "0.05"}], ",", 
     RowBox[{"sig1", "=", "0.2"}], ",", 
     RowBox[{"sig2", "=", "0.3"}], ",", 
     RowBox[{"\[Rho]", "=", "0.8"}], ",", 
     RowBox[{"k", "=", "0.01"}], ",", 
     RowBox[{"t", "=", "10"}]}], "}"}], ",", 
   RowBox[{"LogNormalSpreadOption", "[", 
    RowBox[{
    "S1", ",", "S2", ",", "sig1", ",", "sig2", ",", "\[Rho]", ",", "k", ",", 
     "t"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.400335412775552*^9, {3.402059354544466*^9, 3.402059360638333*^9}}],

Cell[BoxData["0.005961714010313871`"], "Output",
 CellChangeTimes->{3.402059362091486*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"S1", "=", "0.05"}], ",", 
     RowBox[{"S2", "=", "0.05"}], ",", 
     RowBox[{"sig1", "=", "0.2"}], ",", 
     RowBox[{"sig2", "=", "0.2"}], ",", 
     RowBox[{"k1", "=", "0.001"}], ",", 
     RowBox[{"k2", "=", "0.01"}], ",", 
     RowBox[{"k3", "=", "0.03"}], ",", 
     RowBox[{"t", "=", "5"}], ",", 
     RowBox[{"\[Rho]", "=", "0.6"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"LogNormalSpreadOption", "[", 
      RowBox[{
      "S1", ",", "S2", ",", "sig1", ",", "sig2", ",", "\[Rho]", ",", "k1", 
       ",", "t"}], "]"}], ",", 
     RowBox[{"LogNormalSpreadOption", "[", 
      RowBox[{
      "S1", ",", "S2", ",", "sig1", ",", "sig2", ",", "\[Rho]", ",", "k2", 
       ",", "t"}], "]"}], ",", 
     RowBox[{"LogNormalSpreadOption", "[", 
      RowBox[{
      "S1", ",", "S2", ",", "sig1", ",", "sig2", ",", "\[Rho]", ",", "k3", 
       ",", "t"}], "]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.400335412775552*^9, {3.4003354580576715`*^9, 3.4003354896207776`*^9}, {
   3.400335539012351*^9, 3.400335539449859*^9}, {3.4003356720305295`*^9, 
   3.4003356773743825`*^9}, {3.4003357281097317`*^9, 3.40033574939139*^9}, {
   3.4003358582997313`*^9, 3.4003359739113255`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.0074379067323406475`", ",", "0.004066131566916034`", ",", 
   "0.0010050437746842939`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.4003354916051903`*^9, 3.4003355414967737`*^9, 3.4003356842495146`*^9, {
   3.4003357304535265`*^9, 3.400335756219646*^9}, {3.4003359436294947`*^9, 
   3.400335974864469*^9}, 3.400503967594413*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{908, 864},
WindowMargins->{{Automatic, 0}, {Automatic, 5}},
FrontEndVersion->"6.0 for Microsoft Windows (32-bit) (June 19, 2007)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[568, 21, 173, 4, 31, "Input",
 InitializationCell->True],
Cell[744, 27, 225, 5, 31, "Input",
 InitializationCell->True],
Cell[972, 34, 104, 2, 31, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[1101, 40, 179, 2, 83, "Title"],
Cell[1283, 44, 100, 1, 49, "Subtitle"],
Cell[1386, 47, 1658, 31, 281, "Text"],
Cell[CellGroupData[{
Cell[3069, 82, 140, 2, 49, "Subtitle"],
Cell[3212, 86, 101, 1, 28, "Subsubtitle"],
Cell[3316, 89, 742, 13, 155, "Text"],
Cell[CellGroupData[{
Cell[4083, 106, 211, 3, 28, "Subsubtitle"],
Cell[4297, 111, 1114, 33, 36, "Text"],
Cell[5414, 146, 217, 4, 29, "Text"],
Cell[5634, 152, 531, 14, 29, "Text"],
Cell[6168, 168, 240, 3, 29, "Text"],
Cell[6411, 173, 242, 3, 29, "Text"],
Cell[6656, 178, 68, 1, 31, "Input"],
Cell[6727, 181, 377, 10, 29, "Text"],
Cell[7107, 193, 1188, 36, 55, "Text"],
Cell[8298, 231, 143, 2, 29, "Text"],
Cell[8444, 235, 1146, 33, 77, "Text"],
Cell[9595, 271, 305, 4, 29, "Text"],
Cell[9903, 277, 430, 11, 53, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10370, 293, 171, 2, 28, "Subsubtitle"],
Cell[10544, 297, 726, 21, 55, "Text"],
Cell[11273, 320, 631, 16, 42, "Text"],
Cell[11907, 338, 479, 13, 42, "Text"],
Cell[12389, 353, 554, 15, 42, "Text"],
Cell[12946, 370, 526, 13, 87, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13509, 388, 209, 3, 28, "Subsubtitle"],
Cell[13721, 393, 677, 18, 47, "Text"],
Cell[14401, 413, 485, 12, 29, "Text"],
Cell[14889, 427, 94, 1, 31, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15020, 433, 180, 2, 28, "Subsubtitle"],
Cell[15203, 437, 928, 28, 38, "Text"],
Cell[16134, 467, 481, 11, 29, "Text"],
Cell[16618, 480, 486, 9, 29, "Text"],
Cell[17107, 491, 649, 21, 42, "Text"],
Cell[17759, 514, 136, 2, 29, "Text"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[17944, 522, 147, 2, 49, "Subtitle"],
Cell[18094, 526, 172, 2, 29, "Text"],
Cell[18269, 530, 177, 4, 31, "Text"],
Cell[CellGroupData[{
Cell[18471, 538, 279, 3, 28, "Subsubtitle"],
Cell[18753, 543, 1786, 49, 29, "Text"],
Cell[20542, 594, 1215, 38, 29, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21794, 637, 333, 4, 28, "Subsubtitle"],
Cell[22130, 643, 761, 19, 31, "Text"],
Cell[22894, 664, 268, 7, 31, "Text"],
Cell[23165, 673, 286, 9, 29, "Text"],
Cell[23454, 684, 601, 16, 31, "Text"],
Cell[24058, 702, 820, 24, 29, "Text"],
Cell[24881, 728, 91, 1, 29, "Text"],
Cell[24975, 731, 2523, 85, 106, "Text"],
Cell[27501, 818, 1510, 50, 49, "Text"],
Cell[29014, 870, 1309, 40, 87, "Text"],
Cell[30326, 912, 1013, 32, 87, "Text"],
Cell[31342, 946, 924, 31, 32, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32303, 982, 424, 7, 28, "Subsubtitle"],
Cell[32730, 991, 2514, 84, 87, "Text"],
Cell[CellGroupData[{
Cell[35269, 1079, 261, 3, 28, "Subsubsection"],
Cell[35533, 1084, 601, 13, 29, "Text"],
Cell[36137, 1099, 101, 1, 29, "Text"],
Cell[36241, 1102, 612, 19, 29, "Text"],
Cell[36856, 1123, 875, 20, 49, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37768, 1148, 105, 1, 28, "Subsubsection"],
Cell[37876, 1151, 88, 1, 29, "Text"],
Cell[37967, 1154, 2840, 94, 106, "Text"],
Cell[40810, 1250, 891, 27, 87, "Text"],
Cell[41704, 1279, 1115, 36, 49, "Text"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[42868, 1321, 183, 2, 28, "Subsubtitle"],
Cell[43054, 1325, 358, 11, 31, "Text"],
Cell[43415, 1338, 362, 11, 31, "Text"],
Cell[43780, 1351, 118, 1, 29, "Text"],
Cell[43901, 1354, 257, 7, 29, "Text"],
Cell[44161, 1363, 124, 1, 29, "Text"],
Cell[44288, 1366, 303, 8, 29, "Text"],
Cell[44594, 1376, 380, 11, 29, "Text"],
Cell[44977, 1389, 94, 1, 29, "Text"],
Cell[45074, 1392, 814, 27, 78, "Text"],
Cell[45891, 1421, 561, 19, 85, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[46489, 1445, 182, 2, 28, "Subsubtitle"],
Cell[46674, 1449, 89, 1, 29, "Text"],
Cell[CellGroupData[{
Cell[46788, 1454, 126, 1, 28, "Subsubsection"],
Cell[46917, 1457, 468, 14, 32, "Text"],
Cell[47388, 1473, 854, 25, 32, "Text"],
Cell[48245, 1500, 367, 8, 29, "Text"],
Cell[48615, 1510, 905, 26, 32, "Text"],
Cell[49523, 1538, 418, 9, 29, "Text"],
Cell[49944, 1549, 181, 2, 29, "Text"],
Cell[50128, 1553, 532, 16, 32, "Text"],
Cell[50663, 1571, 256, 7, 29, "Text"],
Cell[50922, 1580, 97, 1, 31, "Input"],
Cell[51022, 1583, 582, 17, 32, "Text"],
Cell[51607, 1602, 100, 1, 31, "Input"],
Cell[51710, 1605, 548, 17, 51, "Text"],
Cell[52261, 1624, 123, 2, 31, "Input"],
Cell[52387, 1628, 548, 17, 51, "Text"],
Cell[52938, 1647, 262, 7, 29, "Text"],
Cell[53203, 1656, 293, 6, 29, "Text"],
Cell[53499, 1664, 104, 1, 29, "Text"],
Cell[53606, 1667, 288, 5, 31, "Input"],
Cell[53897, 1674, 1341, 41, 81, "Text"],
Cell[55241, 1717, 220, 3, 31, "Input"],
Cell[55464, 1722, 378, 6, 31, "Input"],
Cell[55845, 1730, 532, 16, 32, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[56414, 1751, 244, 7, 28, "Subsubsection"],
Cell[56661, 1760, 778, 22, 29, "Text"],
Cell[57442, 1784, 297, 7, 29, "Text"],
Cell[57742, 1793, 91, 1, 29, "Text"],
Cell[57836, 1796, 236, 7, 29, "Text"],
Cell[58075, 1805, 580, 17, 46, "Text"],
Cell[58658, 1824, 90, 1, 29, "Text"],
Cell[58751, 1827, 288, 8, 29, "Text"],
Cell[59042, 1837, 629, 18, 46, "Text"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[59732, 1862, 111, 1, 49, "Subtitle"],
Cell[59846, 1865, 111, 1, 29, "Text"],
Cell[CellGroupData[{
Cell[59982, 1870, 145, 1, 28, "Subsubtitle"],
Cell[60130, 1873, 158, 3, 29, "Text"],
Cell[60291, 1878, 508, 10, 65, "Text"],
Cell[60802, 1890, 325, 10, 29, "Text"],
Cell[61130, 1902, 497, 11, 29, "Text"],
Cell[61630, 1915, 243, 5, 29, "Text"],
Cell[61876, 1922, 441, 12, 29, "Text"],
Cell[62320, 1936, 86, 1, 29, "Text"],
Cell[62409, 1939, 496, 13, 29, "Text"],
Cell[62908, 1954, 120, 1, 29, "Text"],
Cell[63031, 1957, 320, 8, 29, "Text"],
Cell[63354, 1967, 727, 23, 59, "Text"],
Cell[64084, 1992, 183, 3, 29, "Text"],
Cell[64270, 1997, 1081, 33, 46, "Text"],
Cell[65354, 2032, 416, 10, 29, "Text"],
Cell[65773, 2044, 782, 24, 59, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[66592, 2073, 128, 1, 28, "Subsubtitle"],
Cell[66723, 2076, 168, 4, 47, "Text"],
Cell[66894, 2082, 537, 19, 47, "Text"],
Cell[67434, 2103, 87, 1, 29, "Text"],
Cell[67524, 2106, 537, 19, 47, "Text"],
Cell[68064, 2127, 144, 3, 29, "Text"],
Cell[68211, 2132, 869, 27, 49, "Text"],
Cell[69083, 2161, 1229, 41, 29, "Text"],
Cell[70315, 2204, 290, 7, 29, "Text"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[70654, 2217, 99, 1, 49, "Subtitle"],
Cell[70756, 2220, 903, 30, 36, "Text"],
Cell[71662, 2252, 221, 8, 31, "Text"],
Cell[71886, 2262, 514, 13, 29, "Text"],
Cell[72403, 2277, 89, 1, 29, "Text"],
Cell[72495, 2280, 1236, 42, 44, "Text"],
Cell[73734, 2324, 1555, 49, 63, "Text"],
Cell[75292, 2375, 85, 1, 29, "Text"],
Cell[75380, 2378, 1008, 34, 42, "Text"],
Cell[76391, 2414, 870, 26, 42, "Text"],
Cell[77264, 2442, 1765, 47, 45, "Text"],
Cell[79032, 2491, 505, 16, 42, "Text"],
Cell[79540, 2509, 947, 27, 42, "Text"],
Cell[80490, 2538, 143, 3, 29, "Text"],
Cell[80636, 2543, 575, 19, 42, "Text"],
Cell[81214, 2564, 1040, 28, 47, "Text"],
Cell[82257, 2594, 119, 1, 29, "Text"],
Cell[82379, 2597, 1315, 44, 63, "Text"],
Cell[83697, 2643, 95, 1, 29, "Text"],
Cell[83795, 2646, 192, 5, 29, "Text"],
Cell[83990, 2653, 88, 1, 29, "Text"],
Cell[84081, 2656, 1884, 62, 75, "Text"],
Cell[85968, 2720, 136, 4, 47, "Text"],
Cell[86107, 2726, 406, 14, 42, "Text"],
Cell[86516, 2742, 1600, 54, 69, "Text"],
Cell[88119, 2798, 87, 1, 29, "Text"],
Cell[88209, 2801, 443, 16, 47, "Text"],
Cell[88655, 2819, 426, 14, 42, "Text"],
Cell[89084, 2835, 260, 9, 42, "Text"],
Cell[89347, 2846, 158, 4, 47, "Text"],
Cell[89508, 2852, 1381, 45, 44, "Text"],
Cell[90892, 2899, 359, 11, 42, "Text"],
Cell[91254, 2912, 923, 31, 45, "Text"],
Cell[92180, 2945, 1381, 45, 44, "Text"],
Cell[93564, 2992, 644, 17, 29, "Text"],
Cell[94211, 3011, 120, 1, 29, "Text"],
Cell[94334, 3014, 443, 16, 47, "Text"],
Cell[94780, 3032, 426, 14, 42, "Text"],
Cell[95209, 3048, 260, 9, 42, "Text"],
Cell[95472, 3059, 360, 12, 42, "Text"],
Cell[95835, 3073, 143, 2, 29, "Text"],
Cell[95981, 3077, 478, 13, 29, "Text"],
Cell[96462, 3092, 392, 8, 29, "Text"],
Cell[96857, 3102, 1608, 47, 83, "Text"],
Cell[98468, 3151, 496, 10, 29, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[99001, 3166, 99, 1, 49, "Subtitle"],
Cell[99103, 3169, 203, 5, 47, "Text"],
Cell[99309, 3176, 10435, 240, 417, "Input",
 InitializationCell->True],
Cell[109749, 3419, 10306, 238, 417, "Input",
 InitializationCell->True],
Cell[120058, 3659, 14887, 330, 423, "Input",
 InitializationCell->True],
Cell[134948, 3991, 9310, 254, 423, "Input",
 InitializationCell->True],
Cell[144261, 4247, 493, 13, 29, "Text"],
Cell[144757, 4262, 17691, 398, 562, "Input",
 InitializationCell->True],
Cell[162451, 4662, 218, 4, 29, "Text"],
Cell[162672, 4668, 12130, 322, 562, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[174827, 4994, 5399, 141, 362, "Input"],
Cell[180229, 5137, 531, 10, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[180797, 5152, 154, 2, 71, "Section"],
Cell[180954, 5156, 1015, 29, 49, "Input"],
Cell[181972, 5187, 496, 11, 31, "Input"],
Cell[CellGroupData[{
Cell[182493, 5202, 1686, 40, 62, "Input"],
Cell[184182, 5244, 858, 18, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[185077, 5267, 2232, 55, 61, "Input"],
Cell[187312, 5324, 2102, 52, 68, "Output"]
}, Open  ]],
Cell[189429, 5379, 942, 29, 60, "Input"],
Cell[190374, 5410, 524, 11, 52, "Input"],
Cell[190901, 5423, 335, 9, 42, "Input"],
Cell[191239, 5434, 1953, 67, 73, "Input"],
Cell[193195, 5503, 531, 17, 51, "Input"],
Cell[CellGroupData[{
Cell[193751, 5524, 190, 6, 42, "Input"],
Cell[193944, 5532, 243, 7, 30, "Output"]
}, Open  ]],
Cell[194202, 5542, 189, 6, 42, "Input"],
Cell[CellGroupData[{
Cell[194416, 5552, 244, 4, 31, "Input"],
Cell[194663, 5558, 6617, 181, 252, "Output"]
}, Open  ]],
Cell[201295, 5742, 1103, 34, 52, "Input"],
Cell[202401, 5778, 1036, 32, 53, "Input"],
Cell[203440, 5812, 1960, 58, 99, "Input"],
Cell[CellGroupData[{
Cell[205425, 5874, 808, 16, 31, "Input"],
Cell[206236, 5892, 337, 9, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[206610, 5906, 734, 17, 31, "Input"],
Cell[207347, 5925, 7282, 202, 295, "Output"]
}, Open  ]],
Cell[214644, 6130, 1252, 30, 152, "Input"],
Cell[215899, 6162, 2584, 77, 116, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[218508, 6243, 175, 4, 31, "Input"],
Cell[218686, 6249, 147, 1, 30, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[218882, 6256, 105, 1, 71, "Section"],
Cell[218990, 6259, 5136, 142, 262, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[224151, 6405, 496, 12, 31, "Input"],
Cell[224650, 6419, 690, 13, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[225377, 6437, 132, 2, 31, "Input"],
Cell[225512, 6441, 466, 11, 30, "Output"]
}, Open  ]],
Cell[225993, 6455, 130, 1, 29, "Text"],
Cell[226126, 6458, 892, 23, 72, "Input",
 InitializationCell->True],
Cell[227021, 6483, 290, 7, 31, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[227348, 6495, 119, 1, 71, "Section"],
Cell[227470, 6498, 232, 4, 29, "Text"],
Cell[227705, 6504, 1321, 39, 106, "Input"],
Cell[229029, 6545, 98, 1, 29, "Text"],
Cell[CellGroupData[{
Cell[229152, 6550, 1261, 38, 106, "Input"],
Cell[230416, 6590, 1141, 31, 54, "Output"]
}, Open  ]],
Cell[231572, 6624, 1222, 32, 32, "Text"],
Cell[CellGroupData[{
Cell[232819, 6660, 1195, 31, 33, "Input"],
Cell[234017, 6693, 496, 8, 27, "Message"],
Cell[234516, 6703, 1042, 28, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[235595, 6736, 1128, 30, 33, "Input"],
Cell[236726, 6768, 474, 8, 27, "Message"]
}, Open  ]],
Cell[CellGroupData[{
Cell[237237, 6781, 228, 7, 31, "Input"],
Cell[237468, 6790, 707, 19, 54, "Output"]
}, Open  ]],
Cell[238190, 6812, 1025, 26, 48, "Text"],
Cell[239218, 6840, 87, 1, 29, "Text"],
Cell[239308, 6843, 284, 7, 31, "Text"],
Cell[CellGroupData[{
Cell[239617, 6854, 461, 12, 31, "Input"],
Cell[240081, 6868, 1143, 29, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[241261, 6902, 1356, 36, 52, "Input"],
Cell[242620, 6940, 508, 8, 27, "Message"],
Cell[243131, 6950, 508, 8, 27, "Message"],
Cell[243642, 6960, 358, 9, 45, "Output"]
}, Open  ]],
Cell[244015, 6972, 3001, 77, 86, "Text"],
Cell[247019, 7051, 296, 7, 31, "Text"],
Cell[247318, 7060, 375, 9, 31, "Input"],
Cell[247696, 7071, 211, 5, 31, "Input"],
Cell[CellGroupData[{
Cell[247932, 7080, 3235, 94, 107, "Input"],
Cell[251170, 7176, 797, 23, 52, "Output"]
}, Open  ]],
Cell[251982, 7202, 94, 1, 31, "Input"],
Cell[252079, 7205, 323, 6, 31, "Input"],
Cell[252405, 7213, 752, 20, 52, "Input",
 InitializationCell->True],
Cell[253160, 7235, 886, 22, 52, "Input",
 InitializationCell->True],
Cell[254049, 7259, 1173, 30, 54, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[255259, 7294, 138, 1, 28, "Subsubtitle"],
Cell[255400, 7297, 179, 3, 31, "Input"],
Cell[CellGroupData[{
Cell[255604, 7304, 1617, 43, 72, "Input"],
Cell[257224, 7349, 11677, 330, 485, "Output"]
}, Open  ]],
Cell[268916, 7682, 161, 3, 29, "Text"],
Cell[269080, 7687, 26865, 659, 1239, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[295970, 8350, 800, 20, 52, "Input"],
Cell[CellGroupData[{
Cell[296795, 8374, 550, 14, 23, "Print"],
Cell[297348, 8390, 799, 23, 23, "Print"]
}, Open  ]],
Cell[298162, 8416, 464, 12, 30, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[298675, 8434, 183, 4, 28, "Subsubtitle"],
Cell[CellGroupData[{
Cell[298883, 8442, 351, 9, 31, "Input"],
Cell[299237, 8453, 282, 8, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[299556, 8466, 274, 8, 31, "Input"],
Cell[299833, 8476, 221, 7, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[300091, 8488, 273, 7, 31, "Input"],
Cell[300367, 8497, 1042, 28, 30, "Output"]
}, Open  ]],
Cell[301424, 8528, 298, 9, 31, "Input"],
Cell[CellGroupData[{
Cell[301747, 8541, 155, 3, 31, "Input"],
Cell[301905, 8546, 561, 19, 33, "Output"]
}, Open  ]],
Cell[302481, 8568, 5088, 132, 366, "Input",
 InitializationCell->True],
Cell[307572, 8702, 192, 5, 47, "Text"],
Cell[CellGroupData[{
Cell[307789, 8711, 1893, 41, 112, "Input"],
Cell[CellGroupData[{
Cell[309709, 8757, 644, 12, 23, "Print"],
Cell[310356, 8771, 644, 12, 23, "Print"],
Cell[311003, 8785, 560, 12, 23, "Print"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[311636, 8805, 191, 2, 49, "Subtitle"],
Cell[311830, 8809, 231, 3, 29, "Text"],
Cell[312064, 8814, 1486, 40, 45, "Text"],
Cell[313553, 8856, 166, 2, 29, "Text"],
Cell[313722, 8860, 1084, 35, 59, "Text"],
Cell[314809, 8897, 2372, 62, 87, "Text"],
Cell[317184, 8961, 135, 1, 29, "Text"],
Cell[317322, 8964, 459, 11, 47, "Text"],
Cell[317784, 8977, 362, 9, 29, "Text"],
Cell[318149, 8988, 419, 9, 29, "Text"],
Cell[318571, 8999, 1038, 27, 31, "Text"],
Cell[319612, 9028, 114, 1, 29, "Text"],
Cell[319729, 9031, 1856, 53, 73, "Text"],
Cell[321588, 9086, 173, 4, 29, "Text"],
Cell[CellGroupData[{
Cell[321786, 9094, 108, 1, 71, "Section"],
Cell[321897, 9097, 620, 14, 29, "Text"],
Cell[322520, 9113, 118, 2, 31, "Input"],
Cell[322641, 9117, 968, 23, 49, "Text"],
Cell[323612, 9142, 248, 3, 29, "Text"],
Cell[323863, 9147, 647, 10, 29, "Text"],
Cell[324513, 9159, 209, 3, 29, "Text"],
Cell[324725, 9164, 373, 5, 29, "Text"],
Cell[325101, 9171, 192, 5, 47, "Text"],
Cell[325296, 9178, 443, 5, 29, "Text"],
Cell[325742, 9185, 775, 20, 42, "Text"],
Cell[326520, 9207, 167, 3, 29, "Text"],
Cell[CellGroupData[{
Cell[326712, 9214, 159, 2, 36, "Subsection"],
Cell[326874, 9218, 342, 11, 42, "Text"],
Cell[327219, 9231, 163, 2, 29, "Text"],
Cell[327385, 9235, 810, 24, 45, "Text"],
Cell[328198, 9261, 182, 2, 29, "Text"],
Cell[328383, 9265, 520, 16, 42, "Text"],
Cell[328906, 9283, 636, 22, 62, "Text"],
Cell[329545, 9307, 1008, 36, 62, "Text"],
Cell[330556, 9345, 119, 1, 29, "Text"],
Cell[330678, 9348, 68, 1, 29, "Text"],
Cell[330749, 9351, 185, 5, 29, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[330971, 9361, 210, 3, 36, "Subsection"],
Cell[331184, 9366, 333, 9, 32, "Text"],
Cell[331520, 9377, 135, 2, 29, "Text"],
Cell[331658, 9381, 909, 25, 45, "Text"],
Cell[332570, 9408, 796, 23, 45, "Text"],
Cell[333369, 9433, 778, 24, 45, "Text"],
Cell[334150, 9459, 143, 2, 29, "Text"],
Cell[334296, 9463, 587, 19, 45, "Text"],
Cell[334886, 9484, 153, 2, 29, "Text"],
Cell[335042, 9488, 796, 26, 45, "Text"],
Cell[335841, 9516, 138, 2, 29, "Text"],
Cell[335982, 9520, 723, 20, 45, "Text"],
Cell[336710, 9543, 157, 2, 29, "Text"],
Cell[336870, 9547, 619, 18, 45, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[337526, 9570, 273, 3, 36, "Subsection"],
Cell[337804, 9576, 495, 12, 29, "Text"],
Cell[338304, 9591, 796, 26, 45, "Text"],
Cell[339103, 9619, 1114, 30, 45, "Text"],
Cell[340220, 9651, 108, 1, 29, "Text"],
Cell[340331, 9654, 827, 25, 45, "Text"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[341207, 9685, 131, 1, 71, "Section"],
Cell[341341, 9688, 1067, 33, 52, "Input"],
Cell[CellGroupData[{
Cell[342433, 9725, 2387, 67, 153, "Input"],
Cell[344823, 9794, 3668, 109, 154, "Output"]
}, Open  ]],
Cell[348506, 9906, 312, 9, 31, "Input"],
Cell[348821, 9917, 314, 9, 31, "Input"],
Cell[CellGroupData[{
Cell[349160, 9930, 221, 6, 31, "Input"],
Cell[349384, 9938, 1207, 37, 82, "Output"]
}, Open  ]]
}, Open  ]],
Cell[350618, 9979, 185, 2, 71, "Section"],
Cell[CellGroupData[{
Cell[350828, 9985, 173, 2, 28, "Subsubtitle"],
Cell[351004, 9989, 338, 10, 31, "Input"],
Cell[351345, 10001, 1682, 50, 123, "Input"],
Cell[353030, 10053, 505, 14, 31, "Input"],
Cell[CellGroupData[{
Cell[353560, 10071, 410, 11, 31, "Input"],
Cell[353973, 10084, 572, 15, 39, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[354582, 10104, 86, 2, 31, "Input"],
Cell[354671, 10108, 450, 13, 33, "Output"]
}, Open  ]],
Cell[355136, 10124, 1651, 41, 76, "Input"],
Cell[CellGroupData[{
Cell[356814, 10170, 333, 7, 31, "Input"],
Cell[357150, 10179, 827, 18, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[358014, 10202, 434, 12, 33, "Input"],
Cell[358451, 10216, 239, 6, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[358727, 10227, 871, 24, 44, "Input"],
Cell[359601, 10253, 689, 19, 50, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[360327, 10277, 341, 9, 43, "Input"],
Cell[360671, 10288, 898, 25, 50, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[361606, 10318, 1244, 33, 50, "Input"],
Cell[362853, 10353, 945, 25, 50, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[363835, 10383, 577, 16, 33, "Input"],
Cell[364415, 10401, 661, 19, 59, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[365113, 10425, 451, 11, 44, "Input"],
Cell[365567, 10438, 1051, 31, 56, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[366667, 10475, 105, 1, 28, "Subsubtitle"],
Cell[366775, 10478, 226, 5, 31, "Input"],
Cell[367004, 10485, 3172, 87, 210, "Input",
 InitializationCell->True],
Cell[370179, 10574, 439, 13, 51, "Input",
 InitializationCell->True],
Cell[370621, 10589, 1179, 42, 31, "Input"],
Cell[371803, 10633, 615, 17, 50, "Text"],
Cell[372421, 10652, 240, 4, 29, "Text"],
Cell[372664, 10658, 2130, 41, 76, "Input",
 InitializationCell->True],
Cell[374797, 10701, 1317, 27, 72, "Input",
 InitializationCell->True],
Cell[376117, 10730, 2448, 47, 76, "Input",
 InitializationCell->True],
Cell[378568, 10779, 1407, 28, 72, "Input",
 InitializationCell->True],
Cell[379978, 10809, 194, 4, 29, "Text"],
Cell[380175, 10815, 7905, 157, 387, "Input",
 InitializationCell->True],
Cell[388083, 10974, 752, 16, 31, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[388860, 10994, 1142, 27, 52, "Input"],
Cell[390005, 11023, 785, 14, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[390827, 11042, 1202, 29, 72, "Input"],
Cell[392032, 11073, 1545, 22, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[393614, 11100, 105, 1, 71, "Section"],
Cell[393722, 11103, 7759, 154, 383, "Input",
 InitializationCell->True],
Cell[401484, 11259, 798, 16, 31, "Input",
 InitializationCell->True],
Cell[402285, 11277, 7840, 198, 404, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[410150, 11479, 1414, 30, 52, "Input"],
Cell[411567, 11511, 1596, 25, 30, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[413212, 11542, 129, 1, 71, "Section"],
Cell[413344, 11545, 288, 10, 31, "Input",
 InitializationCell->True],
Cell[413635, 11557, 224, 8, 57, "Input",
 InitializationCell->True],
Cell[413862, 11567, 1755, 50, 107, "Input",
 InitializationCell->True],
Cell[415620, 11619, 392, 10, 52, "Input",
 InitializationCell->True],
Cell[416015, 11631, 607, 16, 52, "Input",
 InitializationCell->True],
Cell[416625, 11649, 607, 16, 52, "Input",
 InitializationCell->True],
Cell[417235, 11667, 882, 23, 92, "Input",
 InitializationCell->True],
Cell[418120, 11692, 512, 13, 52, "Input",
 InitializationCell->True],
Cell[418635, 11707, 664, 15, 52, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[419324, 11726, 631, 17, 52, "Input"],
Cell[419958, 11745, 90, 1, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[420085, 11751, 1326, 32, 72, "Input"],
Cell[421414, 11785, 373, 8, 30, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
