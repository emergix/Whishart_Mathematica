(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 6.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    317622,       7095]
NotebookOptionsPosition[    312782,       6943]
NotebookOutlinePosition[    313182,       6960]
CellTagsIndexPosition[    313139,       6957]
WindowFrame->Normal
ContainsDynamic->True *)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"<<", " ", 
  "\"\<C:\\\\Documents and Settings\\\\ocroissant\\\\My Documents\\\\BiHeston\
\\\\BiHeston_Process.m\>\""}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.404645251981682*^9, 3.404645291607443*^9}}],

Cell[BoxData[
 RowBox[{"<<", " ", 
  "\"\<C:\\\\Documents and Settings\\\\ocroissant\\\\My Documents\\\\BiHeston\
\\\\BiHeston_VanillaInstruments.m\>\""}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.404645251981682*^9, 3.40464527556026*^9}}],

Cell[CellGroupData[{

Cell["Calibration of the underlyings", "Section",
 CellChangeTimes->{{3.404496712394375*^9, 3.4044967270739746`*^9}, 
   3.4045505166740713`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"InitializeMarketData", "[", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", 
    RowBox[{
     RowBox[{"cms2Tab", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"CMSData", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "3", ",", "202"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "10"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"cms5Tab", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"CMSData", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "3", ",", "202"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "12", ",", "21"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"cms10Tab", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"CMSData", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "3", ",", "202"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "23", ",", "32"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"cms20Tab", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"CMSData", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "3", ",", "202"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "34", ",", "43"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"cms30Tab", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"CMSData", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "3", ",", "202"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "45", ",", "54"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"NormalVol2Y10YTab", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"CMSData", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "215", ",", "261"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "44", ",", "55"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"NormalVol2Y20YTab", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"CMSData", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "274", ",", "320"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "44", ",", "55"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"NormalVol2Y30YTab", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"CMSData", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "333", ",", "379"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "44", ",", "55"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"NormalVol5Y10YTab", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"CMSData", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "392", ",", "438"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "44", ",", "55"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"NormalVol5Y20YTab", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"CMSData", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "451", ",", "497"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "44", ",", "55"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"NormalVol5Y30YTab", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"CMSData", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "510", ",", "556"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "44", ",", "55"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"spreadoptionMaturitiesTab", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"CMSData", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "215", ",", "261"}], "}"}]}], "]"}]}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.404480064785301*^9, 3.404480065754225*^9}, {
   3.404480353321373*^9, 3.4044804612782154`*^9}, {3.404480540542144*^9, 
   3.404480573891656*^9}, {3.404496923594575*^9, 3.404496942142975*^9}, {
   3.404541370686142*^9, 3.4045413795612555`*^9}, {3.4045420905106373`*^9, 
   3.404542119854951*^9}, 3.4045505166740713`*^9, {3.40455965219322*^9, 
   3.404559676959321*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"CMSData", "=", 
   RowBox[{
   "Import", "[", 
    "\"\<C:\\\\Documents and Settings\\\\ocroissant\\\\My \
Documents\\\\CMS_Spread_Market.csv\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"InitializeMarketData", "[", "]"}], ";", 
  RowBox[{"Length", "[", "CMSData", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4044766271213427`*^9, 3.4044766367305326`*^9}, 
   3.4044793300370235`*^9, {3.404479793875393*^9, 3.4044798539810658`*^9}, {
   3.4044798991618767`*^9, 3.4044799031000824`*^9}, 3.4045505166740713`*^9, {
   3.40455969853786*^9, 3.404559712538129*^9}},
 Background->RGBColor[
  0.9803921568627451, 0.6705882352941176, 0.6392156862745098]],

Cell[BoxData["556"], "Output",
 CellChangeTimes->{3.4045598683223696`*^9, 3.4045601667499743`*^9, 
  3.404721793374502*^9, 3.4048383814179144`*^9, 3.404888236810747*^9, 
  3.404890004002147*^9, 3.404906962010547*^9, 3.4050917592055354`*^9, 
  3.405100081065173*^9, 3.405140144031354*^9, 3.4051407205147824`*^9, 
  3.4051408495945597`*^9, 3.4056742690530157`*^9, 3.405775812506048*^9, 
  3.405776102136609*^9, 3.4057763868764505`*^9, 3.4060112291984797`*^9, 
  3.4060141929428825`*^9, 3.406014290382253*^9, 3.4060143307267776`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MarketCMSForward", "[", 
  RowBox[{"5", ",", "\"\<cms5\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.4045528054367647`*^9, 3.404552821062065*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.04818389411495181`", ",", "0.047903`", ",", "0.04819`"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.4045528063430324`*^9, 3.404552821827705*^9}, 
   3.404559883244531*^9, 3.404721801843035*^9, 3.404838385418068*^9, 
   3.4048882426451473`*^9, 3.4048899614141474`*^9, 3.4048900072469473`*^9, 
   3.4049069643817472`*^9, 3.4056756605016065`*^9, 3.405758674623513*^9, 
   3.4060141953023024`*^9, 3.406014337445657*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MarketCMSOptionVol", "[", 
  RowBox[{"0.1", ",", "5", ",", "\"\<cms5\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.404541281857353*^9, 3.404541334748317*^9}, 
   3.4045413778112335`*^9, {3.4045430566698127`*^9, 3.404543076310815*^9}, {
   3.4045450508018494`*^9, 3.404545051458112*^9}, {3.4045501841676874`*^9, 
   3.4045501851520815`*^9}, 3.404550516689697*^9, 3.4045516379924755`*^9, {
   3.4045517386194077`*^9, 3.4045517442913914`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.13565905023966865`", ",", "0.1371547320163596`", ",", 
   "0.13562653812741343`"}], "}"}]], "Output",
 CellChangeTimes->{3.404552867250452*^9, 3.4045598854945745`*^9, 
  3.404721799952459*^9, 3.404906967049347*^9, 3.4050917675026226`*^9, 
  3.4060143386019287`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MarketCMSSpreadOptionNormalVol", "[", 
  RowBox[{"0.01", ",", "5", ",", "\"\<cms2\>\"", ",", "\"\<cms10\>\""}], 
  "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.002840409836061487`", ",", "0.00289`", ",", "0.00284`"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.4060138538269963`*^9, 3.4060139186563663`*^9, 3.4060139698760996`*^9, 
   3.406014198677367*^9, 3.406014345555187*^9, 3.406023873003736*^9, 
   3.4060239225984383`*^9, 3.4060239695837154`*^9, {3.4060240291786094`*^9, 
   3.4060240413819685`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NormalVol2Y10YTab", "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.4060112785744276`*^9, 3.4060112806994686`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.00346`", ",", "0.00321`", ",", "0.00293`", ",", "0.00265`", ",", 
   "0.00237`", ",", "0.00219`", ",", "0.00231`", ",", "0.0026`", ",", 
   "0.00289`", ",", "0.0034`", ",", "0.0022`", ",", "0.00237`"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.4060112465738134`*^9, 3.406011281777614*^9, {3.406014250647115*^9, 
   3.4060142520065165`*^9}, 3.406014294179201*^9, 3.4060143344768496`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"MarketCMSSpreadOptionNormalVol", "[", 
   RowBox[{"K_", ",", "T_", ",", "tenor1_", ",", "tenor2_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "tab", ",", "opt1", ",", "opt2", ",", "i", ",", "j", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"StrikeList", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "0.01"}], ",", 
         RowBox[{"-", "0.0075"}], ",", 
         RowBox[{"-", "0.005"}], ",", 
         RowBox[{"-", "0.0025"}], ",", "0", ",", "0.0025", ",", "0.005", ",", 
         "0.0075", ",", "0.01", ",", "0.015"}], "}"}]}], ",", 
      "\[IndentingNewLine]", "smile1", ",", "smile2", ",", "inter1", ",", 
      "inter2"}], "\[IndentingNewLine]", "}"}], ",", 
    RowBox[{
     RowBox[{"tab", "=", 
      RowBox[{"Switch", "[", 
       RowBox[{"tenor1", ",", "\[IndentingNewLine]", "\"\<cms2\>\"", ",", 
        RowBox[{"Switch", "[", 
         RowBox[{
         "tenor2", ",", "\"\<cms10\>\"", ",", "NormalVol2Y10YTab", ",", 
          "\"\<cms20\>\"", ",", "NormalVol2Y20YTab", ",", "\"\<cms30\>\"", 
          ",", "NormalVol2Y30YTab"}], "]"}], ",", "\[IndentingNewLine]", 
        "\"\<cms5\>\"", ",", 
        RowBox[{"Switch", "[", 
         RowBox[{
         "tenor2", ",", "\"\<cms10\>\"", ",", "NormalVol5Y10YTab", ",", 
          "\"\<cms20\>\"", ",", "NormalVol5Y20YTab", ",", "\"\<cms30\>\"", 
          ",", "NormalVol5Y30YTab"}], "]"}]}], "\[IndentingNewLine]", "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "determination", " ", "du", " ", "rang", " ", "de", " ", "la", " ", 
       "maturit\[EAcute]"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"i", "=", "2"}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"i", "<", 
          RowBox[{"Length", "[", "spreadoptionMaturitiesTab", "]"}]}], ")"}], 
        "&&", 
        RowBox[{"(", " ", 
         RowBox[{"T", ">", 
          RowBox[{"spreadoptionMaturitiesTab", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ")"}]}], ",", 
       RowBox[{"i", "++"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", "interpolation", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"smile1", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"StrikeList", "[", 
           RowBox[{"[", "j", "]"}], "]"}], ",", 
          RowBox[{"tab", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"i", "-", "1"}], ",", "j"}], "]"}], "]"}]}], "}"}], ",", 
        
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{"Length", "[", "StrikeList", "]"}]}], "}"}]}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"smile2", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"StrikeList", "[", 
           RowBox[{"[", "j", "]"}], "]"}], ",", 
          RowBox[{"tab", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{"Length", "[", "StrikeList", "]"}]}], "}"}]}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"inter1", "=", 
      RowBox[{"Interpolation", "[", "smile1", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"inter2", "=", 
      RowBox[{"Interpolation", "[", "smile2", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"opt1", "=", 
      RowBox[{"inter1", "[", "K", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"opt2", "=", 
      RowBox[{"inter2", "[", "K", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"opt1", "+", 
        RowBox[{
         FractionBox[
          RowBox[{"(", 
           RowBox[{"T", "-", 
            RowBox[{"spreadoptionMaturitiesTab", "[", 
             RowBox[{"[", 
              RowBox[{"i", "-", "1"}], "]"}], "]"}]}], ")"}], 
          RowBox[{
           RowBox[{"spreadoptionMaturitiesTab", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "-", 
           RowBox[{"spreadoptionMaturitiesTab", "[", 
            RowBox[{"[", 
             RowBox[{"i", "-", "1"}], "]"}], "]"}]}]], 
         RowBox[{"(", 
          RowBox[{"opt2", "-", "opt1"}], ")"}]}]}], ",", "opt1", ",", 
       "opt2"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4060108940982957`*^9, 3.4060111906977406`*^9}, {
  3.406011851757307*^9, 3.406011871148305*^9}, {3.4060119754784327`*^9, 
  3.406012115918629*^9}, {3.4060122146861506`*^9, 3.406012251483732*^9}, {
  3.4060123056410217`*^9, 3.4060123422354746`*^9}, {3.406012504738594*^9, 
  3.4060125365985813`*^9}, {3.4060125811619368`*^9, 3.406012713992612*^9}, {
  3.406013313129115*^9, 3.406013416193594*^9}, {3.406013820263852*^9, 
  3.4060138478893824`*^9}, {3.406013900218512*^9, 3.406013911656232*^9}, {
  3.406013962500958*^9, 3.406013967329176*^9}, {3.4060238518158293`*^9, 
  3.406023859753482*^9}, {3.4060239121451125`*^9, 3.4060239660523977`*^9}, {
  3.406024008771968*^9, 3.406024038444412*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"MarketCMSOptionVol", "[", 
    RowBox[{"K_", ",", "T_", ",", "tenor_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"tab", ",", "opt1", ",", "opt2", ",", "i"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"tab", "=", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "tenor", ",", "\"\<cms2\>\"", ",", "cms2Tab", ",", "\"\<cms5\>\"", 
         ",", "cms5Tab", ",", "\"\<cms10\>\"", ",", "cms10Tab", ",", 
         "\"\<cms20\>\"", ",", "cms20Tab", ",", "\"\<cms30\>\"", ",", 
         "cms30Tab"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "determination", " ", "du", " ", "rang", " ", "de", " ", "la", " ", 
        "maturit\[EAcute]"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"i", "=", "2"}], ";", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"i", "<", 
           RowBox[{"Length", "[", "tab", "]"}]}], ")"}], "&&", 
         RowBox[{"(", " ", 
          RowBox[{"T", ">", 
           RowBox[{"tab", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ")"}]}], ",", 
        RowBox[{"i", "++"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", "interpolation", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"opt1", "=", 
       RowBox[{
        RowBox[{"SABROptionDirect2", "[", 
         RowBox[{
          RowBox[{"tab", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"i", "-", "1"}], ",", "2"}], "]"}], "]"}], ",", 
          RowBox[{"tab", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"i", "-", "1"}], ",", "3"}], "]"}], "]"}], ",", 
          RowBox[{"tab", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"i", "-", "1"}], ",", "4"}], "]"}], "]"}], ",", 
          RowBox[{"tab", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"i", "-", "1"}], ",", "5"}], "]"}], "]"}], ",", 
          RowBox[{"tab", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"i", "-", "1"}], ",", "6"}], "]"}], "]"}], ",", "K", ",",
           
          RowBox[{"tab", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"i", "-", "1"}], ",", "1"}], "]"}], "]"}]}], "]"}], "[", 
        
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"opt2", "=", 
       RowBox[{
        RowBox[{"SABROptionDirect2", "[", 
         RowBox[{
          RowBox[{"tab", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
          RowBox[{"tab", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "3"}], "]"}], "]"}], ",", 
          RowBox[{"tab", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "4"}], "]"}], "]"}], ",", 
          RowBox[{"tab", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "5"}], "]"}], "]"}], ",", 
          RowBox[{"tab", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "6"}], "]"}], "]"}], ",", "K", ",", 
          RowBox[{"tab", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"opt1", "+", 
         RowBox[{
          FractionBox[
           RowBox[{"(", 
            RowBox[{"T", "-", 
             RowBox[{"tab", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"i", "-", "1"}], ",", "1"}], "]"}], "]"}]}], ")"}], 
           RowBox[{
            RowBox[{"tab", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1"}], "]"}], "]"}], "-", 
            RowBox[{"tab", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"i", "-", "1"}], ",", "1"}], "]"}], "]"}]}]], 
          RowBox[{"(", 
           RowBox[{"opt2", "-", "opt1"}], ")"}]}]}], ",", "opt1", ",", 
        "opt2"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4044821942341022`*^9, 3.404482198000378*^9}, {
   3.4044825025842514`*^9, 3.404482564735614*^9}, {3.404540916639828*^9, 
   3.40454098659161*^9}, {3.404541057715294*^9, 3.4045411052155976`*^9}, {
   3.404541138075183*^9, 3.404541247763385*^9}, {3.4045413606703887`*^9, 
   3.4045413691548724`*^9}, {3.4045417164878316`*^9, 
   3.4045418661157045`*^9}, {3.4045419098509192`*^9, 3.404541936726435*^9}, {
   3.404541993649403*^9, 3.4045420748228364`*^9}, {3.404542135995886*^9, 
   3.404542242154174*^9}, {3.4045428921354036`*^9, 3.4045430482009*^9}, {
   3.4045431034363356`*^9, 3.404543104873863*^9}, {3.4045448723609233`*^9, 
   3.404544925971328*^9}, {3.4045449779567003`*^9, 3.404544978206705*^9}, {
   3.4045450324889975`*^9, 3.4045450733960333`*^9}, {3.404545293087751*^9, 
   3.4045453336354046`*^9}, 3.404545562780429*^9, {3.404545592827881*^9, 
   3.404545595812313*^9}, {3.4045456448913803`*^9, 3.404545895458691*^9}, 
   3.4045501145101004`*^9, {3.4045501496045237`*^9, 3.404550152307701*^9}, {
   3.4045502795132685`*^9, 3.404550282153944*^9}, {3.40455050747077*^9, 
   3.404550516689697*^9}, {3.4045519800459175`*^9, 3.4045519877804413`*^9}, {
   3.40455220384709*^9, 3.404552211987871*^9}, {3.4060118327569427`*^9, 
   3.406011864898185*^9}, 3.406013465194535*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MarketCMSForward", "[", 
   RowBox[{"T_", ",", "tenor_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"tab", ",", "opt1", ",", "opt2"}], "}"}], ",", 
    RowBox[{
     RowBox[{"tab", "=", 
      RowBox[{"Switch", "[", 
       RowBox[{
       "tenor", ",", "\"\<cms2\>\"", ",", "cms2Tab", ",", "\"\<cms5\>\"", ",",
         "cms5Tab", ",", "\"\<cms10\>\"", ",", "cms10Tab", ",", 
        "\"\<cms20\>\"", ",", "cms20Tab", ",", "\"\<cms30\>\"", ",", 
        "cms30Tab"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "determination", " ", "du", " ", "rang", " ", "de", " ", "la", " ", 
       "maturit\[EAcute]"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"i", "=", "2"}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"i", "<", 
          RowBox[{"Length", "[", "tab", "]"}]}], ")"}], "&&", 
        RowBox[{"(", " ", 
         RowBox[{"T", ">", 
          RowBox[{"tab", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ")"}]}], ",", 
       RowBox[{"i", "++"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"opt1", "=", 
      RowBox[{"tab", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"i", "-", "1"}], ",", "2"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"opt2", "=", 
      RowBox[{"tab", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"opt1", "+", 
        RowBox[{
         FractionBox[
          RowBox[{"(", 
           RowBox[{"T", "-", 
            RowBox[{"tab", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"i", "-", "1"}], ",", "1"}], "]"}], "]"}]}], ")"}], 
          RowBox[{
           RowBox[{"tab", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}], "-", 
           RowBox[{"tab", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"i", "-", "1"}], ",", "1"}], "]"}], "]"}]}]], 
         RowBox[{"(", 
          RowBox[{"opt2", "-", "opt1"}], ")"}]}]}], ",", "opt1", ",", 
       "opt2"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4045525000246515`*^9, 3.404552571557275*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Calibration", "Subtitle",
 CellChangeTimes->{{3.4057473942819347`*^9, 3.405747397016362*^9}, {
  3.4059606151619606`*^9, 3.405960618130768*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"S1", ",", "S2", ",", 
      RowBox[{"M1", "=", 
       RowBox[{"-", "0.35"}]}], ",", 
      RowBox[{"M2", "=", 
       RowBox[{"-", "0.35"}]}], ",", 
      RowBox[{"\[Rho]s", "=", "0."}], ",", 
      RowBox[{"\[Rho]sinf", "=", "0."}], ",", 
      RowBox[{"\[Rho]m1", "=", "0."}], ",", 
      RowBox[{"\[Rho]m2", "=", "0."}], ",", 
      RowBox[{"\[Rho]1", "=", 
       RowBox[{"-", "0.45"}]}], ",", 
      RowBox[{"\[Rho]2", "=", 
       RowBox[{"-", "0.45"}]}], ",", " ", "\[CapitalSigma]1", ",", 
      "\[CapitalSigma]2", ",", "\[Theta]1", ",", "\[Theta]2", ",", 
      RowBox[{"\[Tau]", "=", "5"}], ",", 
      RowBox[{"\[Alpha]1", "=", "1"}], ",", 
      RowBox[{"a", "=", "1"}], ",", "M", ",", "\[CapitalSigma]inf", ",", 
      "\[CapitalSigma]", ",", "Q", ",", "\[Beta]m", ",", "S", ",", "\[Rho]", 
      ",", 
      RowBox[{"printflag", "=", 
       RowBox[{"{", "1", "}"}]}], ",", 
      RowBox[{"\[Mu]", "=", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], ",", "inter1", ",", "inter2", ",", 
      "inter3", ",", "smileLN", ",", "interLN", ",", "prices", ",", 
      RowBox[{"tenor", "=", "\"\<cms5\>\""}], ",", "K", ",", "\[Beta]", ",", 
      RowBox[{"limsup", "=", "1000"}], ",", "\[Nu]H2", ",", "\[Rho]H2", ",", 
      "\[Lambda]H2", ",", "\[Theta]H2"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[CapitalSigma]1", "=", "0.01"}], ";", 
     RowBox[{"\[CapitalSigma]2", "=", "0.01"}], ";", 
     RowBox[{"\[Theta]1", "=", 
      RowBox[{"4.", "\[CapitalSigma]1"}]}], ";", 
     RowBox[{"\[Theta]2", "=", 
      RowBox[{"3.", "\[CapitalSigma]2"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"S1", "=", 
      RowBox[{
       RowBox[{"MarketCMSForward", "[", 
        RowBox[{"\[Tau]", ",", "tenor"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", 
     RowBox[{"S2", "=", "S1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"M", "=", 
      RowBox[{"(", GridBox[{
         {"M1", 
          RowBox[{"\[Rho]m1", 
           SqrtBox[
            RowBox[{"M1", " ", "M2"}]]}]},
         {
          RowBox[{"\[Rho]m2", 
           SqrtBox[
            RowBox[{"M1", " ", "M2"}]]}], "M2"}
        }], ")"}]}], ";", 
     RowBox[{"\[CapitalSigma]inf", "=", 
      RowBox[{"(", GridBox[{
         {"\[Theta]1", 
          RowBox[{
           SqrtBox[
            RowBox[{"\[Theta]1", " ", "\[Theta]2"}]], " ", "\[Rho]sinf"}]},
         {
          RowBox[{
           SqrtBox[
            RowBox[{"\[Theta]1", " ", "\[Theta]2"}]], " ", "\[Rho]sinf"}], 
          "\[Theta]2"}
        }], ")"}]}], ";", 
     RowBox[{"\[CapitalSigma]", "=", 
      RowBox[{"(", GridBox[{
         {"\[CapitalSigma]1", 
          RowBox[{
           SqrtBox[
            RowBox[{"\[CapitalSigma]1", " ", "\[CapitalSigma]2"}]], " ", 
           "\[Rho]s"}]},
         {
          RowBox[{
           SqrtBox[
            RowBox[{"\[CapitalSigma]1", " ", "\[CapitalSigma]2"}]], " ", 
           "\[Rho]s"}], "\[CapitalSigma]2"}
        }], ")"}]}], ";", 
     RowBox[{"S", "=", 
      RowBox[{"{", 
       RowBox[{"S1", ",", "S2"}], "}"}]}], ";", 
     RowBox[{"\[Rho]", "=", 
      RowBox[{"{", 
       RowBox[{"\[Rho]1", ",", "\[Rho]2"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"strikes", "=", 
      RowBox[{"{", 
       RowBox[{
       "0.01", ",", "0.0125", ",", "0.015", ",", "0.0175", ",", "0.02", ",", 
        "0.021", ",", "0.022", ",", "0.023", ",", "0.024", ",", "0.0245", ",",
         "0.025", ",", "0.0255", ",", "0.026", ",", "0.0265", ",", "0.027", 
        ",", "0.028", ",", "0.029", ",", "0.03", ",", "0.031", ",", "0.032", 
        ",", "0.033", ",", "0.034", ",", "0.035", ",", "0.036", ",", "0.037", 
        ",", "0.038", ",", "0.039", ",", "0.04", ",", "0.045", ",", "0.048", 
        ",", "0.05", ",", "0.055", ",", "0.058", ",", "0.06", ",", "0.062", 
        ",", "0.065", ",", "0.07", ",", "0.075", ",", "0.08", ",", "0.085", 
        ",", "0.09", ",", "0.095", ",", "0.1", ",", "0.11", ",", "0.12"}], 
       "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Q", "=", 
      RowBox[{"(", GridBox[{
         {"0.25", "0"},
         {"0", "0.25"}
        }], ")"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"prices", "=", 
      RowBox[{"SmileBiHestonUnderlying2Vanilla2", "[", 
       RowBox[{
       "S", ",", "\[Alpha]1", ",", "a", ",", "strikes", ",", "\[Tau]", ",", 
        "\[CapitalSigma]", ",", "M", ",", "\[CapitalSigma]inf", ",", "Q", ",",
         "\[Rho]", ",", "\[Mu]", ",", "printflag"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"smile", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"strikes", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"ImpVolBS", "[", 
           RowBox[{"S1", ",", 
            RowBox[{"strikes", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "\[Tau]", ",", 
            RowBox[{"prices", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "strikes", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"inter", "=", 
      RowBox[{"Interpolation", "[", "smile", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Nu]H2", "=", 
      RowBox[{"2", 
       SqrtBox[
        RowBox[{
         RowBox[{
          RowBox[{"Q", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}], "^", "2"}], "+", 
         RowBox[{
          RowBox[{"Q", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "2"}], "]"}], "]"}], "^", "2"}]}]]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Rho]H2", "=", "\[Rho]2"}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Lambda]H2", "=", 
      RowBox[{
       RowBox[{"-", "2"}], 
       RowBox[{"M", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Theta]H2", "=", 
      RowBox[{"\[Theta]2", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SqrtBox[
            RowBox[{"\[Theta]1", " ", "\[Theta]2"}]], " ", "\[Rho]sinf"}], 
          "-", 
          RowBox[{
           SqrtBox[
            RowBox[{"\[CapitalSigma]1", " ", "\[CapitalSigma]2"}]], " ", 
           "\[Rho]s"}]}], ")"}], 
        FractionBox[
         RowBox[{"M", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}], 
         RowBox[{"M", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}]]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<{\[Lambda]H2,\[Theta]H2,\[Nu]H2,\[Rho]H2}=\>\"", ",", 
       RowBox[{"{", 
        RowBox[{
        "\[Lambda]H2", ",", "\[Theta]H2", ",", "\[Nu]H2", ",", "\[Rho]H2"}], 
        "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"prices", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"LNHestonVanillaCall", "[", 
         RowBox[{"S2", ",", 
          RowBox[{"strikes", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", "\[CapitalSigma]2", ",", 
          "\[Tau]", ",", "\[Lambda]H2", ",", "\[Theta]H2", ",", "\[Nu]H2", 
          ",", "\[Rho]H2", ",", "limsup"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "strikes", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"smile", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"strikes", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"ImpVolBS", "[", 
           RowBox[{"S1", ",", 
            RowBox[{"strikes", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "\[Tau]", ",", 
            RowBox[{"prices", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "strikes", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"inter2", "=", 
      RowBox[{"Interpolation", "[", "smile", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"smileMarket", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"strikes", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"MarketCMSOptionVol", "[", 
            RowBox[{
             RowBox[{"strikes", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "\[Tau]", ",", "tenor"}], 
            "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "strikes", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"interMarket", "=", 
      RowBox[{"Interpolation", "[", "smileMarket", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"inter", "[", "x", "]"}], ",", 
         RowBox[{"inter2", "[", "x", "]"}], ",", 
         RowBox[{"interMarket", "[", "x", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{"strikes", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"Last", "[", "strikes", "]"}]}], "}"}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", "\"\<Implied BS vol\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"PlotLegend", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
         "\"\<BiHestonUnderlying2\>\"", ",", "\"\<Heston\>\"", ",", 
          "\"\<Market\>\""}], "}"}]}], ",", 
       RowBox[{"LegendPosition", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0"}], "}"}]}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0.3"}], "}"}]}]}], "]"}]}]}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.4057762003884954`*^9, 3.4057762025760374`*^9}, 
   3.405776255905186*^9, 3.405776416377017*^9, {3.4057800166648912`*^9, 
   3.4057800478217397`*^9}, {3.4057804365948286`*^9, 
   3.4057804765330954`*^9}, {3.405780805461286*^9, 3.405780852274685*^9}, {
   3.405780886540968*^9, 3.405780890916052*^9}, {3.4057809307761917`*^9, 
   3.40578097858961*^9}, {3.4057810164653373`*^9, 3.405781039372027*^9}, {
   3.4057810767477446`*^9, 3.4057810779040165`*^9}, {3.4057811268424563`*^9, 
   3.405781323018098*^9}, {3.405782231113658*^9, 3.405782274176985*^9}, 
   3.405782619449239*^9, {3.4057826743877935`*^9, 3.4057826899974685`*^9}, {
   3.4057830666922007`*^9, 3.405783080770596*^9}, {3.405784231730194*^9, 
   3.4057842850280924`*^9}, {3.4057843588576345`*^9, 
   3.4057844294839907`*^9}, {3.405784469937893*^9, 3.405784493453969*^9}, {
   3.405784536564172*^9, 3.405784565455352*^9}, 3.405784639222393*^9, 
   3.405784935024947*^9, 3.405785043355152*^9, 3.4057851172315702`*^9, 
   3.4057854921762695`*^9, {3.4057856229131546`*^9, 3.4057856243819323`*^9}, {
   3.4057858318390408`*^9, 3.4057858558707523`*^9}, {3.405785917590687*^9, 
   3.405785956138302*^9}, {3.405786069874861*^9, 3.405786093844071*^9}, {
   3.4057861330323234`*^9, 3.4057862199558673`*^9}, {3.4057862719724913`*^9, 
   3.4057863361612234`*^9}, {3.4057865187272286`*^9, 3.405786547821537*^9}, {
   3.4057866082133217`*^9, 3.405786663495633*^9}, {3.4057882781360083`*^9, 
   3.4057882864799185`*^9}, {3.4057907817465773`*^9, 3.405790790449869*^9}, {
   3.4057908885455027`*^9, 3.4057908910143003`*^9}, {3.4057918203133917`*^9, 
   3.40579182125091*^9}, {3.405792185414152*^9, 3.405792211727157*^9}, 
   3.4057925336552134`*^9, 3.4057925855468345`*^9, {3.4057926925020127`*^9, 
   3.405792696111457*^9}, {3.405792752003155*^9, 3.4057927525187902`*^9}, {
   3.405941648091896*^9, 3.4059418314547915`*^9}, {3.405941926097234*^9, 
   3.405941940191254*^9}, {3.4059421299761477`*^9, 3.4059423046513767`*^9}, {
   3.405942483217305*^9, 3.4059424945300226`*^9}, {3.4059425429215765`*^9, 
   3.405942548671687*^9}, {3.405942651751791*^9, 3.4059427327377205`*^9}, {
   3.405942763988321*^9, 3.405942777801086*^9}, {3.4059443173462696`*^9, 
   3.405944558569651*^9}, {3.4059452030664005`*^9, 3.4059452053164434`*^9}, {
   3.405945361663195*^9, 3.4059456457623997`*^9}, {3.4059456851694064`*^9, 
   3.4059456922945433`*^9}, {3.405945957877767*^9, 3.4059459877533407`*^9}, {
   3.4059461661005154`*^9, 3.4059461689755707`*^9}, {3.4059463494790363`*^9, 
   3.405946350947814*^9}, {3.4059464969037414`*^9, 3.405946497685006*^9}, {
   3.405946601061991*^9, 3.405946605015192*^9}, 3.405946671563345*^9, {
   3.4059467461741524`*^9, 3.405946751314876*^9}, {3.405946800222065*^9, 
   3.4059468100347533`*^9}, {3.4059469260369806`*^9, 3.405946934334015*^9}, {
   3.405947047414311*^9, 3.4059470504612446`*^9}, {3.4059471719167013`*^9, 
   3.405947182010645*^9}, {3.4059494736483936`*^9, 3.405949480851657*^9}, 
   3.405949636042137*^9, 3.405949755060047*^9, 3.4059499185944366`*^9, {
   3.4059501806463428`*^9, 3.4059501943966064`*^9}, {3.4059503280710487`*^9, 
   3.4059503324461327`*^9}, {3.405950473995725*^9, 3.4059504837771626`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Nb1=\"\>", "\[InvisibleSpace]", "30", 
   "\[InvisibleSpace]", "\<\" Nb1n=\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\" Nb2=\"\>", "\[InvisibleSpace]", "20"}],
  SequenceForm["Nb1=", 30, " Nb1n=", 8, " Nb2=", 20],
  Editable->False]], "Print",
 CellChangeTimes->{3.4059459898627567`*^9, 3.4059461704755993`*^9, 
  3.405946352166588*^9, 3.405946500622563*^9, 3.405946607093357*^9, 
  3.4059466722508583`*^9, 3.405946752205518*^9, 3.405946810753517*^9, 
  3.4059469352090316`*^9, 3.4059470515706406`*^9, 3.40594718279191*^9, 
  3.405949490476842*^9, 3.405949637370287*^9, 3.405950011955604*^9, 
  3.4059501963028936`*^9, 3.405950349305831*^9, 3.4059504846365547`*^9, 
  3.406309378578578*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\" S=\"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {"0.04818389411495181`"},
        {"0.04818389411495181`"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], 
   "\[InvisibleSpace]", "\<\" \[CapitalSigma]=\"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0.01`", "0.`"},
       {"0.`", "0.01`"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], "\[InvisibleSpace]", "\<\"M=\"\>", 
   "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"-", "0.35`"}], "0.`"},
       {"0.`", 
        RowBox[{"-", "0.35`"}]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], 
   "\[InvisibleSpace]", "\<\" \[CapitalSigma]inf=\"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0.04`", "0.`"},
       {"0.`", "0.03`"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], "\[InvisibleSpace]", "\<\" Q=\"\>", 
   "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0.25`", "0"},
       {"0", "0.25`"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], "\[InvisibleSpace]", "\<\" \[Rho]=\"\>", 
   "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {
         RowBox[{"-", "0.45`"}]},
        {
         RowBox[{"-", "0.45`"}]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], 
   "\[InvisibleSpace]", "\<\" Imaginary Shifts=\"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {"2"},
        {"2"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], "\[InvisibleSpace]", "\<\" \[Beta]m =\"\>", 
   "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0.22399999999999998`", "0.`"},
       {"0.`", "0.16799999999999998`"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm[" S=", 
   MatrixForm[{0.04818389411495181, 0.04818389411495181}], 
   " \[CapitalSigma]=", 
   MatrixForm[{{0.01, 0.}, {0., 0.01}}], "M=", 
   MatrixForm[{{-0.35, 0.}, {0., -0.35}}], " \[CapitalSigma]inf=", 
   MatrixForm[{{0.04, 0.}, {0., 0.03}}], " Q=", 
   MatrixForm[{{0.25, 0}, {0, 0.25}}], " \[Rho]=", 
   MatrixForm[{-0.45, -0.45}], " Imaginary Shifts=", 
   MatrixForm[{2, 2}], " \[Beta]m =", 
   MatrixForm[{{0.22399999999999998`, 0.}, {0., 0.16799999999999998`}}]],
  Editable->False]], "Print",
 CellChangeTimes->{3.4059459898627567`*^9, 3.4059461704755993`*^9, 
  3.405946352166588*^9, 3.405946500622563*^9, 3.405946607093357*^9, 
  3.4059466722508583`*^9, 3.405946752205518*^9, 3.405946810753517*^9, 
  3.4059469352090316`*^9, 3.4059470515706406`*^9, 3.40594718279191*^9, 
  3.405949490476842*^9, 3.405949637370287*^9, 3.405950011955604*^9, 
  3.4059501963028936`*^9, 3.405950349305831*^9, 3.4059504846365547`*^9, 
  3.406309378580578*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"{NbLegCoef1,NbLegCoef1n,period1,period1n,\[Epsilon]1,imax}=\"\>\
", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"30", ",", "8", ",", "1", ",", "3", ",", "1.`*^-7", ",", "60"}], 
    "}"}], "\[InvisibleSpace]", \
"\<\"{NbLegCoef2,period2,period2n,\[Epsilon]2}=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"20", ",", "1", ",", "2", ",", "1.`*^-8"}], "}"}]}],
  SequenceForm[
  "{NbLegCoef1,NbLegCoef1n,period1,period1n,\[Epsilon]1,imax}=", {
   30, 8, 1, 3, 1.*^-7, 60}, "{NbLegCoef2,period2,period2n,\[Epsilon]2}=", {
   20, 1, 2, 1.*^-8}],
  Editable->False]], "Print",
 CellChangeTimes->{3.4059459898627567`*^9, 3.4059461704755993`*^9, 
  3.405946352166588*^9, 3.405946500622563*^9, 3.405946607093357*^9, 
  3.4059466722508583`*^9, 3.405946752205518*^9, 3.405946810753517*^9, 
  3.4059469352090316`*^9, 3.4059470515706406`*^9, 3.40594718279191*^9, 
  3.405949490476842*^9, 3.405949637370287*^9, 3.405950011955604*^9, 
  3.4059501963028936`*^9, 3.405950349305831*^9, 3.4059504846365547`*^9, 
  3.4063093785825777`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{"\<\"BiHestonLaplaceQuickTransform2[M,Q,\[Rho], \[Mu],\
\[CapitalSigma],{-\[ImaginaryI] 1,-\[ImaginaryI] 1},\[Beta]m,\[Tau]]=\"\>", 
    "\[InvisibleSpace]", "0.8864464632069592`"}], "\[InvisibleSpace]", "+", 
   RowBox[{"0.06827696302000504`", " ", "\[ImaginaryI]"}]}],
  SequenceForm[
  "BiHestonLaplaceQuickTransform2[M,Q,\[Rho], \[Mu],\[CapitalSigma],{-\
\[ImaginaryI] 1,-\[ImaginaryI] 1},\[Beta]m,\[Tau]]=", 
   Complex[0.8864464632069592, 0.06827696302000504]],
  Editable->False]], "Print",
 CellChangeTimes->{3.4059459898627567`*^9, 3.4059461704755993`*^9, 
  3.405946352166588*^9, 3.405946500622563*^9, 3.405946607093357*^9, 
  3.4059466722508583`*^9, 3.405946752205518*^9, 3.405946810753517*^9, 
  3.4059469352090316`*^9, 3.4059470515706406`*^9, 3.40594718279191*^9, 
  3.405949490476842*^9, 3.405949637370287*^9, 3.405950011955604*^9, 
  3.4059501963028936`*^9, 3.405950349305831*^9, 3.4059504846365547`*^9, 
  3.406309378583578*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"integrand(0.1,0.1)=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "142.51212462650693`", ",", "114.09872188492615`", ",", 
     "95.10773950238014`", ",", "81.51823791929195`", ",", 
     "71.31272547478517`", ",", "67.9083857348524`", ",", 
     "64.81247171003265`", ",", "61.98490404876617`", ",", 
     "59.39226014425289`", ",", "58.17507698609288`", ",", 
     "57.00644696447093`", ",", "55.88352376246603`", ",", 
     "54.803679282723245`", ",", "53.7644831245764`", ",", 
     "52.76368433494553`", ",", "50.86907644080979`", ",", 
     "49.10486066545734`", ",", "47.45803548651829`", ",", 
     "45.91727216459687`", ",", "44.47265407840879`", ",", 
     "43.115463334715784`", ",", "41.83800494255854`", ",", 
     "40.63346105607358`", ",", "39.49576945236773`", ",", 
     "38.419521669592406`", ",", "37.399877191503904`", ",", 
     "36.432490804561084`", ",", "35.51345082724931`", ",", 
     "31.530828493849363`", ",", "29.53956811800174`", ",", 
     "28.34487671771156`", ",", "25.738574963633944`", ",", 
     "24.39072192979109`", ",", "23.567139468444257`", ",", 
     "22.796777058886093`", ",", "21.730279617959614`", ",", 
     "20.15632830762798`", ",", "18.79271210653103`", ",", 
     "17.59999088795576`", ",", "16.547998812963534`", ",", 
     "15.613270348071845`", ",", "14.777278359779483`", ",", 
     "14.02520032745565`", ",", "12.726970049690257`", ",", 
     "11.646038744428608`"}], "}"}]}],
  SequenceForm[
  "integrand(0.1,0.1)=", {142.51212462650693`, 114.09872188492615`, 
   95.10773950238014, 81.51823791929195, 71.31272547478517, 67.9083857348524, 
   64.81247171003265, 61.98490404876617, 59.39226014425289, 58.17507698609288,
    57.00644696447093, 55.88352376246603, 54.803679282723245`, 
   53.7644831245764, 52.76368433494553, 50.86907644080979, 49.10486066545734, 
   47.45803548651829, 45.91727216459687, 44.47265407840879, 
   43.115463334715784`, 41.83800494255854, 40.63346105607358, 
   39.49576945236773, 38.419521669592406`, 37.399877191503904`, 
   36.432490804561084`, 35.51345082724931, 31.530828493849363`, 
   29.53956811800174, 28.34487671771156, 25.738574963633944`, 
   24.39072192979109, 23.567139468444257`, 22.796777058886093`, 
   21.730279617959614`, 20.15632830762798, 18.79271210653103, 
   17.59999088795576, 16.547998812963534`, 15.613270348071845`, 
   14.777278359779483`, 14.02520032745565, 12.726970049690257`, 
   11.646038744428608`}],
  Editable->False]], "Print",
 CellChangeTimes->{3.4059459898627567`*^9, 3.4059461704755993`*^9, 
  3.405946352166588*^9, 3.405946500622563*^9, 3.405946607093357*^9, 
  3.4059466722508583`*^9, 3.405946752205518*^9, 3.405946810753517*^9, 
  3.4059469352090316`*^9, 3.4059470515706406`*^9, 3.40594718279191*^9, 
  3.405949490476842*^9, 3.405949637370287*^9, 3.405950011955604*^9, 
  3.4059501963028936`*^9, 3.405950349305831*^9, 3.4059504846365547`*^9, 
  3.406309378585578*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"{\[Lambda]H2,\[Theta]H2,\[Nu]H2,\[Rho]H2}=\"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.7`", ",", "0.03`", ",", "0.5`", ",", 
     RowBox[{"-", "0.45`"}]}], "}"}]}],
  SequenceForm[
  "{\[Lambda]H2,\[Theta]H2,\[Nu]H2,\[Rho]H2}=", {0.7, 0.03, 0.5, -0.45}],
  Editable->False]], "Print",
 CellChangeTimes->{3.4059459898627567`*^9, 3.4059461704755993`*^9, 
  3.405946352166588*^9, 3.405946500622563*^9, 3.405946607093357*^9, 
  3.4059466722508583`*^9, 3.405946752205518*^9, 3.405946810753517*^9, 
  3.4059469352090316`*^9, 3.4059470515706406`*^9, 3.40594718279191*^9, 
  3.405949490476842*^9, 3.405949637370287*^9, 3.405950011955604*^9, 
  3.4059501963028936`*^9, 3.405950349305831*^9, 3.4059504846365547`*^9, 
  3.406309414190578*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"36.083`", ",", 
   GraphicsBox[{InsetBox[
      GraphicsBox[{{}, {}, 
        {Hue[0.67, 0.6, 0.6], LineBox[CompressedData["
1:eJwV1nlYTdsbB/A004SkIv0SKkrlJpr4SumKUJkuUqQUFyWhqISKFJUkFc3z
OXufQ2nc51QnGjSoiGRsLkJFiaTfun/sZz+fZz17Wutd33cvdPawdxUWEhL6
To7/ztZHmm51nAuCWfa+wbtizdB/3JcRFR4EvnryG3paM5QWThWYJwZBPNvh
q2CyCb1ty1+lVARBtiL49PBoE4I2hi1wlgzGe05Eq1tvE8o1rTI7Y4LRGrv2
WFF1E4x6Swu7uCFw3Tyw4m1YEzQPZbX39F6FQN5H5qVyE+QX1BupP7gOxQhH
qQ1ejVhQlHJabG4UZq1x8jv7sx7zr3HjmL+jERvpsfJkZh3UzHpr5XJiQK/X
G0qwewKByYbFxR2xuPcxPTtZsxbHlOuu/bGOx1Z1rey/flTjotpiRjzrLgrZ
Z/K031TBwDtT0fV1IvhDfltiPzzGj2dZZZykZJhNSf9SffMI6nOiJP/hpeA9
7fB29FslLvd3FRxsTcXQ+VHNzHmV6NPZ9K+xWDqcWTccJ00EiFd8vJJRy0DU
3UuuomcrYOe1XVRmRybeiKRuefugHGsObjYuu5gFg/rLQxVi5bgZfYpeHJKF
MbZNkptIOXofJyy6di0Lq3t1kmSnlSNy2aDMzugszJkWp10xXobub+GdH9Oz
sMre86tWbxnCQxrD5tZkwfntBY5vRRnaWXbvjstmY0W3dI7OuTL4jO2+rJKQ
Dc3SnqJ13/m4fuaOfkdSNhrK9sV/+cpH6ljb24z0bOjFPJdP/sRH/dgeIz06
G65zJFtluvhQ+7Hvs3lFNv6ZI8nMaeGj5ofTbre+bKy989OnmcuH4k837QcG
OTBMko2edZIPHd/stjNGOVCwz/UxPM7Hup/9waZrckD1yWvtP8LH0Z9HPjyy
yoHFgmsfCw/ywf/5b8zLPTmoOnhraYI9H4d/eUz9vpCD2Y3UoLIhHwUTZ5/9
XZ+DgFehx30meXBplF5e2pSDTXseLtz/i4fZKSkhuq05kNu+7uiGHzx4WNUZ
K7zLQblQf4HaMA9aUarJnV9zYLI3w0C4h4c4jcfH/OVzce3+TBfPBh787GaL
5+3NxQ47j49jyTwsW5zlpOGUi5Ffzke3JPLQNmZaHHcoF+aBtl5ZCTwY3nU9
FngsF4uPhisdvs3Dl96ili0B5H5NdJ5MOA8H/JyS+lNyUR39okHMhweLLLaR
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
q3s18f8BJv+nSw==
          "]]}, 
        {Hue[0.9060679774997897, 0.6, 0.6], LineBox[CompressedData["
1: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
/D9iXIVl
          "]]}, 
        {Hue[0.14213595499957954`, 0.6, 0.6], LineBox[CompressedData["
1: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
onR4dcRKz3r79hOfE/3UziX+DzTIdRc=
          "]]}},
       AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
       Axes->True,
       AxesOrigin->{0.02, 0},
       DisplayFunction:>$DisplayFunction,
       FormatType->TraditionalForm,
       PlotLabel->FormBox["\"Implied BS vol\"", TraditionalForm],
       PlotRange->{{0.01, 0.12}, {0, 0.3}},
       PlotRangeClipping->True,
       PlotRangePadding->{
         Scaled[0.02], Automatic}], {-1, -0.6180339887498948}, {
      Left, Bottom}, {2, 1.2360679774997896`}], {
      {GrayLevel[0], 
       RectangleBox[{1.05, -0.05}, \
{1.7804347826086957`, 0.7500000000000001}]}, 
      {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[0.001]}], 
       RectangleBox[{1, 0}, {1.7304347826086959`, 0.8000000000000002}], 
       InsetBox[
        GraphicsBox[{{{InsetBox[
             GraphicsBox[
              {Hue[0.1421359549995791, 0.6, 0.6], 
               LineBox[{{0, 0}, {1, 0}}]}], {0.08, 0.08}, {
             Left, Bottom}, {1, 1}], 
            InsetBox["\<\"Market\"\>", {1.21, 0.58}, {-1, 0}, Automatic, {1, 
             0}]}, {InsetBox[
             GraphicsBox[
              {Hue[0.9060679774997897, 0.6, 0.6], 
               LineBox[{{0, 0}, {1, 0}}]}], {0.08, 1.24}, {
             Left, Bottom}, {1, 1}], 
            InsetBox["\<\"Heston\"\>", {1.21, 1.74}, {-1, 0}, Automatic, {1, 
             0}]}, {InsetBox[
             GraphicsBox[
              {Hue[0.67, 0.6, 0.6], 
               LineBox[{{0, 0}, {1, 0}}]}], {0.08, 2.4}, {
             Left, Bottom}, {1, 1}], 
            InsetBox["\<\"BiHestonUnderlying2\"\>", {1.21, 2.9}, {-1, 0}, 
             Automatic, {1, 0}]}}, {}},
         AspectRatio->1.0952380952380953`,
         FormatType->TraditionalForm,
         PlotRange->{{-0.1, 3.26}, {-0.1, 3.5799999999999996`}}], {1, 0}, {
        Left, Bottom}, {0.7304347826086958, 0.8000000000000002}]}}},
    AspectRatio->Automatic,
    Background->None,
    ColorOutput->Automatic,
    ImageSize->Automatic,
    PlotRange->All]}], "}"}]], "Output",
 CellChangeTimes->{3.405946033472969*^9, 3.405946260742957*^9, 
  3.4059464266836433`*^9, 3.405946521607341*^9, 3.4059466354689016`*^9, 
  3.4059467009389086`*^9, 3.4059467866124287`*^9, 3.4059468449260483`*^9, 
  3.4059470170387278`*^9, 3.4059471411817365`*^9, 3.4059472882783103`*^9, 
  3.4059496014320974`*^9, 3.4059497442629642`*^9, 3.4059501191764126`*^9, 
  3.405950299508*^9, 3.4059504325886803`*^9, 3.4059505951699266`*^9, 
  3.406309414837578*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"S1", ",", "S2", ",", 
      RowBox[{"M1", "=", 
       RowBox[{"-", "0.35"}]}], ",", 
      RowBox[{"M2", "=", 
       RowBox[{"-", "0.35"}]}], ",", 
      RowBox[{"\[Rho]s", "=", "0."}], ",", 
      RowBox[{"\[Rho]sinf", "=", "0."}], ",", 
      RowBox[{"\[Rho]m1", "=", "0."}], ",", 
      RowBox[{"\[Rho]m2", "=", "0."}], ",", 
      RowBox[{"\[Rho]1", "=", 
       RowBox[{"-", "0.45"}]}], ",", 
      RowBox[{"\[Rho]2", "=", 
       RowBox[{"-", "0.45"}]}], ",", " ", "\[CapitalSigma]1", ",", 
      "\[CapitalSigma]2", ",", "\[Theta]1", ",", "\[Theta]2", ",", 
      RowBox[{"\[Tau]", "=", "5"}], ",", 
      RowBox[{"\[Alpha]1", "=", "1"}], ",", 
      RowBox[{"a", "=", "1"}], ",", "M", ",", "\[CapitalSigma]inf", ",", 
      "\[CapitalSigma]", ",", "Q", ",", "\[Beta]m", ",", "S", ",", "\[Rho]", 
      ",", 
      RowBox[{"printflag", "=", 
       RowBox[{"{", "1", "}"}]}], ",", 
      RowBox[{"\[Mu]", "=", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], ",", "inter1", ",", "inter2", ",", 
      "inter3", ",", "smileLN", ",", "interLN", ",", "prices", ",", 
      RowBox[{"tenor", "=", "\"\<cms5\>\""}], ",", "K", ",", "\[Beta]", ",", 
      RowBox[{"limsup", "=", "1000"}], ",", "\[Nu]H2", ",", "\[Rho]H2", ",", 
      "\[Lambda]H2", ",", "\[Theta]H2"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[CapitalSigma]1", "=", "0.01"}], ";", 
     RowBox[{"\[CapitalSigma]2", "=", "0.01"}], ";", 
     RowBox[{"\[Theta]1", "=", 
      RowBox[{"3.", "\[CapitalSigma]1"}]}], ";", 
     RowBox[{"\[Theta]2", "=", 
      RowBox[{"3.", "\[CapitalSigma]2"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"S1", "=", 
      RowBox[{
       RowBox[{"MarketCMSForward", "[", 
        RowBox[{"\[Tau]", ",", "tenor"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", 
     RowBox[{"S2", "=", "S1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"M", "=", 
      RowBox[{"(", GridBox[{
         {"M1", 
          RowBox[{"\[Rho]m1", 
           SqrtBox[
            RowBox[{"M1", " ", "M2"}]]}]},
         {
          RowBox[{"\[Rho]m2", 
           SqrtBox[
            RowBox[{"M1", " ", "M2"}]]}], "M2"}
        }], ")"}]}], ";", 
     RowBox[{"\[CapitalSigma]inf", "=", 
      RowBox[{"(", GridBox[{
         {"\[Theta]1", 
          RowBox[{
           SqrtBox[
            RowBox[{"\[Theta]1", " ", "\[Theta]2"}]], " ", "\[Rho]sinf"}]},
         {
          RowBox[{
           SqrtBox[
            RowBox[{"\[Theta]1", " ", "\[Theta]2"}]], " ", "\[Rho]sinf"}], 
          "\[Theta]2"}
        }], ")"}]}], ";", 
     RowBox[{"\[CapitalSigma]", "=", 
      RowBox[{"(", GridBox[{
         {"\[CapitalSigma]1", 
          RowBox[{
           SqrtBox[
            RowBox[{"\[CapitalSigma]1", " ", "\[CapitalSigma]2"}]], " ", 
           "\[Rho]s"}]},
         {
          RowBox[{
           SqrtBox[
            RowBox[{"\[CapitalSigma]1", " ", "\[CapitalSigma]2"}]], " ", 
           "\[Rho]s"}], "\[CapitalSigma]2"}
        }], ")"}]}], ";", 
     RowBox[{"S", "=", 
      RowBox[{"{", 
       RowBox[{"S1", ",", "S2"}], "}"}]}], ";", 
     RowBox[{"\[Rho]", "=", 
      RowBox[{"{", 
       RowBox[{"\[Rho]1", ",", "\[Rho]2"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"strikes", "=", 
      RowBox[{"{", 
       RowBox[{
       "0.01", ",", "0.0125", ",", "0.015", ",", "0.0175", ",", "0.02", ",", 
        "0.021", ",", "0.022", ",", "0.023", ",", "0.024", ",", "0.0245", ",",
         "0.025", ",", "0.0255", ",", "0.026", ",", "0.0265", ",", "0.027", 
        ",", "0.028", ",", "0.029", ",", "0.03", ",", "0.031", ",", "0.032", 
        ",", "0.033", ",", "0.034", ",", "0.035", ",", "0.036", ",", "0.037", 
        ",", "0.038", ",", "0.039", ",", "0.04", ",", "0.045", ",", "0.048", 
        ",", "0.05", ",", "0.055", ",", "0.058", ",", "0.06", ",", "0.062", 
        ",", "0.065", ",", "0.07", ",", "0.075", ",", "0.08", ",", "0.085", 
        ",", "0.09", ",", "0.095", ",", "0.1", ",", "0.11", ",", "0.12"}], 
       "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Q", "=", 
      RowBox[{"(", GridBox[{
         {"0.25", "0"},
         {"0", "0.25"}
        }], ")"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"prices", "=", 
      RowBox[{"SmileBiHestonUnderlying1Vanilla2", "[", 
       RowBox[{
       "S", ",", "\[Alpha]1", ",", "a", ",", "strikes", ",", "\[Tau]", ",", 
        "\[CapitalSigma]", ",", "M", ",", "\[CapitalSigma]inf", ",", "Q", ",",
         "\[Rho]", ",", "\[Mu]", ",", "printflag"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"smile", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"strikes", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"ImpVolBS", "[", 
           RowBox[{"S1", ",", 
            RowBox[{"strikes", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "\[Tau]", ",", 
            RowBox[{"prices", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "strikes", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"inter", "=", 
      RowBox[{"Interpolation", "[", "smile", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Nu]H2", "=", 
      RowBox[{"2", 
       SqrtBox[
        RowBox[{
         RowBox[{
          RowBox[{"Q", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}], "^", "2"}], "+", 
         RowBox[{
          RowBox[{"Q", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "2"}], "]"}], "]"}], "^", "2"}]}]]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Rho]H2", "=", "\[Rho]2"}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Lambda]H2", "=", 
      RowBox[{
       RowBox[{"-", "2"}], 
       RowBox[{"M", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Theta]H2", "=", 
      RowBox[{"\[Theta]2", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SqrtBox[
            RowBox[{"\[Theta]1", " ", "\[Theta]2"}]], " ", "\[Rho]sinf"}], 
          "-", 
          RowBox[{
           SqrtBox[
            RowBox[{"\[CapitalSigma]1", " ", "\[CapitalSigma]2"}]], " ", 
           "\[Rho]s"}]}], ")"}], 
        FractionBox[
         RowBox[{"M", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}], 
         RowBox[{"M", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}]]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<{\[Lambda]H2,\[Theta]H2,\[Nu]H2,\[Rho]H2}=\>\"", ",", 
       RowBox[{"{", 
        RowBox[{
        "\[Lambda]H2", ",", "\[Theta]H2", ",", "\[Nu]H2", ",", "\[Rho]H2"}], 
        "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"prices", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"LNHestonVanillaCall", "[", 
         RowBox[{"S2", ",", 
          RowBox[{"strikes", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", "\[CapitalSigma]2", ",", 
          "\[Tau]", ",", "\[Lambda]H2", ",", "\[Theta]H2", ",", "\[Nu]H2", 
          ",", "\[Rho]H2", ",", "limsup"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "strikes", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"smile", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"strikes", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"ImpVolBS", "[", 
           RowBox[{"S1", ",", 
            RowBox[{"strikes", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "\[Tau]", ",", 
            RowBox[{"prices", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "strikes", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"inter2", "=", 
      RowBox[{"Interpolation", "[", "smile", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"smileMarket", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"strikes", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"MarketCMSOptionVol", "[", 
            RowBox[{
             RowBox[{"strikes", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "\[Tau]", ",", "tenor"}], 
            "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "strikes", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"interMarket", "=", 
      RowBox[{"Interpolation", "[", "smileMarket", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"inter", "[", "x", "]"}], ",", 
         RowBox[{"inter2", "[", "x", "]"}], ",", 
         RowBox[{"interMarket", "[", "x", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{"strikes", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"Last", "[", "strikes", "]"}]}], "}"}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", "\"\<Implied BS vol\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"PlotLegend", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
         "\"\<BiHestonUnderlying2\>\"", ",", "\"\<Heston\>\"", ",", 
          "\"\<Market\>\""}], "}"}]}], ",", 
       RowBox[{"LegendPosition", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0"}], "}"}]}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0.3"}], "}"}]}]}], "]"}]}]}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.4057762003884954`*^9, 3.4057762025760374`*^9}, 
   3.405776255905186*^9, 3.405776416377017*^9, {3.4057800166648912`*^9, 
   3.4057800478217397`*^9}, {3.4057804365948286`*^9, 
   3.4057804765330954`*^9}, {3.405780805461286*^9, 3.405780852274685*^9}, {
   3.405780886540968*^9, 3.405780890916052*^9}, {3.4057809307761917`*^9, 
   3.40578097858961*^9}, {3.4057810164653373`*^9, 3.405781039372027*^9}, {
   3.4057810767477446`*^9, 3.4057810779040165`*^9}, {3.4057811268424563`*^9, 
   3.405781323018098*^9}, {3.405782231113658*^9, 3.405782274176985*^9}, 
   3.405782619449239*^9, {3.4057826743877935`*^9, 3.4057826899974685`*^9}, {
   3.4057830666922007`*^9, 3.405783080770596*^9}, {3.405784231730194*^9, 
   3.4057842850280924`*^9}, {3.4057843588576345`*^9, 
   3.4057844294839907`*^9}, {3.405784469937893*^9, 3.405784493453969*^9}, {
   3.405784536564172*^9, 3.405784565455352*^9}, 3.405784639222393*^9, 
   3.405784935024947*^9, 3.405785043355152*^9, 3.4057851172315702`*^9, 
   3.4057854921762695`*^9, {3.4057856229131546`*^9, 3.4057856243819323`*^9}, {
   3.4057858318390408`*^9, 3.4057858558707523`*^9}, {3.405785917590687*^9, 
   3.405785956138302*^9}, {3.405786069874861*^9, 3.405786093844071*^9}, {
   3.4057861330323234`*^9, 3.4057862199558673`*^9}, {3.4057862719724913`*^9, 
   3.4057863361612234`*^9}, {3.4057865187272286`*^9, 3.405786547821537*^9}, {
   3.4057866082133217`*^9, 3.405786663495633*^9}, {3.4057882781360083`*^9, 
   3.4057882864799185`*^9}, {3.4057907817465773`*^9, 3.405790790449869*^9}, {
   3.4057908885455027`*^9, 3.4057908910143003`*^9}, {3.4057918203133917`*^9, 
   3.40579182125091*^9}, {3.405792185414152*^9, 3.405792211727157*^9}, 
   3.4057925336552134`*^9, 3.4057925855468345`*^9, {3.4057926925020127`*^9, 
   3.405792696111457*^9}, {3.405792752003155*^9, 3.4057927525187902`*^9}, {
   3.405941648091896*^9, 3.4059418314547915`*^9}, {3.405941926097234*^9, 
   3.405941940191254*^9}, {3.4059421299761477`*^9, 3.4059423046513767`*^9}, {
   3.405942483217305*^9, 3.4059424945300226`*^9}, {3.4059425429215765`*^9, 
   3.405942548671687*^9}, {3.405942651751791*^9, 3.4059427327377205`*^9}, {
   3.405942763988321*^9, 3.405942777801086*^9}, {3.4059443173462696`*^9, 
   3.405944558569651*^9}, {3.4059452030664005`*^9, 3.4059452053164434`*^9}, {
   3.405945361663195*^9, 3.4059456457623997`*^9}, {3.4059456851694064`*^9, 
   3.4059456922945433`*^9}, {3.405945957877767*^9, 3.4059459877533407`*^9}, {
   3.4059461661005154`*^9, 3.4059461689755707`*^9}, {3.4059463494790363`*^9, 
   3.405946350947814*^9}, {3.4059464969037414`*^9, 3.405946497685006*^9}, {
   3.405946601061991*^9, 3.405946605015192*^9}, 3.405946671563345*^9, {
   3.4059467461741524`*^9, 3.405946751314876*^9}, {3.405946800222065*^9, 
   3.4059468100347533`*^9}, {3.4059469260369806`*^9, 3.405946934334015*^9}, {
   3.405947047414311*^9, 3.4059470504612446`*^9}, {3.4059471719167013`*^9, 
   3.405947182010645*^9}, {3.4059494736483936`*^9, 3.405949480851657*^9}, 
   3.405949636042137*^9, 3.405949755060047*^9, 3.4059499185944366`*^9, {
   3.4059501806463428`*^9, 3.4059501943966064`*^9}, {3.4059503280710487`*^9, 
   3.4059503324461327`*^9}, {3.405950473995725*^9, 3.4059504837771626`*^9}, {
   3.4059506665306716`*^9, 3.4059506669525547`*^9}, {3.405950768938888*^9, 
   3.4059507691107664`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Nb1=\"\>", "\[InvisibleSpace]", "30", 
   "\[InvisibleSpace]", "\<\" Nb1n=\"\>", "\[InvisibleSpace]", "10", 
   "\[InvisibleSpace]", "\<\" Nb2=\"\>", "\[InvisibleSpace]", "30"}],
  SequenceForm["Nb1=", 30, " Nb1n=", 10, " Nb2=", 30],
  Editable->False]], "Print",
 CellChangeTimes->{3.405950667749445*^9, 3.405950769532649*^9, 
  3.406309426657578*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\" S=\"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {"0.04818389411495181`"},
        {"0.04818389411495181`"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], 
   "\[InvisibleSpace]", "\<\" \[CapitalSigma]=\"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0.01`", "0.`"},
       {"0.`", "0.01`"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], "\[InvisibleSpace]", "\<\"M=\"\>", 
   "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"-", "0.35`"}], "0.`"},
       {"0.`", 
        RowBox[{"-", "0.35`"}]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], 
   "\[InvisibleSpace]", "\<\" \[CapitalSigma]inf=\"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0.03`", "0.`"},
       {"0.`", "0.03`"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], "\[InvisibleSpace]", "\<\" Q=\"\>", 
   "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0.25`", "0"},
       {"0", "0.25`"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], "\[InvisibleSpace]", "\<\" \[Rho]=\"\>", 
   "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {
         RowBox[{"-", "0.45`"}]},
        {
         RowBox[{"-", "0.45`"}]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], 
   "\[InvisibleSpace]", "\<\" Imaginary Shifts=\"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {"2"},
        {"1.1`"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], "\[InvisibleSpace]", "\<\" \[Beta]m =\"\>", 
   "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0.16799999999999998`", "0.`"},
       {"0.`", "0.16799999999999998`"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm[" S=", 
   MatrixForm[{0.04818389411495181, 0.04818389411495181}], 
   " \[CapitalSigma]=", 
   MatrixForm[{{0.01, 0.}, {0., 0.01}}], "M=", 
   MatrixForm[{{-0.35, 0.}, {0., -0.35}}], " \[CapitalSigma]inf=", 
   MatrixForm[{{0.03, 0.}, {0., 0.03}}], " Q=", 
   MatrixForm[{{0.25, 0}, {0, 0.25}}], " \[Rho]=", 
   MatrixForm[{-0.45, -0.45}], " Imaginary Shifts=", 
   MatrixForm[{2, 1.1}], " \[Beta]m =", 
   MatrixForm[{{0.16799999999999998`, 0.}, {0., 0.16799999999999998`}}]],
  Editable->False]], "Print",
 CellChangeTimes->{3.405950667749445*^9, 3.405950769532649*^9, 
  3.406309426686578*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"{NbLegCoef1,NbLegCoef1n,period1,period1n,\[Epsilon]1,imax}=\"\>\
", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"30", ",", "10", ",", "12", ",", "5", ",", "1.`*^-7", ",", "10"}],
     "}"}], "\[InvisibleSpace]", \
"\<\"{NbLegCoef2,period2,period2n,\[Epsilon]2}=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"30", ",", "12", ",", "1.6`", ",", "1.`*^-7"}], "}"}]}],
  SequenceForm[
  "{NbLegCoef1,NbLegCoef1n,period1,period1n,\[Epsilon]1,imax}=", {
   30, 10, 12, 5, 1.*^-7, 10}, "{NbLegCoef2,period2,period2n,\[Epsilon]2}=", {
   30, 12, 1.6, 1.*^-7}],
  Editable->False]], "Print",
 CellChangeTimes->{3.405950667749445*^9, 3.405950769532649*^9, 
  3.4063094266885777`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{"\<\"BiHestonLaplaceQuickTransform2[M,Q,\[Rho], \[Mu],\
\[CapitalSigma],{-\[ImaginaryI] 1,-\[ImaginaryI] 1},\[Beta]m,\[Tau]]=\"\>", 
    "\[InvisibleSpace]", "0.8990728085227759`"}], "\[InvisibleSpace]", "+", 
   RowBox[{"0.06104047231700189`", " ", "\[ImaginaryI]"}]}],
  SequenceForm[
  "BiHestonLaplaceQuickTransform2[M,Q,\[Rho], \[Mu],\[CapitalSigma],{-\
\[ImaginaryI] 1,-\[ImaginaryI] 1},\[Beta]m,\[Tau]]=", 
   Complex[0.8990728085227759, 0.06104047231700189]],
  Editable->False]], "Print",
 CellChangeTimes->{3.405950667749445*^9, 3.405950769532649*^9, 
  3.406309426689578*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"integrand(0.1,0.1)=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "7.49706183038472`", ",", "5.999382726249417`", ",", "4.998817887751574`",
      ",", "4.2831059767324655`", ",", "3.745788892964161`", ",", 
     "3.566588100217242`", ",", "3.40363967301438`", ",", 
     "3.2548301774777517`", ",", "3.1183973788405996`", ",", 
     "3.054349984303728`", ",", "2.9928601936393844`", ",", 
     "2.9337779650589333`", ",", "2.8769647662840083`", ",", 
     "2.822292491646854`", ",", "2.7696424992103736`", ",", 
     "2.6699770549601785`", ",", "2.5771781693488385`", ",", 
     "2.4905606899269`", ",", "2.4095276623530397`", ",", 
     "2.333556581058079`", ",", "2.2621881343721353`", ",", 
     "2.1950169315902652`", ",", "2.1316838163786733`", ",", 
     "2.071869458670167`", ",", "2.0152889836377414`", ",", 
     "1.9616874470667052`", ",", "1.910836005489768`", ",", 
     "1.862528659723533`", ",", "1.6532232100225472`", ",", 
     "1.548594346370245`", ",", "1.4858277466862873`", ",", 
     "1.348918424146954`", ",", "1.278127215830718`", ",", 
     "1.2348756261097242`", ",", "1.1944219385443968`", ",", 
     "1.1384223819152488`", ",", "1.0557885025767466`", ",", 
     "0.9842087347735452`", ",", "0.921608940059369`", ",", 
     "0.8664029459358856`", ",", "0.8173570650219258`", ",", 
     "0.7734973707407913`", ",", "0.7340447750406072`", ",", 
     "0.6659530735671538`", ",", "0.6092701425752287`"}], "}"}]}],
  SequenceForm[
  "integrand(0.1,0.1)=", {7.49706183038472, 5.999382726249417, 
   4.998817887751574, 4.2831059767324655`, 3.745788892964161, 
   3.566588100217242, 3.40363967301438, 3.2548301774777517`, 
   3.1183973788405996`, 3.054349984303728, 2.9928601936393844`, 
   2.9337779650589333`, 2.8769647662840083`, 2.822292491646854, 
   2.7696424992103736`, 2.6699770549601785`, 2.5771781693488385`, 
   2.4905606899269, 2.4095276623530397`, 2.333556581058079, 
   2.2621881343721353`, 2.1950169315902652`, 2.1316838163786733`, 
   2.071869458670167, 2.0152889836377414`, 1.9616874470667052`, 
   1.910836005489768, 1.862528659723533, 1.6532232100225472`, 
   1.548594346370245, 1.4858277466862873`, 1.348918424146954, 
   1.278127215830718, 1.2348756261097242`, 1.1944219385443968`, 
   1.1384223819152488`, 1.0557885025767466`, 0.9842087347735452, 
   0.921608940059369, 0.8664029459358856, 0.8173570650219258, 
   0.7734973707407913, 0.7340447750406072, 0.6659530735671538, 
   0.6092701425752287}],
  Editable->False]], "Print",
 CellChangeTimes->{3.405950667749445*^9, 3.405950769532649*^9, 
  3.406309426691578*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"{\[Lambda]H2,\[Theta]H2,\[Nu]H2,\[Rho]H2}=\"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.7`", ",", "0.03`", ",", "0.5`", ",", 
     RowBox[{"-", "0.45`"}]}], "}"}]}],
  SequenceForm[
  "{\[Lambda]H2,\[Theta]H2,\[Nu]H2,\[Rho]H2}=", {0.7, 0.03, 0.5, -0.45}],
  Editable->False]], "Print",
 CellChangeTimes->{3.405950667749445*^9, 3.405950769532649*^9, 
  3.406309432778578*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"6.566999999999997`", ",", 
   GraphicsBox[{InsetBox[
      GraphicsBox[{{}, {}, 
        {Hue[0.67, 0.6, 0.6], LineBox[CompressedData["
1:eJwd1gk0Fe//B/CStKBSX0lJl0qyFQop3ikpS4uUIhGSkqWyJGUpEaJNiJSQ
5br3zr12MvdaisiSJZK+LZZoQSVb0df/+f3nnDlzXmfmzHPm8zyf9zNyDh77
nYSmTZs2Qs7/XXW5M+PTTO5A8/+PFiyL4MXTO6MxpEltX32kGT3HzvYamEdj
6SbpdgeLZrC1NTSfW0ejvYd1It20GVs+5dY1uUXjzY7HttjSDJuthVO90dHY
V+W0vmh5MxJH+U4SH6OhfHXf/PLOJsg61qqf8L2L7WLfjoi7N4GxpbdmPjMG
019G9l+MbcTSor0eQ9kxKA9quhNwqxGSG4r/aX0Sg4GsnXYhEY2YqxJpl1AX
A2OjPpukgEYML9MYWfUjBnrM2nBh50ZUT/gzdLVjcT75y6NbOo04WyJ5/nhl
LN6+SIlU4b9Ehe6OVcWdcbi5I5i17XQDXKVrI/4zToDiVT+lA321uMxYRYtk
JGKQda3LvrEGml7pUk5vH2Kn8z3L5fLVGGvJKOUmPYJO0IRXSUQV5P+5Pfsw
PxkT1zxXf9atRPDn7gL71hQsZ1ldTlz0DH0qJqc3zXyMkbgPnla/KpAgVbmB
ZqShLSlMbv/0CpifsxAWP5COFYOPG8cWl0PP3nRT6eUMXGly3TNiVoY70Z7U
qtAMqNw+MEvfpAy9lfdXRkRkwLNX1StsZxluKfWLH4zOgHtv92n5bWXo+RXZ
9fVxBqzNUrtctMsQGdpwfXF1Bl6pP3LeI1+GDpb5e7d5mQjuVtn2fKgUvqOH
gmXuZyLIotanzqoUUT731ncmZWLE6qv2hwOlSBltf5f2OBM61xN2je4tRd2o
lc46KhN5plU26kalYIwdGTAoz4SqxZDrW41SVI/ZHXLuy0T+z1cS08RLIfXb
WTlHk4kQ6bC4O88EULmQ2e6jw4TJ8yNG6mUCbP39OWSzHhOLIwOdXpUI4PL7
1MdnRkyY6bwcX5MrgOD36ZjXVkx0r9W6JZwiwIk/HlOTgUzs7LN2vhskQMHE
+ZaddUwMCtxyQgwEON4gplrSyMTGeq8Z0/QFWJicHKrWygQzrv1UgK4AHka1
myTfM9G2utjzmqYAirdlH3V9ZyIi7OeJF6sFiFeodPVflAX3sx0rF4kKcMl8
oUiudRbeyjnRWe18KK3KsFOwy0Kn0BGj9FY+2kc3F8c7ZkGq6ml9WjMfGxOd
XINcs9Bc+KOJV8fHYG9R8+6ALFQzaxNGy/g4dsku6XNyFmqaGNe2ZvGxPYOt
I/uFPH+FcbM6kI+c51YvfgxkofDN4iAxfz4Yn0Vsng5lgSmpLXzQj49JRfvA
k5NZiMpaU/HLi4+CLMmqnPksHDJW+uPswociFWCxU4uFHw78ECVLPmIblD9J
b2bB/KuudqEFH8Lf2336wYLqPLbrLnM+OtdpJtw2ZkEl/r6drxkfCdl9H9/a
sLCPv8B03nY+xPL3uZ8JZkHZ6IijhDoffq1/p7aFsdDpNdH5SY2PzyNZtyWj
WAgcO9wqUOGjUmtm/pNYFnafCFgcoMhHQFHxhHAWCxrfWvrUGXz8KJEPj29k
QToh+6fbAj5s/3251LWVhf9655uEz+OjbvISW7+DhU0YmcUU44Op9/pldzcL
YYHXeCOz+XAovb5YbYyF6K3KCU+n8/GqYji1YjkbFnXn/6wfphEdrl0SIM/G
ghM+dPwQjf37/Jp117AxQhezRX7SaHw3NS13PRtbJssu/BmgUT8+1zZ1Oxuz
3qpeXPqZRpWa3JKrp9hYKZHsI/eORsiI47qt7mx8chYSvHpLw5BON5o8x4Zk
SaZEZAeNCmMVb69LbDzeUdko0k5DcFy7+fhNNj57GlqotNAoTNgduSOfDSnf
m7c3vKDhY38rdfoTNmbH2EitqaGhpdjyhC9gY67LOe/l1TTy8g9/2VjNhqby
BY5kFQ1eo6ORwls2PO/8ztasoOERl3606wMbtuMLkwzLaajZfvF62MPGumEf
E6syGuxv7qmLB9lwT1zxMkpAI1PEb9qs6RzQ2n82rCyh4VxPSz2dycHmVvdi
8yc0FO5OqQXO5ZA8WdcVXEzjsVzI0bFFHIztv7foVyGN5C23nvQpcJD/7+z7
k3k0Es6le1WbcSA7mni8mEtj6LqejqY5eV6ks1aJ2CTt1cSDg8RFfupJFI2J
10LBnrYciOTLDdzi0LDRs7ste4YD7t9j/8axyPdajh4I9yL3Z3v3M4jFz0Qt
GfblQCDz7BM7i9QzpSSp5jIHA9Kh4fVMGitmL6G8ojmIsaBN1TNp+Mpxz36I
40A/ufZIUwaZX12jjSaJHFxxmIAXcZCbF70ijYMLw2p+Fek02kNFgyKYHPit
6H/hRqz+KGX7CIeDvHNbPi0j7mpufPGigAM3ozmuQWk0dPudb2ws4WCLHFq0
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
          "]]}, 
        {Hue[0.9060679774997897, 0.6, 0.6], LineBox[CompressedData["
1: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
/D9iXIVl
          "]]}, 
        {Hue[0.14213595499957954`, 0.6, 0.6], LineBox[CompressedData["
1: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
onR4dcRKz3r79hOfE/3UziX+DzTIdRc=
          "]]}},
       AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
       Axes->True,
       AxesOrigin->{0.02, 0},
       DisplayFunction:>$DisplayFunction,
       FormatType->TraditionalForm,
       PlotLabel->FormBox["\"Implied BS vol\"", TraditionalForm],
       PlotRange->{{0.01, 0.12}, {0, 0.3}},
       PlotRangeClipping->True,
       PlotRangePadding->{
         Scaled[0.02], Automatic}], {-1, -0.6180339887498948}, {
      Left, Bottom}, {2, 1.2360679774997896`}], {
      {GrayLevel[0], 
       RectangleBox[{1.05, -0.05}, \
{1.7804347826086957`, 0.7500000000000001}]}, 
      {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[0.001]}], 
       RectangleBox[{1, 0}, {1.7304347826086959`, 0.8000000000000002}], 
       InsetBox[
        GraphicsBox[{{{InsetBox[
             GraphicsBox[
              {Hue[0.1421359549995791, 0.6, 0.6], 
               LineBox[{{0, 0}, {1, 0}}]}], {0.08, 0.08}, {
             Left, Bottom}, {1, 1}], 
            InsetBox["\<\"Market\"\>", {1.21, 0.58}, {-1, 0}, Automatic, {1, 
             0}]}, {InsetBox[
             GraphicsBox[
              {Hue[0.9060679774997897, 0.6, 0.6], 
               LineBox[{{0, 0}, {1, 0}}]}], {0.08, 1.24}, {
             Left, Bottom}, {1, 1}], 
            InsetBox["\<\"Heston\"\>", {1.21, 1.74}, {-1, 0}, Automatic, {1, 
             0}]}, {InsetBox[
             GraphicsBox[
              {Hue[0.67, 0.6, 0.6], 
               LineBox[{{0, 0}, {1, 0}}]}], {0.08, 2.4}, {
             Left, Bottom}, {1, 1}], 
            InsetBox["\<\"BiHestonUnderlying2\"\>", {1.21, 2.9}, {-1, 0}, 
             Automatic, {1, 0}]}}, {}},
         AspectRatio->1.0952380952380953`,
         FormatType->TraditionalForm,
         PlotRange->{{-0.1, 3.26}, {-0.1, 3.5799999999999996`}}], {1, 0}, {
        Left, Bottom}, {0.7304347826086958, 0.8000000000000002}]}}},
    AspectRatio->Automatic,
    Background->None,
    ColorOutput->Automatic,
    ImageSize->Automatic,
    PlotRange->All]}], "}"}]], "Output",
 CellChangeTimes->{3.405950684202886*^9, 3.405950786861107*^9, 
  3.406309433420578*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"S1", ",", "S2", ",", 
      RowBox[{"M1", "=", 
       RowBox[{"-", "0.35"}]}], ",", 
      RowBox[{"M2", "=", 
       RowBox[{"-", "0.35"}]}], ",", 
      RowBox[{"\[Rho]s", "=", "0.1"}], ",", 
      RowBox[{"\[Rho]sinf", "=", "0.1"}], ",", 
      RowBox[{"\[Rho]m1", "=", "0."}], ",", 
      RowBox[{"\[Rho]m2", "=", "0."}], ",", 
      RowBox[{"\[Rho]1", "=", 
       RowBox[{"-", "0.45"}]}], ",", 
      RowBox[{"\[Rho]2", "=", 
       RowBox[{"-", "0.45"}]}], ",", " ", "\[CapitalSigma]1", ",", 
      "\[CapitalSigma]2", ",", "\[Theta]1", ",", "\[Theta]2", ",", 
      RowBox[{"\[Tau]", "=", "5"}], ",", 
      RowBox[{"\[Alpha]1", "=", "1"}], ",", 
      RowBox[{"a", "=", "1"}], ",", "M", ",", "\[CapitalSigma]inf", ",", 
      "\[CapitalSigma]", ",", "Q", ",", "\[Beta]m", ",", "S", ",", "\[Rho]", 
      ",", 
      RowBox[{"printflag", "=", 
       RowBox[{"{", "1", "}"}]}], ",", 
      RowBox[{"\[Mu]", "=", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], ",", "inter1", ",", "inter2", ",", 
      "inter3", ",", "smileLN", ",", "interLN", ",", "prices", ",", 
      RowBox[{"tenor1", "=", "\"\<cms2\>\""}], ",", 
      RowBox[{"tenor2", "=", "\"\<cms10\>\""}], ",", "K", ",", "\[Beta]", ",",
       
      RowBox[{"limsup", "=", "1000"}], ",", "\[Rho]H1", ",", "\[Nu]H2", ",", 
      "\[Rho]H2", ",", "\[Lambda]H2", ",", "\[Theta]H2", ",", "\[Nu]1", ",", 
      "\[Nu]2", ",", 
      RowBox[{"Lcoefs", "=", 
       RowBox[{"LegendreCoeffs", "[", "40", "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[CapitalSigma]1", "=", "0.01"}], ";", 
     RowBox[{"\[CapitalSigma]2", "=", "0.01"}], ";", 
     RowBox[{"\[Theta]1", "=", 
      RowBox[{"3.", "\[CapitalSigma]1"}]}], ";", 
     RowBox[{"\[Theta]2", "=", 
      RowBox[{"3.", "\[CapitalSigma]2"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"S1", "=", 
      RowBox[{
       RowBox[{"MarketCMSForward", "[", 
        RowBox[{"\[Tau]", ",", "tenor1"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", 
     RowBox[{"S2", "=", 
      RowBox[{
       RowBox[{"MarketCMSForward", "[", 
        RowBox[{"\[Tau]", ",", "tenor2"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"M", "=", 
      RowBox[{"(", GridBox[{
         {"M1", 
          RowBox[{"\[Rho]m1", 
           SqrtBox[
            RowBox[{"M1", " ", "M2"}]]}]},
         {
          RowBox[{"\[Rho]m2", 
           SqrtBox[
            RowBox[{"M1", " ", "M2"}]]}], "M2"}
        }], ")"}]}], ";", 
     RowBox[{"\[CapitalSigma]inf", "=", 
      RowBox[{"(", GridBox[{
         {"\[Theta]1", 
          RowBox[{
           SqrtBox[
            RowBox[{"\[Theta]1", " ", "\[Theta]2"}]], " ", "\[Rho]sinf"}]},
         {
          RowBox[{
           SqrtBox[
            RowBox[{"\[Theta]1", " ", "\[Theta]2"}]], " ", "\[Rho]sinf"}], 
          "\[Theta]2"}
        }], ")"}]}], ";", 
     RowBox[{"\[CapitalSigma]", "=", 
      RowBox[{"(", GridBox[{
         {"\[CapitalSigma]1", 
          RowBox[{
           SqrtBox[
            RowBox[{"\[CapitalSigma]1", " ", "\[CapitalSigma]2"}]], " ", 
           "\[Rho]s"}]},
         {
          RowBox[{
           SqrtBox[
            RowBox[{"\[CapitalSigma]1", " ", "\[CapitalSigma]2"}]], " ", 
           "\[Rho]s"}], "\[CapitalSigma]2"}
        }], ")"}]}], ";", 
     RowBox[{"S", "=", 
      RowBox[{"{", 
       RowBox[{"S1", ",", "S2"}], "}"}]}], ";", 
     RowBox[{"\[Rho]", "=", 
      RowBox[{"{", 
       RowBox[{"\[Rho]1", ",", "\[Rho]2"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Q", "=", 
      RowBox[{"(", GridBox[{
         {"0.25", "0.01"},
         {"0.01", "0.25"}
        }], ")"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"strikes", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "0.01"}], ",", 
        RowBox[{"-", "0.005"}], ",", 
        RowBox[{"-", "0.002"}], ",", 
        RowBox[{"-", "0.001"}], ",", 
        RowBox[{"-", "0.0005"}], ",", 
        RowBox[{"-", "0.0002"}], ",", 
        RowBox[{"-", "0.0001"}], ",", "0", ",", "0.0001", ",", "0.0002", ",", 
        "0.0005", ",", "0.001", ",", "0.002", ",", "0.005", ",", "0.0075", 
        ",", "0.01", ",", "0.015"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"prices", "=", 
      RowBox[{"SmileBiHestonVanilla2", "[", 
       RowBox[{
       "S", ",", "1", ",", "1", ",", "1", ",", "1", ",", "strikes", ",", 
        "\[Tau]", ",", "\[CapitalSigma]", ",", "M", ",", "\[CapitalSigma]inf",
         ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", "printflag"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"smile", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"strikes", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"NormalImplicitVol", "[", 
           RowBox[{
            RowBox[{"S1", "-", "S2"}], ",", 
            RowBox[{"strikes", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "\[Tau]", ",", 
            RowBox[{"prices", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "strikes", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"inter1", "=", 
      RowBox[{"Interpolation", "[", "smile", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"smileMarket", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"strikes", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"MarketCMSSpreadOptionNormalVol", "[", 
            RowBox[{
             RowBox[{"strikes", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "\[Tau]", ",", "tenor1", 
             ",", "tenor2"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "strikes", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"interMarket1", "=", 
      RowBox[{"Interpolation", "[", "smileMarket", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "differrentes", " ", "approx", " ", "pour", " ", "les", " ", "vol", " ",
        "normal", " ", "des", " ", "underlying"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"\[Nu]1", "=", 
      SqrtBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"Q", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"Q", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}], "2"]}]]}], ";", 
     RowBox[{"\[Nu]2", "=", 
      SqrtBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"Q", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"Q", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}], "2"]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Rho]H1", "=", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"Q", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], "\[Rho]1"}], " ", "+", 
        RowBox[{
         RowBox[{"Q", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}], "\[Rho]2"}]}], 
       SqrtBox[
        RowBox[{
         SuperscriptBox[
          RowBox[{"Q", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"Q", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "1"}], "]"}], "]"}], "2"]}]]]}], ";", 
     RowBox[{"\[Rho]H2", "=", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"Q", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}], "\[Rho]1"}], " ", "+", 
        RowBox[{
         RowBox[{"Q", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}], "\[Rho]2"}]}], 
       SqrtBox[
        RowBox[{
         SuperscriptBox[
          RowBox[{"Q", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "2"}], "]"}], "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"Q", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}], "2"]}]]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"vol1", "=", 
      RowBox[{"ImpVolHeston2", "[", 
       RowBox[{
       "S1", ",", "S1", ",", "\[Tau]", ",", "\[CapitalSigma]1", ",", 
        "\[Theta]1", ",", "\[Rho]H1", ",", 
        RowBox[{"-", "M1"}], ",", "\[Nu]1", ",", "Lcoefs"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"vol2", "=", 
      RowBox[{"ImpVolHeston2", "[", 
       RowBox[{
       "S2", ",", "S2", ",", "\[Tau]", ",", "\[CapitalSigma]2", ",", 
        "\[Theta]2", ",", "\[Rho]H2", ",", 
        RowBox[{"-", "M2"}], ",", "\[Nu]2", ",", "Lcoefs"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"NormalVol1", "=", 
      RowBox[{"vol1", "  ", "S1"}]}], ";", 
     RowBox[{"NormalVol1a", "=", 
      RowBox[{"NormalImplicitVol", "[", 
       RowBox[{"S1", ",", "S1", ",", "\[Tau]", ",", 
        RowBox[{"BS", "[", 
         RowBox[{"S1", ",", "S1", ",", "\[Tau]", ",", "vol1"}], "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"NormalVol2", "=", 
      RowBox[{"vol2", " ", "S2"}]}], ";", 
     RowBox[{"NormalVol2a", "=", 
      RowBox[{"NormalImplicitVol", "[", 
       RowBox[{"S2", ",", "S2", ",", "\[Tau]", ",", 
        RowBox[{"BS", "[", 
         RowBox[{"S2", ",", "S2", ",", "\[Tau]", ",", "vol2"}], "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"NormalVol1b", "=", 
      RowBox[{
       RowBox[{"MarketCMSOptionVol", "[", 
        RowBox[{"S1", ",", "\[Tau]", ",", "tenor1"}], "]"}], "  ", "S1"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"NormalVol2b", "=", 
      RowBox[{
       RowBox[{"MarketCMSOptionVol", "[", 
        RowBox[{"S2", ",", "\[Tau]", ",", "tenor2"}], "]"}], "  ", "S2"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<\[Nu]1=\>\"", ",", "\[Nu]1", ",", "\"\< \[Nu]2=\>\"", ",", 
       "\[Nu]2", ",", "\"\< \[Rho]H1=\>\"", ",", "\[Rho]H1", ",", 
       "\"\< \[Rho]H2=\>\"", ",", "\[Rho]H2", ",", "\"\< vol1=\>\"", ",", 
       "vol1", ",", "\"\< vol2=\>\"", ",", "vol2", ",", 
       "\"\< NormalVol1=\>\"", ",", "NormalVol1", ",", "\"\< NormalVol2=\>\"",
        ",", "NormalVol2", ",", "\"\< NormalVol1a=\>\"", ",", "NormalVol1a", 
       ",", "\"\< NormalVol2a=\>\"", ",", "NormalVol2a", ",", 
       "\"\< NormalVol1b=\>\"", ",", "NormalVol1b", ",", 
       "\"\< NormalVol2b=\>\"", ",", "NormalVol2b"}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", " ", 
     RowBox[{"smile", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"strikes", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"NormalImplicitCorrelation", "[", 
           RowBox[{"NormalVol1", " ", ",", "NormalVol2", ",", 
            RowBox[{"inter1", "[", 
             RowBox[{"strikes", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "strikes", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"inter10", "=", 
      RowBox[{"Interpolation", "[", "smile", "]"}]}], ";", 
     "\[IndentingNewLine]", " ", 
     RowBox[{"smileMarket", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"strikes", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"NormalImplicitCorrelation", "[", 
           RowBox[{"NormalVol1", " ", ",", "NormalVol2", ",", 
            RowBox[{"interMarket1", "[", 
             RowBox[{"strikes", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "strikes", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"interMarket10", "=", 
      RowBox[{"Interpolation", "[", "smileMarket", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Plot", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"inter1", "[", "x", "]"}], ",", 
            RowBox[{"interMarket1", "[", "x", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{"strikes", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"Last", "[", "strikes", "]"}]}], "}"}], ",", 
          RowBox[{
          "PlotLabel", "\[Rule]", "\"\<Implied normal vol MRev=0.15\>\""}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"PlotLegend", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<Biheston\>\"", ",", "\"\<Market\>\""}], "}"}]}]}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Plot", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"inter10", "[", "x", "]"}], ",", 
            RowBox[{"interMarket10", "[", "x", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{"strikes", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"Last", "[", "strikes", "]"}]}], "}"}], ",", 
          RowBox[{
          "PlotLabel", "\[Rule]", "\"\<Implied normal correlation\>\""}], ",",
           "\[IndentingNewLine]", 
          RowBox[{"PlotLegend", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<Biheston\>\"", ",", "\"\<Market\>\""}], "}"}]}]}], 
         "]"}]}], "}"}], "]"}]}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.400420962348207*^9, 3.4004210687721252`*^9}, {
   3.4004211951964273`*^9, 3.400421290026373*^9}, {3.4004217619885597`*^9, 
   3.400421783613975*^9}, {3.4009064818853397`*^9, 3.400906510698393*^9}, {
   3.4020336908625154`*^9, 3.4020337021752324`*^9}, {3.402033860818903*^9, 
   3.4020338717566133`*^9}, {3.4020340123218117`*^9, 3.402034022884515*^9}, {
   3.402143532804983*^9, 3.4021435714776*^9}, {3.4021502545434127`*^9, 
   3.402150277340726*^9}, {3.402150318060257*^9, 3.4021503190602765`*^9}, {
   3.4021508739146795`*^9, 3.402150926103182*^9}, {3.402205941048216*^9, 
   3.402206032299968*^9}, {3.402222386473337*^9, 3.4022223919109416`*^9}, {
   3.4022282113507977`*^9, 3.4022282342887383`*^9}, {3.4034169071994333`*^9, 
   3.4034171368132167`*^9}, {3.403417190251743*^9, 3.4034171928924184`*^9}, {
   3.4038720435454235`*^9, 3.4038720779367085`*^9}, {3.403872150328723*^9, 
   3.4038722699716454`*^9}, {3.4038728308886647`*^9, 3.403872841748248*^9}, {
   3.403872982829082*^9, 3.4038729829697094`*^9}, {3.403873031595643*^9, 
   3.403873031720646*^9}, {3.4038734196343436`*^9, 3.4038734198374724`*^9}, {
   3.4038753783750753`*^9, 3.403875380922*^9}, {3.40387624346981*^9, 
   3.403876243938569*^9}, 3.4038769829683833`*^9, {3.403877122346059*^9, 
   3.4038771227679424`*^9}, {3.4038771625499563`*^9, 3.403877163065591*^9}, {
   3.403877324631193*^9, 3.4038773551474037`*^9}, {3.4038773936168923`*^9, 
   3.40387739764822*^9}, {3.4038780215976996`*^9, 3.40387809141154*^9}, 
   3.4038782021792917`*^9, 3.4038782387893696`*^9, {3.4038791308846226`*^9, 
   3.403879131431508*^9}, {3.4038791725729227`*^9, 3.4038791727135506`*^9}, 
   3.403880915450135*^9, {3.403881572775256*^9, 3.4038816079634314`*^9}, {
   3.4038817484661293`*^9, 3.403881834889663*^9}, {3.403881964439026*^9, 
   3.4038819903613987`*^9}, {3.4038820541126223`*^9, 
   3.4038820551126413`*^9}, {3.403882087738268*^9, 3.4038822508976507`*^9}, {
   3.40388231024254*^9, 3.4038823888221736`*^9}, {3.4038826393894844`*^9, 
   3.403882698968753*^9}, 3.4038827641887555`*^9, {3.4038828400964627`*^9, 
   3.4038828570967894`*^9}, {3.4039407380848007`*^9, 3.40394075161631*^9}, {
   3.4039469958143215`*^9, 3.4039472324751153`*^9}, 3.4039472679757967`*^9, {
   3.403947357758771*^9, 3.4039473853218*^9}, {3.403947507839777*^9, 
   3.4039475596532717`*^9}, {3.4039476866088343`*^9, 3.403947691202673*^9}, {
   3.4039482225566244`*^9, 3.4039482791358356`*^9}, {3.403949588801606*^9, 
   3.403949589160988*^9}, {3.403949749835948*^9, 3.403949785352255*^9}, {
   3.4039500598262744`*^9, 3.4039500646232414`*^9}, {3.403950358238254*^9, 
   3.4039503617383213`*^9}, {3.403950421067585*^9, 3.4039504374897757`*^9}, {
   3.4039506060398865`*^9, 3.4039506065086455`*^9}, 3.4039508020436497`*^9, {
   3.4039508397318735`*^9, 3.403950861747921*^9}, {3.403950893982915*^9, 
   3.4039508942172947`*^9}, {3.403951078517708*^9, 3.403951078986467*^9}, {
   3.403952006348022*^9, 3.4039520495051003`*^9}, {3.4039520956153607`*^9, 
   3.4039521059593096`*^9}, {3.4039522097581778`*^9, 3.4039522109457*^9}, {
   3.403952602000083*^9, 3.403952625531785*^9}, {3.4039527686751585`*^9, 
   3.40395278725364*^9}, {3.403977810144146*^9, 3.403977810424946*^9}, {
   3.403977841858946*^9, 3.403977845353346*^9}, {3.404149383978135*^9, 
   3.4041493938841352`*^9}, 3.404194167101803*^9, {3.404194474420203*^9, 
   3.4041944878892117`*^9}, 3.4042069235810976`*^9, 3.40435950413175*^9, {
   3.40435963947735*^9, 3.40435967031855*^9}, {3.40435979385495*^9, 
   3.40435979937735*^9}, {3.40435992101055*^9, 3.40435992205575*^9}, 
   3.4043600113657503`*^9, {3.404717369926572*^9, 3.404717371066825*^9}, {
   3.4047176716322794`*^9, 3.4047176724916544`*^9}, 3.4048301886034374`*^9, 
   3.4048303265773706`*^9, {3.4048306033848743`*^9, 3.404830605556833*^9}, {
   3.405231889611527*^9, 3.405231957222633*^9}, {3.40523217215001*^9, 
   3.405232192494281*^9}, 3.405232322825742*^9, {3.405232588066907*^9, 
   3.4052327483053837`*^9}, {3.4052327818374925`*^9, 
   3.4052329101376514`*^9}, {3.405232998264908*^9, 3.4052330036087947`*^9}, {
   3.405233036109627*^9, 3.405233036672141*^9}, {3.4052330920173078`*^9, 
   3.4052332084421635`*^9}, 3.405233274850113*^9, {3.4052333740870285`*^9, 
   3.4052333823059893`*^9}, {3.405233536294306*^9, 3.4052335399037733`*^9}, {
   3.405233626030978*^9, 3.405233710626894*^9}, {3.4052337737066336`*^9, 
   3.405233823645412*^9}, {3.405233980711933*^9, 3.4052339810088153`*^9}, {
   3.4052340252911987`*^9, 3.405234026338101*^9}, {3.4052343131735687`*^9, 
   3.405234378581493*^9}, {3.405234433973536*^9, 3.405234454724067*^9}, 
   3.405234656244851*^9, {3.405234699917844*^9, 3.4052348279054956`*^9}, {
   3.405234890172714*^9, 3.405234991769065*^9}, 3.405235068333525*^9, {
   3.405235145382373*^9, 3.405235145944887*^9}, {3.4052352526038675`*^9, 
   3.4052353621379213`*^9}, {3.405235410748541*^9, 3.4052354130611*^9}, {
   3.405235459671668*^9, 3.4052354632186337`*^9}, {3.405235521548252*^9, 
   3.4052355398768463`*^9}, {3.405235639863781*^9, 3.405235654989168*^9}, {
   3.4052357842581024`*^9, 3.4052359585750647`*^9}, {3.405236038639614*^9, 
   3.405236054093135*^9}, 3.405236132704522*^9, {3.4052370022580323`*^9, 
   3.4052370715254307`*^9}, {3.4052371309332013`*^9, 3.405237145152315*^9}, {
   3.4052371787000494`*^9, 3.4052373726737647`*^9}, {3.405241052783271*^9, 
   3.405241082205899*^9}, {3.405241209240401*^9, 3.40524120941228*^9}, 
   3.405241278585926*^9, 3.405241367744458*^9, {3.405753643995677*^9, 
   3.405753671761835*^9}, {3.4057537026686788`*^9, 3.405753751794622*^9}, {
   3.4059514715617533`*^9, 3.4059514753430758`*^9}, {3.4059515294378643`*^9, 
   3.405951530875392*^9}, {3.405951562610376*^9, 3.405951571048038*^9}, {
   3.4059516847533464`*^9, 3.405951764379875*^9}, {3.4059520076345453`*^9, 
   3.405952029338087*^9}, {3.4059520779796457`*^9, 3.4059521232148895`*^9}, {
   3.405952220279253*^9, 3.4059522264199963`*^9}, {3.4060244837450695`*^9, 
   3.4060245095139217`*^9}, {3.406024557267589*^9, 3.4060247710652575`*^9}, {
   3.406024832709273*^9, 3.4060248358343925`*^9}, {3.4060248743671227`*^9, 
   3.406024904540156*^9}, {3.4060264607006626`*^9, 3.4060264693414536`*^9}, {
   3.4060265091547174`*^9, 3.4060266140942326`*^9}, {3.406026881521242*^9, 
   3.406026894552742*^9}, {3.40602732621728*^9, 3.406027354983457*^9}, {
   3.4060274947517657`*^9, 3.4060274977986994`*^9}, {3.406027681630354*^9, 
   3.4060276860366883`*^9}, {3.406312899494578*^9, 3.406312900084578*^9}, {
   3.406312997637578*^9, 3.406313000787578*^9}, {3.406313491912578*^9, 
   3.406313497941578*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Nb1=\"\>", "\[InvisibleSpace]", "30", 
   "\[InvisibleSpace]", "\<\" Nb1n=\"\>", "\[InvisibleSpace]", "10", 
   "\[InvisibleSpace]", "\<\" Nb2=\"\>", "\[InvisibleSpace]", "30"}],
  SequenceForm["Nb1=", 30, " Nb1n=", 10, " Nb2=", 30],
  Editable->False]], "Print",
 CellChangeTimes->{3.405951741035677*^9, 3.4059521253086796`*^9, 
  3.4059522300294404`*^9, 3.405952631630901*^9, 3.405952701741622*^9, 
  3.405952799509124*^9, 3.4059530192164674`*^9, 3.405953117640232*^9, 
  3.405953217376522*^9, 3.40602661995372*^9, 3.4060273594210424`*^9, 
  3.406027499095599*^9, 3.4060276867242017`*^9, 3.4060285573815427`*^9, 
  3.406309443163578*^9, 3.406309547143578*^9, 3.406309856918578*^9, 
  3.4063099583765783`*^9, 3.406310011625578*^9, 3.406310712087578*^9, 
  3.4063107986595783`*^9, 3.406311178889578*^9, 3.406311269386578*^9, 
  3.4063113441595783`*^9, 3.4063114688845778`*^9, 3.406311564492578*^9, 
  3.406311886561578*^9, 3.406312010753578*^9, 3.406312174360578*^9, 
  3.4063122537145777`*^9, 3.406312757977578*^9, 3.406312900896578*^9, 
  3.406313002087578*^9, 3.4063131332595778`*^9, 3.406313365128578*^9, 
  3.4063134992265778`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\" S=\"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {"0.04586710908376777`"},
        {"0.050081170606599515`"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], 
   "\[InvisibleSpace]", "\<\" \[CapitalSigma]=\"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0.01`", "0.001`"},
       {"0.001`", "0.01`"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], "\[InvisibleSpace]", "\<\"M=\"\>", 
   "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"-", "0.35`"}], "0.`"},
       {"0.`", 
        RowBox[{"-", "0.35`"}]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], 
   "\[InvisibleSpace]", "\<\" \[CapitalSigma]inf=\"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0.03`", "0.003`"},
       {"0.003`", "0.03`"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], "\[InvisibleSpace]", "\<\" Q=\"\>", 
   "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0.25`", "0.01`"},
       {"0.01`", "0.25`"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], "\[InvisibleSpace]", "\<\" \[Rho]=\"\>", 
   "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {
         RowBox[{"-", "0.45`"}]},
        {
         RowBox[{"-", "0.45`"}]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], 
   "\[InvisibleSpace]", "\<\" Imaginary Shifts=\"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {"1.1`"},
        {"1.01`"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], "\[InvisibleSpace]", "\<\" \[Beta]m =\"\>", 
   "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0.1674602440828402`", "0.0033977440828402376`"},
       {"0.0033977440828402376`", "0.1674602440828402`"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm[" S=", 
   MatrixForm[{0.04586710908376777, 0.050081170606599515`}], 
   " \[CapitalSigma]=", 
   MatrixForm[{{0.01, 0.001}, {0.001, 0.01}}], "M=", 
   MatrixForm[{{-0.35, 0.}, {0., -0.35}}], " \[CapitalSigma]inf=", 
   MatrixForm[{{0.03, 0.003}, {0.003, 0.03}}], " Q=", 
   MatrixForm[{{0.25, 0.01}, {0.01, 0.25}}], " \[Rho]=", 
   MatrixForm[{-0.45, -0.45}], " Imaginary Shifts=", 
   MatrixForm[{1.1, 1.01}], " \[Beta]m =", 
   MatrixForm[{{0.1674602440828402, 0.0033977440828402376`}, {
    0.0033977440828402376`, 0.1674602440828402}}]],
  Editable->False]], "Print",
 CellChangeTimes->{3.405951741035677*^9, 3.4059521253086796`*^9, 
  3.4059522300294404`*^9, 3.405952631630901*^9, 3.405952701741622*^9, 
  3.405952799509124*^9, 3.4059530192164674`*^9, 3.405953117640232*^9, 
  3.405953217376522*^9, 3.40602661995372*^9, 3.4060273594210424`*^9, 
  3.406027499095599*^9, 3.4060276867242017`*^9, 3.4060285573815427`*^9, 
  3.406309443163578*^9, 3.406309547143578*^9, 3.406309856918578*^9, 
  3.4063099583765783`*^9, 3.406310011625578*^9, 3.406310712087578*^9, 
  3.4063107986595783`*^9, 3.406311178889578*^9, 3.406311269386578*^9, 
  3.4063113441595783`*^9, 3.4063114688845778`*^9, 3.406311564492578*^9, 
  3.406311886561578*^9, 3.406312010753578*^9, 3.406312174360578*^9, 
  3.4063122537145777`*^9, 3.406312757977578*^9, 3.406312900896578*^9, 
  3.406313002087578*^9, 3.4063131332595778`*^9, 3.406313365128578*^9, 
  3.406313499276578*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"{NbLegCoef1,NbLegCoef1n,period1,period1n,\[Epsilon]1,imax}=\"\>\
", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"30", ",", "10", ",", "8", ",", "3", ",", "1.`*^-7", ",", "10"}], 
    "}"}], "\[InvisibleSpace]", \
"\<\"{NbLegCoef2,period2,period2n,\[Epsilon]2}=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"30", ",", "12", ",", "1.6`", ",", "1.`*^-7"}], "}"}]}],
  SequenceForm[
  "{NbLegCoef1,NbLegCoef1n,period1,period1n,\[Epsilon]1,imax}=", {
   30, 10, 8, 3, 1.*^-7, 10}, "{NbLegCoef2,period2,period2n,\[Epsilon]2}=", {
   30, 12, 1.6, 1.*^-7}],
  Editable->False]], "Print",
 CellChangeTimes->{3.405951741035677*^9, 3.4059521253086796`*^9, 
  3.4059522300294404`*^9, 3.405952631630901*^9, 3.405952701741622*^9, 
  3.405952799509124*^9, 3.4059530192164674`*^9, 3.405953117640232*^9, 
  3.405953217376522*^9, 3.40602661995372*^9, 3.4060273594210424`*^9, 
  3.406027499095599*^9, 3.4060276867242017`*^9, 3.4060285573815427`*^9, 
  3.406309443163578*^9, 3.406309547143578*^9, 3.406309856918578*^9, 
  3.4063099583765783`*^9, 3.406310011625578*^9, 3.406310712087578*^9, 
  3.4063107986595783`*^9, 3.406311178889578*^9, 3.406311269386578*^9, 
  3.4063113441595783`*^9, 3.4063114688845778`*^9, 3.406311564492578*^9, 
  3.406311886561578*^9, 3.406312010753578*^9, 3.406312174360578*^9, 
  3.4063122537145777`*^9, 3.406312757977578*^9, 3.406312900896578*^9, 
  3.406313002087578*^9, 3.4063131332595778`*^9, 3.406313365128578*^9, 
  3.406313499327578*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{"\<\"BiHestonLaplaceQuickTransform2[M,Q,\[Rho], \[Mu],\
\[CapitalSigma],{-\[ImaginaryI] 1,-\[ImaginaryI] 1},\[Beta]m,\[Tau]]=\"\>", 
    "\[InvisibleSpace]", "0.89109654292586`"}], "\[InvisibleSpace]", "+", 
   RowBox[{"0.056237707657408854`", " ", "\[ImaginaryI]"}]}],
  SequenceForm[
  "BiHestonLaplaceQuickTransform2[M,Q,\[Rho], \[Mu],\[CapitalSigma],{-\
\[ImaginaryI] 1,-\[ImaginaryI] 1},\[Beta]m,\[Tau]]=", 
   Complex[0.89109654292586, 0.056237707657408854`]],
  Editable->False]], "Print",
 CellChangeTimes->{3.405951741035677*^9, 3.4059521253086796`*^9, 
  3.4059522300294404`*^9, 3.405952631630901*^9, 3.405952701741622*^9, 
  3.405952799509124*^9, 3.4059530192164674`*^9, 3.405953117640232*^9, 
  3.405953217376522*^9, 3.40602661995372*^9, 3.4060273594210424`*^9, 
  3.406027499095599*^9, 3.4060276867242017`*^9, 3.4060285573815427`*^9, 
  3.406309443163578*^9, 3.406309547143578*^9, 3.406309856918578*^9, 
  3.4063099583765783`*^9, 3.406310011625578*^9, 3.406310712087578*^9, 
  3.4063107986595783`*^9, 3.406311178889578*^9, 3.406311269386578*^9, 
  3.4063113441595783`*^9, 3.4063114688845778`*^9, 3.406311564492578*^9, 
  3.406311886561578*^9, 3.406312010753578*^9, 3.406312174360578*^9, 
  3.4063122537145777`*^9, 3.406312757977578*^9, 3.406312900896578*^9, 
  3.406313002087578*^9, 3.4063131332595778`*^9, 3.406313365128578*^9, 
  3.406313499377578*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"integrand(0.1,0.1)=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "5.175107193330988`", ",", "5.173057459000649`", ",", "5.17131224701055`",
      ",", "5.166661086239445`", ",", "5.159818294968215`", ",", 
     "5.147742494576427`", ",", "5.117187083885028`", ",", 
     "5.095053264714775`", ",", "5.074732265972561`", ",", 
     "5.037763696517574`"}], "}"}]}],
  SequenceForm[
  "integrand(0.1,0.1)=", {5.175107193330988, 5.173057459000649, 
   5.17131224701055, 5.166661086239445, 5.159818294968215, 5.147742494576427, 
   5.117187083885028, 5.095053264714775, 5.074732265972561, 
   5.037763696517574}],
  Editable->False]], "Print",
 CellChangeTimes->{3.405951741035677*^9, 3.4059521253086796`*^9, 
  3.4059522300294404`*^9, 3.405952631630901*^9, 3.405952701741622*^9, 
  3.405952799509124*^9, 3.4059530192164674`*^9, 3.405953117640232*^9, 
  3.405953217376522*^9, 3.40602661995372*^9, 3.4060273594210424`*^9, 
  3.406027499095599*^9, 3.4060276867242017`*^9, 3.4060285573815427`*^9, 
  3.406309443163578*^9, 3.406309547143578*^9, 3.406309856918578*^9, 
  3.4063099583765783`*^9, 3.406310011625578*^9, 3.406310712087578*^9, 
  3.4063107986595783`*^9, 3.406311178889578*^9, 3.406311269386578*^9, 
  3.4063113441595783`*^9, 3.4063114688845778`*^9, 3.406311564492578*^9, 
  3.406311886561578*^9, 3.406312010753578*^9, 3.406312174360578*^9, 
  3.4063122537145777`*^9, 3.406312757977578*^9, 3.406312900896578*^9, 
  3.406313002087578*^9, 3.4063131332595778`*^9, 3.406313365128578*^9, 
  3.406313499427578*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\" S=\"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {"0.04586710908376777`"},
        {"0.050081170606599515`"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], 
   "\[InvisibleSpace]", "\<\" \[CapitalSigma]=\"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0.01`", "0.001`"},
       {"0.001`", "0.01`"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], "\[InvisibleSpace]", "\<\"M=\"\>", 
   "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"-", "0.35`"}], "0.`"},
       {"0.`", 
        RowBox[{"-", "0.35`"}]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], 
   "\[InvisibleSpace]", "\<\" \[CapitalSigma]inf=\"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0.03`", "0.003`"},
       {"0.003`", "0.03`"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], "\[InvisibleSpace]", "\<\" Q=\"\>", 
   "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0.25`", "0.01`"},
       {"0.01`", "0.25`"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], "\[InvisibleSpace]", "\<\" \[Rho]=\"\>", 
   "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {
         RowBox[{"-", "0.45`"}]},
        {
         RowBox[{"-", "0.45`"}]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], 
   "\[InvisibleSpace]", "\<\" Imaginary Shifts=\"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {"1.1`"},
        {"1.01`"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], "\[InvisibleSpace]", "\<\" \[Beta]m =\"\>", 
   "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0.1674602440828402`", "0.0033977440828402376`"},
       {"0.0033977440828402376`", "0.1674602440828402`"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm[" S=", 
   MatrixForm[{0.04586710908376777, 0.050081170606599515`}], 
   " \[CapitalSigma]=", 
   MatrixForm[{{0.01, 0.001}, {0.001, 0.01}}], "M=", 
   MatrixForm[{{-0.35, 0.}, {0., -0.35}}], " \[CapitalSigma]inf=", 
   MatrixForm[{{0.03, 0.003}, {0.003, 0.03}}], " Q=", 
   MatrixForm[{{0.25, 0.01}, {0.01, 0.25}}], " \[Rho]=", 
   MatrixForm[{-0.45, -0.45}], " Imaginary Shifts=", 
   MatrixForm[{1.1, 1.01}], " \[Beta]m =", 
   MatrixForm[{{0.1674602440828402, 0.0033977440828402376`}, {
    0.0033977440828402376`, 0.1674602440828402}}]],
  Editable->False]], "Print",
 CellChangeTimes->{3.405951741035677*^9, 3.4059521253086796`*^9, 
  3.4059522300294404`*^9, 3.405952631630901*^9, 3.405952701741622*^9, 
  3.405952799509124*^9, 3.4059530192164674`*^9, 3.405953117640232*^9, 
  3.405953217376522*^9, 3.40602661995372*^9, 3.4060273594210424`*^9, 
  3.406027499095599*^9, 3.4060276867242017`*^9, 3.4060285573815427`*^9, 
  3.406309443163578*^9, 3.406309547143578*^9, 3.406309856918578*^9, 
  3.4063099583765783`*^9, 3.406310011625578*^9, 3.406310712087578*^9, 
  3.4063107986595783`*^9, 3.406311178889578*^9, 3.406311269386578*^9, 
  3.4063113441595783`*^9, 3.4063114688845778`*^9, 3.406311564492578*^9, 
  3.406311886561578*^9, 3.406312010753578*^9, 3.406312174360578*^9, 
  3.4063122537145777`*^9, 3.406312757977578*^9, 3.406312900896578*^9, 
  3.406313002087578*^9, 3.4063131332595778`*^9, 3.406313365128578*^9, 
  3.406313514695578*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"{NbLegCoef1,NbLegCoef1n,period1,period1n,\[Epsilon]1,imax}=\"\>\
", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"30", ",", "10", ",", "8", ",", "3", ",", "1.`*^-7", ",", "10"}], 
    "}"}], "\[InvisibleSpace]", \
"\<\"{NbLegCoef2,period2,period2n,\[Epsilon]2}=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"30", ",", "12", ",", "1.6`", ",", "1.`*^-7"}], "}"}]}],
  SequenceForm[
  "{NbLegCoef1,NbLegCoef1n,period1,period1n,\[Epsilon]1,imax}=", {
   30, 10, 8, 3, 1.*^-7, 10}, "{NbLegCoef2,period2,period2n,\[Epsilon]2}=", {
   30, 12, 1.6, 1.*^-7}],
  Editable->False]], "Print",
 CellChangeTimes->{3.405951741035677*^9, 3.4059521253086796`*^9, 
  3.4059522300294404`*^9, 3.405952631630901*^9, 3.405952701741622*^9, 
  3.405952799509124*^9, 3.4059530192164674`*^9, 3.405953117640232*^9, 
  3.405953217376522*^9, 3.40602661995372*^9, 3.4060273594210424`*^9, 
  3.406027499095599*^9, 3.4060276867242017`*^9, 3.4060285573815427`*^9, 
  3.406309443163578*^9, 3.406309547143578*^9, 3.406309856918578*^9, 
  3.4063099583765783`*^9, 3.406310011625578*^9, 3.406310712087578*^9, 
  3.4063107986595783`*^9, 3.406311178889578*^9, 3.406311269386578*^9, 
  3.4063113441595783`*^9, 3.4063114688845778`*^9, 3.406311564492578*^9, 
  3.406311886561578*^9, 3.406312010753578*^9, 3.406312174360578*^9, 
  3.4063122537145777`*^9, 3.406312757977578*^9, 3.406312900896578*^9, 
  3.406313002087578*^9, 3.4063131332595778`*^9, 3.406313365128578*^9, 
  3.406313514715578*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{"\<\"BiHestonLaplaceQuickTransform2[M,Q,\[Rho], \[Mu],\
\[CapitalSigma],{-\[ImaginaryI] 1,-\[ImaginaryI] 1},\[Beta]m,\[Tau]]=\"\>", 
    "\[InvisibleSpace]", "0.89109654292586`"}], "\[InvisibleSpace]", "+", 
   RowBox[{"0.056237707657408854`", " ", "\[ImaginaryI]"}]}],
  SequenceForm[
  "BiHestonLaplaceQuickTransform2[M,Q,\[Rho], \[Mu],\[CapitalSigma],{-\
\[ImaginaryI] 1,-\[ImaginaryI] 1},\[Beta]m,\[Tau]]=", 
   Complex[0.89109654292586, 0.056237707657408854`]],
  Editable->False]], "Print",
 CellChangeTimes->{3.405951741035677*^9, 3.4059521253086796`*^9, 
  3.4059522300294404`*^9, 3.405952631630901*^9, 3.405952701741622*^9, 
  3.405952799509124*^9, 3.4059530192164674`*^9, 3.405953117640232*^9, 
  3.405953217376522*^9, 3.40602661995372*^9, 3.4060273594210424`*^9, 
  3.406027499095599*^9, 3.4060276867242017`*^9, 3.4060285573815427`*^9, 
  3.406309443163578*^9, 3.406309547143578*^9, 3.406309856918578*^9, 
  3.4063099583765783`*^9, 3.406310011625578*^9, 3.406310712087578*^9, 
  3.4063107986595783`*^9, 3.406311178889578*^9, 3.406311269386578*^9, 
  3.4063113441595783`*^9, 3.4063114688845778`*^9, 3.406311564492578*^9, 
  3.406311886561578*^9, 3.406312010753578*^9, 3.406312174360578*^9, 
  3.4063122537145777`*^9, 3.406312757977578*^9, 3.406312900896578*^9, 
  3.406313002087578*^9, 3.4063131332595778`*^9, 3.406313365128578*^9, 
  3.4063135147405777`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"integrand(0.1,0.1)=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "6.195905866739837`", ",", "6.247057149982782`", ",", 
     "6.283870403410892`", ",", "6.298419062559822`", ",", 
     "6.306663031316106`", ",", "6.312266580362692`", ",", 
     "6.314369157453862`"}], "}"}]}],
  SequenceForm[
  "integrand(0.1,0.1)=", {6.195905866739837, 6.247057149982782, 
   6.283870403410892, 6.298419062559822, 6.306663031316106, 6.312266580362692,
    6.314369157453862}],
  Editable->False]], "Print",
 CellChangeTimes->{3.405951741035677*^9, 3.4059521253086796`*^9, 
  3.4059522300294404`*^9, 3.405952631630901*^9, 3.405952701741622*^9, 
  3.405952799509124*^9, 3.4059530192164674`*^9, 3.405953117640232*^9, 
  3.405953217376522*^9, 3.40602661995372*^9, 3.4060273594210424`*^9, 
  3.406027499095599*^9, 3.4060276867242017`*^9, 3.4060285573815427`*^9, 
  3.406309443163578*^9, 3.406309547143578*^9, 3.406309856918578*^9, 
  3.4063099583765783`*^9, 3.406310011625578*^9, 3.406310712087578*^9, 
  3.4063107986595783`*^9, 3.406311178889578*^9, 3.406311269386578*^9, 
  3.4063113441595783`*^9, 3.4063114688845778`*^9, 3.406311564492578*^9, 
  3.406311886561578*^9, 3.406312010753578*^9, 3.406312174360578*^9, 
  3.4063122537145777`*^9, 3.406312757977578*^9, 3.406312900896578*^9, 
  3.406313002087578*^9, 3.4063131332595778`*^9, 3.406313365128578*^9, 
  3.406313514781578*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[Nu]1=\"\>", "\[InvisibleSpace]", "0.2501999200639361`", 
   "\[InvisibleSpace]", "\<\" \[Nu]2=\"\>", "\[InvisibleSpace]", 
   "0.2501999200639361`", "\[InvisibleSpace]", "\<\" \[Rho]H1=\"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"-", "0.4676260486817974`"}], 
   "\[InvisibleSpace]", "\<\" \[Rho]H2=\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "0.4676260486817974`"}], 
   "\[InvisibleSpace]", "\<\" vol1=\"\>", "\[InvisibleSpace]", 
   "0.12040126377971333107315810889860688900686689316`30.", 
   "\[InvisibleSpace]", "\<\" vol2=\"\>", "\[InvisibleSpace]", 
   "0.120401263779713502295566592015400886255877964784`30.", 
   "\[InvisibleSpace]", "\<\" NormalVol1=\"\>", "\[InvisibleSpace]", 
   "0.005522457899607609`", "\[InvisibleSpace]", "\<\" NormalVol2=\"\>", 
   "\[InvisibleSpace]", "0.006029836232602022`", 
   "\[InvisibleSpace]", "\<\" NormalVol1a=\"\>", "\[InvisibleSpace]", 
   "0.005505824778150481`", "\[InvisibleSpace]", "\<\" NormalVol2a=\"\>", 
   "\[InvisibleSpace]", "0.006011674935540695`", 
   "\[InvisibleSpace]", "\<\" NormalVol1b=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.005893684335747865`", ",", "0.005919860092924627`", ",", 
     "0.005893102699436108`"}], "}"}], 
   "\[InvisibleSpace]", "\<\" NormalVol2b=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.005751392459703689`", ",", "0.005769696957178536`", ",", 
     "0.005750994568998627`"}], "}"}]}],
  SequenceForm[
  "\[Nu]1=", 0.2501999200639361, " \[Nu]2=", 0.2501999200639361, 
   " \[Rho]H1=", -0.4676260486817974, " \[Rho]H2=", -0.4676260486817974, 
   " vol1=", 0.1204012637797133310731581088986`30., " vol2=", 
   0.1204012637797135022955665920154`30., " NormalVol1=", 
   0.005522457899607609, " NormalVol2=", 0.006029836232602022, 
   " NormalVol1a=", 0.005505824778150481, " NormalVol2a=", 
   0.006011674935540695, " NormalVol1b=", {0.005893684335747865, 
   0.005919860092924627, 0.005893102699436108}, " NormalVol2b=", {
   0.005751392459703689, 0.005769696957178536, 0.005750994568998627}],
  Editable->False]], "Print",
 CellChangeTimes->{3.405951741035677*^9, 3.4059521253086796`*^9, 
  3.4059522300294404`*^9, 3.405952631630901*^9, 3.405952701741622*^9, 
  3.405952799509124*^9, 3.4059530192164674`*^9, 3.405953117640232*^9, 
  3.405953217376522*^9, 3.40602661995372*^9, 3.4060273594210424`*^9, 
  3.406027499095599*^9, 3.4060276867242017`*^9, 3.4060285573815427`*^9, 
  3.406309443163578*^9, 3.406309547143578*^9, 3.406309856918578*^9, 
  3.4063099583765783`*^9, 3.406310011625578*^9, 3.406310712087578*^9, 
  3.4063107986595783`*^9, 3.406311178889578*^9, 3.406311269386578*^9, 
  3.4063113441595783`*^9, 3.4063114688845778`*^9, 3.406311564492578*^9, 
  3.406311886561578*^9, 3.406312010753578*^9, 3.406312174360578*^9, 
  3.4063122537145777`*^9, 3.406312757977578*^9, 3.406312900896578*^9, 
  3.406313002087578*^9, 3.4063131332595778`*^9, 3.406313365128578*^9, 
  3.406313527026578*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   GraphicsBox[{InsetBox[
      GraphicsBox[{{}, {}, 
        {Hue[0.67, 0.6, 0.6], LineBox[CompressedData["
1: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

          "]]}},
       AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
       Axes->True,
       AxesOrigin->{0, 0.01},
       DisplayFunction:>$DisplayFunction,
       FormatType->TraditionalForm,
       PlotLabel->FormBox[
        "\"Implied normal vol MRev=0.15\"", TraditionalForm],
       PlotRange->{{-0.01, 0.015}, {0.009282045566703824, 
        0.0717222720791455}},
       PlotRangeClipping->True,
       PlotRangePadding->{
         Scaled[0.02], 
         Scaled[0.02]}], {-1, -0.6180339887498948}, {
      Left, Bottom}, {2, 1.2360679774997896`}], {
      {GrayLevel[0], 
       RectangleBox[{-1.15, -0.8680339887498949}, \
{-0.34999999999999987`, -0.2680339887498948}]}, 
      {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[0.001]}], 
       RectangleBox[{-1.2, -0.8180339887498949}, \
{-0.3999999999999999, -0.21803398874989477`}], InsetBox[
        GraphicsBox[{{{InsetBox[
             GraphicsBox[
              {Hue[0.9060679774997897, 0.6, 0.6], 
               LineBox[{{0, 0}, {1, 0}}]}], {0.08, 0.08}, {
             Left, Bottom}, {1, 1}], 
            InsetBox["\<\"Market\"\>", {1.21, 0.58}, {-1, 0}, Automatic, {1, 
             0}]}, {InsetBox[
             GraphicsBox[
              {Hue[0.67, 0.6, 0.6], 
               LineBox[{{0, 0}, {1, 0}}]}], {0.08, 1.24}, {
             Left, Bottom}, {1, 1}], 
            InsetBox["\<\"Biheston\"\>", {1.21, 1.74}, {-1, 0}, Automatic, {1,
              0}]}}, {}},
         AspectRatio->0.7500000000000001,
         FormatType->TraditionalForm,
         PlotRange->{{-0.1, 3.26}, {-0.1, 
          2.42}}], {-1.2, -0.8180339887498949}, {
        Left, Bottom}, {0.8, 0.6000000000000001}]}}},
    AspectRatio->Automatic,
    Background->None,
    ColorOutput->Automatic,
    ImageSize->Automatic,
    PlotRange->All], ",", 
   GraphicsBox[{InsetBox[
      GraphicsBox[{{}, {}, 
        {Hue[0.67, 0.6, 0.6], LineBox[CompressedData["
1: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
          "]]}},
       AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
       Axes->True,
       AxesOrigin->{0, 0},
       DisplayFunction:>$DisplayFunction,
       FormatType->TraditionalForm,
       PlotLabel->FormBox["\"Implied normal correlation\"", TraditionalForm],
       PlotRange->{{-0.01, 0.015}, {-73.9276733361718, 10.358535943804364`}},
       PlotRangeClipping->True,
       PlotRangePadding->{
         Scaled[0.02], 
         Scaled[0.02]}], {-1, -0.6180339887498948}, {
      Left, Bottom}, {2, 1.2360679774997896`}], {
      {GrayLevel[0], 
       RectangleBox[{-1.15, -0.8680339887498949}, \
{-0.34999999999999987`, -0.2680339887498948}]}, 
      {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[0.001]}], 
       RectangleBox[{-1.2, -0.8180339887498949}, \
{-0.3999999999999999, -0.21803398874989477`}], InsetBox[
        GraphicsBox[{{{InsetBox[
             GraphicsBox[
              {Hue[0.9060679774997897, 0.6, 0.6], 
               LineBox[{{0, 0}, {1, 0}}]}], {0.08, 0.08}, {
             Left, Bottom}, {1, 1}], 
            InsetBox["\<\"Market\"\>", {1.21, 0.58}, {-1, 0}, Automatic, {1, 
             0}]}, {InsetBox[
             GraphicsBox[
              {Hue[0.67, 0.6, 0.6], 
               LineBox[{{0, 0}, {1, 0}}]}], {0.08, 1.24}, {
             Left, Bottom}, {1, 1}], 
            InsetBox["\<\"Biheston\"\>", {1.21, 1.74}, {-1, 0}, Automatic, {1,
              0}]}}, {}},
         AspectRatio->0.7500000000000001,
         FormatType->TraditionalForm,
         PlotRange->{{-0.1, 3.26}, {-0.1, 
          2.42}}], {-1.2, -0.8180339887498949}, {
        Left, Bottom}, {0.8, 0.6000000000000001}]}}},
    AspectRatio->Automatic,
    Background->None,
    ColorOutput->Automatic,
    ImageSize->Automatic,
    PlotRange->All]}], "}"}]], "Print",
 CellChangeTimes->{3.405951741035677*^9, 3.4059521253086796`*^9, 
  3.4059522300294404`*^9, 3.405952631630901*^9, 3.405952701741622*^9, 
  3.405952799509124*^9, 3.4059530192164674`*^9, 3.405953117640232*^9, 
  3.405953217376522*^9, 3.40602661995372*^9, 3.4060273594210424`*^9, 
  3.406027499095599*^9, 3.4060276867242017`*^9, 3.4060285573815427`*^9, 
  3.406309443163578*^9, 3.406309547143578*^9, 3.406309856918578*^9, 
  3.4063099583765783`*^9, 3.406310011625578*^9, 3.406310712087578*^9, 
  3.4063107986595783`*^9, 3.406311178889578*^9, 3.406311269386578*^9, 
  3.4063113441595783`*^9, 3.4063114688845778`*^9, 3.406311564492578*^9, 
  3.406311886561578*^9, 3.406312010753578*^9, 3.406312174360578*^9, 
  3.4063122537145777`*^9, 3.406312757977578*^9, 3.406312900896578*^9, 
  3.406313002087578*^9, 3.4063131332595778`*^9, 3.406313365128578*^9, 
  3.406313534158578*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"34.52300000000001`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.4063114906735783`*^9, 3.4063115716005783`*^9, 
  3.406311894452578*^9, 3.406312017558578*^9, 3.406312193330578*^9, 
  3.406312272566578*^9, 3.406312776903578*^9, 3.4063129203465776`*^9, 
  3.406313022080578*^9, 3.406313204462578*^9, 3.406313457849578*^9, 
  3.406313534187578*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Fit of the Initial Dynamics", "Section",
 CellChangeTimes->{{3.4045528957822495`*^9, 3.404552917876424*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"le", " ", "process", " ", 
    RowBox[{"sabr", " ", ":", " ", 
     FractionBox["dF", "F"]}]}], "=", 
   RowBox[{
    FractionBox["\[Alpha]", 
     SuperscriptBox["F", 
      RowBox[{"1", "-", "\[Beta]"}]]], 
    SubscriptBox["dW", "1"]}]}], ";", " ", 
  RowBox[{"d\[Alpha]", "=", 
   RowBox[{"\[Nu]", " ", "\[Alpha]", "  ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[Rho]", " ", 
       SubscriptBox["dW", "1"]}], "+", 
      SqrtBox[
       RowBox[{"1", "-", 
        SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], 
    SubscriptBox["dW", "2"]}]}]}]], "Input",
 CellChangeTimes->{{3.4044806481701136`*^9, 3.404480679988111*^9}, 
   3.404496921847375*^9, {3.4044970303141747`*^9, 3.4044972015865746`*^9}, 
   3.404550516689697*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Var", "[", 
   SubscriptBox["Y", "1"], "]"}], "=", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     FractionBox["\[Alpha]", 
      SuperscriptBox["F", 
       RowBox[{"1", "-", "\[Beta]"}]]], ")"}], "2"], "==", 
   SubscriptBox["\[CapitalSigma]", "11"]}]}]], "Input",
 CellChangeTimes->{{3.4044806481701136`*^9, 3.404480679988111*^9}, {
   3.404480800899626*^9, 3.4044808173868494`*^9}, 3.404496928102975*^9, {
   3.404497787796175*^9, 3.4044977962513747`*^9}, {3.404497913329375*^9, 
   3.404497940161375*^9}, {3.4044979982713747`*^9, 3.4044980069917746`*^9}, 
   3.404550516689697*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"d", "[", 
   SubscriptBox["\[CapitalSigma]", "11"], "]"}], "=", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{"2", "\[Alpha]", " ", "d\[Alpha]"}], 
     SuperscriptBox["F", 
      RowBox[{"2", "-", 
       RowBox[{"2", "\[Beta]"}]}]]], "+", 
    RowBox[{
     SuperscriptBox["\[Alpha]", "2"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", "\[Beta]"}], "-", "2"}], ")"}], 
     SuperscriptBox["F", 
      RowBox[{
       RowBox[{"2", "\[Beta]"}], "-", "3"}]], "dF"}]}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"2", "\[Alpha]", " ", 
      SuperscriptBox["F", 
       RowBox[{
        RowBox[{"2", "\[Beta]"}], "-", "2"}]], "\[Nu]", " ", "\[Alpha]", "  ",
       
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Rho]", " ", 
         SubscriptBox["dW", "1"]}], "+", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], 
      SubscriptBox["dW", "2"]}], "+", 
     RowBox[{
      SuperscriptBox["\[Alpha]", "2"], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", "\[Beta]"}], "-", "2"}], ")"}], 
      SuperscriptBox["F", 
       RowBox[{
        RowBox[{"2", "\[Beta]"}], "-", "3"}]], "\[Alpha]", " ", 
      SuperscriptBox["F", "\[Beta]"], 
      SubscriptBox["dW", "1"]}]}], "=", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", 
         SuperscriptBox["\[Alpha]", "2"], " ", 
         SuperscriptBox["F", 
          RowBox[{
           RowBox[{"2", "\[Beta]"}], "-", "2"}]], "\[Nu]", "  ", "\[Rho]"}], 
        " ", "+", 
        RowBox[{
         SuperscriptBox["\[Alpha]", "3"], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", "\[Beta]"}], "-", "2"}], ")"}], 
         SuperscriptBox["F", 
          RowBox[{
           RowBox[{"3", "\[Beta]"}], "-", "3"}]]}]}], " ", ")"}], 
      SubscriptBox["dW", "1"]}], "+", 
     RowBox[{"2", 
      SuperscriptBox["\[Alpha]", "2"], " ", 
      SuperscriptBox["F", 
       RowBox[{
        RowBox[{"2", "\[Beta]"}], "-", "2"}]], "\[Nu]", "   ", 
      SqrtBox[
       RowBox[{"1", "-", 
        SuperscriptBox["\[Rho]", "2"]}]], 
      SubscriptBox["dW", "2"]}]}]}]}]}]], "Input",
 CellChangeTimes->{
  3.4044980154781747`*^9, {3.404498057145775*^9, 3.404498158030975*^9}, 
   3.4044982138633747`*^9, {3.404498305930975*^9, 3.4044985911433744`*^9}, 
   3.404550516689697*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"so", " ", 
   RowBox[{"Var", "[", 
    SubscriptBox["\[CapitalSigma]", "11"], "]"}]}], "=", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", 
       SuperscriptBox["\[Alpha]", "2"], " ", 
       SuperscriptBox["F", 
        RowBox[{
         RowBox[{"2", "\[Beta]"}], "-", "2"}]], "\[Nu]", "  ", "\[Rho]"}], 
      " ", "+", 
      RowBox[{
       SuperscriptBox["\[Alpha]", "3"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", "\[Beta]"}], "-", "2"}], ")"}], 
       SuperscriptBox["F", 
        RowBox[{
         RowBox[{"3", "\[Beta]"}], "-", "3"}]]}]}], " ", ")"}], "2"], "+", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"2", 
      SuperscriptBox["\[Alpha]", "2"], " ", 
      SuperscriptBox["F", 
       RowBox[{
        RowBox[{"2", "\[Beta]"}], "-", "2"}]], "\[Nu]", "   ", 
      SqrtBox[
       RowBox[{"1", "-", 
        SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], "2"]}]}]], "Input",
 CellChangeTimes->{{3.404498560114975*^9, 3.404498581939375*^9}, {
   3.404498626352575*^9, 3.404498641857375*^9}, 3.404550516689697*^9}],

Cell[BoxData[
 RowBox[{"le", " ", "process", " ", "de", " ", 
  RowBox[{"wishart", " ", ":", " "}]}]], "Input",
 CellChangeTimes->{{3.4044806481701136`*^9, 3.404480679988111*^9}, {
   3.404480803947027*^9, 3.4044808046502743`*^9}, {3.4044808521897373`*^9, 
   3.404480856565493*^9}, 3.404496934155775*^9, {3.404497349474575*^9, 
   3.404497357836175*^9}, 3.404550516689697*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Var", "[", 
   SubscriptBox["Y", "1"], "]"}], "=", 
  SubscriptBox["\[CapitalSigma]", "11"]}]], "Input",
 CellChangeTimes->{{3.4044975837965746`*^9, 3.404497594014575*^9}, 
   3.404550516689697*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Var", "[", 
   SubscriptBox["\[CapitalSigma]", "11"], "]"}], "=", 
  RowBox[{"4", 
   SubscriptBox["\[CapitalSigma]", "11"], 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["Q", "11"], "2"], "+", 
     SuperscriptBox[
      SubscriptBox["Q", "12"], "2"]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.404497609084175*^9, 3.404497619692175*^9}, 
   3.404550516689697*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Covar", "[", 
   RowBox[{
    SubscriptBox["Y", "i"], ",", 
    SubscriptBox["\[CapitalSigma]", "11"]}], "]"}], "=", 
  RowBox[{"2", 
   SubscriptBox["\[CapitalSigma]", 
    RowBox[{"1", "i"}]], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SubscriptBox["Q", "11"], 
      SubscriptBox["\[Rho]", "1"]}], "+", 
     RowBox[{
      SubscriptBox["Q", "21"], 
      SubscriptBox["\[Rho]", "2"]}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.404497663948575*^9, 3.404497665336975*^9}, 
   3.404550516689697*^9}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.4044974764685745`*^9, 3.404497482037775*^9}, 
   3.4044977725705748`*^9, 3.404550516689697*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Vect", "[", 
   FractionBox[
    SubscriptBox["dS", 
     RowBox[{"i", ",", "t"}]], 
    SubscriptBox["S", 
     RowBox[{"i", ",", "t"}]]], "]"}], "=", 
  RowBox[{
   SqrtBox[
    SubscriptBox["\[CapitalSigma]", "t"]], 
   SubscriptBox["dZ", "t"]}]}]], "Text",
 CellChangeTimes->{{3.3984989352520385`*^9, 3.398498968548487*^9}, {
   3.3985029207219324`*^9, 3.3985029667399135`*^9}, {3.3985917842745314`*^9, 
   3.398591784555787*^9}, {3.404497862161375*^9, 3.4044978720205746`*^9}, 
   3.404550516689697*^9}],

Cell[BoxData[
 RowBox[{
  SubscriptBox["d\[CapitalSigma]", "t"], "=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"M", " ", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["\[CapitalSigma]", "t"], "-", 
         SubscriptBox["\[CapitalSigma]", "\[Infinity]"]}], ")"}]}], "+", " ", 
      
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["\[CapitalSigma]", "t"], "-", 
         SubscriptBox["\[CapitalSigma]", "\[Infinity]"]}], ")"}], 
       SuperscriptBox["M", "*"]}]}], ")"}], "dt"}], "+", 
   RowBox[{
    SqrtBox[
     SubscriptBox["\[CapitalSigma]", "t"]], 
    SubscriptBox["dW", "t"], "Q"}], " ", "+", 
   RowBox[{
    SuperscriptBox["Q", "*"], 
    SuperscriptBox[
     SubscriptBox["dW", "t"], "*"], 
    SuperscriptBox[
     RowBox[{"(", 
      SqrtBox[
       SubscriptBox["\[CapitalSigma]", "t"]], ")"}], "*"]}]}]}]], "Text",
 CellChangeTimes->{{3.398493257699712*^9, 3.398493303496001*^9}, {
   3.39849340749467*^9, 3.398493522540072*^9}, {3.398503431285205*^9, 
   3.398503461426409*^9}, {3.4008432459038897`*^9, 3.400843250075845*^9}, 
   3.404550516689697*^9}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.4044806481701136`*^9, 3.404480679988111*^9}, {
   3.4044808071194506`*^9, 3.4044808079008355`*^9}, {3.404480871380553*^9, 
   3.404480876084491*^9}, 3.404496940052575*^9, 3.404550516689697*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"cms30", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "cms30", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "10"}], "}"}]}], "]"}], " ", "//", " ", 
   "MatrixForm"}], ";"}]], "Input",
 CellChangeTimes->{{3.404481208048094*^9, 3.4044812474611535`*^9}, {
   3.404481320036192*^9, 3.4044814126928253`*^9}, {3.4044816908658857`*^9, 
   3.404481703915015*^9}, 3.4044821616972313`*^9, 3.404496955917775*^9, 
   3.4045407095839663`*^9, 3.4045415384226637`*^9, 3.404550516689697*^9, 
   3.405146462047842*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"S1", ",", "S2", ",", 
      RowBox[{"M1", "=", 
       RowBox[{"-", "0.15"}]}], ",", 
      RowBox[{"M2", "=", 
       RowBox[{"-", "0.15"}]}], ",", 
      RowBox[{"\[Rho]s", "=", "0.8"}], ",", 
      RowBox[{"\[Rho]sinf", "=", "0.8"}], ",", 
      RowBox[{"\[Rho]m1", "=", "0."}], ",", 
      RowBox[{"\[Rho]m2", "=", "0."}], ",", 
      RowBox[{"\[Rho]1", "=", 
       RowBox[{"-", "0.45"}]}], ",", 
      RowBox[{"\[Rho]2", "=", 
       RowBox[{"-", "0.45"}]}], ",", " ", "\[CapitalSigma]1", ",", 
      "\[CapitalSigma]2", ",", "\[Theta]1", ",", "\[Theta]2", ",", 
      RowBox[{"\[Beta]", "=", "5"}], ",", 
      RowBox[{"\[Tau]", "=", "5"}], ",", "M", ",", "\[CapitalSigma]inf", ",", 
      "\[CapitalSigma]", ",", "Q", ",", "\[Beta]m", ",", "S", ",", "\[Rho]", 
      ",", 
      RowBox[{"printflag", "=", 
       RowBox[{"{", "1", "}"}]}], ",", 
      RowBox[{"\[Mu]", "=", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], ",", "inter1", ",", "inter2", ",", 
      "inter3", ",", "smileLN", ",", "interLN", ",", "prices", ",", 
      RowBox[{"tenor", "=", "\"\<cms5\>\""}], ",", "K", ",", "\[Alpha]1", ",",
       "a"}], "}"}], ",", 
    RowBox[{
     RowBox[{"\[CapitalSigma]1", "=", "0.015"}], ";", 
     RowBox[{"\[CapitalSigma]2", "=", "0.01"}], ";", 
     RowBox[{"\[Theta]1", "=", "\[CapitalSigma]1"}], ";", 
     RowBox[{"\[Theta]2", "=", "\[CapitalSigma]2"}], ";", 
     RowBox[{"\[Alpha]1", "=", "1"}], ";", 
     RowBox[{"a", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"S1", "=", 
      RowBox[{
       RowBox[{"MarketCMSForward", "[", 
        RowBox[{"\[Tau]", ",", "tenor"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", 
     RowBox[{"S2", "=", "S1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"M", "=", 
      RowBox[{"(", GridBox[{
         {"M1", 
          RowBox[{"\[Rho]m1", 
           SqrtBox[
            RowBox[{"M1", " ", "M2"}]]}]},
         {
          RowBox[{"\[Rho]m2", 
           SqrtBox[
            RowBox[{"M1", " ", "M2"}]]}], "M2"}
        }], ")"}]}], ";", 
     RowBox[{"\[CapitalSigma]inf", "=", 
      RowBox[{"(", GridBox[{
         {"\[Theta]1", 
          RowBox[{
           SqrtBox[
            RowBox[{"\[Theta]1", " ", "\[Theta]2"}]], " ", "\[Rho]sinf"}]},
         {
          RowBox[{
           SqrtBox[
            RowBox[{"\[Theta]1", " ", "\[Theta]2"}]], " ", "\[Rho]sinf"}], 
          "\[Theta]2"}
        }], ")"}]}], ";", 
     RowBox[{"\[CapitalSigma]", "=", 
      RowBox[{"(", GridBox[{
         {"\[CapitalSigma]1", 
          RowBox[{
           SqrtBox[
            RowBox[{"\[CapitalSigma]1", " ", "\[CapitalSigma]2"}]], " ", 
           "\[Rho]s"}]},
         {
          RowBox[{
           SqrtBox[
            RowBox[{"\[CapitalSigma]1", " ", "\[CapitalSigma]2"}]], " ", 
           "\[Rho]s"}], "\[CapitalSigma]2"}
        }], ")"}]}], ";", 
     RowBox[{"S", "=", 
      RowBox[{"{", 
       RowBox[{"S1", ",", "S2"}], "}"}]}], ";", 
     RowBox[{"\[Rho]", "=", 
      RowBox[{"{", 
       RowBox[{"\[Rho]1", ",", "\[Rho]2"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"strikes", "=", 
      RowBox[{"{", 
       RowBox[{
       "0.01", ",", "0.0125", ",", "0.015", ",", "0.0175", ",", "0.02", ",", 
        "0.025", ",", "0.03", ",", "0.035", ",", "0.04", ",", "0.045", ",", 
        "0.048", ",", "0.05", ",", "0.055", ",", "0.06", ",", "0.08", ",", 
        "0.1", ",", "0.11", ",", "0.12", ",", "0.13", ",", "0.14", ",", 
        "0.15"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Q", "=", 
      RowBox[{
       RowBox[{"CholeskyDecomposition", "[", 
        RowBox[{"-", 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"M", ".", "\[CapitalSigma]inf"}], "+", 
            RowBox[{"\[CapitalSigma]inf", ".", " ", 
             RowBox[{"Transpose", "[", "M", "]"}]}]}], "2"], ")"}]}], "]"}], 
       "/", "\[Beta]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Coef1", "=", 
      RowBox[{"LegendreCoeffs", "[", "80", "]"}]}], ";", 
     RowBox[{"Coef2", "=", 
      RowBox[{"LegendreCoeffs", "[", "30", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"LegendreCoef1", "=", "Coef1"}], ";", 
     RowBox[{"LegendreCoef1n", "=", "Coef2"}], ";", 
     RowBox[{"period1", "=", "6"}], ";", 
     RowBox[{"period1n", "=", "3"}], ";", 
     RowBox[{"\[Epsilon]1", "=", "0.000001"}], ";", 
     RowBox[{"LegendreCoef2", "=", "Coef1"}], ";", 
     RowBox[{"period2", "=", "8"}], ";", 
     RowBox[{"period2n", "=", "4"}], ";", 
     RowBox[{"\[Epsilon]2", "=", "0.000001"}], ";", 
     RowBox[{"imax", "=", "10"}], ";", 
     RowBox[{"\[Lambda]1", "=", "2"}], ";", 
     RowBox[{"\[Lambda]2", "=", "1.2"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"prices", "=", 
      RowBox[{"SmileBiHestonUnderlying1Vanilla", "[", 
       RowBox[{
       "S", ",", "\[Alpha]1", ",", "a", ",", "strikes", ",", "\[Tau]", ",", 
        "\[CapitalSigma]", ",", "M", ",", "\[CapitalSigma]inf", ",", 
        "\[Beta]", ",", "\[Rho]", ",", "\[Mu]", ",", "printflag"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"smile", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"strikes", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"ImpVolBS", "[", 
           RowBox[{"S1", ",", 
            RowBox[{"strikes", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "\[Tau]", ",", 
            RowBox[{"prices", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "strikes", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"smileMarket", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"strikes", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"MarketCMSOptionVol", "[", 
            RowBox[{
             RowBox[{"strikes", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "\[Tau]", ",", "tenor"}], 
            "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "strikes", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"inter", "=", 
      RowBox[{"Interpolation", "[", "smile", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"interMarket", "=", 
      RowBox[{"Interpolation", "[", "smileMarket", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"inter", "[", "x", "]"}], ",", 
         RowBox[{"interMarket", "[", "x", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{"strikes", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"Last", "[", "strikes", "]"}]}], "}"}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", "\"\<Implied BS vol\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"PlotLegend", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<BiHestonUnderlying1\>\"", ",", "\"\<Market\>\""}], 
         "}"}]}], ",", 
       RowBox[{"LegendPosition", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0"}], "}"}]}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0.3"}], "}"}]}]}], "]"}]}]}], "]"}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.4042074577632284`*^9, 3.4042074770760994`*^9}, {
   3.4042075328115444`*^9, 3.4042077538626633`*^9}, {3.404207970241818*^9, 
   3.404207993351637*^9}, {3.4042080286491895`*^9, 3.404208043665103*^9}, {
   3.4042173037335176`*^9, 3.4042173873444977`*^9}, {3.4042175109093704`*^9, 
   3.404217554472707*^9}, {3.4042999349691343`*^9, 3.4042999555923347`*^9}, 
   3.404325362832144*^9, 3.4043253935953436`*^9, {3.4043813496393437`*^9, 
   3.4043813704653435`*^9}, {3.404456304258438*^9, 3.404456370334422*^9}, {
   3.4046498109902925`*^9, 3.4046498399752235`*^9}, {3.4046509463870916`*^9, 
   3.404650973731366*^9}, {3.404653049614973*^9, 3.404653081803091*^9}, {
   3.404826792070529*^9, 3.404826795492535*^9}, {3.4048268941525736`*^9, 
   3.4048268964651623`*^9}, {3.404838629255556*^9, 3.404838644381137*^9}, {
   3.405003582974747*^9, 3.4050035922723475`*^9}, {3.4050918622706738`*^9, 
   3.4050918685833354`*^9}, 3.405092260780875*^9, {3.405101581745773*^9, 
   3.405101582151373*^9}, {3.4051403012067823`*^9, 3.4051406029669824`*^9}, {
   3.4051410575824413`*^9, 3.4051411259275036`*^9}, {3.4051412098041143`*^9, 
   3.405141232038957*^9}, {3.4051431058212996`*^9, 3.405143158650777*^9}, {
   3.4051432003549695`*^9, 3.405143242559175*^9}, {3.4051432892478704`*^9, 
   3.405143360171561*^9}, {3.4051434107041044`*^9, 3.405143439939228*^9}, {
   3.405143475408886*^9, 3.4051435175974655`*^9}, {3.4051436028652735`*^9, 
   3.4051436299284663`*^9}, {3.405143664444975*^9, 3.4051436721482973`*^9}, {
   3.4051437090242414`*^9, 3.405143761634963*^9}, 3.40514382363655*^9, {
   3.4051438551686077`*^9, 3.4051438897319922`*^9}, {3.4051439244672565`*^9, 
   3.405143954186767*^9}, 3.4051440300637093`*^9, {3.4051440892839756`*^9, 
   3.4051440917371635`*^9}, {3.405144174364279*^9, 3.40514417500492*^9}, {
   3.4051442267874956`*^9, 3.4051442275218897`*^9}, {3.405144423370653*^9, 
   3.405144429855194*^9}, {3.4051445125604362`*^9, 3.4051445127635665`*^9}, 
   3.405144622985138*^9, 3.405144741910057*^9, 3.4051448663663683`*^9, {
   3.4051450509960947`*^9, 3.4051450646214437`*^9}, 3.4051451061068807`*^9, {
   3.4051451799681463`*^9, 3.4051451825932136`*^9}, {3.4051452789706807`*^9, 
   3.4051452797050743`*^9}, {3.405145367660451*^9, 3.4051453897547665`*^9}, {
   3.4051454445530443`*^9, 3.4051454481000104`*^9}, 3.405145505163971*^9, {
   3.4051455539308443`*^9, 3.405145578197091*^9}, 3.405145637667363*^9, {
   3.4051457107473593`*^9, 3.4051457112473717`*^9}, {3.4051458827205114`*^9, 
   3.405145895252082*^9}, 3.4051459371906557`*^9, {3.4051460458653126`*^9, 
   3.4051460587875185`*^9}, 3.405146096194726*^9, {3.405146127554904*^9, 
   3.4051461281017933`*^9}, {3.405146160024485*^9, 3.405146162165165*^9}, {
   3.4051462002598906`*^9, 3.4051462113851748`*^9}, {3.405146247167341*^9, 
   3.4051462476517286`*^9}, 3.405159066573634*^9, {3.405159121996928*^9, 
   3.4051591258407764`*^9}, {3.4051592207963324`*^9, 
   3.4051592450157022`*^9}, {3.4051593373930674`*^9, 3.405159352393451*^9}, {
   3.4051595148663607`*^9, 3.405159524272851*^9}, 3.405159569430257*^9, {
   3.405159638416398*^9, 3.405159638635154*^9}, {3.405160130788378*^9, 
   3.405160154398357*^9}, {3.4057587744848056`*^9, 3.4057587760317106`*^9}, {
   3.405758849611248*^9, 3.4057588555644875`*^9}, {3.4057589512069488`*^9, 
   3.4057589713167095`*^9}, {3.4057590080830407`*^9, 
   3.4057590110987234`*^9}, {3.405759122897745*^9, 3.405759123038373*^9}, {
   3.405759192524082*^9, 3.405759192992841*^9}, {3.4057592404000015`*^9, 
   3.4057592487751617`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Nb1=\"\>", "\[InvisibleSpace]", "62", 
   "\[InvisibleSpace]", "\<\" Nb1n=\"\>", "\[InvisibleSpace]", "30", 
   "\[InvisibleSpace]", "\<\" Nb2=\"\>", "\[InvisibleSpace]", "77"}],
  SequenceForm["Nb1=", 62, " Nb1n=", 30, " Nb2=", 77],
  Editable->False]], "Print",
 CellChangeTimes->{3.405160181149042*^9, 3.4056742916315746`*^9, 
  3.4057587995477867`*^9, 3.405758880080583*^9, 3.4057589748011513`*^9, 
  3.4057590176926003`*^9, 3.405759128741607*^9, 3.4057591989617057`*^9, 
  3.405759254869029*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\" S=\"\>", "\[InvisibleSpace]", 
   InterpretationBox[GridBox[{
      {"0.04818389411495181`"},
      {"0.04818389411495181`"}
     },
     BaselinePosition->{Baseline, {1, 1}},
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}}],
    ColumnForm[{0.04818389411495181, 0.04818389411495181}],
    Editable->False], "\[InvisibleSpace]", "\<\" \[CapitalSigma]=\"\>", 
   "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0.015`", "0.009797958971132711`"},
       {"0.009797958971132711`", "0.01`"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], "\[InvisibleSpace]", "\<\"M=\"\>", 
   "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"-", "0.15`"}], "0.`"},
       {"0.`", 
        RowBox[{"-", "0.15`"}]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], 
   "\[InvisibleSpace]", "\<\" \[CapitalSigma]inf=\"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0.015`", "0.009797958971132711`"},
       {"0.009797958971132711`", "0.01`"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], "\[InvisibleSpace]", "\<\" Q=\"\>", 
   "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0.009486832980505138`", "0.006196773353931867`"},
       {"0.`", "0.0046475800154489`"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], "\[InvisibleSpace]", "\<\" \[Rho]=\"\>", 
   "\[InvisibleSpace]", 
   InterpretationBox[GridBox[{
      {
       RowBox[{"-", "0.45`"}]},
      {
       RowBox[{"-", "0.45`"}]}
     },
     BaselinePosition->{Baseline, {1, 1}},
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}}],
    ColumnForm[{-0.45, -0.45}],
    Editable->False], "\[InvisibleSpace]", "\<\" Imaginary Shifts=\"\>", 
   "\[InvisibleSpace]", 
   InterpretationBox[GridBox[{
      {"2"},
      {"1.1`"}
     },
     BaselinePosition->{Baseline, {1, 1}},
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}}],
    ColumnForm[{2, 1.1}],
    Editable->False]}],
  SequenceForm[" S=", 
   ColumnForm[{0.04818389411495181, 0.04818389411495181}], 
   " \[CapitalSigma]=", 
   MatrixForm[{{0.015, 0.009797958971132711}, {0.009797958971132711, 0.01}}], 
   "M=", 
   MatrixForm[{{-0.15, 0.}, {0., -0.15}}], " \[CapitalSigma]inf=", 
   MatrixForm[{{0.015, 0.009797958971132711}, {0.009797958971132711, 0.01}}], 
   " Q=", 
   MatrixForm[{{0.009486832980505138, 0.006196773353931867}, {0., 
    0.0046475800154489}}], " \[Rho]=", 
   ColumnForm[{-0.45, -0.45}], " Imaginary Shifts=", 
   ColumnForm[{2, 1.1}]],
  Editable->False]], "Print",
 CellChangeTimes->{3.405160181149042*^9, 3.4056742916315746`*^9, 
  3.4057587995477867`*^9, 3.405758880080583*^9, 3.4057589748011513`*^9, 
  3.4057590176926003`*^9, 3.405759128741607*^9, 3.4057591989617057`*^9, 
  3.405759262275421*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"{NbLegCoef1,NbLegCoef1n,period1,period1n,\[Epsilon]1,imax}=\"\>\
", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "62", ",", "30", ",", "14.52`", ",", "12.`", ",", "0.00001`", ",", "10"}],
     "}"}]}],
  SequenceForm[
  "{NbLegCoef1,NbLegCoef1n,period1,period1n,\[Epsilon]1,imax}=", {
   62, 30, 14.52, 12., 0.00001, 10}],
  Editable->False]], "Print",
 CellChangeTimes->{3.405160181149042*^9, 3.4056742916315746`*^9, 
  3.4057587995477867`*^9, 3.405758880080583*^9, 3.4057589748011513`*^9, 
  3.4057590176926003`*^9, 3.405759128741607*^9, 3.4057591989617057`*^9, 
  3.405759262275421*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"{NbLegCoef2,period2,period2n,\[Epsilon]2}=\"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"77", ",", "16.`", ",", "1.6`", ",", "0.00001`"}], "}"}]}],
  SequenceForm[
  "{NbLegCoef2,period2,period2n,\[Epsilon]2}=", {77, 16., 1.6, 0.00001}],
  Editable->False]], "Print",
 CellChangeTimes->{3.405160181149042*^9, 3.4056742916315746`*^9, 
  3.4057587995477867`*^9, 3.405758880080583*^9, 3.4057589748011513`*^9, 
  3.4057590176926003`*^9, 3.405759128741607*^9, 3.4057591989617057`*^9, 
  3.405759262275421*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"24.328000000000007`", ",", 
   GraphicsBox[{InsetBox[
      GraphicsBox[{{}, {}, 
        {Hue[0.67, 0.6, 0.6], LineBox[CompressedData["
1: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
r2slPuHgrvfThgXZTI1dl0m++rOD3TrXngW6Uhl/KnG80K/jy8+wsC72Y/JT
4vbyqx7q51kQYCo4y5D8aLgoIPeSFwvlrW5u//LpwIfaLX5XWVgi8E5mGcm3
AYz5nKgb5HnPq+y9xNTxsNclgSzYpK7xLyJWL4leOBLFgnqNen0Iyd9rLNKd
nPJZUCx4nnR2KTmfCn2T3oUsZG5VZeQRW87IBISWkHik1bM/Ecfk5iXdZ7FQ
8vB00AVSLxb+Ln4+yCO/f3jX3J/Uk4kUaqN9Fwu1697uf0PqUZQb3yO39ywo
0U5cVSD1UdVA18C/hwWzOMl0L+JzY7U2GYMsGL5a9EKS1Of3u59HdX9nIWzZ
ny8XSP1+MtT1/dhiNpbwDMJ1SX+gLa+pdkKIjbykubxU4pLT0a4nRdlQbcoe
nSam9Rp8tV3BRv//FLUek/7D4S1zwEGGDbsv/vf0Sb8ypyWi01WbjdkORn/D
1lPwFPwifgls1HbbiPwiHjbee9hNlw3JpzVyZ0j/9OLJnzZ3AzYuF4me2CtL
8lf1uWfe5myoy88SESH9GNi7qwKc2dCRWbTqNenn6D9SpgNd2GiqUCy2UKIg
p/5bK/gSG0kds83aiQVLS8pvebLx4fS16nbSD77NX02/E8CGq9mTM72qpP9N
mcyiJbEhmJuqv5n0p8zAB6EFz9hg0qS/p2tT2CMvu8C7mY2z1qMPNHeS89GQ
Eqjfxsbtb9dsm4jHF0X79r5iYzJqpGbmP5Lvoj09VvSx8VpqysdpF4UHKXqn
An6xsXF4Stp9L4V09oftx+TKceLz7V/GpuR5S0u2gkI5Yi4qHJxtRoHzu019
Uqkcd+WdGJXE73fWbYzeXI5ypZlcZXMKkjUFsg3a5VAcVNm3mtwv7rV4iagf
KodQleDYZnL/uP1p6adFvuUQjMv3UXYk9WZW8sxy/3KIZG0bEXci65GQWyYd
VI728PayOc6k3hpvg3p4Ofx/DKr1nif7V3Is9hitHN8OWUsUXiT3mSvZuwpL
ynGs4bSyP7lffZujmbC/pxy38mPnaYSS87KaU3y0vxzqjqs+G4VRyNpqWHtq
sBw/tHaq24eT/EEC5/G1HBmSQn9pd0h9bLyxN/VXOSRm824uvUshNbphfESk
Ah8GLdqMyX3woLSVUZRuBfKUeEc6ikk/mMSfdkavAlY2smVzSsl8Vtyf2GlQ
gZgjDZYadApKwlPJn00qkPN6JjSBQe4jfHGjuy0r8J9acPjlCvJ9fWiN/elS
gf0PngedqSb3E2uvz88uVSC17furBzWkX3gljUz3CngNrbk2Vkvi2ewydMCn
gvS5zFrfBtJPVS3Ruh9UgSkxrZPFz8l9NNWw2zq5AtIPjjREvqYgJTGmrpZW
AeEY5ZOr35D+4h7t1oLMCkgqn1jxoIvC7IhBNWZeBeKdxcaevCf7eT0wUJBR
Ad6emK3LP5Lv+wRXkfu0AuYztwd7xij8Xb3dXW6qAi2/qQizxVV4Nvu3z7ff
ZP1c89u/l1Qh4VOlH2u6Akc9FJIyhaqgztSO3Du7EglvO4enRKtw1ljngYNg
JYJGj1uUrKxCi7d+T45MJaKGVCTM5KuQ8crCRN60EquKeFo2u6uwJ+qS7Ib8
Sgxscf6QdL0Kl1/d6jzg9BCyT+pNo+ZxENW/3SJY6hG4fLfaLE05iK+pb+/v
fYQFj9sz2UUc3Hb6JmEW/xgtzjUlvYu4EA9x+aRE7rGjdLvXXo5chF9pqlQS
rIL/ioilj1q4+KZSd0irugrShW/Xf1XhIbnLxLN8NwciN8O1c6J4EOr6eGth
Fgf9OQslro/xMLlz343eaQ7y3FY8K9lbDfPQZI/9J7mYv0Iz3S+tGvI7Hpvq
VnJh2hm+UHG8GrUyAq7OS3n4KVowclinBp1TepEKl3lIlFLYoXe3Bnab9sdc
aOKhfno0f/kHYlO9hL2bquE3u+dC7cZazFyLNDYjfjbNmWkipuV3zRwnNt+Q
dOc1cdPsS3buxBGCe4q+EO9gpShnEdPWWX0V2VQLYYkpin9zNVx8Ux1PED/u
z+97RKzYHGE7SXxU5GdsA7H13JejfJtrMb5zl0E7sayLuK8A8YZ7rwq+EP94
F5aymjjGcI7HKrVqnFfS6tpN7Fh0fIEn8ZbkskORxHO78ir9iRNXFvbGE6fN
n3COIDZuTL+YSdxhE9qaQ/yt6WoEi1hnKTuhg1jF6tfTt8RdmGXSQ8zzf2Y5
QOzhbPJ3mNijL2FohLigts9uzpZqZOspzJutVgv9cVUxYWILg08xi4l713g3
SBBH3sxaL0Z81ajWW574wpgVXYpY3FNYZQvxYtriXQrE/wcltOsQ
          "]]}, 
        {Hue[0.9060679774997897, 0.6, 0.6], LineBox[CompressedData["
1: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
          "]]}},
       AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
       Axes->True,
       AxesOrigin->{0.02, 0},
       DisplayFunction:>$DisplayFunction,
       FormatType->TraditionalForm,
       PlotLabel->FormBox["\"Implied BS vol\"", TraditionalForm],
       PlotRange->{{0.01, 0.15}, {0, 0.3}},
       PlotRangeClipping->True,
       PlotRangePadding->{
         Scaled[0.02], Automatic}], {-1, -0.6180339887498948}, {
      Left, Bottom}, {2, 1.2360679774997896`}], {
      {GrayLevel[0], RectangleBox[{1.05, -0.05}, {1.85, 0.55}]}, 
      {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[0.001]}], 
       RectangleBox[{1, 0}, {1.8, 0.6000000000000001}], InsetBox[
        GraphicsBox[{{{InsetBox[
             GraphicsBox[
              {Hue[0.9060679774997897, 0.6, 0.6], 
               LineBox[{{0, 0}, {1, 0}}]}], {0.08, 0.08}, {
             Left, Bottom}, {1, 1}], 
            InsetBox["\<\"Market\"\>", {1.21, 0.58}, {-1, 0}, Automatic, {1, 
             0}]}, {InsetBox[
             GraphicsBox[
              {Hue[0.67, 0.6, 0.6], 
               LineBox[{{0, 0}, {1, 0}}]}], {0.08, 1.24}, {
             Left, Bottom}, {1, 1}], 
            InsetBox["\<\"BiHestonUnderlying1\"\>", {1.21, 1.74}, {-1, 0}, 
             Automatic, {1, 0}]}}, {}},
         AspectRatio->0.7500000000000001,
         FormatType->TraditionalForm,
         PlotRange->{{-0.1, 3.26}, {-0.1, 2.42}}], {1, 0}, {
        Left, Bottom}, {0.8, 0.6000000000000001}]}}},
    AspectRatio->Automatic,
    Background->None,
    ColorOutput->Automatic,
    ImageSize->{564., Automatic},
    PlotRange->All]}], "}"}]], "Output",
 CellChangeTimes->{3.405160200727668*^9, 3.40567431977274*^9, 
  3.4057588074854393`*^9, 3.405758887533851*^9, 3.4057589822231693`*^9, 
  3.4057590523026395`*^9, 3.405759149617008*^9, 3.405759214962013*^9, 
  3.4057592742131505`*^9}]
}, Open  ]],

Cell[BoxData["Manipulate"], "Input",
 CellChangeTimes->{{3.405768946436722*^9, 3.405768954968136*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"Sin", "[", 
      RowBox[{
       RowBox[{"a", " ", "x"}], "+", "b"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", "6"}], "}"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "2", ",", "\"\<Multiplier\>\""}], "}"}], ",", "1", 
     ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"b", ",", "0", ",", "\"\<Phase Parameter\>\""}], "}"}], ",", 
     "0", ",", "10"}], "}"}]}], "]"}]], "Input",
 CellID->26946],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`a$$ = 2.31, $CellContext`b$$ = 3.08, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`a$$], 2, "Multiplier"}, 1, 4}, {{
       Hold[$CellContext`b$$], 0, "Phase Parameter"}, 0, 10}}, 
    Typeset`size$$ = {360., {106., 110.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`a$292967$$ = 0, $CellContext`b$292968$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`a$$ = 2, $CellContext`b$$ = 0}, 
      "ControllerVariables" :> {
        Hold[$CellContext`a$$, $CellContext`a$292967$$, 0], 
        Hold[$CellContext`b$$, $CellContext`b$292968$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Plot[
        Sin[$CellContext`a$$ $CellContext`x + $CellContext`b$$], \
{$CellContext`x, 0, 6}], 
      "Specifications" :> {{{$CellContext`a$$, 2, "Multiplier"}, 1, 
         4}, {{$CellContext`b$$, 0, "Phase Parameter"}, 0, 10}}, 
      "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{408., {164., 169.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.405768997672081*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"S1", ",", "S2", ",", 
       RowBox[{"M1", "=", 
        RowBox[{"-", "0.15"}]}], ",", 
       RowBox[{"M2", "=", 
        RowBox[{"-", "0.15"}]}], ",", 
       RowBox[{"\[Rho]s", "=", "0.8"}], ",", 
       RowBox[{"\[Rho]sinf", "=", "0.8"}], ",", 
       RowBox[{"\[Rho]m1", "=", "0."}], ",", 
       RowBox[{"\[Rho]m2", "=", "0."}], ",", 
       RowBox[{"\[Rho]1", "=", 
        RowBox[{"-", "0.15"}]}], ",", 
       RowBox[{"\[Rho]2", "=", 
        RowBox[{"-", "0.15"}]}], ",", " ", "\[CapitalSigma]1", ",", 
       "\[CapitalSigma]2", ",", "\[Theta]1", ",", "\[Theta]2", ",", 
       RowBox[{"\[Tau]", "=", "5"}], ",", 
       RowBox[{"\[Alpha]1", "=", "1"}], ",", 
       RowBox[{"a", "=", "1"}], ",", "M", ",", "\[CapitalSigma]inf", ",", 
       "\[CapitalSigma]", ",", "Q", ",", "\[Beta]m", ",", "S", ",", "\[Rho]", 
       ",", 
       RowBox[{"printflag", "=", "0"}], ",", 
       RowBox[{"\[Mu]", "=", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}]}], ",", "inter1", ",", "inter2", ",", 
       "inter3", ",", "smileLN", ",", "interLN", ",", "prices", ",", 
       RowBox[{"tenor", "=", "\"\<cms5\>\""}], ",", "K"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[CapitalSigma]1", "=", "0.015"}], ";", 
      RowBox[{"\[CapitalSigma]2", "=", "0.01"}], ";", 
      RowBox[{"\[Theta]1", "=", 
       RowBox[{"1.", "\[CapitalSigma]1"}]}], ";", 
      RowBox[{"\[Theta]2", "=", "\[CapitalSigma]2"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"S1", "=", 
       RowBox[{
        RowBox[{"MarketCMSForward", "[", 
         RowBox[{"\[Tau]", ",", "tenor"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", 
      RowBox[{"S2", "=", "S1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"M", "=", 
       RowBox[{"(", GridBox[{
          {"M1", 
           RowBox[{"\[Rho]m1", 
            SqrtBox[
             RowBox[{"M1", " ", "M2"}]]}]},
          {
           RowBox[{"\[Rho]m2", 
            SqrtBox[
             RowBox[{"M1", " ", "M2"}]]}], "M2"}
         }], ")"}]}], ";", 
      RowBox[{"\[CapitalSigma]inf", "=", 
       RowBox[{"(", GridBox[{
          {"\[Theta]1", 
           RowBox[{
            SqrtBox[
             RowBox[{"\[Theta]1", " ", "\[Theta]2"}]], " ", "\[Rho]sinf"}]},
          {
           RowBox[{
            SqrtBox[
             RowBox[{"\[Theta]1", " ", "\[Theta]2"}]], " ", "\[Rho]sinf"}], 
           "\[Theta]2"}
         }], ")"}]}], ";", 
      RowBox[{"\[CapitalSigma]", "=", 
       RowBox[{"(", GridBox[{
          {"\[CapitalSigma]1", 
           RowBox[{
            SqrtBox[
             RowBox[{"\[CapitalSigma]1", " ", "\[CapitalSigma]2"}]], " ", 
            "\[Rho]s"}]},
          {
           RowBox[{
            SqrtBox[
             RowBox[{"\[CapitalSigma]1", " ", "\[CapitalSigma]2"}]], " ", 
            "\[Rho]s"}], "\[CapitalSigma]2"}
         }], ")"}]}], ";", 
      RowBox[{"S", "=", 
       RowBox[{"{", 
        RowBox[{"S1", ",", "S2"}], "}"}]}], ";", 
      RowBox[{"\[Rho]", "=", 
       RowBox[{"{", 
        RowBox[{"\[Rho]1", ",", "\[Rho]2"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"strikes", "=", 
       RowBox[{"{", 
        RowBox[{
        "0.01", ",", "0.0125", ",", "0.015", ",", "0.0175", ",", "0.02", ",", 
         "0.021", ",", "0.022", ",", "0.023", ",", "0.024", ",", "0.025", ",",
          "0.026", ",", "0.027", ",", "0.028", ",", "0.029", ",", "0.03", ",",
          "0.031", ",", "0.032", ",", "0.033", ",", "0.034", ",", "0.035", 
         ",", "0.036", ",", "0.037", ",", "0.038", ",", "0.039", ",", "0.04", 
         ",", "0.045", ",", "0.048", ",", "0.05", ",", "0.055", ",", "0.06", 
         ",", "0.065", ",", "0.07", ",", "0.075", ",", "0.08", ",", "0.085", 
         ",", "0.09", ",", "0.095", ",", "0.1", ",", "0.11", ",", "0.12"}], 
        "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Q", "=", 
       RowBox[{
        RowBox[{"CholeskyDecomposition", "[", 
         RowBox[{"-", 
          RowBox[{"(", 
           FractionBox[
            RowBox[{
             RowBox[{"M", ".", "\[CapitalSigma]inf"}], "+", 
             RowBox[{"\[CapitalSigma]inf", ".", " ", 
              RowBox[{"Transpose", "[", "M", "]"}]}]}], "2"], ")"}]}], "]"}], 
        "/", "\[Beta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Coef1", "=", 
       RowBox[{"LegendreCoeffs", "[", "20", "]"}]}], ";", 
      RowBox[{"Coef2", "=", 
       RowBox[{"LegendreCoeffs", "[", "10", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"LegendreCoef1", "=", "Coef1"}], ";", 
      RowBox[{"LegendreCoef1n", "=", "Coef2"}], ";", 
      RowBox[{"period1", "=", "10"}], ";", 
      RowBox[{"period1n", "=", "5"}], ";", 
      RowBox[{"\[Epsilon]1", "=", "0.000001"}], ";", 
      RowBox[{"LegendreCoef2", "=", "Coef1"}], ";", 
      RowBox[{"period2", "=", "12"}], ";", 
      RowBox[{"period2n", "=", "1.6"}], ";", 
      RowBox[{"\[Epsilon]2", "=", "0.000001"}], ";", 
      RowBox[{"imax", "=", "3"}], ";", 
      RowBox[{"\[Lambda]1", "=", "2"}], ";", 
      RowBox[{"\[Lambda]2", "=", "1.2"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"prices", "=", 
         RowBox[{"SmileBiHestonUnderlying1Vanilla", "[", 
          RowBox[{
          "S", ",", "\[Alpha]1", ",", "a", ",", "strikes", ",", "\[Tau]", ",",
            "\[CapitalSigma]", ",", "M", ",", "\[CapitalSigma]inf", ",", 
           "\[Beta]", ",", "\[Rho]", ",", "\[Mu]", ",", "printflag"}], 
          "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"prices", "=", 
       RowBox[{"SmileBiHestonUnderlying1VanillaAux", "[", 
        RowBox[{
        "S", ",", "\[Alpha]1", ",", "a", ",", "strikes", ",", "\[Tau]", ",", 
         "\[CapitalSigma]", ",", "M", ",", "\[CapitalSigma]inf", ",", "Q", 
         ",", "\[Rho]", ",", "\[Mu]", ",", "\[Beta]", ",", "\[Lambda]1", ",", 
         "\[Lambda]2", ",", 
         RowBox[{"{", 
          RowBox[{
          "LegendreCoef1", ",", "LegendreCoef1n", ",", "period1", ",", 
           "period1n", ",", "\[Epsilon]1", ",", "imax"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "LegendreCoef2", ",", "period2", ",", "period2n", ",", 
           "\[Epsilon]2"}], "}"}], ",", "printflag"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"smile", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"strikes", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"ImpVolBS", "[", 
            RowBox[{"S1", ",", 
             RowBox[{"strikes", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "\[Tau]", ",", 
             RowBox[{"prices", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "strikes", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"smileMarket", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"strikes", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"MarketCMSOptionVol", "[", 
             RowBox[{
              RowBox[{"strikes", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", "\[Tau]", ",", "tenor"}], 
             "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "strikes", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"inter", "=", 
       RowBox[{"Interpolation", "[", "smile", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"interMarket", "=", 
       RowBox[{"Interpolation", "[", "smileMarket", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Plot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"inter", "[", "x", "]"}], ",", 
          RowBox[{"interMarket", "[", "x", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{"strikes", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"Last", "[", "strikes", "]"}]}], "}"}], ",", 
        RowBox[{"PlotLabel", "\[Rule]", "\"\<Implied BS vol\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"PlotLegend", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<BiHestonUnderlying1\>\"", ",", "\"\<Market\>\""}], 
          "}"}]}], ",", 
        RowBox[{"LegendPosition", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}]}], ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0.3"}], "}"}]}]}], "]"}]}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Beta]", ",", "2.5", ",", "\"\<Multiplier\>\""}], "}"}], ",", 
     "2", ",", "7"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.40576916715971*^9, {3.4057692321765833`*^9, 3.4057692510206947`*^9}, {
   3.4057692960684347`*^9, 3.405769326912777*^9}, 3.405769453571459*^9, {
   3.4057758979295635`*^9, 3.405775902898409*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"S1", ",", "S2", ",", 
      RowBox[{"M1", "=", 
       RowBox[{"-", "0.35"}]}], ",", 
      RowBox[{"M2", "=", 
       RowBox[{"-", "0.35"}]}], ",", 
      RowBox[{"\[Rho]s", "=", "0.5"}], ",", 
      RowBox[{"\[Rho]sinf", "=", "0.5"}], ",", 
      RowBox[{"\[Rho]m1", "=", "0."}], ",", 
      RowBox[{"\[Rho]m2", "=", "0."}], ",", 
      RowBox[{"\[Rho]1", "=", 
       RowBox[{"-", "0.45"}]}], ",", 
      RowBox[{"\[Rho]2", "=", 
       RowBox[{"-", "0.45"}]}], ",", " ", "\[CapitalSigma]1", ",", 
      "\[CapitalSigma]2", ",", "\[Theta]1", ",", "\[Theta]2", ",", 
      RowBox[{"\[Tau]", "=", "5"}], ",", 
      RowBox[{"\[Alpha]1", "=", "1"}], ",", 
      RowBox[{"a", "=", "1"}], ",", "M", ",", "\[CapitalSigma]inf", ",", 
      "\[CapitalSigma]", ",", "Q", ",", "\[Beta]m", ",", "S", ",", "\[Rho]", 
      ",", 
      RowBox[{"printflag", "=", 
       RowBox[{"{", "1", "}"}]}], ",", 
      RowBox[{"\[Mu]", "=", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], ",", "inter1", ",", "inter2", ",", 
      "inter3", ",", "smileLN", ",", "interLN", ",", "prices", ",", 
      RowBox[{"tenor1", "=", "\"\<cms2\>\""}], ",", 
      RowBox[{"tenor2", "=", "\"\<cms10\>\""}], ",", "K", ",", "\[Beta]", ",",
       
      RowBox[{"limsup", "=", "1000"}], ",", "\[Rho]H1", ",", "\[Nu]H2", ",", 
      "\[Rho]H2", ",", "\[Lambda]H2", ",", "\[Theta]H2", ",", "\[Nu]1", ",", 
      "\[Nu]2", ",", 
      RowBox[{"Lcoefs", "=", 
       RowBox[{"LegendreCoeffs", "[", "40", "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[CapitalSigma]1", "=", "0.01"}], ";", 
     RowBox[{"\[CapitalSigma]2", "=", "0.01"}], ";", 
     RowBox[{"\[Theta]1", "=", 
      RowBox[{"3.", "\[CapitalSigma]1"}]}], ";", 
     RowBox[{"\[Theta]2", "=", 
      RowBox[{"3.", "\[CapitalSigma]2"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"S1", "=", 
      RowBox[{
       RowBox[{"MarketCMSForward", "[", 
        RowBox[{"\[Tau]", ",", "tenor1"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", 
     RowBox[{"S2", "=", 
      RowBox[{
       RowBox[{"MarketCMSForward", "[", 
        RowBox[{"\[Tau]", ",", "tenor2"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"M", "=", 
      RowBox[{"(", GridBox[{
         {"M1", 
          RowBox[{"\[Rho]m1", 
           SqrtBox[
            RowBox[{"M1", " ", "M2"}]]}]},
         {
          RowBox[{"\[Rho]m2", 
           SqrtBox[
            RowBox[{"M1", " ", "M2"}]]}], "M2"}
        }], ")"}]}], ";", 
     RowBox[{"\[CapitalSigma]inf", "=", 
      RowBox[{"(", GridBox[{
         {"\[Theta]1", 
          RowBox[{
           SqrtBox[
            RowBox[{"\[Theta]1", " ", "\[Theta]2"}]], " ", "\[Rho]sinf"}]},
         {
          RowBox[{
           SqrtBox[
            RowBox[{"\[Theta]1", " ", "\[Theta]2"}]], " ", "\[Rho]sinf"}], 
          "\[Theta]2"}
        }], ")"}]}], ";", 
     RowBox[{"\[CapitalSigma]", "=", 
      RowBox[{"(", GridBox[{
         {"\[CapitalSigma]1", 
          RowBox[{
           SqrtBox[
            RowBox[{"\[CapitalSigma]1", " ", "\[CapitalSigma]2"}]], " ", 
           "\[Rho]s"}]},
         {
          RowBox[{
           SqrtBox[
            RowBox[{"\[CapitalSigma]1", " ", "\[CapitalSigma]2"}]], " ", 
           "\[Rho]s"}], "\[CapitalSigma]2"}
        }], ")"}]}], ";", 
     RowBox[{"S", "=", 
      RowBox[{"{", 
       RowBox[{"S1", ",", "S2"}], "}"}]}], ";", 
     RowBox[{"\[Rho]", "=", 
      RowBox[{"{", 
       RowBox[{"\[Rho]1", ",", "\[Rho]2"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Q", "=", 
      RowBox[{"(", GridBox[{
         {"0.25", "0.01"},
         {"0.01", "0.25"}
        }], ")"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Test2BiHestonVanilla2", "[", 
      RowBox[{"S", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
       RowBox[{"-", "0.01"}], ",", "\[Tau]", ",", "\[CapitalSigma]", ",", "M",
        ",", "\[CapitalSigma]inf", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",",
        "1.1", ",", "1.01", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LegendreCoeffs", "[", "30", "]"}], ",", 
         RowBox[{"LegendreCoeffs", "[", "15", "]"}], ",", "8", ",", "5", ",", 
         "0.0000001", ",", "20"}], "}"}], ",", "14"}], "]"}]}]}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.4060277708820677`*^9, 3.4060277738977504`*^9}, {
   3.4060279027752247`*^9, 3.4060279729328213`*^9}, {3.406028036699671*^9, 
   3.4060280660283594`*^9}, 3.4060281307952275`*^9, {3.406028162920844*^9, 
   3.4060281635146055`*^9}, 3.4060284791925416`*^9, {3.4060288779970737`*^9, 
   3.4060289356388054`*^9}, {3.4060289708113556`*^9, 3.4060290330313005`*^9}, 
   3.406029224613104*^9, {3.4060294514768343`*^9, 3.4060294706178265`*^9}, {
   3.406029625558302*^9, 3.406029653027579*^9}, {3.406030006253111*^9, 
   3.406030006784371*^9}, {3.406030037925594*^9, 3.406030038144348*^9}, {
   3.406030134974332*^9, 3.4060301351618357`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"15.546999999999995`", ",", 
   GraphicsBox[{{}, {}, 
     {Hue[0.67, 0.6, 0.6], LineBox[CompressedData["
1:eJw1lAtMk1cUx4u8EQVGoSCPPihQinUMBsKU3iPKoOCDQp0zkffqAAnglLmh
IC3UKAMJGpHJZAiMpys4FkYQubxEgsxUo8JgoCDitBqEiXMG46D37iRfvny5
9zvnf/6/cy83IT1SvorBYMiXn5X3/xHiOyP9TYvRc2m7s0rbgzR9B67enOmi
37eR9trmGEOLTjSVxVSHTI0h1frbTWuM2+n6FLK5WMKJUrSi/bqYRay+uxVq
tpruf4YY57Obhli1aF9x76Jg3xziJXg9SDtYQf+fR93ytEaJ41nkodvwCq3l
CsI+Nsun+V6jVMf0VFHUl6gmI9BspPoNUrn4DC42JmKS/y26W9CYOhn5LWar
tMsZ3yHrK45BSxoFJvXeI781D7PPDebj34dXggE3X1oy25ZUmNTXg8Tbc57m
0yq8nHy5gj5sc0D98oV8TPQYQJGquqiwJg+H6goawh8fVV3cGq/ERJ8R+G/C
ct43CqwrrzKGw1sud07bKjDRawIJbNYht2AF7ltWU9xrCrIX5WH3HyuofjNI
HOhK8+1SYkLDHDKCjIV3FHm0nzVQ/bnw6Y9TeThQJ3AtlCVpnabL82h/FnCj
ZDZYUqCk65awUNB0+temXNqvJYQ0N4psdx2j+63AfeAvf9HZr2n/VjDqJze3
epGBj67IyfoAQquqj46nJFE/rCHdeDi5Y08CvvD9SliD9E3bicTKOOoPEx52
Ou2uLUjEK9mk7UwofVexeuZkCvXLBrj+ht65/K+wLt2IDdR6fPfDncwj1D9b
iKkpa4gRHcOvV+xZtAUzhUDptuc49ZMFR/UGGst4uVgnj2kHDjZFZypbcqi/
dvDJuKwErmdhH13YQ8D7tIEHzEzqtz3EJ3ZFCLWpOFIncB3os7wfxO+Ipf6v
A838YCtDH/BBnYEOEG/Sc25SuRURHo4wl+N+I/VfGdLZV+wIGVWyScWTvYjw
cYL09+Zqw969SCdP7QRfBAihUPwZIjyc4Qm/vaTeTooID2fYreTELCaH0PPA
hhH1VZFkYBM9D2xYCgkszWF70P85MDj7VJ0geS4mfnBg2HRstGGCQ/lyoDCt
z2KpyIv6w4XTuWbpzeqNlDcXdh+bN60130z94kJsmsRUGxVA+XPBSvQmv8GW
T/3jwarKjkOvwr0RmQcetNwLzArf+ikifvIgxrX5ilYvCJH5cAH7e7suhEb4
Un9dIKTFS/lL9E46Ly4wcSKnJuwyl94HLjDtOaWfLpHS886HFOaGiuORodR/
PsTVNXbrm/nSeeJDsVOKF6qKoDxc4c8hQezxySg6X67ADm+Bt0lRlI8r4NjV
fRUzEXTeXGHedEwmattCebnBYb+RyewmP3q/uEHrtp8ZP5Vtw4SfGwj7XR/X
l/nQeXSDUy0brvFzFsSEhzt428skRvuNEOHhDjvkVj33HRiUhzvUpwRt7u6y
oDwE4F15OvjZ/etiwkMA54f31C3tHBUTHgJof+S90SfzipjwEEDpdttbBo86
xISHB4wtrj8stdSICQ8PcGno6P5w+z0x4eEBceMtsv5L/WLCQwjz9dHJLM7f
XYSHEHpf1nHPaOwpDyEc8JqMzJnwofMvBN4pJwNu1CZ6nj3hUqfnluZX0Yjw
8ISKW3bO2UOFiPDwBPemA4H/GB2hPNaDSWShtnxOg/8DlMHa4g==
       "]]}},
    AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
    Axes->True,
    AxesOrigin->{0, 0},
    ImageSize->{906., Automatic},
    PlotLabel->FormBox["\"U1:2nd Inv. Fourier:\"", TraditionalForm],
    PlotRange->{All, All},
    PlotRangeClipping->True,
    PlotRangePadding->{Automatic, Automatic}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.406029389538145*^9, {3.406029470914707*^9, 3.406029488711924*^9}, 
   3.4060296114955316`*^9, {3.4060296431992655`*^9, 3.406029668918509*^9}, 
   3.406030023097184*^9, 3.4060300548009176`*^9, 3.406030151318396*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"S1", ",", "S2", ",", 
      RowBox[{"M1", "=", 
       RowBox[{"-", "0.35"}]}], ",", 
      RowBox[{"M2", "=", 
       RowBox[{"-", "0.35"}]}], ",", 
      RowBox[{"\[Rho]s", "=", "0.5"}], ",", 
      RowBox[{"\[Rho]sinf", "=", "0.5"}], ",", 
      RowBox[{"\[Rho]m1", "=", "0."}], ",", 
      RowBox[{"\[Rho]m2", "=", "0."}], ",", 
      RowBox[{"\[Rho]1", "=", 
       RowBox[{"-", "0.45"}]}], ",", 
      RowBox[{"\[Rho]2", "=", 
       RowBox[{"-", "0.45"}]}], ",", " ", "\[CapitalSigma]1", ",", 
      "\[CapitalSigma]2", ",", "\[Theta]1", ",", "\[Theta]2", ",", 
      RowBox[{"\[Tau]", "=", "5"}], ",", 
      RowBox[{"\[Alpha]1", "=", "1"}], ",", 
      RowBox[{"a", "=", "1"}], ",", "M", ",", "\[CapitalSigma]inf", ",", 
      "\[CapitalSigma]", ",", "Q", ",", "\[Beta]m", ",", "S", ",", "\[Rho]", 
      ",", 
      RowBox[{"printflag", "=", 
       RowBox[{"{", "1", "}"}]}], ",", 
      RowBox[{"\[Mu]", "=", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], ",", "inter1", ",", "inter2", ",", 
      "inter3", ",", "smileLN", ",", "interLN", ",", "prices", ",", 
      RowBox[{"tenor1", "=", "\"\<cms2\>\""}], ",", 
      RowBox[{"tenor2", "=", "\"\<cms10\>\""}], ",", "K", ",", "\[Beta]", ",",
       
      RowBox[{"limsup", "=", "1000"}], ",", "\[Rho]H1", ",", "\[Nu]H2", ",", 
      "\[Rho]H2", ",", "\[Lambda]H2", ",", "\[Theta]H2", ",", "\[Nu]1", ",", 
      "\[Nu]2", ",", 
      RowBox[{"Lcoefs", "=", 
       RowBox[{"LegendreCoeffs", "[", "40", "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[CapitalSigma]1", "=", "0.01"}], ";", 
     RowBox[{"\[CapitalSigma]2", "=", "0.01"}], ";", 
     RowBox[{"\[Theta]1", "=", 
      RowBox[{"3.", "\[CapitalSigma]1"}]}], ";", 
     RowBox[{"\[Theta]2", "=", 
      RowBox[{"3.", "\[CapitalSigma]2"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"S1", "=", 
      RowBox[{
       RowBox[{"MarketCMSForward", "[", 
        RowBox[{"\[Tau]", ",", "tenor1"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", 
     RowBox[{"S2", "=", 
      RowBox[{
       RowBox[{"MarketCMSForward", "[", 
        RowBox[{"\[Tau]", ",", "tenor2"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"M", "=", 
      RowBox[{"(", GridBox[{
         {"M1", 
          RowBox[{"\[Rho]m1", 
           SqrtBox[
            RowBox[{"M1", " ", "M2"}]]}]},
         {
          RowBox[{"\[Rho]m2", 
           SqrtBox[
            RowBox[{"M1", " ", "M2"}]]}], "M2"}
        }], ")"}]}], ";", 
     RowBox[{"\[CapitalSigma]inf", "=", 
      RowBox[{"(", GridBox[{
         {"\[Theta]1", 
          RowBox[{
           SqrtBox[
            RowBox[{"\[Theta]1", " ", "\[Theta]2"}]], " ", "\[Rho]sinf"}]},
         {
          RowBox[{
           SqrtBox[
            RowBox[{"\[Theta]1", " ", "\[Theta]2"}]], " ", "\[Rho]sinf"}], 
          "\[Theta]2"}
        }], ")"}]}], ";", 
     RowBox[{"\[CapitalSigma]", "=", 
      RowBox[{"(", GridBox[{
         {"\[CapitalSigma]1", 
          RowBox[{
           SqrtBox[
            RowBox[{"\[CapitalSigma]1", " ", "\[CapitalSigma]2"}]], " ", 
           "\[Rho]s"}]},
         {
          RowBox[{
           SqrtBox[
            RowBox[{"\[CapitalSigma]1", " ", "\[CapitalSigma]2"}]], " ", 
           "\[Rho]s"}], "\[CapitalSigma]2"}
        }], ")"}]}], ";", 
     RowBox[{"S", "=", 
      RowBox[{"{", 
       RowBox[{"S1", ",", "S2"}], "}"}]}], ";", 
     RowBox[{"\[Rho]", "=", 
      RowBox[{"{", 
       RowBox[{"\[Rho]1", ",", "\[Rho]2"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Q", "=", 
      RowBox[{"(", GridBox[{
         {"0.25", "0.01"},
         {"0.01", "0.25"}
        }], ")"}]}], ";", 
     RowBox[{"\[Beta]m", "=", 
      RowBox[{"-", 
       RowBox[{
        RowBox[{"(", 
         FractionBox[
          RowBox[{
           RowBox[{"M", ".", "\[CapitalSigma]inf"}], "+", 
           RowBox[{"\[CapitalSigma]inf", ".", 
            RowBox[{"Transpose", "[", "M", "]"}]}]}], "2"], ")"}], ".", 
        RowBox[{"Inverse", "[", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Transpose", "[", "Q", "]"}], ".", "Q"}], ")"}], 
         "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"SmileSymetrizedBiHestonVanillaIntegrand2", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Log", "[", 
             RowBox[{"S", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
            RowBox[{"Log", "[", 
             RowBox[{"S", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], ",", "1", ",", 
          "1", ",", "1", ",", "1", ",", 
          RowBox[{"{", "S1", "}"}], ",", "\[Tau]", ",", "\[CapitalSigma]", 
          ",", "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", "\[Beta]m", 
          ",", "1.1", ",", "1.01", ",", "14", ",", "\[Omega]2"}], "]"}], "[", 
        
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Omega]2", ",", "14.38", " ", ",", "14.40"}], "}"}]}], 
      "]"}]}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.4060277708820677`*^9, 3.4060277738977504`*^9}, {
   3.4060279027752247`*^9, 3.4060279729328213`*^9}, {3.406028036699671*^9, 
   3.4060280660283594`*^9}, 3.4060281307952275`*^9, {3.406028162920844*^9, 
   3.4060281635146055`*^9}, 3.4060284791925416`*^9, {3.4060288779970737`*^9, 
   3.4060289356388054`*^9}, {3.4060289708113556`*^9, 3.4060290330313005`*^9}, 
   3.406029224613104*^9, {3.4060294514768343`*^9, 3.4060294706178265`*^9}, {
   3.406029625558302*^9, 3.406029653027579*^9}, {3.406030006253111*^9, 
   3.406030006784371*^9}, {3.406030037925594*^9, 3.406030038144348*^9}, {
   3.406030134974332*^9, 3.4060301351618357`*^9}, {3.406372390190527*^9, 
   3.406372441550888*^9}, {3.4063726672583466`*^9, 3.4063727446817083`*^9}, {
   3.406372797776477*^9, 3.4063728287770724`*^9}, {3.406372876793619*^9, 
   3.406372878949911*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"9.344000000000038`", ",", 
   GraphicsBox[{{}, {}, 
     {Hue[0.67, 0.6, 0.6], LineBox[CompressedData["
1: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
       "]]}},
    AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
    Axes->True,
    AxesOrigin->{14.38, 0},
    ImageSize->{635., Automatic},
    PlotRange->{{14.38, 14.4}, {-1.8827449627411432`*^302, 
     2.3721961836296337`*^302}},
    PlotRangeClipping->True,
    PlotRangePadding->{
      Scaled[0.02], 
      Scaled[0.02]}]}], "}"}]], "Output",
 CellChangeTimes->{3.4063727654477315`*^9, 3.4063728514181323`*^9, 
  3.4063728891063557`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Explosion", " ", "typique"}]], "Input",
 CellChangeTimes->{{3.406372972264202*^9, 3.406372975826771*^9}},
 Background->RGBColor[1, 0, 0]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"S1", ",", "S2", ",", 
      RowBox[{"M1", "=", 
       RowBox[{"-", "0.35"}]}], ",", 
      RowBox[{"M2", "=", 
       RowBox[{"-", "0.35"}]}], ",", 
      RowBox[{"\[Rho]s", "=", "0.5"}], ",", 
      RowBox[{"\[Rho]sinf", "=", "0.5"}], ",", 
      RowBox[{"\[Rho]m1", "=", "0."}], ",", 
      RowBox[{"\[Rho]m2", "=", "0."}], ",", 
      RowBox[{"\[Rho]1", "=", 
       RowBox[{"-", "0.45"}]}], ",", 
      RowBox[{"\[Rho]2", "=", 
       RowBox[{"-", "0.45"}]}], ",", " ", "\[CapitalSigma]1", ",", 
      "\[CapitalSigma]2", ",", "\[Theta]1", ",", "\[Theta]2", ",", 
      RowBox[{"\[Tau]", "=", "5"}], ",", 
      RowBox[{"\[Alpha]1", "=", "1"}], ",", 
      RowBox[{"a", "=", "1"}], ",", "M", ",", "\[CapitalSigma]inf", ",", 
      "\[CapitalSigma]", ",", "Q", ",", "\[Beta]m", ",", "S", ",", "\[Rho]", 
      ",", 
      RowBox[{"printflag", "=", 
       RowBox[{"{", "1", "}"}]}], ",", 
      RowBox[{"\[Mu]", "=", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], ",", "inter1", ",", "inter2", ",", 
      "inter3", ",", "smileLN", ",", "interLN", ",", "prices", ",", 
      RowBox[{"tenor1", "=", "\"\<cms2\>\""}], ",", 
      RowBox[{"tenor2", "=", "\"\<cms10\>\""}], ",", "K", ",", "\[Beta]", ",",
       
      RowBox[{"limsup", "=", "1000"}], ",", "\[Rho]H1", ",", "\[Nu]H2", ",", 
      "\[Rho]H2", ",", "\[Lambda]H2", ",", "\[Theta]H2", ",", "\[Nu]1", ",", 
      "\[Nu]2", ",", 
      RowBox[{"Lcoefs", "=", 
       RowBox[{"LegendreCoeffs", "[", "40", "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[CapitalSigma]1", "=", "0.01"}], ";", 
     RowBox[{"\[CapitalSigma]2", "=", "0.01"}], ";", 
     RowBox[{"\[Theta]1", "=", 
      RowBox[{"3.", "\[CapitalSigma]1"}]}], ";", 
     RowBox[{"\[Theta]2", "=", 
      RowBox[{"3.", "\[CapitalSigma]2"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"S1", "=", 
      RowBox[{
       RowBox[{"MarketCMSForward", "[", 
        RowBox[{"\[Tau]", ",", "tenor1"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", 
     RowBox[{"S2", "=", 
      RowBox[{
       RowBox[{"MarketCMSForward", "[", 
        RowBox[{"\[Tau]", ",", "tenor2"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"M", "=", 
      RowBox[{"(", GridBox[{
         {"M1", 
          RowBox[{"\[Rho]m1", 
           SqrtBox[
            RowBox[{"M1", " ", "M2"}]]}]},
         {
          RowBox[{"\[Rho]m2", 
           SqrtBox[
            RowBox[{"M1", " ", "M2"}]]}], "M2"}
        }], ")"}]}], ";", 
     RowBox[{"\[CapitalSigma]inf", "=", 
      RowBox[{"(", GridBox[{
         {"\[Theta]1", 
          RowBox[{
           SqrtBox[
            RowBox[{"\[Theta]1", " ", "\[Theta]2"}]], " ", "\[Rho]sinf"}]},
         {
          RowBox[{
           SqrtBox[
            RowBox[{"\[Theta]1", " ", "\[Theta]2"}]], " ", "\[Rho]sinf"}], 
          "\[Theta]2"}
        }], ")"}]}], ";", 
     RowBox[{"\[CapitalSigma]", "=", 
      RowBox[{"(", GridBox[{
         {"\[CapitalSigma]1", 
          RowBox[{
           SqrtBox[
            RowBox[{"\[CapitalSigma]1", " ", "\[CapitalSigma]2"}]], " ", 
           "\[Rho]s"}]},
         {
          RowBox[{
           SqrtBox[
            RowBox[{"\[CapitalSigma]1", " ", "\[CapitalSigma]2"}]], " ", 
           "\[Rho]s"}], "\[CapitalSigma]2"}
        }], ")"}]}], ";", 
     RowBox[{"S", "=", 
      RowBox[{"{", 
       RowBox[{"S1", ",", "S2"}], "}"}]}], ";", 
     RowBox[{"\[Rho]", "=", 
      RowBox[{"{", 
       RowBox[{"\[Rho]1", ",", "\[Rho]2"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Q", "=", 
      RowBox[{"(", GridBox[{
         {"0.25", "0.01"},
         {"0.01", "0.25"}
        }], ")"}]}], ";", 
     RowBox[{"\[Beta]m", "=", 
      RowBox[{"-", 
       RowBox[{
        RowBox[{"(", 
         FractionBox[
          RowBox[{
           RowBox[{"M", ".", "\[CapitalSigma]inf"}], "+", 
           RowBox[{"\[CapitalSigma]inf", ".", 
            RowBox[{"Transpose", "[", "M", "]"}]}]}], "2"], ")"}], ".", 
        RowBox[{"Inverse", "[", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Transpose", "[", "Q", "]"}], ".", "Q"}], ")"}], 
         "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"SmileSymetrizedBiHestonVanillaIntegrand2", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Log", "[", 
          RowBox[{"S", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
         RowBox[{"Log", "[", 
          RowBox[{"S", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], ",", "1", ",", "1",
        ",", "1", ",", "1", ",", 
       RowBox[{"{", "S1", "}"}], ",", "\[Tau]", ",", "\[CapitalSigma]", ",", 
       "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", "\[Beta]m", ",", 
       "1.1", ",", "1.01", ",", "14", ",", "14.398"}], "]"}]}]}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.4060277708820677`*^9, 3.4060277738977504`*^9}, {
   3.4060279027752247`*^9, 3.4060279729328213`*^9}, {3.406028036699671*^9, 
   3.4060280660283594`*^9}, 3.4060281307952275`*^9, {3.406028162920844*^9, 
   3.4060281635146055`*^9}, 3.4060284791925416`*^9, {3.4060288779970737`*^9, 
   3.4060289356388054`*^9}, {3.4060289708113556`*^9, 3.4060290330313005`*^9}, 
   3.406029224613104*^9, {3.4060294514768343`*^9, 3.4060294706178265`*^9}, {
   3.406029625558302*^9, 3.406029653027579*^9}, {3.406030006253111*^9, 
   3.406030006784371*^9}, {3.406030037925594*^9, 3.406030038144348*^9}, {
   3.406030134974332*^9, 3.4060301351618357`*^9}, {3.406372390190527*^9, 
   3.406372441550888*^9}, {3.4063726672583466`*^9, 3.4063727446817083`*^9}, {
   3.406372797776477*^9, 3.4063728287770724`*^9}, {3.406372876793619*^9, 
   3.406372878949911*^9}, {3.4063729219976125`*^9, 3.4063729580451794`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.014999999999975255`", ",", 
   RowBox[{"{", "1.0426134748898463`*^302", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.406372960107719*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"S1", ",", "S2", ",", 
     RowBox[{"M1", "=", 
      RowBox[{"-", "0.35"}]}], ",", 
     RowBox[{"M2", "=", 
      RowBox[{"-", "0.35"}]}], ",", 
     RowBox[{"\[Rho]s", "=", "0.5"}], ",", 
     RowBox[{"\[Rho]sinf", "=", "0.5"}], ",", 
     RowBox[{"\[Rho]m1", "=", "0."}], ",", 
     RowBox[{"\[Rho]m2", "=", "0."}], ",", 
     RowBox[{"\[Rho]1", "=", 
      RowBox[{"-", "0.45"}]}], ",", 
     RowBox[{"\[Rho]2", "=", 
      RowBox[{"-", "0.45"}]}], ",", " ", "\[CapitalSigma]1", ",", 
     "\[CapitalSigma]2", ",", "\[Theta]1", ",", "\[Theta]2", ",", 
     RowBox[{"\[Tau]", "=", "5"}], ",", 
     RowBox[{"\[Alpha]1", "=", "1"}], ",", 
     RowBox[{"a", "=", "1"}], ",", "M", ",", "\[CapitalSigma]inf", ",", 
     "\[CapitalSigma]", ",", "Q", ",", "\[Beta]m", ",", "S", ",", "\[Rho]", 
     ",", 
     RowBox[{"printflag", "=", 
      RowBox[{"{", "1", "}"}]}], ",", 
     RowBox[{"\[Mu]", "=", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}]}], ",", "inter1", ",", "inter2", ",", 
     "inter3", ",", "smileLN", ",", "interLN", ",", "prices", ",", 
     RowBox[{"tenor1", "=", "\"\<cms2\>\""}], ",", 
     RowBox[{"tenor2", "=", "\"\<cms10\>\""}], ",", "K", ",", "\[Beta]", ",", 
     
     RowBox[{"limsup", "=", "1000"}], ",", "\[Rho]H1", ",", "\[Nu]H2", ",", 
     "\[Rho]H2", ",", "\[Lambda]H2", ",", "\[Theta]H2", ",", "\[Nu]1", ",", 
     "\[Nu]2", ",", 
     RowBox[{"Lcoefs", "=", 
      RowBox[{"LegendreCoeffs", "[", "40", "]"}]}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[CapitalSigma]1", "=", "0.01"}], ";", 
    RowBox[{"\[CapitalSigma]2", "=", "0.01"}], ";", 
    RowBox[{"\[Theta]1", "=", 
     RowBox[{"3.", "\[CapitalSigma]1"}]}], ";", 
    RowBox[{"\[Theta]2", "=", 
     RowBox[{"3.", "\[CapitalSigma]2"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"S1", "=", 
     RowBox[{
      RowBox[{"MarketCMSForward", "[", 
       RowBox[{"\[Tau]", ",", "tenor1"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";", 
    RowBox[{"S2", "=", 
     RowBox[{
      RowBox[{"MarketCMSForward", "[", 
       RowBox[{"\[Tau]", ",", "tenor2"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"M", "=", 
     RowBox[{"(", GridBox[{
        {"M1", 
         RowBox[{"\[Rho]m1", 
          SqrtBox[
           RowBox[{"M1", " ", "M2"}]]}]},
        {
         RowBox[{"\[Rho]m2", 
          SqrtBox[
           RowBox[{"M1", " ", "M2"}]]}], "M2"}
       }], ")"}]}], ";", 
    RowBox[{"\[CapitalSigma]inf", "=", 
     RowBox[{"(", GridBox[{
        {"\[Theta]1", 
         RowBox[{
          SqrtBox[
           RowBox[{"\[Theta]1", " ", "\[Theta]2"}]], " ", "\[Rho]sinf"}]},
        {
         RowBox[{
          SqrtBox[
           RowBox[{"\[Theta]1", " ", "\[Theta]2"}]], " ", "\[Rho]sinf"}], 
         "\[Theta]2"}
       }], ")"}]}], ";", 
    RowBox[{"\[CapitalSigma]", "=", 
     RowBox[{"(", GridBox[{
        {"\[CapitalSigma]1", 
         RowBox[{
          SqrtBox[
           RowBox[{"\[CapitalSigma]1", " ", "\[CapitalSigma]2"}]], " ", 
          "\[Rho]s"}]},
        {
         RowBox[{
          SqrtBox[
           RowBox[{"\[CapitalSigma]1", " ", "\[CapitalSigma]2"}]], " ", 
          "\[Rho]s"}], "\[CapitalSigma]2"}
       }], ")"}]}], ";", 
    RowBox[{"S", "=", 
     RowBox[{"{", 
      RowBox[{"S1", ",", "S2"}], "}"}]}], ";", 
    RowBox[{"\[Rho]", "=", 
     RowBox[{"{", 
      RowBox[{"\[Rho]1", ",", "\[Rho]2"}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Q", "=", 
     RowBox[{"(", GridBox[{
        {"0.25", "0.01"},
        {"0.01", "0.25"}
       }], ")"}]}], ";", 
    RowBox[{"\[Beta]m", "=", 
     RowBox[{"-", 
      RowBox[{
       RowBox[{"(", 
        FractionBox[
         RowBox[{
          RowBox[{"M", ".", "\[CapitalSigma]inf"}], "+", 
          RowBox[{"\[CapitalSigma]inf", ".", 
           RowBox[{"Transpose", "[", "M", "]"}]}]}], "2"], ")"}], ".", 
       RowBox[{"Inverse", "[", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Transpose", "[", "Q", "]"}], ".", "Q"}], ")"}], 
        "]"}]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"SmileSymetrizedBiHestonVanillaIntegrand2", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Log", "[", 
         RowBox[{"S", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
        RowBox[{"Log", "[", 
         RowBox[{"S", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], ",", "1", ",", "1", 
      ",", "1", ",", "1", ",", 
      RowBox[{"{", "S1", "}"}], ",", "\[Tau]", ",", "\[CapitalSigma]", ",", 
      "M", ",", "Q", ",", "\[Rho]", ",", "\[Mu]", ",", "\[Beta]m", ",", "1.1",
       ",", "1.01", ",", "14", ",", "14.398"}], "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.4060277708820677`*^9, 3.4060277738977504`*^9}, {
   3.4060279027752247`*^9, 3.4060279729328213`*^9}, {3.406028036699671*^9, 
   3.4060280660283594`*^9}, 3.4060281307952275`*^9, {3.406028162920844*^9, 
   3.4060281635146055`*^9}, 3.4060284791925416`*^9, {3.4060288779970737`*^9, 
   3.4060289356388054`*^9}, {3.4060289708113556`*^9, 3.4060290330313005`*^9}, 
   3.406029224613104*^9, {3.4060294514768343`*^9, 3.4060294706178265`*^9}, {
   3.406029625558302*^9, 3.406029653027579*^9}, {3.406030006253111*^9, 
   3.406030006784371*^9}, {3.406030037925594*^9, 3.406030038144348*^9}, {
   3.406030134974332*^9, 3.4060301351618357`*^9}, {3.406372390190527*^9, 
   3.406372441550888*^9}, {3.4063726672583466`*^9, 3.4063727446817083`*^9}, {
   3.406372797776477*^9, 3.4063728287770724`*^9}, {3.406372876793619*^9, 
   3.406372878949911*^9}, {3.4063729219976125`*^9, 3.4063729580451794`*^9}, {
   3.4063749416926394`*^9, 3.4063749428801622`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"EXPH=\"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"5693.077486318702`", "\[InvisibleSpace]", "-", 
         RowBox[{"6884.288497316625`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"5778.703724208007`", "\[InvisibleSpace]", "-", 
         RowBox[{"7126.47433518449`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "101.95000426030445`"}], "+", 
         RowBox[{"24.650189775626504`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "103.02162116717457`"}], "+", 
         RowBox[{"27.694483817017638`", " ", "\[ImaginaryI]"}]}]},
       {
        RowBox[{"5947.527589188441`", "\[InvisibleSpace]", "-", 
         RowBox[{"7001.752864756818`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"6041.50334931289`", "\[InvisibleSpace]", "-", 
         RowBox[{"7257.193057263933`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "105.0631848508327`"}], "+", 
         RowBox[{"23.85369140280318`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "106.49111210833449`"}], "+", 
         RowBox[{"27.239355135249905`", " ", "\[ImaginaryI]"}]}]},
       {
        RowBox[{
         RowBox[{"-", "620537.5927219228`"}], "+", 
         RowBox[{"75063.24093062698`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "636828.5611165736`"}], "+", 
         RowBox[{"83320.62741775611`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"6355.277681735744`", "\[InvisibleSpace]", "+", 
         RowBox[{"3660.21477565863`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"6570.442105551918`", "\[InvisibleSpace]", "+", 
         RowBox[{"3559.3162715063827`", " ", "\[ImaginaryI]"}]}]},
       {
        RowBox[{
         RowBox[{"-", "636828.5611165735`"}], "+", 
         RowBox[{"83320.62741775607`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "653421.4673786735`"}], "+", 
         RowBox[{"92042.47563442642`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"6566.759164854965`", "\[InvisibleSpace]", "+", 
         RowBox[{"3698.813256805067`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"6785.942950395135`", "\[InvisibleSpace]", "+", 
         RowBox[{"3588.8089880090383`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], "\[InvisibleSpace]", "\<\" \[Delta]=\"\>", 
   "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"-", "37051.72291508876`"}], "-", 
    RowBox[{"61256.344644874334`", " ", "\[ImaginaryI]"}]}], 
   "\[InvisibleSpace]", "\<\" LogA11=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"5.472348151493733`", "\[InvisibleSpace]", "-", 
        RowBox[{"1.069256595876816`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"4.226677950924809`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.13071279652390747`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"4.228046799915772`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.227443832142901`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"5.706366607775766`", "\[InvisibleSpace]", "-", 
        RowBox[{"1.0455276132533289`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
    "}"}]}],
  SequenceForm["EXPH=", 
   MatrixForm[{{
      Complex[5693.077486318702, -6884.288497316625], 
      Complex[5778.703724208007, -7126.47433518449], 
      Complex[-101.95000426030445`, 24.650189775626504`], 
      Complex[-103.02162116717457`, 27.694483817017638`]}, {
      Complex[5947.527589188441, -7001.752864756818], 
      Complex[6041.50334931289, -7257.193057263933], 
      Complex[-105.0631848508327, 23.85369140280318], 
      Complex[-106.49111210833449`, 27.239355135249905`]}, {
      Complex[-620537.5927219228, 75063.24093062698], 
      Complex[-636828.5611165736, 83320.62741775611], 
      Complex[6355.277681735744, 3660.21477565863], 
      Complex[6570.442105551918, 3559.3162715063827`]}, {
      Complex[-636828.5611165735, 83320.62741775607], 
      Complex[-653421.4673786735, 92042.47563442642], 
      Complex[6566.759164854965, 3698.813256805067], 
      Complex[6785.942950395135, 3588.8089880090383`]}}], " \[Delta]=", 
   Complex[-37051.72291508876, -61256.344644874334`], " LogA11=", {{
     Complex[5.472348151493733, -1.069256595876816], 
     Complex[4.226677950924809, 0.13071279652390747`]}, {
     Complex[4.228046799915772, 0.227443832142901], 
     Complex[5.706366607775766, -1.0455276132533289`]}}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.406373139501788*^9, {3.406374908692006*^9, 3.4063749437708044`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{"\<\"EXPH=\"\>", "\[InvisibleSpace]", 
    TagBox[
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {
         RowBox[{"50587.91721943778`", "\[InvisibleSpace]", "+", 
          RowBox[{"31210.774765470793`", " ", "\[ImaginaryI]"}]}], 
         RowBox[{
          RowBox[{"-", "49335.84003044746`"}], "-", 
          RowBox[{"36056.70854573162`", " ", "\[ImaginaryI]"}]}], 
         RowBox[{
          RowBox[{"-", "792.2318180974936`"}], "-", 
          RowBox[{"9.626746071438745`", " ", "\[ImaginaryI]"}]}], 
         RowBox[{"312.59158609390437`", "\[InvisibleSpace]", "+", 
          RowBox[{"739.8225776999244`", " ", "\[ImaginaryI]"}]}]},
        {
         RowBox[{
          RowBox[{"-", "45566.66496717551`"}], "+", 
          RowBox[{"39377.412583657926`", " ", "\[ImaginaryI]"}]}], 
         RowBox[{"49872.29528114289`", "\[InvisibleSpace]", "-", 
          RowBox[{"36694.51812485963`", " ", "\[ImaginaryI]"}]}], 
         RowBox[{"250.5293878888345`", "\[InvisibleSpace]", "-", 
          RowBox[{"762.5614418203563`", " ", "\[ImaginaryI]"}]}], 
         RowBox[{
          RowBox[{"-", "810.2260552728205`"}], "+", 
          RowBox[{"76.78057075420477`", " ", "\[ImaginaryI]"}]}]},
        {
         RowBox[{
          RowBox[{"-", "3.68712472092662`*^6"}], "+", 
          RowBox[{"476522.3085844696`", " ", "\[ImaginaryI]"}]}], 
         RowBox[{"3.81735755068794`*^6", "-", 
          RowBox[{"191887.8081106389`", " ", "\[ImaginaryI]"}]}], 
         RowBox[{"38864.936683392916`", "\[InvisibleSpace]", "-", 
          RowBox[{"30738.936713124247`", " ", "\[ImaginaryI]"}]}], 
         RowBox[{
          RowBox[{"-", "44334.564853168275`"}], "-", 
          RowBox[{"23626.215425065286`", " ", "\[ImaginaryI]"}]}]},
        {
         RowBox[{"3.8173575506879413`*^6", "-", 
          RowBox[{"191887.808110638`", " ", "\[ImaginaryI]"}]}], 
         RowBox[{
          RowBox[{"-", "3.927943332802536`*^6"}], "-", 
          RowBox[{"110316.05780588786`", " ", "\[ImaginaryI]"}]}], 
         RowBox[{
          RowBox[{"-", "42305.45059853889`"}], "+", 
          RowBox[{"28379.76296477773`", " ", "\[ImaginaryI]"}]}], 
         RowBox[{"43539.966870965756`", "\[InvisibleSpace]", "+", 
          RowBox[{"27780.48272639377`", " ", "\[ImaginaryI]"}]}]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]], "\[InvisibleSpace]", "\<\" \[Delta]=\"\>", 
    "\[InvisibleSpace]", "310303.1927495003`"}], "\[InvisibleSpace]", "-", 
   RowBox[{
    RowBox[{"12500.332925915718`", " ", "\[ImaginaryI]"}], 
    "\[InvisibleSpace]", "\<\" LogA11=\"\>", "\[InvisibleSpace]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"6.191991791662448`", "\[InvisibleSpace]", "+", 
         RowBox[{"3.484823277063987`", " ", "\[ImaginaryI]"}]}], ",", 
        RowBox[{
         RowBox[{"-", "4.912004886163706`"}], "-", 
         RowBox[{"3.9643729055650025`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "4.896325798045312`"}], "+", 
         RowBox[{"3.8374573768442795`", " ", "\[ImaginaryI]"}]}], ",", 
        RowBox[{"6.454124100877853`", "\[InvisibleSpace]", "-", 
         RowBox[{"3.525085761818299`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
     "}"}]}]}],
  SequenceForm["EXPH=", 
   MatrixForm[{{
      Complex[50587.91721943778, 31210.774765470793`], 
      Complex[-49335.84003044746, -36056.70854573162], 
      Complex[-792.2318180974936, -9.626746071438745], 
      Complex[312.59158609390437`, 739.8225776999244]}, {
      Complex[-45566.66496717551, 39377.412583657926`], 
      Complex[49872.29528114289, -36694.51812485963], 
      Complex[250.5293878888345, -762.5614418203563], 
      Complex[-810.2260552728205, 76.78057075420477]}, {
      Complex[-3.68712472092662*^6, 476522.3085844696], 
      Complex[3.81735755068794*^6, -191887.8081106389], 
      Complex[38864.936683392916`, -30738.936713124247`], 
      Complex[-44334.564853168275`, -23626.215425065286`]}, {
      Complex[3.8173575506879413`*^6, -191887.808110638], 
      Complex[-3.927943332802536*^6, -110316.05780588786`], 
      Complex[-42305.45059853889, 28379.76296477773], 
      Complex[43539.966870965756`, 27780.48272639377]}}], " \[Delta]=", 
   Complex[310303.1927495003, -12500.332925915718`], " LogA11=", {{
     Complex[6.191991791662448, 3.484823277063987], 
     Complex[-4.912004886163706, -3.9643729055650025`]}, {
     Complex[-4.896325798045312, 3.8374573768442795`], 
     Complex[6.454124100877853, -3.525085761818299]}}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.406373139501788*^9, {3.406374908692006*^9, 3.4063749437708044`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"EXPH=\"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"889.1926351484886`", "\[InvisibleSpace]", "-", 
         RowBox[{"8151.771491020317`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "354.28550281703656`"}], "-", 
         RowBox[{"8356.537643426167`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "72.65048856928158`"}], "+", 
         RowBox[{"70.21746505721956`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "56.62700721193342`"}], "+", 
         RowBox[{"74.24567255543639`", " ", "\[ImaginaryI]"}]}]},
       {
        RowBox[{"63.31760986409779`", "\[InvisibleSpace]", "-", 
         RowBox[{"9331.692734155191`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "1366.9666987338512`"}], "-", 
         RowBox[{"9427.437050205837`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "74.03633308012061`"}], "+", 
         RowBox[{"87.77452241744251`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "55.685709247237874`"}], "+", 
         RowBox[{"90.7777235099301`", " ", "\[ImaginaryI]"}]}]},
       {
        RowBox[{
         RowBox[{"-", "433636.19778440456`"}], "+", 
         RowBox[{"423469.5323391453`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "372529.3966625909`"}], "+", 
         RowBox[{"493720.55881696695`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"7438.844736763103`", "\[InvisibleSpace]", "-", 
         RowBox[{"594.1651583775432`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"6727.83503255726`", "\[InvisibleSpace]", "-", 
         RowBox[{"1577.2031517996156`", " ", "\[ImaginaryI]"}]}]},
       {
        RowBox[{
         RowBox[{"-", "372529.3966625909`"}], "+", 
         RowBox[{"493720.558816967`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "300033.44812799286`"}], "+", 
         RowBox[{"555277.12311267`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"7414.277476611118`", "\[InvisibleSpace]", "-", 
         RowBox[{"1738.9097958681414`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"6544.742847135251`", "\[InvisibleSpace]", "-", 
         RowBox[{"2625.3826280046324`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], "\[InvisibleSpace]", "\<\" \[Delta]=\"\>", 
   "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"-", "62735.179161816835`"}], "-", 
    RowBox[{"16574.891589410137`", " ", "\[ImaginaryI]"}]}], 
   "\[InvisibleSpace]", "\<\" LogA11=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"5.237952847189781`", "\[InvisibleSpace]", "-", 
        RowBox[{"0.8948693307496727`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"4.026840196507116`", "\[InvisibleSpace]", "-", 
        RowBox[{"0.2095259447133462`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",",
      
     RowBox[{"{", 
      RowBox[{
       RowBox[{"4.498874249701225`", "\[InvisibleSpace]", "-", 
        RowBox[{"0.012729663674607676`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"5.842462430015967`", "\[InvisibleSpace]", "-", 
        RowBox[{"1.9884214135920553`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
    "}"}]}],
  SequenceForm["EXPH=", 
   MatrixForm[{{
      Complex[889.1926351484886, -8151.771491020317], 
      Complex[-354.28550281703656`, -8356.537643426167], 
      Complex[-72.65048856928158, 70.21746505721956], 
      Complex[-56.62700721193342, 74.24567255543639]}, {
      Complex[63.31760986409779, -9331.692734155191], 
      Complex[-1366.9666987338512`, -9427.437050205837], 
      Complex[-74.03633308012061, 87.77452241744251], 
      Complex[-55.685709247237874`, 90.7777235099301]}, {
      Complex[-433636.19778440456`, 423469.5323391453], 
      Complex[-372529.3966625909, 493720.55881696695`], 
      Complex[7438.844736763103, -594.1651583775432], 
      Complex[6727.83503255726, -1577.2031517996156`]}, {
      Complex[-372529.3966625909, 493720.558816967], 
      Complex[-300033.44812799286`, 555277.12311267], 
      Complex[7414.277476611118, -1738.9097958681414`], 
      Complex[6544.742847135251, -2625.3826280046324`]}}], " \[Delta]=", 
   Complex[-62735.179161816835`, -16574.891589410137`], " LogA11=", {{
     Complex[5.237952847189781, -0.8948693307496727], 
     Complex[4.026840196507116, -0.2095259447133462]}, {
     Complex[4.498874249701225, -0.012729663674607676`], 
     Complex[5.842462430015967, -1.9884214135920553`]}}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.406373139501788*^9, {3.406374908692006*^9, 3.40637494378643*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{"\<\"EXPH=\"\>", "\[InvisibleSpace]", 
    TagBox[
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {
         RowBox[{"56094.036990015906`", "\[InvisibleSpace]", "-", 
          RowBox[{"11391.641141663094`", " ", "\[ImaginaryI]"}]}], 
         RowBox[{
          RowBox[{"-", "57123.60366543068`"}], "+", 
          RowBox[{"15334.787587241372`", " ", "\[ImaginaryI]"}]}], 
         RowBox[{
          RowBox[{"-", "564.5549015236883`"}], "+", 
          RowBox[{"487.85939900718114`", " ", "\[ImaginaryI]"}]}], 
         RowBox[{"710.9085352753109`", "\[InvisibleSpace]", "+", 
          RowBox[{"280.09451106315663`", " ", "\[ImaginaryI]"}]}]},
        {
         RowBox[{
          RowBox[{"-", "2545.080502761738`"}], "+", 
          RowBox[{"58382.51299311246`", " ", "\[ImaginaryI]"}]}], 
         RowBox[{
          RowBox[{"-", "1103.6170044186965`"}], "-", 
          RowBox[{"60378.17348166948`", " ", "\[ImaginaryI]"}]}], 
         RowBox[{
          RowBox[{"-", "344.1895528274359`"}], "-", 
          RowBox[{"679.5584916802155`", " ", "\[ImaginaryI]"}]}], 
         RowBox[{
          RowBox[{"-", "452.910413689579`"}], "+", 
          RowBox[{"635.3007975414724`", " ", "\[ImaginaryI]"}]}]},
        {
         RowBox[{
          RowBox[{"-", "2.1115012885620934`*^6"}], "+", 
          RowBox[{"2.78315423325779`*^6", " ", "\[ImaginaryI]"}]}], 
         RowBox[{"1.999888837933677`*^6", "-", 
          RowBox[{"3.0055073429922997`*^6", " ", "\[ImaginaryI]"}]}], 
         RowBox[{"6205.412165600831`", "\[InvisibleSpace]", "-", 
          RowBox[{"45112.34086701475`", " ", "\[ImaginaryI]"}]}], 
         RowBox[{
          RowBox[{"-", "43874.66131953381`"}], "+", 
          RowBox[{"15822.011127242855`", " ", "\[ImaginaryI]"}]}]},
        {
         RowBox[{"1.9998888379336766`*^6", "-", 
          RowBox[{"3.0055073429922983`*^6", " ", "\[ImaginaryI]"}]}], 
         RowBox[{
          RowBox[{"-", "1.8705618586394943`*^6"}], "+", 
          RowBox[{"3.2277058580129617`*^6", " ", "\[ImaginaryI]"}]}], 
         RowBox[{
          RowBox[{"-", "3516.1960626191194`"}], "+", 
          RowBox[{"46925.360232864725`", " ", "\[ImaginaryI]"}]}], 
         RowBox[{"44241.150433070594`", "\[InvisibleSpace]", "-", 
          RowBox[{"19123.28971239743`", " ", "\[ImaginaryI]"}]}]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]], "\[InvisibleSpace]", "\<\" \[Delta]=\"\>", 
    "\[InvisibleSpace]", "186447.46143186092`"}], "\[InvisibleSpace]", "-", 
   RowBox[{
    RowBox[{"235685.68549585342`", " ", "\[ImaginaryI]"}], 
    "\[InvisibleSpace]", "\<\" LogA11=\"\>", "\[InvisibleSpace]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"6.462827979485572`", "\[InvisibleSpace]", "+", 
         RowBox[{"3.8167161784280803`", " ", "\[ImaginaryI]"}]}], ",", 
        RowBox[{
         RowBox[{"-", "5.669892352875208`"}], "-", 
         RowBox[{"3.5842036917529523`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "5.063651132416357`"}], "+", 
         RowBox[{"4.27582377201794`", " ", "\[ImaginaryI]"}]}], ",", 
        RowBox[{"6.150431241865725`", "\[InvisibleSpace]", "-", 
         RowBox[{"4.718231094590896`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
     "}"}]}]}],
  SequenceForm["EXPH=", 
   MatrixForm[{{
      Complex[56094.036990015906`, -11391.641141663094`], 
      Complex[-57123.60366543068, 15334.787587241372`], 
      Complex[-564.5549015236883, 487.85939900718114`], 
      Complex[710.9085352753109, 280.09451106315663`]}, {
      Complex[-2545.080502761738, 58382.51299311246], 
      Complex[-1103.6170044186965`, -60378.17348166948], 
      Complex[-344.1895528274359, -679.5584916802155], 
      Complex[-452.910413689579, 635.3007975414724]}, {
      Complex[-2.1115012885620934`*^6, 2.78315423325779*^6], 
      Complex[1.999888837933677*^6, -3.0055073429922997`*^6], 
      Complex[6205.412165600831, -45112.34086701475], 
      Complex[-43874.66131953381, 15822.011127242855`]}, {
      Complex[1.9998888379336766`*^6, -3.0055073429922983`*^6], 
      Complex[-1.8705618586394943`*^6, 3.2277058580129617`*^6], 
      Complex[-3516.1960626191194`, 46925.360232864725`], 
      Complex[44241.150433070594`, -19123.28971239743]}}], " \[Delta]=", 
   Complex[186447.46143186092`, -235685.68549585342`], " LogA11=", {{
     Complex[6.462827979485572, 3.8167161784280803`], 
     Complex[-5.669892352875208, -3.5842036917529523`]}, {
     Complex[-5.063651132416357, 4.27582377201794], 
     Complex[6.150431241865725, -4.718231094590896]}}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.406373139501788*^9, {3.406374908692006*^9, 3.40637494378643*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"propagatorDroit=\"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"-", "0.004715427155165214`"}], "+", 
    RowBox[{"0.011100738232024654`", " ", "\[ImaginaryI]"}]}], 
   "\[InvisibleSpace]", "\<\" SympropagatorDroit=\"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"-", "1.36445907604612`*^307"}], "+", 
    RowBox[{"4.900555513224498`*^307", " ", "\[ImaginaryI]"}]}], 
   "\[InvisibleSpace]", "\<\" propagatorGauche=\"\>", "\[InvisibleSpace]", 
   RowBox[{"2.5551386544444448`*^-8", "-", 
    RowBox[{"1.569565197564779`*^-8", " ", "\[ImaginaryI]"}]}], 
   "\[InvisibleSpace]", "\<\" SympropagatorGauche=\"\>", "\[InvisibleSpace]", 
   
   RowBox[{
    RowBox[{"-", "7.060078274337567`*^-225"}], "+", 
    RowBox[{"2.436171607955673`*^-226", " ", "\[ImaginaryI]"}]}]}],
  SequenceForm["propagatorDroit=", 
   Complex[-0.004715427155165214, 0.011100738232024654`], 
   " SympropagatorDroit=", 
   Complex[-1.36445907604612*^307, 4.900555513224498*^307], 
   " propagatorGauche=", 
   Complex[2.5551386544444448`*^-8, -1.569565197564779*^-8], 
   " SympropagatorGauche=", 
   Complex[-7.060078274337567*^-225, 2.436171607955673*^-226]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.406373139501788*^9, {3.406374908692006*^9, 3.40637494378643*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", "1.0426134748898463`*^302", "}"}]], "Output",
 CellChangeTimes->{
  3.4063731395642896`*^9, {3.406374908801383*^9, 3.4063749438020554`*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"BiHestonLaplaceQuickTransform2", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"M11_", ",", "M12_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"M21_", ",", "M22_"}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Q11_", ",", "Q12_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Q21_", ",", "Q22_"}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Rho]1_", ",", "\[Rho]2_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Mu]1_", ",", "\[Mu]2_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[CapitalSigma]11_", ",", "\[CapitalSigma]12_"}], "}"}], ",", 
      
      RowBox[{"{", 
       RowBox[{"\[CapitalSigma]21_", ",", "\[CapitalSigma]22_"}], "}"}]}], 
     "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Gamma]1_", ",", "\[Gamma]2_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Beta]11_", ",", "\[Beta]12_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Beta]21_", ",", "\[Beta]22_"}], "}"}]}], "}"}], ",", 
    "\[Tau]_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"EXPH", "=", 
       RowBox[{"MatrixExp", "[", 
        RowBox[{"\[Tau]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              FractionBox["1", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "M11"}], "-", 
                RowBox[{"Q11", " ", "\[Gamma]1", " ", "\[Rho]1"}], "-", 
                RowBox[{"Q21", " ", "\[Gamma]1", " ", "\[Rho]2"}]}], ")"}]}], 
             ",", 
             RowBox[{
              FractionBox["1", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "M12"}], "-", 
                RowBox[{"Q11", " ", "\[Gamma]2", " ", "\[Rho]1"}], "-", 
                RowBox[{"Q21", " ", "\[Gamma]2", " ", "\[Rho]2"}]}], ")"}]}], 
             ",", 
             RowBox[{
              FractionBox["1", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", 
                 SuperscriptBox["Q11", "2"]}], "-", 
                SuperscriptBox["Q21", "2"]}], ")"}]}], ",", 
             RowBox[{
              FractionBox["1", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "Q11"}], " ", "Q12"}], "-", 
                RowBox[{"Q21", " ", "Q22"}]}], ")"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              FractionBox["1", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "M21"}], "-", 
                RowBox[{"Q12", " ", "\[Gamma]1", " ", "\[Rho]1"}], "-", 
                RowBox[{"Q22", " ", "\[Gamma]1", " ", "\[Rho]2"}]}], ")"}]}], 
             ",", 
             RowBox[{
              FractionBox["1", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "M22"}], "-", 
                RowBox[{"Q12", " ", "\[Gamma]2", " ", "\[Rho]1"}], "-", 
                RowBox[{"Q22", " ", "\[Gamma]2", " ", "\[Rho]2"}]}], ")"}]}], 
             ",", 
             RowBox[{
              FractionBox["1", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "Q11"}], " ", "Q12"}], "-", 
                RowBox[{"Q21", " ", "Q22"}]}], ")"}]}], ",", 
             RowBox[{
              FractionBox["1", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", 
                 SuperscriptBox["Q12", "2"]}], "-", 
                SuperscriptBox["Q22", "2"]}], ")"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               FractionBox["\[Gamma]1", "2"]}], "+", 
              FractionBox[
               SuperscriptBox["\[Gamma]1", "2"], "2"], "+", 
              RowBox[{"\[Gamma]1", " ", "\[Mu]1"}]}], ",", 
             FractionBox[
              RowBox[{"\[Gamma]1", " ", "\[Gamma]2"}], "2"], ",", 
             RowBox[{
              FractionBox["1", "2"], " ", 
              RowBox[{"(", 
               RowBox[{"M11", "+", 
                RowBox[{"Q11", " ", "\[Gamma]1", " ", "\[Rho]1"}], "+", 
                RowBox[{"Q21", " ", "\[Gamma]1", " ", "\[Rho]2"}]}], ")"}]}], 
             ",", 
             RowBox[{
              FractionBox["1", "2"], " ", 
              RowBox[{"(", 
               RowBox[{"M21", "+", 
                RowBox[{"Q12", " ", "\[Gamma]1", " ", "\[Rho]1"}], "+", 
                RowBox[{"Q22", " ", "\[Gamma]1", " ", "\[Rho]2"}]}], 
               ")"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             FractionBox[
              RowBox[{"\[Gamma]1", " ", "\[Gamma]2"}], "2"], ",", 
             RowBox[{
              RowBox[{"-", 
               FractionBox["\[Gamma]2", "2"]}], "+", 
              FractionBox[
               SuperscriptBox["\[Gamma]2", "2"], "2"], "+", 
              RowBox[{"\[Gamma]2", " ", "\[Mu]2"}]}], ",", 
             RowBox[{
              FractionBox["1", "2"], " ", 
              RowBox[{"(", 
               RowBox[{"M12", "+", 
                RowBox[{"Q11", " ", "\[Gamma]2", " ", "\[Rho]1"}], "+", 
                RowBox[{"Q21", " ", "\[Gamma]2", " ", "\[Rho]2"}]}], ")"}]}], 
             ",", 
             RowBox[{
              FractionBox["1", "2"], " ", 
              RowBox[{"(", 
               RowBox[{"M22", "+", 
                RowBox[{"Q12", " ", "\[Gamma]2", " ", "\[Rho]1"}], "+", 
                RowBox[{"Q22", " ", "\[Gamma]2", " ", "\[Rho]2"}]}], 
               ")"}]}]}], "}"}]}], "}"}]}], "]"}]}], ",", "\[Delta]", ",", 
      "LogA11"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Delta]", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"EXPH", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}]}], " ", 
        RowBox[{"EXPH", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"EXPH", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
        RowBox[{"EXPH", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"LogA11", "=", 
      RowBox[{"MatrixLog2", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{"EXPH", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "}"}]}], "}"}], "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<EXPH=\>\"", ",", 
       RowBox[{"EXPH", " ", "//", " ", "MatrixForm"}], ",", 
       "\"\< \[Delta]=\>\"", ",", "\[Delta]", ",", "\"\< LogA11=\>\"", ",", 
       "LogA11"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"A", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"EXPH", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", 
             RowBox[{"EXPH", "[", 
              RowBox[{"[", 
               RowBox[{"3", ",", "1"}], "]"}], "]"}]}], " ", "-", 
            RowBox[{
             RowBox[{"EXPH", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", 
             RowBox[{"EXPH", "[", 
              RowBox[{"[", 
               RowBox[{"4", ",", "1"}], "]"}], "]"}]}]}], " ", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"+", 
              RowBox[{"EXPH", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "2"}], "]"}], "]"}]}], " ", 
             RowBox[{"EXPH", "[", 
              RowBox[{"[", 
               RowBox[{"3", ",", "2"}], "]"}], "]"}]}], "-", 
            RowBox[{
             RowBox[{"EXPH", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", 
             RowBox[{"EXPH", "[", 
              RowBox[{"[", 
               RowBox[{"4", ",", "2"}], "]"}], "]"}]}]}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"+", 
              RowBox[{"EXPH", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}]}], " ", 
             RowBox[{"EXPH", "[", 
              RowBox[{"[", 
               RowBox[{"4", ",", "1"}], "]"}], "]"}]}], "-", 
            RowBox[{
             RowBox[{"EXPH", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", 
             RowBox[{"EXPH", "[", 
              RowBox[{"[", 
               RowBox[{"3", ",", "1"}], "]"}], "]"}]}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"+", 
              RowBox[{"EXPH", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}]}], " ", 
             RowBox[{"EXPH", "[", 
              RowBox[{"[", 
               RowBox[{"4", ",", "2"}], "]"}], "]"}]}], "-", 
            RowBox[{
             RowBox[{"EXPH", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", 
             RowBox[{"EXPH", "[", 
              RowBox[{"[", 
               RowBox[{"3", ",", "2"}], "]"}], "]"}]}]}]}], " ", "}"}]}], 
        "}"}], "/", "\[Delta]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<A=\>\"", ",", "A"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{
        FractionBox["1", "\[Delta]"], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"EXPH", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", 
              RowBox[{"EXPH", "[", 
               RowBox[{"[", 
                RowBox[{"3", ",", "1"}], "]"}], "]"}]}], " ", "-", 
             RowBox[{
              RowBox[{"EXPH", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", 
              RowBox[{"EXPH", "[", 
               RowBox[{"[", 
                RowBox[{"4", ",", "1"}], "]"}], "]"}]}]}], " ", ")"}], 
           "\[CapitalSigma]11"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"EXPH", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", 
              RowBox[{"EXPH", "[", 
               RowBox[{"[", 
                RowBox[{"3", ",", "2"}], "]"}], "]"}]}], "-", 
             RowBox[{
              RowBox[{"EXPH", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", 
              RowBox[{"EXPH", "[", 
               RowBox[{"[", 
                RowBox[{"4", ",", "2"}], "]"}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"EXPH", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
              RowBox[{"EXPH", "[", 
               RowBox[{"[", 
                RowBox[{"4", ",", "1"}], "]"}], "]"}]}], "-", 
             RowBox[{
              RowBox[{"EXPH", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", 
              RowBox[{"EXPH", "[", 
               RowBox[{"[", 
                RowBox[{"3", ",", "1"}], "]"}], "]"}]}]}], ")"}], " ", 
           "\[CapitalSigma]12"}], "+", "\[IndentingNewLine]", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"EXPH", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
              RowBox[{"EXPH", "[", 
               RowBox[{"[", 
                RowBox[{"4", ",", "2"}], "]"}], "]"}]}], "-", 
             RowBox[{
              RowBox[{"EXPH", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", 
              RowBox[{"EXPH", "[", 
               RowBox[{"[", 
                RowBox[{"3", ",", "2"}], "]"}], "]"}]}]}], ")"}], " ", 
           "\[CapitalSigma]22"}]}], ")"}]}], "-", 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Beta]11", " ", 
           RowBox[{"LogA11", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "+", 
          RowBox[{"\[Beta]12", " ", 
           RowBox[{"LogA11", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "+", 
          RowBox[{"\[Beta]21", " ", 
           RowBox[{"LogA11", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "+", 
          RowBox[{"\[Beta]22", " ", 
           RowBox[{"LogA11", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[Beta]11", " ", 
              RowBox[{"(", 
               RowBox[{"M11", "+", 
                RowBox[{"Q11", " ", "\[Gamma]1", " ", "\[Rho]1"}], "+", 
                RowBox[{"Q21", " ", "\[Gamma]1", " ", "\[Rho]2"}]}], ")"}]}], 
             "+", 
             RowBox[{"\[Beta]21", " ", 
              RowBox[{"(", 
               RowBox[{"M21", "+", 
                RowBox[{"Q12", " ", "\[Gamma]1", " ", "\[Rho]1"}], "+", 
                RowBox[{"Q22", " ", "\[Gamma]1", " ", "\[Rho]2"}]}], ")"}]}], 
             "+", 
             RowBox[{"\[Beta]12", " ", 
              RowBox[{"(", 
               RowBox[{"M12", "+", 
                RowBox[{"Q11", " ", "\[Gamma]2", " ", "\[Rho]1"}], "+", 
                RowBox[{"Q21", " ", "\[Gamma]2", " ", "\[Rho]2"}]}], ")"}]}], 
             "+", 
             RowBox[{"\[Beta]22", " ", 
              RowBox[{"(", 
               RowBox[{"M22", "+", 
                RowBox[{"Q12", " ", "\[Gamma]2", " ", "\[Rho]1"}], "+", 
                RowBox[{"Q22", " ", "\[Gamma]2", " ", "\[Rho]2"}]}], 
               ")"}]}]}], ")"}], " ", "\[Tau]"}]}], ")"}]}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.398689746086896*^9, 3.39868976571579*^9}, {
   3.398690925586488*^9, 3.3986910907286205`*^9}, {3.398691590593399*^9, 
   3.3986916004234734`*^9}, {3.398692032962397*^9, 3.39869209364631*^9}, {
   3.3986925101195464`*^9, 3.398692518433696*^9}, {3.3986951810712333`*^9, 
   3.398695325084175*^9}, {3.3986953610600605`*^9, 3.3986954393099575`*^9}, {
   3.3986965831453133`*^9, 3.3986966039671736`*^9}, {3.398696639308217*^9, 
   3.3986966879654016`*^9}, {3.3986967213097916`*^9, 
   3.3986967248567348`*^9}, {3.398696770904494*^9, 3.398696889344268*^9}, {
   3.3986970007620354`*^9, 3.3986970489713306`*^9}, {3.3986974823842573`*^9, 
   3.398697532752773*^9}, {3.3987529399727573`*^9, 3.39875299455193*^9}, {
   3.398753037990264*^9, 3.398753063678257*^9}, {3.3987531523205843`*^9, 
   3.3987532912763767`*^9}, {3.3987533420586023`*^9, 
   3.3987534255914555`*^9}, {3.3987534717642174`*^9, 
   3.3987535094368153`*^9}, {3.3987770283161182`*^9, 3.398777119911627*^9}, {
   3.398777173522031*^9, 3.398777249148483*^9}, {3.3990283070466003`*^9, 
   3.399028307655995*^9}, {3.399028744357469*^9, 3.399028747638824*^9}, {
   3.3993525960192556`*^9, 3.39935261708216*^9}, {3.3993530399027777`*^9, 
   3.399353055590579*^9}, 3.3993531000289326`*^9, {3.39935333325216*^9, 
   3.3993533979565277`*^9}, 3.3993534714110627`*^9, {3.399353504239818*^9, 
   3.399353526130863*^9}, 3.399353619663909*^9, {3.3993538043237047`*^9, 
   3.399353861434176*^9}, {3.3993540798758698`*^9, 3.399354117782848*^9}, {
   3.3993543213648815`*^9, 3.399354332724475*^9}, {3.3993544810085716`*^9, 
   3.399354488368088*^9}, 3.39935480565543*^9, 3.3993552721487613`*^9, {
   3.3993666542422934`*^9, 3.3993667471347017`*^9}, {3.39936684574597*^9, 
   3.399366860105621*^9}, {3.3993675282121983`*^9, 3.3993675314310102`*^9}, 
   3.399609417953703*^9, {3.3996423849276905`*^9, 3.399642397068549*^9}, {
   3.3996424279285164`*^9, 3.3996424822108088`*^9}, {3.399703313058091*^9, 
   3.3997033979815965`*^9}, {3.3997034597952833`*^9, 3.399703478998777*^9}, {
   3.3997101596895437`*^9, 3.399710194955846*^9}, {3.399710680543294*^9, 
   3.399710729044225*^9}, 3.3997107627323723`*^9, {3.3997108923442354`*^9, 
   3.3997108934692574`*^9}, {3.3997181401396403`*^9, 3.399718148483551*^9}, {
   3.3997182570481353`*^9, 3.399718312096067*^9}, {3.399718413160507*^9, 
   3.39971842398884*^9}, {3.3997185011465716`*^9, 3.3997185329909334`*^9}, {
   3.3997185745698566`*^9, 3.399718598664069*^9}, {3.39972065528168*^9, 
   3.39972071751725*^9}, {3.3997232187840233`*^9, 3.399723233643684*^9}, {
   3.3997234000531287`*^9, 3.3997234005687637`*^9}, {3.400407907714303*^9, 
   3.400407915261323*^9}, {3.4004155917680845`*^9, 3.400415629628186*^9}, {
   3.4005721179416647`*^9, 3.4005721419890013`*^9}, {3.4005721760052795`*^9, 
   3.4005721845835695`*^9}, {3.4005722273656406`*^9, 
   3.4005722379752197`*^9}, {3.400572305273387*^9, 3.400572337055247*^9}, {
   3.400816614783207*^9, 3.4008166155332212`*^9}, 3.402032114347872*^9, {
   3.402205513305629*^9, 3.402205553790781*^9}, {3.4022056337298155`*^9, 
   3.402205666777325*^9}, {3.402206142427082*^9, 3.4022061429427176`*^9}, 
   3.4022063420090394`*^9, {3.4022063922287536`*^9, 3.4022064283700724`*^9}, {
   3.4022066940001726`*^9, 3.40220669985966*^9}, {3.402206778392418*^9, 
   3.402206820533852*^9}, {3.4022072688549595`*^9, 3.402207376513276*^9}, {
   3.402207470921339*^9, 3.402207504265729*^9}, {3.4022075400945425`*^9, 
   3.4022077664113874`*^9}, {3.402208049729327*^9, 3.4022080663702717`*^9}, {
   3.402208128355837*^9, 3.402208177075522*^9}, {3.4022082700304317`*^9, 
   3.4022083228439455`*^9}, 3.402208385767029*^9, 3.4022084313304033`*^9, 
   3.4022084987535734`*^9, {3.4022085325667224`*^9, 3.402208610474468*^9}, {
   3.402208698179277*^9, 3.402208738242546*^9}, 3.4022087894622793`*^9, {
   3.4022088244473267`*^9, 3.4022088560729337`*^9}, {3.402208910808359*^9, 
   3.4022089956537385`*^9}, {3.4022091015151463`*^9, 
   3.4022091356720514`*^9}, {3.4022092062046556`*^9, 
   3.4022092880812283`*^9}, {3.4022093816924*^9, 3.4022094398497667`*^9}, {
   3.402212688302761*^9, 3.402212777616976*^9}, 3.402212812648898*^9, {
   3.402212853321554*^9, 3.402212883728388*^9}, {3.4022129482452517`*^9, 
   3.4022129494483995`*^9}, {3.402212981558391*^9, 3.4022129823396564`*^9}, {
   3.40221301534029*^9, 3.4022130161059294`*^9}, 3.4022130658881354`*^9, {
   3.4022133357214413`*^9, 3.4022133506904783`*^9}, {3.402213446504818*^9, 
   3.402213611226731*^9}, {3.402213647289923*^9, 3.402213649961849*^9}, 
   3.4022137912145615`*^9, {3.402213823012047*^9, 3.402213851200088*^9}, 
   3.4022139212326827`*^9, 3.402213972827423*^9, {3.402214042563137*^9, 
   3.4022140431412735`*^9}, {3.402214094486009*^9, 3.402214106033106*^9}, {
   3.4022141823158207`*^9, 3.4022141834720926`*^9}, {3.4022142135507956`*^9, 
   3.402214247520197*^9}, {3.4022143135839653`*^9, 3.40221432161537*^9}, {
   3.4022144793683987`*^9, 3.4022144914311304`*^9}, {3.40221462032423*^9, 
   3.4022146326525917`*^9}, {3.4022147606550493`*^9, 
   3.4022147826867228`*^9}, {3.402215189960167*^9, 3.4022152009447527`*^9}, {
   3.4022152632896996`*^9, 3.4022152646178503`*^9}, 3.4022153593227935`*^9, 
   3.4022154124956894`*^9, 3.4022154543558683`*^9, 3.402215741923889*^9, {
   3.402217172654484*^9, 3.402217224858611*^9}, {3.4022173617987404`*^9, 
   3.4022173701426506`*^9}, {3.4041931588011937`*^9, 
   3.4041931894736576`*^9}, {3.404214076921564*^9, 3.4042140775153255`*^9}, 
   3.404214168142065*^9, {3.404214241862231*^9, 3.404214317269929*^9}, {
   3.404214351676839*^9, 3.4042144035840855`*^9}, {3.4042148344204826`*^9, 
   3.404214844608178*^9}, {3.4042157010621223`*^9, 3.404215733297116*^9}, {
   3.404215928207108*^9, 3.4042160022554045`*^9}, 3.4042167475509644`*^9, {
   3.4042183886762233`*^9, 3.4042183946294622`*^9}, 3.404825703809991*^9, 
   3.4048280570409765`*^9, {3.406373734497587*^9, 3.4063737586543007`*^9}, {
   3.406373790686166*^9, 3.4063738165616627`*^9}, {3.4063748687381144`*^9, 
   3.406374875613246*^9}, {3.4063762906716647`*^9, 3.406376316469035*^9}, {
   3.4063763472665014`*^9, 3.4063764866910534`*^9}, 3.406376947059267*^9, {
   3.4063770492799797`*^9, 3.4063770561863623`*^9}, {3.4063771014216056`*^9, 
   3.406377145594329*^9}, {3.4063771983297167`*^9, 3.4063772068298798`*^9}, 
   3.4063772831125937`*^9, {3.4063773262852983`*^9, 3.40637734931699*^9}, {
   3.4063773903177776`*^9, 3.406377395239747*^9}, {3.406377433271727*^9, 
   3.406377439365594*^9}, {3.4063774839289494`*^9, 3.406377520820283*^9}, {
   3.4063775845871325`*^9, 3.406377603837502*^9}, {3.406377728543021*^9, 
   3.4063778169978447`*^9}}]
}, Open  ]]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowToolbars->"EditBar",
WindowSize->{1102, 949},
WindowMargins->{{Automatic, 0}, {Automatic, 0}},
FrontEndVersion->"6.0 for Microsoft Windows (32-bit) (June 19, 2007)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[568, 21, 247, 5, 31, "Input",
 InitializationCell->True],
Cell[818, 28, 257, 5, 31, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[1100, 37, 145, 2, 71, "Section"],
Cell[1248, 41, 5264, 143, 272, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[6537, 188, 730, 17, 88, "Input",
 InitializationCell->True],
Cell[7270, 207, 530, 7, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7837, 219, 171, 3, 31, "Input"],
Cell[8011, 224, 458, 8, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8506, 237, 465, 7, 31, "Input"],
Cell[8974, 246, 310, 7, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9321, 258, 155, 3, 31, "Input"],
Cell[9479, 263, 391, 8, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9907, 276, 163, 3, 31, "Input"],
Cell[10073, 281, 435, 9, 30, "Output"]
}, Open  ]],
Cell[10523, 293, 5238, 124, 442, "Input",
 InitializationCell->True],
Cell[15764, 419, 5541, 131, 282, "Input",
 InitializationCell->True],
Cell[21308, 552, 2463, 66, 222, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[23808, 623, 150, 2, 49, "Subtitle"],
Cell[CellGroupData[{
Cell[23983, 629, 13322, 304, 588, "Input"],
Cell[CellGroupData[{
Cell[37330, 937, 757, 13, 23, "Print"],
Cell[38090, 952, 6655, 173, 36, "Print"],
Cell[44748, 1127, 1087, 21, 26, "Print"],
Cell[45838, 1150, 1000, 18, 23, "Print"],
Cell[46841, 1170, 2962, 51, 62, "Print"],
Cell[49806, 1223, 800, 16, 23, "Print"]
}, Open  ]],
Cell[50621, 1242, 18049, 314, 113, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[68707, 1561, 13428, 306, 588, "Input"],
Cell[CellGroupData[{
Cell[82160, 1871, 401, 8, 23, "Print"],
Cell[82564, 1881, 6302, 168, 36, "Print"],
Cell[88869, 2051, 740, 16, 26, "Print"],
Cell[89612, 2069, 642, 13, 23, "Print"],
Cell[90257, 2084, 2624, 46, 62, "Print"],
Cell[92884, 2132, 442, 11, 23, "Print"]
}, Open  ]],
Cell[93341, 2146, 17720, 309, 113, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[111098, 2460, 20747, 453, 798, "Input"],
Cell[CellGroupData[{
Cell[131870, 2917, 1185, 19, 23, "Print"],
Cell[133058, 2938, 7209, 180, 69, "Print"],
Cell[140270, 3120, 1518, 27, 26, "Print"],
Cell[141791, 3149, 1423, 24, 23, "Print"],
Cell[143217, 3175, 1575, 28, 23, "Print"],
Cell[144795, 3205, 7209, 180, 69, "Print"],
Cell[152007, 3387, 1518, 27, 26, "Print"],
Cell[153528, 3416, 1425, 24, 23, "Print"],
Cell[154956, 3442, 1429, 26, 23, "Print"],
Cell[156388, 3470, 2981, 52, 62, "Print"],
Cell[159372, 3524, 12720, 239, 132, "Print"]
}, Open  ]],
Cell[172107, 3766, 395, 7, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[172539, 3778, 114, 1, 71, "Section"],
Cell[172656, 3781, 782, 23, 47, "Input"],
Cell[173441, 3806, 627, 15, 46, "Input"],
Cell[174071, 3823, 2414, 75, 77, "Input"],
Cell[176488, 3900, 1121, 34, 47, "Input"],
Cell[177612, 3936, 377, 6, 31, "Input"],
Cell[177992, 3944, 233, 6, 31, "Input"],
Cell[178228, 3952, 427, 13, 33, "Input"],
Cell[178658, 3967, 547, 18, 31, "Input"],
Cell[179208, 3987, 144, 2, 31, "Input"],
Cell[179355, 3991, 543, 15, 47, "Text"],
Cell[179901, 4008, 1142, 34, 36, "Text"],
Cell[181046, 4044, 242, 3, 31, "Input"],
Cell[181291, 4049, 736, 18, 31, "Input"],
Cell[CellGroupData[{
Cell[182052, 4071, 11248, 243, 475, "Input"],
Cell[CellGroupData[{
Cell[193325, 4318, 549, 10, 23, "Print"],
Cell[193877, 4330, 4902, 127, 85, "Print"],
Cell[198782, 4459, 649, 15, 23, "Print"],
Cell[199434, 4476, 569, 12, 23, "Print"]
}, Open  ]],
Cell[200018, 4491, 15960, 275, 271, "Output"]
}, Open  ]],
Cell[215993, 4769, 102, 1, 31, "Input"],
Cell[CellGroupData[{
Cell[216120, 4774, 616, 20, 31, "Input",
 CellID->26946],
Cell[216739, 4796, 1874, 38, 350, "Output"]
}, Open  ]],
Cell[218628, 4837, 9326, 225, 488, "Input"],
Cell[CellGroupData[{
Cell[227979, 5066, 5068, 123, 246, "Input"],
Cell[233050, 5191, 2428, 45, 631, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[235515, 5241, 6098, 151, 248, "Input"],
Cell[241616, 5394, 15228, 257, 384, "Output"]
}, Open  ]],
Cell[256859, 5654, 161, 3, 47, "Input"],
Cell[CellGroupData[{
Cell[257045, 5661, 5879, 144, 228, "Input"],
Cell[262927, 5807, 182, 4, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[263146, 5816, 5768, 143, 228, "Input"],
Cell[CellGroupData[{
Cell[268939, 5963, 5102, 108, 89, "Print"],
Cell[274044, 6073, 5194, 110, 96, "Print"],
Cell[279241, 6185, 5123, 110, 89, "Print"],
Cell[284367, 6297, 5246, 112, 96, "Print"],
Cell[289616, 6411, 1312, 28, 43, "Print"]
}, Open  ]],
Cell[290943, 6442, 168, 3, 33, "Output"]
}, Open  ]],
Cell[291126, 6448, 21628, 491, 536, "Input"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
